/*! jQuery v1.8.2 jquery.com | jquery.org/license */
(function(a,b){function G(a){var b=F[a]={};return p.each(a.split(s),function(a,c){b[c]=!0}),b}function J(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(I,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:+d+""===d?+d:H.test(d)?p.parseJSON(d):d}catch(f){}p.data(a,c,d)}else{d=b}}return d}function K(a){var b;for(b in a){if(b==="data"&&p.isEmptyObject(a[b])){continue}if(b!=="toJSON"){return !1}}return !0}function ba(){return !1}function bb(){return !0}function bh(a){return !a||!a.parentNode||a.parentNode.nodeType===11}function bi(a,b){do{a=a[b]}while(a&&a.nodeType!==1);return a}function bj(a,b,c){b=b||0;if(p.isFunction(b)){return p.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c})}if(b.nodeType){return p.grep(a,function(a,d){return a===b===c})}if(typeof b=="string"){var d=p.grep(a,function(a){return a.nodeType===1});if(be.test(b)){return p.filter(b,d,!c)}b=p.filter(b,d)}return p.grep(a,function(a,d){return p.inArray(a,b)>=0===c})}function bk(a){var b=bl.split("|"),c=a.createDocumentFragment();if(c.createElement){while(b.length){c.createElement(b.pop())}}return c}function bC(a,b){return a.getElementsByTagName(b)[0]||a.appendChild(a.ownerDocument.createElement(b))}function bD(a,b){if(b.nodeType!==1||!p.hasData(a)){return}var c,d,e,f=p._data(a),g=p._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h){for(d=0,e=h[c].length;d<e;d++){p.event.add(b,c,h[c][d])}}}g.data&&(g.data=p.extend({},g.data))}function bE(a,b){var c;if(b.nodeType!==1){return}b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),c==="object"?(b.parentNode&&(b.outerHTML=a.outerHTML),p.support.html5Clone&&a.innerHTML&&!p.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):c==="input"&&bv.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):c==="option"?b.selected=a.defaultSelected:c==="input"||c==="textarea"?b.defaultValue=a.defaultValue:c==="script"&&b.text!==a.text&&(b.text=a.text),b.removeAttribute(p.expando)}function bF(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bG(a){bv.test(a.type)&&(a.defaultChecked=a.checked)}function bY(a,b){if(b in a){return b}var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=bW.length;while(e--){b=bW[e]+c;if(b in a){return b}}return d}function bZ(a,b){return a=b||a,p.css(a,"display")==="none"||!p.contains(a.ownerDocument,a)}function b$(a,b){var c,d,e=[],f=0,g=a.length;for(;f<g;f++){c=a[f];if(!c.style){continue}e[f]=p._data(c,"olddisplay"),b?(!e[f]&&c.style.display==="none"&&(c.style.display=""),c.style.display===""&&bZ(c)&&(e[f]=p._data(c,"olddisplay",cc(c.nodeName)))):(d=bH(c,"display"),!e[f]&&d!=="none"&&p._data(c,"olddisplay",d))}for(f=0;f<g;f++){c=a[f];if(!c.style){continue}if(!b||c.style.display==="none"||c.style.display===""){c.style.display=b?e[f]||"":"none"}}return a}function b_(a,b,c){var d=bP.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function ca(a,b,c,d){var e=c===(d?"border":"content")?4:b==="width"?1:0,f=0;for(;e<4;e+=2){c==="margin"&&(f+=p.css(a,c+bV[e],!0)),d?(c==="content"&&(f-=parseFloat(bH(a,"padding"+bV[e]))||0),c!=="margin"&&(f-=parseFloat(bH(a,"border"+bV[e]+"Width"))||0)):(f+=parseFloat(bH(a,"padding"+bV[e]))||0,c!=="padding"&&(f+=parseFloat(bH(a,"border"+bV[e]+"Width"))||0))}return f}function cb(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=!0,f=p.support.boxSizing&&p.css(a,"boxSizing")==="border-box";if(d<=0||d==null){d=bH(a,b);if(d<0||d==null){d=a.style[b]}if(bQ.test(d)){return d}e=f&&(p.support.boxSizingReliable||d===a.style[b]),d=parseFloat(d)||0}return d+ca(a,b,c||(f?"border":"content"),e)+"px"}function cc(a){if(bS[a]){return bS[a]}var b=p("<"+a+">").appendTo(e.body),c=b.css("display");b.remove();if(c==="none"||c===""){bI=e.body.appendChild(bI||p.extend(e.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!bJ||!bI.createElement){bJ=(bI.contentWindow||bI.contentDocument).document,bJ.write("<!doctype html><html><body>"),bJ.close()}b=bJ.body.appendChild(bJ.createElement(a)),c=bH(b,"display"),e.body.removeChild(bI)}return bS[a]=c,c}function ci(a,b,c,d){var e;if(p.isArray(b)){p.each(b,function(b,e){c||ce.test(a)?d(a,e):ci(a+"["+(typeof e=="object"?b:"")+"]",e,c,d)})}else{if(!c&&p.type(b)==="object"){for(e in b){ci(a+"["+e+"]",b[e],c,d)}}else{d(a,b)}}}function cz(a){return function(b,c){typeof b!="string"&&(c=b,b="*");var d,e,f,g=b.toLowerCase().split(s),h=0,i=g.length;if(p.isFunction(c)){for(;h<i;h++){d=g[h],f=/^\+/.test(d),f&&(d=d.substr(1)||"*"),e=a[d]=a[d]||[],e[f?"unshift":"push"](c)}}}}function cA(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h,i=a[f],j=0,k=i?i.length:0,l=a===cv;for(;j<k&&(l||!h);j++){h=i[j](c,d,e),typeof h=="string"&&(!l||g[h]?h=b:(c.dataTypes.unshift(h),h=cA(a,c,d,e,h,g)))}return(l||!h)&&!g["*"]&&(h=cA(a,c,d,e,"*",g)),h}function cB(a,c){var d,e,f=p.ajaxSettings.flatOptions||{};for(d in c){c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d])}e&&p.extend(!0,a,e)}function cC(a,c,d){var e,f,g,h,i=a.contents,j=a.dataTypes,k=a.responseFields;for(f in k){f in d&&(c[k[f]]=d[f])}while(j[0]==="*"){j.shift(),e===b&&(e=a.mimeType||c.getResponseHeader("content-type"))}if(e){for(f in i){if(i[f]&&i[f].test(e)){j.unshift(f);break}}}if(j[0] in d){g=j[0]}else{for(f in d){if(!j[0]||a.converters[f+" "+j[0]]){g=f;break}h||(h=f)}g=g||h}if(g){return g!==j[0]&&j.unshift(g),d[g]}}function cD(a,b){var c,d,e,f,g=a.dataTypes.slice(),h=g[0],i={},j=0;a.dataFilter&&(b=a.dataFilter(b,a.dataType));if(g[1]){for(c in a.converters){i[c.toLowerCase()]=a.converters[c]}}for(;e=g[++j];){if(e!=="*"){if(h!=="*"&&h!==e){c=i[h+" "+e]||i["* "+e];if(!c){for(d in i){f=d.split(" ");if(f[1]===e){c=i[h+" "+f[0]]||i["* "+f[0]];if(c){c===!0?c=i[d]:i[d]!==!0&&(e=f[0],g.splice(j--,0,e));break}}}}if(c!==!0){if(c&&a["throws"]){b=c(b)}else{try{b=c(b)}catch(k){return{state:"parsererror",error:c?k:"No conversion from "+h+" to "+e}}}}}h=e}}return{state:"success",data:b}}function cL(){try{return new a.XMLHttpRequest}catch(b){}}function cM(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function cU(){return setTimeout(function(){cN=b},0),cN=p.now()}function cV(a,b){p.each(b,function(b,c){var d=(cT[b]||[]).concat(cT["*"]),e=0,f=d.length;for(;e<f;e++){if(d[e].call(a,b,c)){return}}})}function cW(a,b,c){var d,e=0,f=0,g=cS.length,h=p.Deferred().always(function(){delete i.elem}),i=function(){var b=cN||cU(),c=Math.max(0,j.startTime+j.duration-b),d=1-(c/j.duration||0),e=0,f=j.tweens.length;for(;e<f;e++){j.tweens[e].run(d)}return h.notifyWith(a,[j,d,c]),d<1&&f?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:p.extend({},b),opts:p.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:cN||cU(),duration:c.duration,tweens:[],createTween:function(b,c,d){var e=p.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(e),e},stop:function(b){var c=0,d=b?j.tweens.length:0;for(;c<d;c++){j.tweens[c].run(1)}return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;cX(k,j.opts.specialEasing);for(;e<g;e++){d=cS[e].call(j,a,k,j.opts);if(d){return d}}return cV(j,k),p.isFunction(j.opts.start)&&j.opts.start.call(a,j),p.fx.timer(p.extend(i,{anim:j,queue:j.opts.queue,elem:a})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function cX(a,b){var c,d,e,f,g;for(c in a){d=p.camelCase(c),e=b[d],f=a[c],p.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=p.cssHooks[d];if(g&&"expand" in g){f=g.expand(f),delete a[d];for(c in f){c in a||(a[c]=f[c],b[c]=e)}}else{b[d]=e}}}function cY(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=a.style,n={},o=[],q=a.nodeType&&bZ(a);c.queue||(j=p._queueHooks(a,"fx"),j.unqueued==null&&(j.unqueued=0,k=j.empty.fire,j.empty.fire=function(){j.unqueued||k()}),j.unqueued++,l.always(function(){l.always(function(){j.unqueued--,p.queue(a,"fx").length||j.empty.fire()})})),a.nodeType===1&&("height" in b||"width" in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],p.css(a,"display")==="inline"&&p.css(a,"float")==="none"&&(!p.support.inlineBlockNeedsLayout||cc(a.nodeName)==="inline"?m.display="inline-block":m.zoom=1)),c.overflow&&(m.overflow="hidden",p.support.shrinkWrapBlocks||l.done(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b){f=b[d];if(cP.exec(f)){delete b[d];if(f===(q?"hide":"show")){continue}o.push(d)}}g=o.length;if(g){h=p._data(a,"fxshow")||p._data(a,"fxshow",{}),q?p(a).show():l.done(function(){p(a).hide()}),l.done(function(){var b;p.removeData(a,"fxshow",!0);for(b in n){p.style(a,b,n[b])}});for(d=0;d<g;d++){e=o[d],i=l.createTween(e,q?h[e]:0),n[e]=h[e]||p.style(a,e),e in h||(h[e]=i.start,q&&(i.end=i.start,i.start=e==="width"||e==="height"?1:0))}}}function cZ(a,b,c,d,e){return new cZ.prototype.init(a,b,c,d,e)}function c$(a,b){var c,d={height:a},e=0;b=b?1:0;for(;e<4;e+=2-b){c=bV[e],d["margin"+c]=d["padding"+c]=a}return b&&(d.opacity=d.width=a),d}function da(a){return p.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}var c,d,e=a.document,f=a.location,g=a.navigator,h=a.jQuery,i=a.$,j=Array.prototype.push,k=Array.prototype.slice,l=Array.prototype.indexOf,m=Object.prototype.toString,n=Object.prototype.hasOwnProperty,o=String.prototype.trim,p=function(a,b){return new p.fn.init(a,b,c)},q=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,r=/\S/,s=/\s+/,t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,u=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,y=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,z=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,A=/^-ms-/,B=/-([\da-z])/gi,C=function(a,b){return(b+"").toUpperCase()},D=function(){e.addEventListener?(e.removeEventListener("DOMContentLoaded",D,!1),p.ready()):e.readyState==="complete"&&(e.detachEvent("onreadystatechange",D),p.ready())},E={};p.fn=p.prototype={constructor:p,init:function(a,c,d){var f,g,h,i;if(!a){return this}if(a.nodeType){return this.context=this[0]=a,this.length=1,this}if(typeof a=="string"){a.charAt(0)==="<"&&a.charAt(a.length-1)===">"&&a.length>=3?f=[null,a,null]:f=u.exec(a);if(f&&(f[1]||!c)){if(f[1]){return c=c instanceof p?c[0]:c,i=c&&c.nodeType?c.ownerDocument||c:e,a=p.parseHTML(f[1],i,!0),v.test(f[1])&&p.isPlainObject(c)&&this.attr.call(a,c,!0),p.merge(this,a)}g=e.getElementById(f[2]);if(g&&g.parentNode){if(g.id!==f[2]){return d.find(a)}this.length=1,this[0]=g}return this.context=e,this.selector=a,this}return !c||c.jquery?(c||d).find(a):this.constructor(c).find(a)}return p.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),p.makeArray(a,this))},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return k.call(this)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=p.merge(this.constructor(),a);return d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d},each:function(a,b){return p.each(this,a,b)},ready:function(a){return p.ready.promise().done(a),this},eq:function(a){return a=+a,a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(k.apply(this,arguments),"slice",k.call(arguments).join(","))},map:function(a){return this.pushStack(p.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:j,sort:[].sort,splice:[].splice},p.fn.init.prototype=p.fn,p.extend=p.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;typeof h=="boolean"&&(k=h,h=arguments[1]||{},i=2),typeof h!="object"&&!p.isFunction(h)&&(h={}),j===i&&(h=this,--i);for(;i<j;i++){if((a=arguments[i])!=null){for(c in a){d=h[c],e=a[c];if(h===e){continue}k&&e&&(p.isPlainObject(e)||(f=p.isArray(e)))?(f?(f=!1,g=d&&p.isArray(d)?d:[]):g=d&&p.isPlainObject(d)?d:{},h[c]=p.extend(k,g,e)):e!==b&&(h[c]=e)}}}return h},p.extend({noConflict:function(b){return a.$===p&&(a.$=i),b&&a.jQuery===p&&(a.jQuery=h),p},isReady:!1,readyWait:1,holdReady:function(a){a?p.readyWait++:p.ready(!0)},ready:function(a){if(a===!0?--p.readyWait:p.isReady){return}if(!e.body){return setTimeout(p.ready,1)}p.isReady=!0;if(a!==!0&&--p.readyWait>0){return}d.resolveWith(e,[p]),p.fn.trigger&&p(e).trigger("ready").off("ready")},isFunction:function(a){return p.type(a)==="function"},isArray:Array.isArray||function(a){return p.type(a)==="array"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return !isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):E[m.call(a)]||"object"},isPlainObject:function(a){if(!a||p.type(a)!=="object"||a.nodeType||p.isWindow(a)){return !1}try{if(a.constructor&&!n.call(a,"constructor")&&!n.call(a.constructor.prototype,"isPrototypeOf")){return !1}}catch(c){return !1}var d;for(d in a){}return d===b||n.call(a,d)},isEmptyObject:function(a){var b;for(b in a){return !1}return !0},error:function(a){throw new Error(a)},parseHTML:function(a,b,c){var d;return !a||typeof a!="string"?null:(typeof b=="boolean"&&(c=b,b=0),b=b||e,(d=v.exec(a))?[b.createElement(d[1])]:(d=p.buildFragment([a],b,c?null:[]),p.merge([],(d.cacheable?p.clone(d.fragment):d.fragment).childNodes)))},parseJSON:function(b){if(!b||typeof b!="string"){return null}b=p.trim(b);if(a.JSON&&a.JSON.parse){return a.JSON.parse(b)}if(w.test(b.replace(y,"@").replace(z,"]").replace(x,""))){return(new Function("return "+b))()}p.error("Invalid JSON: "+b)},parseXML:function(c){var d,e;if(!c||typeof c!="string"){return null}try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&p.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&r.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(A,"ms-").replace(B,C)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,c,d){var e,f=0,g=a.length,h=g===b||p.isFunction(a);if(d){if(h){for(e in a){if(c.apply(a[e],d)===!1){break}}}else{for(;f<g;){if(c.apply(a[f++],d)===!1){break}}}}else{if(h){for(e in a){if(c.call(a[e],e,a[e])===!1){break}}}else{for(;f<g;){if(c.call(a[f],f,a[f++])===!1){break}}}}return a},trim:o&&!o.call(" ")?function(a){return a==null?"":o.call(a)}:function(a){return a==null?"":(a+"").replace(t,"")},makeArray:function(a,b){var c,d=b||[];return a!=null&&(c=p.type(a),a.length==null||c==="string"||c==="function"||c==="regexp"||p.isWindow(a)?j.call(d,a):p.merge(d,a)),d},inArray:function(a,b,c){var d;if(b){if(l){return l.call(b,a,c)}d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++){if(c in b&&b[c]===a){return c}}}return -1},merge:function(a,c){var d=c.length,e=a.length,f=0;if(typeof d=="number"){for(;f<d;f++){a[e++]=c[f]}}else{while(c[f]!==b){a[e++]=c[f++]}}return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;c=!!c;for(;f<g;f++){d=!!b(a[f],f),c!==d&&e.push(a[f])}return e},map:function(a,c,d){var e,f,g=[],h=0,i=a.length,j=a instanceof p||i!==b&&typeof i=="number"&&(i>0&&a[0]&&a[i-1]||i===0||p.isArray(a));if(j){for(;h<i;h++){e=c(a[h],h,d),e!=null&&(g[g.length]=e)}}else{for(f in a){e=c(a[f],f,d),e!=null&&(g[g.length]=e)}}return g.concat.apply([],g)},guid:1,proxy:function(a,c){var d,e,f;return typeof c=="string"&&(d=a[c],c=a,a=d),p.isFunction(a)?(e=k.call(arguments,2),f=function(){return a.apply(c,e.concat(k.call(arguments)))},f.guid=a.guid=a.guid||p.guid++,f):b},access:function(a,c,d,e,f,g,h){var i,j=d==null,k=0,l=a.length;if(d&&typeof d=="object"){for(k in d){p.access(a,c,k,d[k],1,g,e)}f=1}else{if(e!==b){i=h===b&&p.isFunction(e),j&&(i?(i=c,c=function(a,b,c){return i.call(p(a),c)}):(c.call(a,e),c=null));if(c){for(;k<l;k++){c(a[k],d,i?e.call(a[k],k,c(a[k],d)):e,h)}}f=1}}return f?a:j?c.call(a):l?c(a[0],d):g},now:function(){return(new Date).getTime()}}),p.ready.promise=function(b){if(!d){d=p.Deferred();if(e.readyState==="complete"){setTimeout(p.ready,1)}else{if(e.addEventListener){e.addEventListener("DOMContentLoaded",D,!1),a.addEventListener("load",p.ready,!1)}else{e.attachEvent("onreadystatechange",D),a.attachEvent("onload",p.ready);var c=!1;try{c=a.frameElement==null&&e.documentElement}catch(f){}c&&c.doScroll&&function g(){if(!p.isReady){try{c.doScroll("left")}catch(a){return setTimeout(g,50)}p.ready()}}()}}}return d.promise(b)},p.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){E["[object "+b+"]"]=b.toLowerCase()}),c=p(e);var F={};p.Callbacks=function(a){a=typeof a=="string"?F[a]||G(a):p.extend({},a);var c,d,e,f,g,h,i=[],j=!a.once&&[],k=function(b){c=a.memory&&b,d=!0,h=f||0,f=0,g=i.length,e=!0;for(;i&&h<g;h++){if(i[h].apply(b[0],b[1])===!1&&a.stopOnFalse){c=!1;break}}e=!1,i&&(j?j.length&&k(j.shift()):c?i=[]:l.disable())},l={add:function(){if(i){var b=i.length;(function d(b){p.each(b,function(b,c){var e=p.type(c);e==="function"&&(!a.unique||!l.has(c))?i.push(c):c&&c.length&&e!=="string"&&d(c)})})(arguments),e?g=i.length:c&&(f=b,k(c))}return this},remove:function(){return i&&p.each(arguments,function(a,b){var c;while((c=p.inArray(b,i,c))>-1){i.splice(c,1),e&&(c<=g&&g--,c<=h&&h--)}}),this},has:function(a){return p.inArray(a,i)>-1},empty:function(){return i=[],this},disable:function(){return i=j=c=b,this},disabled:function(){return !i},lock:function(){return j=b,c||l.disable(),this},locked:function(){return !j},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],i&&(!d||j)&&(e?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return !!d}};return l},p.extend({Deferred:function(a){var b=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return p.Deferred(function(c){p.each(b,function(b,d){var f=d[0],g=a[b];e[d[1]](p.isFunction(g)?function(){var a=g.apply(this,arguments);a&&p.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f+"With"](this===e?c:this,[a])}:c[f])}),a=null}).promise()},promise:function(a){return a!=null?p.extend(a,d):d}},e={};return d.pipe=d.then,p.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[a^1][2].disable,b[2][2].lock),e[f[0]]=g.fire,e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=k.call(arguments),d=c.length,e=d!==1||a&&p.isFunction(a.promise)?d:0,f=e===1?a:p.Deferred(),g=function(a,b,c){return function(d){b[a]=this,c[a]=arguments.length>1?k.call(arguments):d,c===h?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},h,i,j;if(d>1){h=new Array(d),i=new Array(d),j=new Array(d);for(;b<d;b++){c[b]&&p.isFunction(c[b].promise)?c[b].promise().done(g(b,j,c)).fail(f.reject).progress(g(b,i,h)):--e}}return e||f.resolveWith(j,c),f.promise()}}),p.support=function(){var b,c,d,f,g,h,i,j,k,l,m,n=e.createElement("div");n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=n.getElementsByTagName("*"),d=n.getElementsByTagName("a")[0],d.style.cssText="top:1px;float:left;opacity:.5";if(!c||!c.length){return{}}f=e.createElement("select"),g=f.appendChild(e.createElement("option")),h=n.getElementsByTagName("input")[0],b={leadingWhitespace:n.firstChild.nodeType===3,tbody:!n.getElementsByTagName("tbody").length,htmlSerialize:!!n.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:d.getAttribute("href")==="/a",opacity:/^0.5/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:h.value==="on",optSelected:g.selected,getSetAttribute:n.className!=="t",enctype:!!e.createElement("form").enctype,html5Clone:e.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:e.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},h.checked=!0,b.noCloneChecked=h.cloneNode(!0).checked,f.disabled=!0,b.optDisabled=!g.disabled;try{delete n.test}catch(o){b.deleteExpando=!1}!n.addEventListener&&n.attachEvent&&n.fireEvent&&(n.attachEvent("onclick",m=function(){b.noCloneEvent=!1}),n.cloneNode(!0).fireEvent("onclick"),n.detachEvent("onclick",m)),h=e.createElement("input"),h.value="t",h.setAttribute("type","radio"),b.radioValue=h.value==="t",h.setAttribute("checked","checked"),h.setAttribute("name","t"),n.appendChild(h),i=e.createDocumentFragment(),i.appendChild(n.lastChild),b.checkClone=i.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=h.checked,i.removeChild(h),i.appendChild(n);if(n.attachEvent){for(k in {submit:!0,change:!0,focusin:!0}){j="on"+k,l=j in n,l||(n.setAttribute(j,"return;"),l=typeof n[j]=="function"),b[k+"Bubbles"]=l}}return p(function(){var c,d,f,g,h="padding:0;margin:0;border:0;display:block;overflow:hidden;",i=e.getElementsByTagName("body")[0];if(!i){return}c=e.createElement("div"),c.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",i.insertBefore(c,i.firstChild),d=e.createElement("div"),c.appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",f=d.getElementsByTagName("td"),f[0].style.cssText="padding:0;margin:0;border:0;display:none",l=f[0].offsetHeight===0,f[0].style.display="",f[1].style.display="none",b.reliableHiddenOffsets=l&&f[0].offsetHeight===0,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",b.boxSizing=d.offsetWidth===4,b.doesNotIncludeMarginInBodyOffset=i.offsetTop!==1,a.getComputedStyle&&(b.pixelPosition=(a.getComputedStyle(d,null)||{}).top!=="1%",b.boxSizingReliable=(a.getComputedStyle(d,null)||{width:"4px"}).width==="4px",g=e.createElement("div"),g.style.cssText=d.style.cssText=h,g.style.marginRight=g.style.width="0",d.style.width="1px",d.appendChild(g),b.reliableMarginRight=!parseFloat((a.getComputedStyle(g,null)||{}).marginRight)),typeof d.style.zoom!="undefined"&&(d.innerHTML="",d.style.cssText=h+"width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=d.offsetWidth===3,d.style.display="block",d.style.overflow="visible",d.innerHTML="<div></div>",d.firstChild.style.width="5px",b.shrinkWrapBlocks=d.offsetWidth!==3,c.style.zoom=1),i.removeChild(c),c=d=f=g=null}),i.removeChild(n),c=d=f=g=h=i=n=null,b}();var H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,I=/([A-Z])/g;p.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(p.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?p.cache[a[p.expando]]:a[p.expando],!!a&&!K(a)},data:function(a,c,d,e){if(!p.acceptData(a)){return}var f,g,h=p.expando,i=typeof c=="string",j=a.nodeType,k=j?p.cache:a,l=j?a[h]:a[h]&&h;if((!l||!k[l]||!e&&!k[l].data)&&i&&d===b){return}l||(j?a[h]=l=p.deletedIds.pop()||p.guid++:l=h),k[l]||(k[l]={},j||(k[l].toJSON=p.noop));if(typeof c=="object"||typeof c=="function"){e?k[l]=p.extend(k[l],c):k[l].data=p.extend(k[l].data,c)}return f=k[l],e||(f.data||(f.data={}),f=f.data),d!==b&&(f[p.camelCase(c)]=d),i?(g=f[c],g==null&&(g=f[p.camelCase(c)])):g=f,g},removeData:function(a,b,c){if(!p.acceptData(a)){return}var d,e,f,g=a.nodeType,h=g?p.cache:a,i=g?a[p.expando]:p.expando;if(!h[i]){return}if(b){d=c?h[i]:h[i].data;if(d){p.isArray(b)||(b in d?b=[b]:(b=p.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,f=b.length;e<f;e++){delete d[b[e]]}if(!(c?K:p.isEmptyObject)(d)){return}}}if(!c){delete h[i].data;if(!K(h[i])){return}}g?p.cleanData([a],!0):p.support.deleteExpando||h!=h.window?delete h[i]:h[i]=null},_data:function(a,b,c){return p.data(a,b,c,!0)},acceptData:function(a){var b=a.nodeName&&p.noData[a.nodeName.toLowerCase()];return !b||b!==!0&&a.getAttribute("classid")===b}}),p.fn.extend({data:function(a,c){var d,e,f,g,h,i=this[0],j=0,k=null;if(a===b){if(this.length){k=p.data(i);if(i.nodeType===1&&!p._data(i,"parsedAttrs")){f=i.attributes;for(h=f.length;j<h;j++){g=f[j].name,g.indexOf("data-")||(g=p.camelCase(g.substring(5)),J(i,g,k[g]))}p._data(i,"parsedAttrs",!0)}}return k}return typeof a=="object"?this.each(function(){p.data(this,a)}):(d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",e=d[1]+"!",p.access(this,function(c){if(c===b){return k=this.triggerHandler("getData"+e,[d[0]]),k===b&&i&&(k=p.data(i,a),k=J(i,a,k)),k===b&&d[1]?this.data(d[0]):k}d[1]=c,this.each(function(){var b=p(this);b.triggerHandler("setData"+e,d),p.data(this,a,c),b.triggerHandler("changeData"+e,d)})},null,c,arguments.length>1,null,!1))},removeData:function(a){return this.each(function(){p.removeData(this,a)})}}),p.extend({queue:function(a,b,c){var d;if(a){return b=(b||"fx")+"queue",d=p._data(a,b),c&&(!d||p.isArray(c)?d=p._data(a,b,p.makeArray(c)):d.push(c)),d||[]}},dequeue:function(a,b){b=b||"fx";var c=p.queue(a,b),d=c.length,e=c.shift(),f=p._queueHooks(a,b),g=function(){p.dequeue(a,b)};e==="inprogress"&&(e=c.shift(),d--),e&&(b==="fx"&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return p._data(a,c)||p._data(a,c,{empty:p.Callbacks("once memory").add(function(){p.removeData(a,b+"queue",!0),p.removeData(a,c,!0)})})}}),p.fn.extend({queue:function(a,c){var d=2;return typeof a!="string"&&(c=a,a="fx",d--),arguments.length<d?p.queue(this[0],a):c===b?this:this.each(function(){var b=p.queue(this,a,c);p._queueHooks(this,a),a==="fx"&&b[0]!=="inprogress"&&p.dequeue(this,a)})},dequeue:function(a){return this.each(function(){p.dequeue(this,a)})},delay:function(a,b){return a=p.fx?p.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=p.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};typeof a!="string"&&(c=a,a=b),a=a||"fx";while(h--){d=p._data(g[h],a+"queueHooks"),d&&d.empty&&(e++,d.empty.add(i))}return i(),f.promise(c)}});var L,M,N,O=/[\t\r\n]/g,P=/\r/g,Q=/^(?:button|input)$/i,R=/^(?:button|input|object|select|textarea)$/i,S=/^a(?:rea|)$/i,T=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,U=p.support.getSetAttribute;p.fn.extend({attr:function(a,b){return p.access(this,p.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){p.removeAttr(this,a)})},prop:function(a,b){return p.access(this,p.prop,a,b,arguments.length>1)},removeProp:function(a){return a=p.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g,h;if(p.isFunction(a)){return this.each(function(b){p(this).addClass(a.call(this,b,this.className))})}if(a&&typeof a=="string"){b=a.split(s);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1){if(!e.className&&b.length===1){e.className=a}else{f=" "+e.className+" ";for(g=0,h=b.length;g<h;g++){f.indexOf(" "+b[g]+" ")<0&&(f+=b[g]+" ")}e.className=p.trim(f)}}}}return this},removeClass:function(a){var c,d,e,f,g,h,i;if(p.isFunction(a)){return this.each(function(b){p(this).removeClass(a.call(this,b,this.className))})}if(a&&typeof a=="string"||a===b){c=(a||"").split(s);for(h=0,i=this.length;h<i;h++){e=this[h];if(e.nodeType===1&&e.className){d=(" "+e.className+" ").replace(O," ");for(f=0,g=c.length;f<g;f++){while(d.indexOf(" "+c[f]+" ")>=0){d=d.replace(" "+c[f]+" "," ")}}e.className=a?p.trim(d):""}}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";return p.isFunction(a)?this.each(function(c){p(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if(c==="string"){var e,f=0,g=p(this),h=b,i=a.split(s);while(e=i[f++]){h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e)}}else{if(c==="undefined"||c==="boolean"){this.className&&p._data(this,"__className__",this.className),this.className=this.className||a===!1?"":p._data(this,"__className__")||""}}})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++){if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(O," ").indexOf(b)>=0){return !0}}return !1},val:function(a){var c,d,e,f=this[0];if(!arguments.length){if(f){return c=p.valHooks[f.type]||p.valHooks[f.nodeName.toLowerCase()],c&&"get" in c&&(d=c.get(f,"value"))!==b?d:(d=f.value,typeof d=="string"?d.replace(P,""):d==null?"":d)}return}return e=p.isFunction(a),this.each(function(d){var f,g=p(this);if(this.nodeType!==1){return}e?f=a.call(this,d,g.val()):f=a,f==null?f="":typeof f=="number"?f+="":p.isArray(f)&&(f=p.map(f,function(a){return a==null?"":a+""})),c=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()];if(!c||!("set" in c)||c.set(this,f,"value")===b){this.value=f}})}}),p.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return !b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,f=a.selectedIndex,g=[],h=a.options,i=a.type==="select-one";if(f<0){return null}c=i?f:0,d=i?f+1:h.length;for(;c<d;c++){e=h[c];if(e.selected&&(p.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!p.nodeName(e.parentNode,"optgroup"))){b=p(e).val();if(i){return b}g.push(b)}}return i&&!g.length&&h.length?p(h[f]).val():g},set:function(a,b){var c=p.makeArray(b);return p(a).find("option").each(function(){this.selected=p.inArray(p(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attrFn:{},attr:function(a,c,d,e){var f,g,h,i=a.nodeType;if(!a||i===3||i===8||i===2){return}if(e&&p.isFunction(p.fn[c])){return p(a)[c](d)}if(typeof a.getAttribute=="undefined"){return p.prop(a,c,d)}h=i!==1||!p.isXMLDoc(a),h&&(c=c.toLowerCase(),g=p.attrHooks[c]||(T.test(c)?M:L));if(d!==b){if(d===null){p.removeAttr(a,c);return}return g&&"set" in g&&h&&(f=g.set(a,d,c))!==b?f:(a.setAttribute(c,d+""),d)}return g&&"get" in g&&h&&(f=g.get(a,c))!==null?f:(f=a.getAttribute(c),f===null?b:f)},removeAttr:function(a,b){var c,d,e,f,g=0;if(b&&a.nodeType===1){d=b.split(s);for(;g<d.length;g++){e=d[g],e&&(c=p.propFix[e]||e,f=T.test(e),f||p.attr(a,e,""),a.removeAttribute(U?e:c),f&&c in a&&(a[c]=!1))}}},attrHooks:{type:{set:function(a,b){if(Q.test(a.nodeName)&&a.parentNode){p.error("type property can't be changed")}else{if(!p.support.radioValue&&b==="radio"&&p.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},value:{get:function(a,b){return L&&p.nodeName(a,"button")?L.get(a,b):b in a?a.value:null},set:function(a,b,c){if(L&&p.nodeName(a,"button")){return L.set(a,b,c)}a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;if(!a||h===3||h===8||h===2){return}return g=h!==1||!p.isXMLDoc(a),g&&(c=p.propFix[c]||c,f=p.propHooks[c]),d!==b?f&&"set" in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get" in f&&(e=f.get(a,c))!==null?e:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):R.test(a.nodeName)||S.test(a.nodeName)&&a.href?0:b}}}}),M={get:function(a,c){var d,e=p.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;return b===!1?p.removeAttr(a,c):(d=p.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}},U||(N={name:!0,id:!0,coords:!0},L=p.valHooks.button={get:function(a,c){var d;return d=a.getAttributeNode(c),d&&(N[c]?d.value!=="":d.specified)?d.value:b},set:function(a,b,c){var d=a.getAttributeNode(c);return d||(d=e.createAttribute(c),a.setAttributeNode(d)),d.value=b+""}},p.each(["width","height"],function(a,b){p.attrHooks[b]=p.extend(p.attrHooks[b],{set:function(a,c){if(c===""){return a.setAttribute(b,"auto"),c}}})}),p.attrHooks.contenteditable={get:L.get,set:function(a,b,c){b===""&&(b="false"),L.set(a,b,c)}}),p.support.hrefNormalized||p.each(["href","src","width","height"],function(a,c){p.attrHooks[c]=p.extend(p.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),p.support.style||(p.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=b+""}}),p.support.optSelected||(p.propHooks.selected=p.extend(p.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),p.support.enctype||(p.propFix.enctype="encoding"),p.support.checkOn||p.each(["radio","checkbox"],function(){p.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]=p.extend(p.valHooks[this],{set:function(a,b){if(p.isArray(b)){return a.checked=p.inArray(p(a).val(),b)>=0}}})});var V=/^(?:textarea|input|select)$/i,W=/^([^\.]*|)(?:\.(.+)|)$/,X=/(?:^|\s)hover(\.\S+|)\b/,Y=/^key/,Z=/^(?:mouse|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=function(a){return p.event.special.hover?a:a.replace(X,"mouseenter$1 mouseleave$1")};p.event={add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,q,r;if(a.nodeType===3||a.nodeType===8||!c||!d||!(g=p._data(a))){return}d.handler&&(o=d,d=o.handler,f=o.selector),d.guid||(d.guid=p.guid++),i=g.events,i||(g.events=i={}),h=g.handle,h||(g.handle=h=function(a){return typeof p!="undefined"&&(!a||p.event.triggered!==a.type)?p.event.dispatch.apply(h.elem,arguments):b},h.elem=a),c=p.trim(_(c)).split(" ");for(j=0;j<c.length;j++){k=W.exec(c[j])||[],l=k[1],m=(k[2]||"").split(".").sort(),r=p.event.special[l]||{},l=(f?r.delegateType:r.bindType)||l,r=p.event.special[l]||{},n=p.extend({type:l,origType:k[1],data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&p.expr.match.needsContext.test(f),namespace:m.join(".")},o),q=i[l];if(!q){q=i[l]=[],q.delegateCount=0;if(!r.setup||r.setup.call(a,e,m,h)===!1){a.addEventListener?a.addEventListener(l,h,!1):a.attachEvent&&a.attachEvent("on"+l,h)}}r.add&&(r.add.call(a,n),n.handler.guid||(n.handler.guid=d.guid)),f?q.splice(q.delegateCount++,0,n):q.push(n),p.event.global[l]=!0}a=null},global:{},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,q,r=p.hasData(a)&&p._data(a);if(!r||!(m=r.events)){return}b=p.trim(_(b||"")).split(" ");for(f=0;f<b.length;f++){g=W.exec(b[f])||[],h=i=g[1],j=g[2];if(!h){for(h in m){p.event.remove(a,h+b[f],c,d,!0)}continue}n=p.event.special[h]||{},h=(d?n.delegateType:n.bindType)||h,o=m[h]||[],k=o.length,j=j?new RegExp("(^|\\.)"+j.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(l=0;l<o.length;l++){q=o[l],(e||i===q.origType)&&(!c||c.guid===q.guid)&&(!j||j.test(q.namespace))&&(!d||d===q.selector||d==="**"&&q.selector)&&(o.splice(l--,1),q.selector&&o.delegateCount--,n.remove&&n.remove.call(a,q))}o.length===0&&k!==o.length&&((!n.teardown||n.teardown.call(a,j,r.handle)===!1)&&p.removeEvent(a,h,r.handle),delete m[h])}p.isEmptyObject(m)&&(delete r.handle,p.removeData(a,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,f,g){if(!f||f.nodeType!==3&&f.nodeType!==8){var h,i,j,k,l,m,n,o,q,r,s=c.type||c,t=[];if($.test(s+p.event.triggered)){return}s.indexOf("!")>=0&&(s=s.slice(0,-1),i=!0),s.indexOf(".")>=0&&(t=s.split("."),s=t.shift(),t.sort());if((!f||p.event.customEvent[s])&&!p.event.global[s]){return}c=typeof c=="object"?c[p.expando]?c:new p.Event(s,c):new p.Event(s),c.type=s,c.isTrigger=!0,c.exclusive=i,c.namespace=t.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+t.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,m=s.indexOf(":")<0?"on"+s:"";if(!f){h=p.cache;for(j in h){h[j].events&&h[j].events[s]&&p.event.trigger(c,d,h[j].handle.elem,!0)}return}c.result=b,c.target||(c.target=f),d=d!=null?p.makeArray(d):[],d.unshift(c),n=p.event.special[s]||{};if(n.trigger&&n.trigger.apply(f,d)===!1){return}q=[[f,n.bindType||s]];if(!g&&!n.noBubble&&!p.isWindow(f)){r=n.delegateType||s,k=$.test(r+s)?f:f.parentNode;for(l=f;k;k=k.parentNode){q.push([k,r]),l=k}l===(f.ownerDocument||e)&&q.push([l.defaultView||l.parentWindow||a,r])}for(j=0;j<q.length&&!c.isPropagationStopped();j++){k=q[j][0],c.type=q[j][1],o=(p._data(k,"events")||{})[c.type]&&p._data(k,"handle"),o&&o.apply(k,d),o=m&&k[m],o&&p.acceptData(k)&&o.apply&&o.apply(k,d)===!1&&c.preventDefault()}return c.type=s,!g&&!c.isDefaultPrevented()&&(!n._default||n._default.apply(f.ownerDocument,d)===!1)&&(s!=="click"||!p.nodeName(f,"a"))&&p.acceptData(f)&&m&&f[s]&&(s!=="focus"&&s!=="blur"||c.target.offsetWidth!==0)&&!p.isWindow(f)&&(l=f[m],l&&(f[m]=null),p.event.triggered=s,f[s](),p.event.triggered=b,l&&(f[m]=l)),c.result}return},dispatch:function(c){c=p.event.fix(c||a.event);var d,e,f,g,h,i,j,l,m,n,o=(p._data(this,"events")||{})[c.type]||[],q=o.delegateCount,r=k.call(arguments),s=!c.exclusive&&!c.namespace,t=p.event.special[c.type]||{},u=[];r[0]=c,c.delegateTarget=this;if(t.preDispatch&&t.preDispatch.call(this,c)===!1){return}if(q&&(!c.button||c.type!=="click")){for(f=c.target;f!=this;f=f.parentNode||this){if(f.disabled!==!0||c.type!=="click"){h={},j=[];for(d=0;d<q;d++){l=o[d],m=l.selector,h[m]===b&&(h[m]=l.needsContext?p(m,this).index(f)>=0:p.find(m,this,null,[f]).length),h[m]&&j.push(l)}j.length&&u.push({elem:f,matches:j})}}}o.length>q&&u.push({elem:this,matches:o.slice(q)});for(d=0;d<u.length&&!c.isPropagationStopped();d++){i=u[d],c.currentTarget=i.elem;for(e=0;e<i.matches.length&&!c.isImmediatePropagationStopped();e++){l=i.matches[e];if(s||!c.namespace&&!l.namespace||c.namespace_re&&c.namespace_re.test(l.namespace)){c.data=l.data,c.handleObj=l,g=((p.event.special[l.origType]||{}).handle||l.handler).apply(i.elem,r),g!==b&&(c.result=g,g===!1&&(c.preventDefault(),c.stopPropagation()))}}}return t.postDispatch&&t.postDispatch.call(this,c),c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,f,g,h=c.button,i=c.fromElement;return a.pageX==null&&c.clientX!=null&&(d=a.target.ownerDocument||e,f=d.documentElement,g=d.body,a.pageX=c.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=c.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?c.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0),a}},fix:function(a){if(a[p.expando]){return a}var b,c,d=a,f=p.event.fixHooks[a.type]||{},g=f.props?this.props.concat(f.props):this.props;a=p.Event(d);for(b=g.length;b;){c=g[--b],a[c]=d[c]}return a.target||(a.target=d.srcElement||e),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,f.filter?f.filter(a,d):a},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){p.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=p.extend(new p.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?p.event.trigger(e,null,b):p.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},p.event.handle=p.event.dispatch,p.removeEvent=e.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]=="undefined"&&(a[d]=null),a.detachEvent(d,c))},p.Event=function(a,b){if(this instanceof p.Event){a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?bb:ba):this.type=a,b&&p.extend(this,b),this.timeStamp=a&&a.timeStamp||p.now(),this[p.expando]=!0}else{return new p.Event(a,b)}},p.Event.prototype={preventDefault:function(){this.isDefaultPrevented=bb;var a=this.originalEvent;if(!a){return}a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=bb;var a=this.originalEvent;if(!a){return}a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()},isDefaultPrevented:ba,isPropagationStopped:ba,isImmediatePropagationStopped:ba},p.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){p.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj,g=f.selector;if(!e||e!==d&&!p.contains(d,e)){a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b}return c}}}),p.support.submitBubbles||(p.event.special.submit={setup:function(){if(p.nodeName(this,"form")){return !1}p.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=p.nodeName(c,"input")||p.nodeName(c,"button")?c.form:b;d&&!p._data(d,"_submit_attached")&&(p.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),p._data(d,"_submit_attached",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&p.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(p.nodeName(this,"form")){return !1}p.event.remove(this,"._submit")}}),p.support.changeBubbles||(p.event.special.change={setup:function(){if(V.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){p.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),p.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),p.event.simulate("change",this,a,!0)})}return !1}p.event.add(this,"beforeactivate._change",function(a){var b=a.target;V.test(b.nodeName)&&!p._data(b,"_change_attached")&&(p.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&p.event.simulate("change",this.parentNode,a,!0)}),p._data(b,"_change_attached",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox"){return a.handleObj.handler.apply(this,arguments)}},teardown:function(){return p.event.remove(this,"._change"),!V.test(this.nodeName)}}),p.support.focusinBubbles||p.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){p.event.simulate(b,a.target,p.event.fix(a),!0)};p.event.special[b]={setup:function(){c++===0&&e.addEventListener(a,d,!0)},teardown:function(){--c===0&&e.removeEventListener(a,d,!0)}}}),p.fn.extend({on:function(a,c,d,e,f){var g,h;if(typeof a=="object"){typeof c!="string"&&(d=d||c,c=b);for(h in a){this.on(h,c,d,a[h],f)}return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1){e=ba}else{if(!e){return this}}return f===1&&(g=e,e=function(a){return p().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=p.guid++)),this.each(function(){p.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj){return e=a.handleObj,p(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this}if(typeof a=="object"){for(f in a){this.off(f,c,a[f])}return this}if(c===!1||typeof c=="function"){d=c,c=b}return d===!1&&(d=ba),this.each(function(){p.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return p(this.context).on(a,this.selector,b,c),this},die:function(a,b){return p(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length===1?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,b){return this.each(function(){p.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0]){return p.event.trigger(a,b,this[0],!0)}},toggle:function(a){var b=arguments,c=a.guid||p.guid++,d=0,e=function(c){var e=(p._data(this,"lastToggle"+a.guid)||0)%d;return p._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length){b[d++].guid=c}return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){p.fn[b]=function(a,c){return c==null&&(c=a,a=null),arguments.length>0?this.on(b,null,a,c):this.trigger(b)},Y.test(b)&&(p.event.fixHooks[b]=p.event.keyHooks),Z.test(b)&&(p.event.fixHooks[b]=p.event.mouseHooks)}),function(a,b){function bc(a,b,c,d){c=c||[],b=b||r;var e,f,i,j,k=b.nodeType;if(!a||typeof a!="string"){return c}if(k!==1&&k!==9){return[]}i=g(b);if(!i&&!d){if(e=P.exec(a)){if(j=e[1]){if(k===9){f=b.getElementById(j);if(!f||!f.parentNode){return c}if(f.id===j){return c.push(f),c}}else{if(b.ownerDocument&&(f=b.ownerDocument.getElementById(j))&&h(b,f)&&f.id===j){return c.push(f),c}}}else{if(e[2]){return w.apply(c,x.call(b.getElementsByTagName(a),0)),c}if((j=e[3])&&_&&b.getElementsByClassName){return w.apply(c,x.call(b.getElementsByClassName(j),0)),c}}}}return bp(a.replace(L,"$1"),b,c,d,i)}function bd(a){return function(b){var c=b.nodeName.toLowerCase();return c==="input"&&b.type===a}}function be(a){return function(b){var c=b.nodeName.toLowerCase();return(c==="input"||c==="button")&&b.type===a}}function bf(a){return z(function(b){return b=+b,z(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--){c[e=f[g]]&&(c[e]=!(d[e]=c[e]))}})})}function bg(a,b,c){if(a===b){return c}var d=a.nextSibling;while(d){if(d===b){return -1}d=d.nextSibling}return 1}function bh(a,b){var c,d,f,g,h,i,j,k=C[o][a];if(k){return b?0:k.slice(0)}h=a,i=[],j=e.preFilter;while(h){if(!c||(d=M.exec(h))){d&&(h=h.slice(d[0].length)),i.push(f=[])}c=!1;if(d=N.exec(h)){f.push(c=new q(d.shift())),h=h.slice(c.length),c.type=d[0].replace(L," ")}for(g in e.filter){(d=W[g].exec(h))&&(!j[g]||(d=j[g](d,r,!0)))&&(f.push(c=new q(d.shift())),h=h.slice(c.length),c.type=g,c.matches=d)}if(!c){break}}return b?h.length:h?bc.error(a):C(a,i).slice(0)}function bi(a,b,d){var e=b.dir,f=d&&b.dir==="parentNode",g=u++;return b.first?function(b,c,d){while(b=b[e]){if(f||b.nodeType===1){return a(b,c,d)}}}:function(b,d,h){if(!h){var i,j=t+" "+g+" ",k=j+c;while(b=b[e]){if(f||b.nodeType===1){if((i=b[o])===k){return b.sizset}if(typeof i=="string"&&i.indexOf(j)===0){if(b.sizset){return b}}else{b[o]=k;if(a(b,d,h)){return b.sizset=!0,b}b.sizset=!1}}}}else{while(b=b[e]){if(f||b.nodeType===1){if(a(b,d,h)){return b}}}}}}function bj(a){return a.length>1?function(b,c,d){var e=a.length;while(e--){if(!a[e](b,c,d)){return !1}}return !0}:a[0]}function bk(a,b,c,d,e){var f,g=[],h=0,i=a.length,j=b!=null;for(;h<i;h++){if(f=a[h]){if(!c||c(f,d,e)){g.push(f),j&&b.push(h)}}}return g}function bl(a,b,c,d,e,f){return d&&!d[o]&&(d=bl(d)),e&&!e[o]&&(e=bl(e,f)),z(function(f,g,h,i){if(f&&e){return}var j,k,l,m=[],n=[],o=g.length,p=f||bo(b||"*",h.nodeType?[h]:h,[],f),q=a&&(f||!b)?bk(p,m,a,h,i):p,r=c?e||(f?a:o||d)?[]:g:q;c&&c(q,r,h,i);if(d){l=bk(r,n),d(l,[],h,i),j=l.length;while(j--){if(k=l[j]){r[n[j]]=!(q[n[j]]=k)}}}if(f){j=a&&r.length;while(j--){if(k=r[j]){f[m[j]]=!(g[m[j]]=k)}}}else{r=bk(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):w.apply(g,r)}})}function bm(a){var b,c,d,f=a.length,g=e.relative[a[0].type],h=g||e.relative[" "],i=g?1:0,j=bi(function(a){return a===b},h,!0),k=bi(function(a){return y.call(b,a)>-1},h,!0),m=[function(a,c,d){return !g&&(d||c!==l)||((b=c).nodeType?j(a,c,d):k(a,c,d))}];for(;i<f;i++){if(c=e.relative[a[i].type]){m=[bi(bj(m),c)]}else{c=e.filter[a[i].type].apply(null,a[i].matches);if(c[o]){d=++i;for(;d<f;d++){if(e.relative[a[d].type]){break}}return bl(i>1&&bj(m),i>1&&a.slice(0,i-1).join("").replace(L,"$1"),c,i<d&&bm(a.slice(i,d)),d<f&&bm(a=a.slice(d)),d<f&&a.join(""))}m.push(c)}}return bj(m)}function bn(a,b){var d=b.length>0,f=a.length>0,g=function(h,i,j,k,m){var n,o,p,q=[],s=0,u="0",x=h&&[],y=m!=null,z=l,A=h||f&&e.find.TAG("*",m&&i.parentNode||i),B=t+=z==null?1:Math.E;y&&(l=i!==r&&i,c=g.el);for(;(n=A[u])!=null;u++){if(f&&n){for(o=0;p=a[o];o++){if(p(n,i,j)){k.push(n);break}}y&&(t=B,c=++g.el)}d&&((n=!p&&n)&&s--,h&&x.push(n))}s+=u;if(d&&u!==s){for(o=0;p=b[o];o++){p(x,q,i,j)}if(h){if(s>0){while(u--){!x[u]&&!q[u]&&(q[u]=v.call(k))}}q=bk(q)}w.apply(k,q),y&&!h&&q.length>0&&s+b.length>1&&bc.uniqueSort(k)}return y&&(t=B,l=z),x};return g.el=0,d?z(g):g}function bo(a,b,c,d){var e=0,f=b.length;for(;e<f;e++){bc(a,b[e],c,d)}return c}function bp(a,b,c,d,f){var g,h,j,k,l,m=bh(a),n=m.length;if(!d&&m.length===1){h=m[0]=m[0].slice(0);if(h.length>2&&(j=h[0]).type==="ID"&&b.nodeType===9&&!f&&e.relative[h[1].type]){b=e.find.ID(j.matches[0].replace(V,""),b,f)[0];if(!b){return c}a=a.slice(h.shift().length)}for(g=W.POS.test(a)?-1:h.length-1;g>=0;g--){j=h[g];if(e.relative[k=j.type]){break}if(l=e.find[k]){if(d=l(j.matches[0].replace(V,""),R.test(h[0].type)&&b.parentNode||b,f)){h.splice(g,1),a=d.length&&h.join("");if(!a){return w.apply(c,x.call(d,0)),c}break}}}}return i(a,m)(d,b,f,c,R.test(a)),c}function bq(){}var c,d,e,f,g,h,i,j,k,l,m=!0,n="undefined",o=("sizcache"+Math.random()).replace(".",""),q=String,r=a.document,s=r.documentElement,t=0,u=0,v=[].pop,w=[].push,x=[].slice,y=[].indexOf||function(a){var b=0,c=this.length;for(;b<c;b++){if(this[b]===a){return b}}return -1},z=function(a,b){return a[o]=b==null||b,a},A=function(){var a={},b=[];return z(function(c,d){return b.push(c)>e.cacheLength&&delete a[b.shift()],a[c]=d},a)},B=A(),C=A(),D=A(),E="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",G=F.replace("w","w#"),H="([*^$|!~]?=)",I="\\["+E+"*("+F+")"+E+"*(?:"+H+E+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+G+")|)|)"+E+"*\\]",J=":("+F+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+I+")|[^:]|\\\\.)*|.*))\\)|)",K=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+E+"*((?:-\\d)?\\d*)"+E+"*\\)|)(?=[^-]|$)",L=new RegExp("^"+E+"+|((?:^|[^\\\\])(?:\\\\.)*)"+E+"+$","g"),M=new RegExp("^"+E+"*,"+E+"*"),N=new RegExp("^"+E+"*([\\x20\\t\\r\\n\\f>+~])"+E+"*"),O=new RegExp(J),P=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,Q=/^:not/,R=/[\x20\t\r\n\f]*[+~]/,S=/:not\($/,T=/h\d/i,U=/input|select|textarea|button/i,V=/\\(?!\\)/g,W={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),NAME:new RegExp("^\\[name=['\"]?("+F+")['\"]?\\]"),TAG:new RegExp("^("+F.replace("w","w*")+")"),ATTR:new RegExp("^"+I),PSEUDO:new RegExp("^"+J),POS:new RegExp(K,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+E+"*(even|odd|(([+-]|)(\\d*)n|)"+E+"*(?:([+-]|)"+E+"*(\\d+)|))"+E+"*\\)|)","i"),needsContext:new RegExp("^"+E+"*[>+~]|"+K,"i")},X=function(a){var b=r.createElement("div");try{return a(b)}catch(c){return !1}finally{b=null}},Y=X(function(a){return a.appendChild(r.createComment("")),!a.getElementsByTagName("*").length}),Z=X(function(a){return a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!==n&&a.firstChild.getAttribute("href")==="#"}),$=X(function(a){a.innerHTML="<select></select>";var b=typeof a.lastChild.getAttribute("multiple");return b!=="boolean"&&b!=="string"}),_=X(function(a){return a.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!a.getElementsByClassName||!a.getElementsByClassName("e").length?!1:(a.lastChild.className="e",a.getElementsByClassName("e").length===2)}),ba=X(function(a){a.id=o+0,a.innerHTML="<a name='"+o+"'></a><div name='"+o+"'></div>",s.insertBefore(a,s.firstChild);var b=r.getElementsByName&&r.getElementsByName(o).length===2+r.getElementsByName(o+0).length;return d=!r.getElementById(o),s.removeChild(a),b});try{x.call(s.childNodes,0)[0].nodeType}catch(bb){x=function(a){var b,c=[];for(;b=this[a];a++){c.push(b)}return c}}bc.matches=function(a,b){return bc(a,null,null,b)},bc.matchesSelector=function(a,b){return bc(b,null,null,[a]).length>0},f=bc.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(e===1||e===9||e===11){if(typeof a.textContent=="string"){return a.textContent}for(a=a.firstChild;a;a=a.nextSibling){c+=f(a)}}else{if(e===3||e===4){return a.nodeValue}}}else{for(;b=a[d];d++){c+=f(b)}}return c},g=bc.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?b.nodeName!=="HTML":!1},h=bc.contains=s.contains?function(a,b){var c=a.nodeType===9?a.documentElement:a,d=b&&b.parentNode;return a===d||!!(d&&d.nodeType===1&&c.contains&&c.contains(d))}:s.compareDocumentPosition?function(a,b){return b&&!!(a.compareDocumentPosition(b)&16)}:function(a,b){while(b=b.parentNode){if(b===a){return !0}}return !1},bc.attr=function(a,b){var c,d=g(a);return d||(b=b.toLowerCase()),(c=e.attrHandle[b])?c(a):d||$?a.getAttribute(b):(c=a.getAttributeNode(b),c?typeof a[b]=="boolean"?a[b]?b:null:c.specified?c.value:null:null)},e=bc.selectors={cacheLength:50,createPseudo:z,match:W,attrHandle:Z?{}:{href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}},find:{ID:d?function(a,b,c){if(typeof b.getElementById!==n&&!c){var d=b.getElementById(a);return d&&d.parentNode?[d]:[]}}:function(a,c,d){if(typeof c.getElementById!==n&&!d){var e=c.getElementById(a);return e?e.id===a||typeof e.getAttributeNode!==n&&e.getAttributeNode("id").value===a?[e]:b:[]}},TAG:Y?function(a,b){if(typeof b.getElementsByTagName!==n){return b.getElementsByTagName(a)}}:function(a,b){var c=b.getElementsByTagName(a);if(a==="*"){var d,e=[],f=0;for(;d=c[f];f++){d.nodeType===1&&e.push(d)}return e}return c},NAME:ba&&function(a,b){if(typeof b.getElementsByName!==n){return b.getElementsByName(name)}},CLASS:_&&function(a,b,c){if(typeof b.getElementsByClassName!==n&&!c){return b.getElementsByClassName(a)}}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(V,""),a[3]=(a[4]||a[5]||"").replace(V,""),a[2]==="~="&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),a[1]==="nth"?(a[2]||bc.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*(a[2]==="even"||a[2]==="odd")),a[4]=+(a[6]+a[7]||a[2]==="odd")):a[2]&&bc.error(a[0]),a},PSEUDO:function(a){var b,c;if(W.CHILD.test(a[0])){return null}if(a[3]){a[2]=a[3]}else{if(b=a[4]){O.test(b)&&(c=bh(b,!0))&&(c=b.indexOf(")",b.length-c)-b.length)&&(b=b.slice(0,c),a[0]=a[0].slice(0,c)),a[2]=b}}return a.slice(0,3)}},filter:{ID:d?function(a){return a=a.replace(V,""),function(b){return b.getAttribute("id")===a}}:function(a){return a=a.replace(V,""),function(b){var c=typeof b.getAttributeNode!==n&&b.getAttributeNode("id");return c&&c.value===a}},TAG:function(a){return a==="*"?function(){return !0}:(a=a.replace(V,"").toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=B[o][a];return b||(b=B(a,new RegExp("(^|"+E+")"+a+"("+E+"|$)"))),function(a){return b.test(a.className||typeof a.getAttribute!==n&&a.getAttribute("class")||"")}},ATTR:function(a,b,c){return function(d,e){var f=bc.attr(d,a);return f==null?b==="!=":b?(f+="",b==="="?f===c:b==="!="?f!==c:b==="^="?c&&f.indexOf(c)===0:b==="*="?c&&f.indexOf(c)>-1:b==="$="?c&&f.substr(f.length-c.length)===c:b==="~="?(" "+f+" ").indexOf(c)>-1:b==="|="?f===c||f.substr(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d){return a==="nth"?function(a){var b,e,f=a.parentNode;if(c===1&&d===0){return !0}if(f){e=0;for(b=f.firstChild;b;b=b.nextSibling){if(b.nodeType===1){e++;if(a===b){break}}}}return e-=d,e===c||e%c===0&&e/c>=0}:function(b){var c=b;switch(a){case"only":case"first":while(c=c.previousSibling){if(c.nodeType===1){return !1}}if(a==="first"){return !0}c=b;case"last":while(c=c.nextSibling){if(c.nodeType===1){return !1}}return !0}}},PSEUDO:function(a,b){var c,d=e.pseudos[a]||e.setFilters[a.toLowerCase()]||bc.error("unsupported pseudo: "+a);return d[o]?d(b):d.length>1?(c=[a,a,"",b],e.setFilters.hasOwnProperty(a.toLowerCase())?z(function(a,c){var e,f=d(a,b),g=f.length;while(g--){e=y.call(a,f[g]),a[e]=!(c[e]=f[g])}}):function(a){return d(a,0,c)}):d}},pseudos:{not:z(function(a){var b=[],c=[],d=i(a.replace(L,"$1"));return d[o]?z(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--){if(f=g[h]){a[h]=!(b[h]=f)}}}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:z(function(a){return function(b){return bc(a,b).length>0}}),contains:z(function(a){return function(b){return(b.textContent||b.innerText||f(b)).indexOf(a)>-1}}),enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&!!a.checked||b==="option"&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return !e.pseudos.empty(a)},empty:function(a){var b;a=a.firstChild;while(a){if(a.nodeName>"@"||(b=a.nodeType)===3||b===4){return !1}a=a.nextSibling}return !0},header:function(a){return T.test(a.nodeName)},text:function(a){var b,c;return a.nodeName.toLowerCase()==="input"&&(b=a.type)==="text"&&((c=a.getAttribute("type"))==null||c.toLowerCase()===b)},radio:bd("radio"),checkbox:bd("checkbox"),file:bd("file"),password:bd("password"),image:bd("image"),submit:be("submit"),reset:be("reset"),button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&a.type==="button"||b==="button"},input:function(a){return U.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||b.hasFocus())&&(!!a.type||!!a.href)},active:function(a){return a===a.ownerDocument.activeElement},first:bf(function(a,b,c){return[0]}),last:bf(function(a,b,c){return[b-1]}),eq:bf(function(a,b,c){return[c<0?c+b:c]}),even:bf(function(a,b,c){for(var d=0;d<b;d+=2){a.push(d)}return a}),odd:bf(function(a,b,c){for(var d=1;d<b;d+=2){a.push(d)}return a}),lt:bf(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;){a.push(d)}return a}),gt:bf(function(a,b,c){for(var d=c<0?c+b:c;++d<b;){a.push(d)}return a})}},j=s.compareDocumentPosition?function(a,b){return a===b?(k=!0,0):(!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition:a.compareDocumentPosition(b)&4)?-1:1}:function(a,b){if(a===b){return k=!0,0}if(a.sourceIndex&&b.sourceIndex){return a.sourceIndex-b.sourceIndex}var c,d,e=[],f=[],g=a.parentNode,h=b.parentNode,i=g;if(g===h){return bg(a,b)}if(!g){return -1}if(!h){return 1}while(i){e.unshift(i),i=i.parentNode}i=h;while(i){f.unshift(i),i=i.parentNode}c=e.length,d=f.length;for(var j=0;j<c&&j<d;j++){if(e[j]!==f[j]){return bg(e[j],f[j])}}return j===c?bg(a,f[j],-1):bg(e[j],b,1)},[0,0].sort(j),m=!k,bc.uniqueSort=function(a){var b,c=1;k=m,a.sort(j);if(k){for(;b=a[c];c++){b===a[c-1]&&a.splice(c--,1)}}return a},bc.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},i=bc.compile=function(a,b){var c,d=[],e=[],f=D[o][a];if(!f){b||(b=bh(a)),c=b.length;while(c--){f=bm(b[c]),f[o]?d.push(f):e.push(f)}f=D(a,bn(e,d))}return f},r.querySelectorAll&&function(){var a,b=bp,c=/'|\\/g,d=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,e=[":focus"],f=[":active",":focus"],h=s.matchesSelector||s.mozMatchesSelector||s.webkitMatchesSelector||s.oMatchesSelector||s.msMatchesSelector;X(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||e.push("\\["+E+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),a.querySelectorAll(":checked").length||e.push(":checked")}),X(function(a){a.innerHTML="<p test=''></p>",a.querySelectorAll("[test^='']").length&&e.push("[*^$]="+E+"*(?:\"\"|'')"),a.innerHTML="<input type='hidden'/>",a.querySelectorAll(":enabled").length||e.push(":enabled",":disabled")}),e=new RegExp(e.join("|")),bp=function(a,d,f,g,h){if(!g&&!h&&(!e||!e.test(a))){var i,j,k=!0,l=o,m=d,n=d.nodeType===9&&a;if(d.nodeType===1&&d.nodeName.toLowerCase()!=="object"){i=bh(a),(k=d.getAttribute("id"))?l=k.replace(c,"\\$&"):d.setAttribute("id",l),l="[id='"+l+"'] ",j=i.length;while(j--){i[j]=l+i[j].join("")}m=R.test(a)&&d.parentNode||d,n=i.join(",")}if(n){try{return w.apply(f,x.call(m.querySelectorAll(n),0)),f}catch(p){}finally{k||d.removeAttribute("id")}}}return b(a,d,f,g,h)},h&&(X(function(b){a=h.call(b,"div");try{h.call(b,"[test!='']:sizzle"),f.push("!=",J)}catch(c){}}),f=new RegExp(f.join("|")),bc.matchesSelector=function(b,c){c=c.replace(d,"='$1']");if(!g(b)&&!f.test(c)&&(!e||!e.test(c))){try{var i=h.call(b,c);if(i||a||b.document&&b.document.nodeType!==11){return i}}catch(j){}}return bc(c,null,null,[b]).length>0})}(),e.pseudos.nth=e.pseudos.eq,e.filters=bq.prototype=e.pseudos,e.setFilters=new bq,bc.attr=p.attr,p.find=bc,p.expr=bc.selectors,p.expr[":"]=p.expr.pseudos,p.unique=bc.uniqueSort,p.text=bc.getText,p.isXMLDoc=bc.isXML,p.contains=bc.contains}(a);var bc=/Until$/,bd=/^(?:parents|prev(?:Until|All))/,be=/^.[^:#\[\.,]*$/,bf=p.expr.match.needsContext,bg={children:!0,contents:!0,next:!0,prev:!0};p.fn.extend({find:function(a){var b,c,d,e,f,g,h=this;if(typeof a!="string"){return p(a).filter(function(){for(b=0,c=h.length;b<c;b++){if(p.contains(h[b],this)){return !0}}})}g=this.pushStack("","find",a);for(b=0,c=this.length;b<c;b++){d=g.length,p.find(a,this[b],g);if(b>0){for(e=d;e<g.length;e++){for(f=0;f<d;f++){if(g[f]===g[e]){g.splice(e--,1);break}}}}}return g},has:function(a){var b,c=p(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++){if(p.contains(this,c[b])){return !0}}})},not:function(a){return this.pushStack(bj(this,a,!1),"not",a)},filter:function(a){return this.pushStack(bj(this,a,!0),"filter",a)},is:function(a){return !!a&&(typeof a=="string"?bf.test(a)?p(a,this.context).index(this[0])>=0:p.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c,d=0,e=this.length,f=[],g=bf.test(a)||typeof a!="string"?p(a,b||this.context):0;for(;d<e;d++){c=this[d];while(c&&c.ownerDocument&&c!==b&&c.nodeType!==11){if(g?g.index(c)>-1:p.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}}return f=f.length>1?p.unique(f):f,this.pushStack(f,"closest",a)},index:function(a){return a?typeof a=="string"?p.inArray(this[0],p(a)):p.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c=typeof a=="string"?p(a,b):p.makeArray(a&&a.nodeType?[a]:a),d=p.merge(this.get(),c);return this.pushStack(bh(c[0])||bh(d[0])?d:p.unique(d))},addBack:function(a){return this.add(a==null?this.prevObject:this.prevObject.filter(a))}}),p.fn.andSelf=p.fn.addBack,p.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return p.dir(a,"parentNode")},parentsUntil:function(a,b,c){return p.dir(a,"parentNode",c)},next:function(a){return bi(a,"nextSibling")},prev:function(a){return bi(a,"previousSibling")},nextAll:function(a){return p.dir(a,"nextSibling")},prevAll:function(a){return p.dir(a,"previousSibling")},nextUntil:function(a,b,c){return p.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return p.dir(a,"previousSibling",c)},siblings:function(a){return p.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return p.sibling(a.firstChild)},contents:function(a){return p.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:p.merge([],a.childNodes)}},function(a,b){p.fn[a]=function(c,d){var e=p.map(this,b,c);return bc.test(a)||(d=c),d&&typeof d=="string"&&(e=p.filter(d,e)),e=this.length>1&&!bg[a]?p.unique(e):e,this.length>1&&bd.test(a)&&(e=e.reverse()),this.pushStack(e,a,k.call(arguments).join(","))}}),p.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),b.length===1?p.find.matchesSelector(b[0],a)?[b[0]]:[]:p.find.matches(a,b)},dir:function(a,c,d){var e=[],f=a[c];while(f&&f.nodeType!==9&&(d===b||f.nodeType!==1||!p(f).is(d))){f.nodeType===1&&e.push(f),f=f[c]}return e},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling){a.nodeType===1&&a!==b&&c.push(a)}return c}});var bl="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",bm=/ jQuery\d+="(?:null|\d+)"/g,bn=/^\s+/,bo=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bp=/<([\w:]+)/,bq=/<tbody/i,br=/<|&#?\w+;/,bs=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,bu=new RegExp("<(?:"+bl+")[\\s/>]","i"),bv=/^(?:checkbox|radio)$/,bw=/checked\s*(?:[^=]|=\s*.checked.)/i,bx=/\/(java|ecma)script/i,by=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,bz={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bA=bk(e),bB=bA.appendChild(e.createElement("div"));bz.optgroup=bz.option,bz.tbody=bz.tfoot=bz.colgroup=bz.caption=bz.thead,bz.th=bz.td,p.support.htmlSerialize||(bz._default=[1,"X<div>","</div>"]),p.fn.extend({text:function(a){return p.access(this,function(a){return a===b?p.text(this):this.empty().append((this[0]&&this[0].ownerDocument||e).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(p.isFunction(a)){return this.each(function(b){p(this).wrapAll(a.call(this,b))})}if(this[0]){var b=p(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1){a=a.firstChild}return a}).append(this)}return this},wrapInner:function(a){return p.isFunction(a)?this.each(function(b){p(this).wrapInner(a.call(this,b))}):this.each(function(){var b=p(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=p.isFunction(a);return this.each(function(c){p(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(a,this.firstChild)})},before:function(){if(!bh(this[0])){return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)})}if(arguments.length){var a=p.clean(arguments);return this.pushStack(p.merge(a,this),"before",this.selector)}},after:function(){if(!bh(this[0])){return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)})}if(arguments.length){var a=p.clean(arguments);return this.pushStack(p.merge(this,a),"after",this.selector)}},remove:function(a,b){var c,d=0;for(;(c=this[d])!=null;d++){if(!a||p.filter(a,[c]).length){!b&&c.nodeType===1&&(p.cleanData(c.getElementsByTagName("*")),p.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c)}}return this},empty:function(){var a,b=0;for(;(a=this[b])!=null;b++){a.nodeType===1&&p.cleanData(a.getElementsByTagName("*"));while(a.firstChild){a.removeChild(a.firstChild)}}return this},clone:function(a,b){return a=a==null?!1:a,b=b==null?a:b,this.map(function(){return p.clone(this,a,b)})},html:function(a){return p.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b){return c.nodeType===1?c.innerHTML.replace(bm,""):b}if(typeof a=="string"&&!bs.test(a)&&(p.support.htmlSerialize||!bu.test(a))&&(p.support.leadingWhitespace||!bn.test(a))&&!bz[(bp.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(bo,"<$1></$2>");try{for(;d<e;d++){c=this[d]||{},c.nodeType===1&&(p.cleanData(c.getElementsByTagName("*")),c.innerHTML=a)}c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){return bh(this[0])?this.length?this.pushStack(p(p.isFunction(a)?a():a),"replaceWith",a):this:p.isFunction(a)?this.each(function(b){var c=p(this),d=c.html();c.replaceWith(a.call(this,b,d))}):(typeof a!="string"&&(a=p(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;p(this).remove(),b?p(b).before(a):p(c).append(a)}))},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){a=[].concat.apply([],a);var e,f,g,h,i=0,j=a[0],k=[],l=this.length;if(!p.support.checkClone&&l>1&&typeof j=="string"&&bw.test(j)){return this.each(function(){p(this).domManip(a,c,d)})}if(p.isFunction(j)){return this.each(function(e){var f=p(this);a[0]=j.call(this,e,c?f.html():b),f.domManip(a,c,d)})}if(this[0]){e=p.buildFragment(a,this,k),g=e.fragment,f=g.firstChild,g.childNodes.length===1&&(g=f);if(f){c=c&&p.nodeName(f,"tr");for(h=e.cacheable||l-1;i<l;i++){d.call(c&&p.nodeName(this[i],"table")?bC(this[i],"tbody"):this[i],i===h?g:p.clone(g,!0,!0))}}g=f=null,k.length&&p.each(k,function(a,b){b.src?p.ajax?p.ajax({url:b.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):p.error("no ajax"):p.globalEval((b.text||b.textContent||b.innerHTML||"").replace(by,"")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),p.buildFragment=function(a,c,d){var f,g,h,i=a[0];return c=c||e,c=!c.nodeType&&c[0]||c,c=c.ownerDocument||c,a.length===1&&typeof i=="string"&&i.length<512&&c===e&&i.charAt(0)==="<"&&!bt.test(i)&&(p.support.checkClone||!bw.test(i))&&(p.support.html5Clone||!bu.test(i))&&(g=!0,f=p.fragments[i],h=f!==b),f||(f=c.createDocumentFragment(),p.clean(a,c,f,d),g&&(p.fragments[i]=h&&f)),{fragment:f,cacheable:g}},p.fragments={},p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){p.fn[a]=function(c){var d,e=0,f=[],g=p(c),h=g.length,i=this.length===1&&this[0].parentNode;if((i==null||i&&i.nodeType===11&&i.childNodes.length===1)&&h===1){return g[b](this[0]),this}for(;e<h;e++){d=(e>0?this.clone(!0):this).get(),p(g[e])[b](d),f=f.concat(d)}return this.pushStack(f,a,g.selector)}}),p.extend({clone:function(a,b,c){var d,e,f,g;p.support.html5Clone||p.isXMLDoc(a)||!bu.test("<"+a.nodeName+">")?g=a.cloneNode(!0):(bB.innerHTML=a.outerHTML,bB.removeChild(g=bB.firstChild));if((!p.support.noCloneEvent||!p.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!p.isXMLDoc(a)){bE(a,g),d=bF(a),e=bF(g);for(f=0;d[f];++f){e[f]&&bE(d[f],e[f])}}if(b){bD(a,g);if(c){d=bF(a),e=bF(g);for(f=0;d[f];++f){bD(d[f],e[f])}}}return d=e=null,g},clean:function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,q,r,s=b===e&&bA,t=[];if(!b||typeof b.createDocumentFragment=="undefined"){b=e}for(f=0;(h=a[f])!=null;f++){typeof h=="number"&&(h+="");if(!h){continue}if(typeof h=="string"){if(!br.test(h)){h=b.createTextNode(h)}else{s=s||bk(b),l=b.createElement("div"),s.appendChild(l),h=h.replace(bo,"<$1></$2>"),i=(bp.exec(h)||["",""])[1].toLowerCase(),j=bz[i]||bz._default,k=j[0],l.innerHTML=j[1]+h+j[2];while(k--){l=l.lastChild}if(!p.support.tbody){m=bq.test(h),n=i==="table"&&!m?l.firstChild&&l.firstChild.childNodes:j[1]==="<table>"&&!m?l.childNodes:[];for(g=n.length-1;g>=0;--g){p.nodeName(n[g],"tbody")&&!n[g].childNodes.length&&n[g].parentNode.removeChild(n[g])}}!p.support.leadingWhitespace&&bn.test(h)&&l.insertBefore(b.createTextNode(bn.exec(h)[0]),l.firstChild),h=l.childNodes,l.parentNode.removeChild(l)}}h.nodeType?t.push(h):p.merge(t,h)}l&&(h=l=s=null);if(!p.support.appendChecked){for(f=0;(h=t[f])!=null;f++){p.nodeName(h,"input")?bG(h):typeof h.getElementsByTagName!="undefined"&&p.grep(h.getElementsByTagName("input"),bG)}}if(c){q=function(a){if(!a.type||bx.test(a.type)){return d?d.push(a.parentNode?a.parentNode.removeChild(a):a):c.appendChild(a)}};for(f=0;(h=t[f])!=null;f++){if(!p.nodeName(h,"script")||!q(h)){c.appendChild(h),typeof h.getElementsByTagName!="undefined"&&(r=p.grep(p.merge([],h.getElementsByTagName("script")),q),t.splice.apply(t,[f+1,0].concat(r)),f+=r.length)}}}return t},cleanData:function(a,b){var c,d,e,f,g=0,h=p.expando,i=p.cache,j=p.support.deleteExpando,k=p.event.special;for(;(e=a[g])!=null;g++){if(b||p.acceptData(e)){d=e[h],c=d&&i[d];if(c){if(c.events){for(f in c.events){k[f]?p.event.remove(e,f):p.removeEvent(e,f,c.handle)}}i[d]&&(delete i[d],j?delete e[h]:e.removeAttribute?e.removeAttribute(h):e[h]=null,p.deletedIds.push(d))}}}}}),function(){var a,b;p.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},a=p.uaMatch(g.userAgent),b={},a.browser&&(b[a.browser]=!0,b.version=a.version),b.chrome?b.webkit=!0:b.webkit&&(b.safari=!0),p.browser=b,p.sub=function(){function a(b,c){return new a.fn.init(b,c)}p.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function c(c,d){return d&&d instanceof p&&!(d instanceof a)&&(d=a(d)),p.fn.init.call(this,c,d,b)},a.fn.init.prototype=a.fn;var b=a(e);return a}}();var bH,bI,bJ,bK=/alpha\([^)]*\)/i,bL=/opacity=([^)]*)/,bM=/^(top|right|bottom|left)$/,bN=/^(none|table(?!-c[ea]).+)/,bO=/^margin/,bP=new RegExp("^("+q+")(.*)$","i"),bQ=new RegExp("^("+q+")(?!px)[a-z%]+$","i"),bR=new RegExp("^([-+])=("+q+")","i"),bS={},bT={position:"absolute",visibility:"hidden",display:"block"},bU={letterSpacing:0,fontWeight:400},bV=["Top","Right","Bottom","Left"],bW=["Webkit","O","Moz","ms"],bX=p.fn.toggle;p.fn.extend({css:function(a,c){return p.access(this,function(a,c,d){return d!==b?p.style(a,c,d):p.css(a,c)},a,c,arguments.length>1)},show:function(){return b$(this,!0)},hide:function(){return b$(this)},toggle:function(a,b){var c=typeof a=="boolean";return p.isFunction(a)&&p.isFunction(b)?bX.apply(this,arguments):this.each(function(){(c?a:bZ(this))?p(this).show():p(this).hide()})}}),p.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bH(a,"opacity");return c===""?"1":c}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":p.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!a||a.nodeType===3||a.nodeType===8||!a.style){return}var f,g,h,i=p.camelCase(c),j=a.style;c=p.cssProps[i]||(p.cssProps[i]=bY(j,i)),h=p.cssHooks[c]||p.cssHooks[i];if(d===b){return h&&"get" in h&&(f=h.get(a,!1,e))!==b?f:j[c]}g=typeof d,g==="string"&&(f=bR.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(p.css(a,c)),g="number");if(d==null||g==="number"&&isNaN(d)){return}g==="number"&&!p.cssNumber[i]&&(d+="px");if(!h||!("set" in h)||(d=h.set(a,d,e))!==b){try{j[c]=d}catch(k){}}},css:function(a,c,d,e){var f,g,h,i=p.camelCase(c);return c=p.cssProps[i]||(p.cssProps[i]=bY(a.style,i)),h=p.cssHooks[c]||p.cssHooks[i],h&&"get" in h&&(f=h.get(a,!0,e)),f===b&&(f=bH(a,c)),f==="normal"&&c in bU&&(f=bU[c]),d||e!==b?(g=parseFloat(f),d||p.isNumeric(g)?g||0:f):f},swap:function(a,b,c){var d,e,f={};for(e in b){f[e]=a.style[e],a.style[e]=b[e]}d=c.call(a);for(e in b){a.style[e]=f[e]}return d}}),a.getComputedStyle?bH=function(b,c){var d,e,f,g,h=a.getComputedStyle(b,null),i=b.style;return h&&(d=h[c],d===""&&!p.contains(b.ownerDocument,b)&&(d=p.style(b,c)),bQ.test(d)&&bO.test(c)&&(e=i.width,f=i.minWidth,g=i.maxWidth,i.minWidth=i.maxWidth=i.width=d,d=h.width,i.width=e,i.minWidth=f,i.maxWidth=g)),d}:e.documentElement.currentStyle&&(bH=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;return e==null&&f&&f[b]&&(e=f[b]),bQ.test(e)&&!bM.test(b)&&(c=f.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),f.left=b==="fontSize"?"1em":e,e=f.pixelLeft+"px",f.left=c,d&&(a.runtimeStyle.left=d)),e===""?"auto":e}),p.each(["height","width"],function(a,b){p.cssHooks[b]={get:function(a,c,d){if(c){return a.offsetWidth===0&&bN.test(bH(a,"display"))?p.swap(a,bT,function(){return cb(a,b,d)}):cb(a,b,d)}},set:function(a,c,d){return b_(a,c,d?ca(a,b,d,p.support.boxSizing&&p.css(a,"boxSizing")==="border-box"):0)}}}),p.support.opacity||(p.cssHooks.opacity={get:function(a,b){return bL.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=p.isNumeric(b)?"alpha(opacity="+b*100+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&p.trim(f.replace(bK,""))===""&&c.removeAttribute){c.removeAttribute("filter");if(d&&!d.filter){return}}c.filter=bK.test(f)?f.replace(bK,e):f+" "+e}}),p(function(){p.support.reliableMarginRight||(p.cssHooks.marginRight={get:function(a,b){return p.swap(a,{display:"inline-block"},function(){if(b){return bH(a,"marginRight")}})}}),!p.support.pixelPosition&&p.fn.position&&p.each(["top","left"],function(a,b){p.cssHooks[b]={get:function(a,c){if(c){var d=bH(a,b);return bQ.test(d)?p(a).position()[b]+"px":d}}}})}),p.expr&&p.expr.filters&&(p.expr.filters.hidden=function(a){return a.offsetWidth===0&&a.offsetHeight===0||!p.support.reliableHiddenOffsets&&(a.style&&a.style.display||bH(a,"display"))==="none"},p.expr.filters.visible=function(a){return !p.expr.filters.hidden(a)}),p.each({margin:"",padding:"",border:"Width"},function(a,b){p.cssHooks[a+b]={expand:function(c){var d,e=typeof c=="string"?c.split(" "):[c],f={};for(d=0;d<4;d++){f[a+bV[d]+b]=e[d]||e[d-2]||e[0]}return f}},bO.test(a)||(p.cssHooks[a+b].set=b_)});var cd=/%20/g,ce=/\[\]$/,cf=/\r?\n/g,cg=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,ch=/^(?:select|textarea)/i;p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?p.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ch.test(this.nodeName)||cg.test(this.type))}).map(function(a,b){var c=p(this).val();return c==null?null:p.isArray(c)?p.map(c,function(a,c){return{name:b.name,value:a.replace(cf,"\r\n")}}):{name:b.name,value:c.replace(cf,"\r\n")}}).get()}}),p.param=function(a,c){var d,e=[],f=function(a,b){b=p.isFunction(b)?b():b==null?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=p.ajaxSettings&&p.ajaxSettings.traditional);if(p.isArray(a)||a.jquery&&!p.isPlainObject(a)){p.each(a,function(){f(this.name,this.value)})}else{for(d in a){ci(d,a[d],c,f)}}return e.join("&").replace(cd,"+")};var cj,ck,cl=/#.*$/,cm=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,cn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,co=/^(?:GET|HEAD)$/,cp=/^\/\//,cq=/\?/,cr=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,cs=/([?&])_=[^&]*/,ct=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,cu=p.fn.load,cv={},cw={},cx=["*/"]+["*"];try{ck=f.href}catch(cy){ck=e.createElement("a"),ck.href="",ck=ck.href}cj=ct.exec(ck.toLowerCase())||[],p.fn.load=function(a,c,d){if(typeof a!="string"&&cu){return cu.apply(this,arguments)}if(!this.length){return this}var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),p.isFunction(c)?(d=c,c=b):c&&typeof c=="object"&&(f="POST"),p.ajax({url:a,type:f,dataType:"html",data:c,complete:function(a,b){d&&h.each(d,g||[a.responseText,b,a])}}).done(function(a){g=arguments,h.html(e?p("<div>").append(a.replace(cr,"")).find(e):a)}),this},p.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){p.fn[b]=function(a){return this.on(b,a)}}),p.each(["get","post"],function(a,c){p[c]=function(a,d,e,f){return p.isFunction(d)&&(f=f||e,e=d,d=b),p.ajax({type:c,url:a,data:d,success:e,dataType:f})}}),p.extend({getScript:function(a,c){return p.get(a,b,c,"script")},getJSON:function(a,b,c){return p.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?cB(a,p.ajaxSettings):(b=a,a=p.ajaxSettings),cB(a,b),a},ajaxSettings:{url:ck,isLocal:cn.test(cj[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":cx},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:cz(cv),ajaxTransport:cz(cw),ajax:function(a,c){function y(a,c,f,i){var k,s,t,u,w,y=c;if(v===2){return}v=2,h&&clearTimeout(h),g=b,e=i||"",x.readyState=a>0?4:0,f&&(u=cC(l,x,f));if(a>=200&&a<300||a===304){l.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(p.lastModified[d]=w),w=x.getResponseHeader("Etag"),w&&(p.etag[d]=w)),a===304?(y="notmodified",k=!0):(k=cD(l,u),y=k.state,s=k.data,t=k.error,k=!t)}else{t=y;if(!y||a){y="error",a<0&&(a=0)}}x.status=a,x.statusText=(c||y)+"",k?o.resolveWith(m,[s,y,x]):o.rejectWith(m,[x,y,t]),x.statusCode(r),r=b,j&&n.trigger("ajax"+(k?"Success":"Error"),[x,l,k?s:t]),q.fireWith(m,[x,y]),j&&(n.trigger("ajaxComplete",[x,l]),--p.active||p.event.trigger("ajaxStop"))}typeof a=="object"&&(c=a,a=b),c=c||{};var d,e,f,g,h,i,j,k,l=p.ajaxSetup({},c),m=l.context||l,n=m!==l&&(m.nodeType||m instanceof p)?p(m):p.event,o=p.Deferred(),q=p.Callbacks("once memory"),r=l.statusCode||{},t={},u={},v=0,w="canceled",x={readyState:0,setRequestHeader:function(a,b){if(!v){var c=a.toLowerCase();a=u[c]=u[c]||a,t[a]=b}return this},getAllResponseHeaders:function(){return v===2?e:null},getResponseHeader:function(a){var c;if(v===2){if(!f){f={};while(c=cm.exec(e)){f[c[1].toLowerCase()]=c[2]}}c=f[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return v||(l.mimeType=a),this},abort:function(a){return a=a||w,g&&g.abort(a),y(0,a),this}};o.promise(x),x.success=x.done,x.error=x.fail,x.complete=q.add,x.statusCode=function(a){if(a){var b;if(v<2){for(b in a){r[b]=[r[b],a[b]]}}else{b=a[x.status],x.always(b)}}return this},l.url=((a||l.url)+"").replace(cl,"").replace(cp,cj[1]+"//"),l.dataTypes=p.trim(l.dataType||"*").toLowerCase().split(s),l.crossDomain==null&&(i=ct.exec(l.url.toLowerCase())||!1,l.crossDomain=i&&i.join(":")+(i[3]?"":i[1]==="http:"?80:443)!==cj.join(":")+(cj[3]?"":cj[1]==="http:"?80:443)),l.data&&l.processData&&typeof l.data!="string"&&(l.data=p.param(l.data,l.traditional)),cA(cv,l,c,x);if(v===2){return x}j=l.global,l.type=l.type.toUpperCase(),l.hasContent=!co.test(l.type),j&&p.active++===0&&p.event.trigger("ajaxStart");if(!l.hasContent){l.data&&(l.url+=(cq.test(l.url)?"&":"?")+l.data,delete l.data),d=l.url;if(l.cache===!1){var z=p.now(),A=l.url.replace(cs,"$1_="+z);l.url=A+(A===l.url?(cq.test(l.url)?"&":"?")+"_="+z:"")}}(l.data&&l.hasContent&&l.contentType!==!1||c.contentType)&&x.setRequestHeader("Content-Type",l.contentType),l.ifModified&&(d=d||l.url,p.lastModified[d]&&x.setRequestHeader("If-Modified-Since",p.lastModified[d]),p.etag[d]&&x.setRequestHeader("If-None-Match",p.etag[d])),x.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+cx+"; q=0.01":""):l.accepts["*"]);for(k in l.headers){x.setRequestHeader(k,l.headers[k])}if(!l.beforeSend||l.beforeSend.call(m,x,l)!==!1&&v!==2){w="abort";for(k in {success:1,error:1,complete:1}){x[k](l[k])}g=cA(cw,l,c,x);if(!g){y(-1,"No Transport")}else{x.readyState=1,j&&n.trigger("ajaxSend",[x,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){x.abort("timeout")},l.timeout));try{v=1,g.send(t,y)}catch(B){if(v<2){y(-1,B)}else{throw B}}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var cE=[],cF=/\?/,cG=/(=)\?(?=&|$)|\?\?/,cH=p.now();p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=cE.pop()||p.expando+"_"+cH++;return this[a]=!0,a}}),p.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.data,j=c.url,k=c.jsonp!==!1,l=k&&cG.test(j),m=k&&!l&&typeof i=="string"&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&cG.test(i);if(c.dataTypes[0]==="jsonp"||l||m){return f=c.jsonpCallback=p.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,g=a[f],l?c.url=j.replace(cG,"$1"+f):m?c.data=i.replace(cG,"$1"+f):k&&(c.url+=(cF.test(j)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||p.error(f+" was not called"),h[0]},c.dataTypes[0]="json",a[f]=function(){h=arguments},e.always(function(){a[f]=g,c[f]&&(c.jsonpCallback=d.jsonpCallback,cE.push(f)),h&&p.isFunction(g)&&g(h[0]),h=g=b}),"script"}}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return p.globalEval(a),a}}}),p.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),p.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=e.head||e.getElementsByTagName("head")[0]||e.documentElement;return{send:function(f,g){c=e.createElement("script"),c.async="async",a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,e){if(e||!c.readyState||/loaded|complete/.test(c.readyState)){c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||g(200,"success")}},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var cI,cJ=a.ActiveXObject?function(){for(var a in cI){cI[a](0,1)}}:!1,cK=0;p.ajaxSettings.xhr=a.ActiveXObject?function(){return !this.isLocal&&cL()||cM()}:cL,function(a){p.extend(p.support,{ajax:!!a,cors:!!a&&"withCredentials" in a})}(p.ajaxSettings.xhr()),p.support.ajax&&p.ajaxTransport(function(c){if(!c.crossDomain||p.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async);if(c.xhrFields){for(h in c.xhrFields){i[h]=c.xhrFields[h]}}c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e){i.setRequestHeader(h,e[h])}}catch(j){}i.send(c.hasContent&&c.data||null),d=function(a,e){var h,j,k,l,m;try{if(d&&(e||i.readyState===4)){d=b,g&&(i.onreadystatechange=p.noop,cJ&&delete cI[g]);if(e){i.readyState!==4&&i.abort()}else{h=i.status,k=i.getAllResponseHeaders(),l={},m=i.responseXML,m&&m.documentElement&&(l.xml=m);try{l.text=i.responseText}catch(a){}try{j=i.statusText}catch(n){j=""}!h&&c.isLocal&&!c.crossDomain?h=l.text?200:404:h===1223&&(h=204)}}}catch(o){e||f(-1,o)}l&&f(h,j,l,k)},c.async?i.readyState===4?setTimeout(d,0):(g=++cK,cJ&&(cI||(cI={},p(a).unload(cJ)),cI[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var cN,cO,cP=/^(?:toggle|show|hide)$/,cQ=new RegExp("^(?:([-+])=|)("+q+")([a-z%]*)$","i"),cR=/queueHooks$/,cS=[cY],cT={"*":[function(a,b){var c,d,e=this.createTween(a,b),f=cQ.exec(b),g=e.cur(),h=+g||0,i=1,j=20;if(f){c=+f[2],d=f[3]||(p.cssNumber[a]?"":"px");if(d!=="px"&&h){h=p.css(e.elem,a,!0)||c||1;do{i=i||".5",h=h/i,p.style(e.elem,a,h+d)}while(i!==(i=e.cur()/g)&&i!==1&&--j)}e.unit=d,e.start=h,e.end=f[1]?h+(f[1]+1)*c:c}return e}]};p.Animation=p.extend(cW,{tweener:function(a,b){p.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");var c,d=0,e=a.length;for(;d<e;d++){c=a[d],cT[c]=cT[c]||[],cT[c].unshift(b)}},prefilter:function(a,b){b?cS.unshift(a):cS.push(a)}}),p.Tween=cZ,cZ.prototype={constructor:cZ,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(p.cssNumber[c]?"":"px")},cur:function(){var a=cZ.propHooks[this.prop];return a&&a.get?a.get(this):cZ.propHooks._default.get(this)},run:function(a){var b,c=cZ.propHooks[this.prop];return this.options.duration?this.pos=b=p.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):cZ.propHooks._default.set(this),this}},cZ.prototype.init.prototype=cZ.prototype,cZ.propHooks={_default:{get:function(a){var b;return a.elem[a.prop]==null||!!a.elem.style&&a.elem.style[a.prop]!=null?(b=p.css(a.elem,a.prop,!1,""),!b||b==="auto"?0:b):a.elem[a.prop]},set:function(a){p.fx.step[a.prop]?p.fx.step[a.prop](a):a.elem.style&&(a.elem.style[p.cssProps[a.prop]]!=null||p.cssHooks[a.prop])?p.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},cZ.propHooks.scrollTop=cZ.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},p.each(["toggle","show","hide"],function(a,b){var c=p.fn[b];p.fn[b]=function(d,e,f){return d==null||typeof d=="boolean"||!a&&p.isFunction(d)&&p.isFunction(e)?c.apply(this,arguments):this.animate(c$(b,!0),d,e,f)}}),p.fn.extend({fadeTo:function(a,b,c,d){return this.filter(bZ).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=p.isEmptyObject(a),f=p.speed(b,c,d),g=function(){var b=cW(this,p.extend({},a),f);e&&b.stop(!0)};return e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=a!=null&&a+"queueHooks",f=p.timers,g=p._data(this);if(c){g[c]&&g[c].stop&&e(g[c])}else{for(c in g){g[c]&&g[c].stop&&cR.test(c)&&e(g[c])}}for(c=f.length;c--;){f[c].elem===this&&(a==null||f[c].queue===a)&&(f[c].anim.stop(d),b=!1,f.splice(c,1))}(b||!d)&&p.dequeue(this,a)})}}),p.each({slideDown:c$("show"),slideUp:c$("hide"),slideToggle:c$("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){p.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),p.speed=function(a,b,c){var d=a&&typeof a=="object"?p.extend({},a):{complete:c||!c&&b||p.isFunction(a)&&a,duration:a,easing:c&&b||b&&!p.isFunction(b)&&b};d.duration=p.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in p.fx.speeds?p.fx.speeds[d.duration]:p.fx.speeds._default;if(d.queue==null||d.queue===!0){d.queue="fx"}return d.old=d.complete,d.complete=function(){p.isFunction(d.old)&&d.old.call(this),d.queue&&p.dequeue(this,d.queue)},d},p.easing={linear:function(a){return a},swing:function(a){return 0.5-Math.cos(a*Math.PI)/2}},p.timers=[],p.fx=cZ.prototype.init,p.fx.tick=function(){var a,b=p.timers,c=0;for(;c<b.length;c++){a=b[c],!a()&&b[c]===a&&b.splice(c--,1)}b.length||p.fx.stop()},p.fx.timer=function(a){a()&&p.timers.push(a)&&!cO&&(cO=setInterval(p.fx.tick,p.fx.interval))},p.fx.interval=13,p.fx.stop=function(){clearInterval(cO),cO=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fx.step={},p.expr&&p.expr.filters&&(p.expr.filters.animated=function(a){return p.grep(p.timers,function(b){return a===b.elem}).length});var c_=/^(?:body|html)$/i;p.fn.offset=function(a){if(arguments.length){return a===b?this:this.each(function(b){p.offset.setOffset(this,a,b)})}var c,d,e,f,g,h,i,j={top:0,left:0},k=this[0],l=k&&k.ownerDocument;if(!l){return}return(d=l.body)===k?p.offset.bodyOffset(k):(c=l.documentElement,p.contains(c,k)?(typeof k.getBoundingClientRect!="undefined"&&(j=k.getBoundingClientRect()),e=da(l),f=c.clientTop||d.clientTop||0,g=c.clientLeft||d.clientLeft||0,h=e.pageYOffset||c.scrollTop,i=e.pageXOffset||c.scrollLeft,{top:j.top+h-f,left:j.left+i-g}):j)},p.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return p.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(p.css(a,"marginTop"))||0,c+=parseFloat(p.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=p.css(a,"position");d==="static"&&(a.style.position="relative");var e=p(a),f=e.offset(),g=p.css(a,"top"),h=p.css(a,"left"),i=(d==="absolute"||d==="fixed")&&p.inArray("auto",[g,h])>-1,j={},k={},l,m;i?(k=e.position(),l=k.top,m=k.left):(l=parseFloat(g)||0,m=parseFloat(h)||0),p.isFunction(b)&&(b=b.call(a,c,f)),b.top!=null&&(j.top=b.top-f.top+l),b.left!=null&&(j.left=b.left-f.left+m),"using" in b?b.using.call(a,j):e.css(j)}},p.fn.extend({position:function(){if(!this[0]){return}var a=this[0],b=this.offsetParent(),c=this.offset(),d=c_.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(p.css(a,"marginTop"))||0,c.left-=parseFloat(p.css(a,"marginLeft"))||0,d.top+=parseFloat(p.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(p.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||e.body;while(a&&!c_.test(a.nodeName)&&p.css(a,"position")==="static"){a=a.offsetParent}return a||e.body})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);p.fn[a]=function(e){return p.access(this,function(a,e,f){var g=da(a);if(f===b){return g?c in g?g[c]:g.document.documentElement[e]:a[e]}g?g.scrollTo(d?p(g).scrollLeft():f,d?f:p(g).scrollTop()):a[e]=f},a,e,arguments.length,null)}}),p.each({Height:"height",Width:"width"},function(a,c){p.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){p.fn[e]=function(e,f){var g=arguments.length&&(d||typeof e!="boolean"),h=d||(e===!0||f===!0?"margin":"border");return p.access(this,function(c,d,e){var f;return p.isWindow(c)?c.document.documentElement["client"+a]:c.nodeType===9?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?p.css(c,d,e,h):p.style(c,d,e,h)},c,g?e:b,g,null)}})}),a.jQuery=a.$=p,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return p})})(window);
/*!jQuery Knob*/
(function(g){var e={},f=Math.max,h=Math.min;e.c={};e.c.d=g(document);e.c.t=function(a){return a.originalEvent.touches.length-1};e.o=function(){var a=this;this.o=null;this.$=null;this.i=null;this.g=null;this.v=null;this.cv=null;this.x=0;this.y=0;this.$c=null;this.c=null;this.t=0;this.isInit=false;this.fgColor=null;this.pColor=null;this.dH=null;this.cH=null;this.eH=null;this.rH=null;this.run=function(){var b=function(c,d){var j;for(j in d){a.o[j]=d[j]}a.init();a._configure()._draw()};if(this.$.data("kontroled")){return}this.$.data("kontroled",true);this.extend();this.o=g.extend({min:this.$.data("min")||0,max:this.$.data("max")||100,stopper:true,readOnly:this.$.data("readonly"),cursor:(this.$.data("cursor")===true&&30)||this.$.data("cursor")||0,thickness:this.$.data("thickness")||0.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:this.$.data("displayinput")==null||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor")||this.$.data("fgcolor")||"#87CEEB",inline:false,step:this.$.data("step")||1,draw:null,change:null,cancel:null,release:null},this.o);if(this.$.is("fieldset")){this.v={};this.i=this.$.find("input");this.i.each(function(d){var c=g(this);a.i[d]=c;a.v[d]=c.val();c.bind("change",function(){var j={};j[d]=c.val();a.val(j)})});this.$.find("legend").remove()}else{this.i=this.$;this.v=this.$.val();(this.v=="")&&(this.v=this.o.min);this.$.bind("change",function(){a.val(a._validate(a.$.val()))})}(!this.o.displayInput)&&this.$.hide();this.$c=g('<canvas width="'+this.o.width+'px" height="'+this.o.height+'px"></canvas>');this.c=this.$c[0].getContext("2d");this.$.wrap(g('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;"></div>')).before(this.$c);if(this.v instanceof Object){this.cv={};this.copy(this.v,this.cv)}else{this.cv=this.v}this.$.bind("configure",b).parent().bind("configure",b);this._listen()._configure()._xy().init();this.isInit=true;this._draw();return this};this._draw=function(){var c=true,b=document.createElement("canvas");b.width=a.o.width;b.height=a.o.height;a.g=b.getContext("2d");a.clear();a.dH&&(c=a.dH());(c!==false)&&a.draw();a.c.drawImage(b,0,0);b=null};this._touch=function(c){var b=function(d){var j=a.xy2val(d.originalEvent.touches[a.t].pageX,d.originalEvent.touches[a.t].pageY);if(j==a.cv){return}if(a.cH&&(a.cH(j)===false)){return}a.change(a._validate(j));a._draw()};this.t=e.c.t(c);b(c);e.c.d.bind("touchmove.k",b).bind("touchend.k",function(){e.c.d.unbind("touchmove.k touchend.k");if(a.rH&&(a.rH(a.cv)===false)){return}a.val(a.cv)});return this};this._mouse=function(b){var c=function(d){var j=a.xy2val(d.pageX,d.pageY);if(j==a.cv){return}if(a.cH&&(a.cH(j)===false)){return}a.change(a._validate(j));a._draw()};c(b);e.c.d.bind("mousemove.k",c).bind("keyup.k",function(d){if(d.keyCode===27){e.c.d.unbind("mouseup.k mousemove.k keyup.k");if(a.eH&&(a.eH()===false)){return}a.cancel()}}).bind("mouseup.k",function(d){e.c.d.unbind("mousemove.k mouseup.k keyup.k");if(a.rH&&(a.rH(a.cv)===false)){return}a.val(a.cv)});return this};this._xy=function(){var b=this.$c.offset();this.x=b.left;this.y=b.top;return this};this._listen=function(){if(!this.o.readOnly){this.$c.bind("mousedown",function(b){b.preventDefault();a._xy()._mouse(b)}).bind("touchstart",function(b){b.preventDefault();a._xy()._touch(b)});this.listen()}else{this.$.attr("readonly","readonly")}return this};this._configure=function(){if(this.o.draw){this.dH=this.o.draw}if(this.o.change){this.cH=this.o.change}if(this.o.cancel){this.eH=this.o.cancel}if(this.o.release){this.rH=this.o.release}if(this.o.displayPrevious){this.pColor=this.h2rgba(this.o.fgColor,"0.4");this.fgColor=this.h2rgba(this.o.fgColor,"0.6")}else{this.fgColor=this.o.fgColor}return this};this._clear=function(){this.$c[0].width=this.$c[0].width};this._validate=function(b){return(~~(((b<0)?-0.5:0.5)+(b/this.o.step)))*this.o.step};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(b){};this.val=function(b){};this.xy2val=function(c,b){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(b,d){var c;b=b.substring(1,7);c=[parseInt(b.substring(0,2),16),parseInt(b.substring(2,4),16),parseInt(b.substring(4,6),16)];return"rgba("+c[0]+","+c[1]+","+c[2]+","+d+")"};this.copy=function(b,c){for(var d in b){c[d]=b[d]}}};e.Dial=function(){e.o.call(this);this.startAngle=null;this.xy=null;this.radius=null;this.lineWidth=null;this.cursorExt=null;this.w2=null;this.PI2=2*Math.PI;this.extend=function(){this.o=g.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:true},this.o)};this.val=function(a){if(null!=a){this.cv=this.o.stopper?f(h(a,this.o.max),this.o.min):a;this.v=this.cv;this.$.val(this.v);this._draw()}else{return this.v}};this.xy2val=function(d,a){var c,b;c=Math.atan2(d-(this.x+this.w2),-(a-this.y-this.w2))-this.angleOffset;if(this.angleArc!=this.PI2&&(c<0)&&(c>-0.5)){c=0}else{if(c<0){c+=this.PI2}}b=~~(0.5+(c*(this.o.max-this.o.min)/this.angleArc))+this.o.min;this.o.stopper&&(b=f(h(b,this.o.max),this.o.min));return b};this.listen=function(){var k=this,a=function(q){q.preventDefault();var r=q.originalEvent,j=r.detail||r.wheelDeltaX,p=r.detail||r.wheelDeltaY,i=parseInt(k.$.val())+(j>0||p>0?k.o.step:j<0||p<0?-k.o.step:0);if(k.cH&&(k.cH(i)===false)){return}k.val(i)},c,b,l=1,d={37:-k.o.step,38:k.o.step,39:k.o.step,40:-k.o.step};this.$.bind("keydown",function(i){var j=i.keyCode;if(j>=96&&j<=105){j=i.keyCode=j-48}c=parseInt(String.fromCharCode(j));if(isNaN(c)){(j!==13)&&(j!==8)&&(j!==9)&&(j!==189)&&i.preventDefault();if(g.inArray(j,[37,38,39,40])>-1){i.preventDefault();var n=parseInt(k.$.val())+d[j]*l;k.o.stopper&&(n=f(h(n,k.o.max),k.o.min));k.change(n);k._draw();b=window.setTimeout(function(){l*=2},30)}}}).bind("keyup",function(i){if(isNaN(c)){if(b){window.clearTimeout(b);b=null;l=1;k.val(k.$.val())}}else{(k.$.val()>k.o.max&&k.$.val(k.o.max))||(k.$.val()<k.o.min&&k.$.val(k.o.min))}});this.$c.bind("mousewheel DOMMouseScroll",a);this.$.bind("mousewheel DOMMouseScroll",a)};this.init=function(){if(this.v<this.o.min||this.v>this.o.max){this.v=this.o.min}this.$.val(this.v);this.w2=this.o.width/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var a=f(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:((this.o.width/2+4)>>0)+"px",height:((this.o.width/3)>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":((this.o.width/3)>>0)+"px","margin-left":"-"+((this.o.width*3/4+2)>>0)+"px",border:0,background:"none",font:"bold "+((this.o.width/a)>>0)+"px Arial","text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})};this.change=function(a){this.cv=a;this.$.val(a)};this.angle=function(a){return(a-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.draw=function(){var a=this.g,m=this.angle(this.cv),l=this.startAngle,d=l+m,n,c,b=1;a.lineWidth=this.lineWidth;a.lineCap=this.lineCap;this.o.cursor&&(l=d-this.cursorExt)&&(d=d+this.cursorExt);a.beginPath();a.strokeStyle=this.o.bgColor;a.arc(this.xy,this.xy,this.radius,this.endAngle,this.startAngle,true);a.stroke();if(this.o.displayPrevious){c=this.startAngle+this.angle(this.v);n=this.startAngle;this.o.cursor&&(n=c-this.cursorExt)&&(c=c+this.cursorExt);a.beginPath();a.strokeStyle=this.pColor;a.arc(this.xy,this.xy,this.radius,n,c,false);a.stroke();b=(this.cv==this.v)}a.beginPath();a.strokeStyle=b?this.o.fgColor:this.fgColor;a.arc(this.xy,this.xy,this.radius,l,d,false);a.stroke()};this.cancel=function(){this.val(this.v)}};g.fn.dial=g.fn.knob=function(a){return this.each(function(){var b=new e.Dial();b.o=a;b.$=g(this);b.run()}).parent()}})(jQuery);"use strict";var THREE=THREE||{REVISION:"59"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};THREE.extend=function(h,g){if(Object.keys){for(var l=Object.keys(g),k=0,j=l.length;k<j;k++){var i=l[k];Object.defineProperty(h,i,Object.getOwnPropertyDescriptor(g,i))}}else{for(i in l={}.hasOwnProperty,g){l.call(g,i)&&(h[i]=g[i])}}return h};(function(){for(var e=0,d=["ms","moz","webkit","o"],f=0;f<d.length&&!self.requestAnimationFrame;++f){self.requestAnimationFrame=self[d[f]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[d[f]+"CancelAnimationFrame"]||self[d[f]+"CancelRequestAnimationFrame"]}void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(a){var j=Date.now(),i=Math.max(0,16-(j-e)),g=self.setTimeout(function(){a(j+i)},i);e=j+i;return g});void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(b){self.clearTimeout(b)})})();THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1000;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.Color=function(b){void 0!==b&&this.set(b);return this};THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(b){b instanceof THREE.Color?this.copy(b):"number"===typeof b?this.setHex(b):"string"===typeof b&&this.setStyle(b);return this},setHex:function(b){b=Math.floor(b);this.r=(b>>16&255)/255;this.g=(b>>8&255)/255;this.b=(b&255)/255;return this},setRGB:function(e,d,f){this.r=e;this.g=d;this.b=f;return this},setHSL:function(f,e,h){if(0===e){this.r=this.g=this.b=h}else{var g=function(i,d,j){0>j&&(j+=1);1<j&&(j-=1);return j<1/6?i+6*(d-i)*j:0.5>j?d:j<2/3?i+6*(d-i)*(2/3-j):i},e=0.5>=h?h*(1+e):h+e-h*e,h=2*h-e;this.r=g(h,e,f+1/3);this.g=g(h,e,f);this.b=g(h,e,f-1/3)}return this},setStyle:function(b){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(b)){return b=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(b),this.r=Math.min(255,parseInt(b[1],10))/255,this.g=Math.min(255,parseInt(b[2],10))/255,this.b=Math.min(255,parseInt(b[3],10))/255,this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(b)){return b=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(b),this.r=Math.min(100,parseInt(b[1],10))/100,this.g=Math.min(100,parseInt(b[2],10))/100,this.b=Math.min(100,parseInt(b[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(b)){return b=/^\#([0-9a-f]{6})$/i.exec(b),this.setHex(parseInt(b[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(b)){return b=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(b),this.setHex(parseInt(b[1]+b[1]+b[2]+b[2]+b[3]+b[3],16)),this}if(/^(\w+)$/i.test(b)){return this.setHex(THREE.ColorKeywords[b]),this}},copy:function(b){this.r=b.r;this.g=b.g;this.b=b.b;return this},copyGammaToLinear:function(b){this.r=b.r*b.r;this.g=b.g*b.g;this.b=b.b*b.b;return this},copyLinearToGamma:function(b){this.r=Math.sqrt(b.r);this.g=Math.sqrt(b.g);this.b=Math.sqrt(b.b);return this},convertGammaToLinear:function(){var e=this.r,d=this.g,f=this.b;this.r=e*e;this.g=d*d;this.b=f*f;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var b={h:0,s:0,l:0};return function(){var a=this.r,p=this.g,o=this.b,n=Math.max(a,p,o),m=Math.min(a,p,o),k,l=(m+n)/2;if(m===n){m=k=0}else{var j=n-m,m=0.5>=l?j/(n+m):j/(2-n-m);switch(n){case a:k=(p-o)/j+(p<o?6:0);break;case p:k=(o-a)/j+2;break;case o:k=(a-p)/j+4}k/=6}b.h=k;b.s=m;b.l=l;return b}}(),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(f,e,h){var g=this.getHSL();g.h+=f;g.s+=e;g.l+=h;this.setHSL(g.h,g.s,g.l);return this},add:function(b){this.r+=b.r;this.g+=b.g;this.b+=b.b;return this},addColors:function(d,c){this.r=d.r+c.r;this.g=d.g+c.g;this.b=d.b+c.b;return this},addScalar:function(b){this.r+=b;this.g+=b;this.b+=b;return this},multiply:function(b){this.r*=b.r;this.g*=b.g;this.b*=b.b;return this},multiplyScalar:function(b){this.r*=b;this.g*=b;this.b*=b;return this},lerp:function(d,c){this.r+=(d.r-this.r)*c;this.g+=(d.g-this.g)*c;this.b+=(d.b-this.b)*c;return this},equals:function(b){return b.r===this.r&&b.g===this.g&&b.b===this.b},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(f,e,h,g){this._x=f||0;this._y=e||0;this._z=h||0;this._w=void 0!==g?g:1};THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)},get x(){return this._x},set x(b){this._x=b;this._updateEuler()},get y(){return this._y},set y(b){this._y=b;this._updateEuler()},get z(){return this._z},set z(b){this._z=b;this._updateEuler()},get w(){return this._w},set w(b){this._w=b;this._updateEuler()},set:function(f,e,h,g){this._x=f;this._y=e;this._z=h;this._w=g;this._updateEuler();return this},copy:function(b){this._x=b._x;this._y=b._y;this._z=b._z;this._w=b._w;this._updateEuler();return this},setFromEuler:function(j,i){void 0===typeof j.order&&console.error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var p=Math.cos(j._x/2),o=Math.cos(j._y/2),n=Math.cos(j._z/2),m=Math.sin(j._x/2),k=Math.sin(j._y/2),l=Math.sin(j._z/2);void 0===j.order||"XYZ"===j.order?(this._x=m*o*n+p*k*l,this._y=p*k*n-m*o*l,this._z=p*o*l+m*k*n,this._w=p*o*n-m*k*l):"YXZ"===j.order?(this._x=m*o*n+p*k*l,this._y=p*k*n-m*o*l,this._z=p*o*l-m*k*n,this._w=p*o*n+m*k*l):"ZXY"===j.order?(this._x=m*o*n-p*k*l,this._y=p*k*n+m*o*l,this._z=p*o*l+m*k*n,this._w=p*o*n-m*k*l):"ZYX"===j.order?(this._x=m*o*n-p*k*l,this._y=p*k*n+m*o*l,this._z=p*o*l-m*k*n,this._w=p*o*n+m*k*l):"YZX"===j.order?(this._x=m*o*n+p*k*l,this._y=p*k*n+m*o*l,this._z=p*o*l-m*k*n,this._w=p*o*n-m*k*l):"XZY"===j.order&&(this._x=m*o*n-p*k*l,this._y=p*k*n-m*o*l,this._z=p*o*l+m*k*n,this._w=p*o*n+m*k*l);!1!==i&&this._updateEuler();return this},setFromAxisAngle:function(f,e){var h=e/2,g=Math.sin(h);this._x=f.x*g;this._y=f.y*g;this._z=f.z*g;this._w=Math.cos(h);this._updateEuler();return this},setFromRotationMatrix:function(t){var s=t.elements,r=s[0],t=s[4],q=s[8],p=s[1],o=s[5],m=s[9],n=s[2],l=s[6],s=s[10],k=r+o+s;0<k?(r=0.5/Math.sqrt(k+1),this._w=0.25/r,this._x=(l-m)*r,this._y=(q-n)*r,this._z=(p-t)*r):r>o&&r>s?(r=2*Math.sqrt(1+r-o-s),this._w=(l-m)/r,this._x=0.25*r,this._y=(t+p)/r,this._z=(q+n)/r):o>s?(r=2*Math.sqrt(1+o-r-s),this._w=(q-n)/r,this._x=(t+p)/r,this._y=0.25*r,this._z=(m+l)/r):(r=2*Math.sqrt(1+s-r-o),this._w=(p-t)/r,this._x=(q+n)/r,this._y=(m+l)/r,this._z=0.25*r);this._updateEuler();return this},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this._updateEuler();return this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var b=this.length();0===b?(this._z=this._y=this._x=0,this._w=1):(b=1/b,this._x*=b,this._y*=b,this._z*=b,this._w*=b);return this},multiply:function(d,c){return void 0!==c?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(d,c)):this.multiplyQuaternions(this,d)},multiplyQuaternions:function(t,s){var r=t._x,q=t._y,p=t._z,o=t._w,m=s._x,n=s._y,l=s._z,k=s._w;this._x=r*k+o*m+q*l-p*n;this._y=q*k+o*n+p*m-r*l;this._z=p*k+o*l+r*n-q*m;this._w=o*k-r*m-q*n-p*l;this._updateEuler();return this},multiplyVector3:function(b){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return b.applyQuaternion(this)},slerp:function(r,q){var p=this._x,o=this._y,n=this._z,m=this._w,k=m*r._w+p*r._x+o*r._y+n*r._z;0>k?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,k=-k):this.copy(r);if(1<=k){return this._w=m,this._x=p,this._y=o,this._z=n,this}var l=Math.acos(k),j=Math.sqrt(1-k*k);if(0.001>Math.abs(j)){return this._w=0.5*(m+this._w),this._x=0.5*(p+this._x),this._y=0.5*(o+this._y),this._z=0.5*(n+this._z),this}k=Math.sin((1-q)*l)/j;l=Math.sin(q*l)/j;this._w=m*k+this._w*l;this._x=p*k+this._x*l;this._y=o*k+this._y*l;this._z=n*k+this._z*l;this._updateEuler();return this},equals:function(b){return b._x===this._x&&b._y===this._y&&b._z===this._z&&b._w===this._w},fromArray:function(b){this._x=b[0];this._y=b[1];this._z=b[2];this._w=b[3];this._updateEuler();return this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}};THREE.Quaternion.slerp=function(f,e,h,g){return h.copy(f).slerp(e,g)};THREE.Vector2=function(d,c){this.x=d||0;this.y=c||0};THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(d,c){this.x=d;this.y=c;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setComponent:function(d,c){switch(d){case 0:this.x=c;break;case 1:this.y=c;break;default:throw Error("index is out of range: "+d)}},getComponent:function(b){switch(b){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+b)}},copy:function(b){this.x=b.x;this.y=b.y;return this},add:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(d,c)}this.x+=d.x;this.y+=d.y;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;return this},addScalar:function(b){this.x+=b;this.y+=b;return this},sub:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(d,c)}this.x-=d.x;this.y-=d.y;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;return this},divideScalar:function(b){0!==b?(b=1/b,this.x*=b,this.y*=b):this.y=this.x=0;return this},min:function(b){this.x>b.x&&(this.x=b.x);this.y>b.y&&(this.y=b.y);return this},max:function(b){this.x<b.x&&(this.x=b.x);this.y<b.y&&(this.y=b.y);return this},clamp:function(d,c){this.x<d.x?this.x=d.x:this.x>c.x&&(this.x=c.x);this.y<d.y?this.y=d.y:this.y>c.y&&(this.y=c.y);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},distanceToSquared:function(d){var c=this.x-d.x,d=this.y-d.y;return c*c+d*d},setLength:function(d){var c=this.length();0!==c&&d!==c&&this.multiplyScalar(d/c);return this},lerp:function(d,c){this.x+=(d.x-this.x)*c;this.y+=(d.y-this.y)*c;return this},equals:function(b){return b.x===this.x&&b.y===this.y},fromArray:function(b){this.x=b[0];this.y=b[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(e,d,f){this.x=e||0;this.y=d||0;this.z=f||0};THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(e,d,f){this.x=e;this.y=d;this.z=f;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setZ:function(b){this.z=b;return this},setComponent:function(d,c){switch(d){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw Error("index is out of range: "+d)}},getComponent:function(b){switch(b){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+b)}},copy:function(b){this.x=b.x;this.y=b.y;this.z=b.z;return this},add:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(d,c)}this.x+=d.x;this.y+=d.y;this.z+=d.z;return this},addScalar:function(b){this.x+=b;this.y+=b;this.z+=b;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;this.z=d.z+c.z;return this},sub:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(d,c)}this.x-=d.x;this.y-=d.y;this.z-=d.z;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;this.z=d.z-c.z;return this},multiply:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(d,c)}this.x*=d.x;this.y*=d.y;this.z*=d.z;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;this.z*=b;return this},multiplyVectors:function(d,c){this.x=d.x*c.x;this.y=d.y*c.y;this.z=d.z*c.z;return this},applyMatrix3:function(f){var e=this.x,h=this.y,g=this.z,f=f.elements;this.x=f[0]*e+f[3]*h+f[6]*g;this.y=f[1]*e+f[4]*h+f[7]*g;this.z=f[2]*e+f[5]*h+f[8]*g;return this},applyMatrix4:function(f){var e=this.x,h=this.y,g=this.z,f=f.elements;this.x=f[0]*e+f[4]*h+f[8]*g+f[12];this.y=f[1]*e+f[5]*h+f[9]*g+f[13];this.z=f[2]*e+f[6]*h+f[10]*g+f[14];return this},applyProjection:function(g){var f=this.x,j=this.y,i=this.z,g=g.elements,h=1/(g[3]*f+g[7]*j+g[11]*i+g[15]);this.x=(g[0]*f+g[4]*j+g[8]*i+g[12])*h;this.y=(g[1]*f+g[5]*j+g[9]*i+g[13])*h;this.z=(g[2]*f+g[6]*j+g[10]*i+g[14])*h;return this},applyQuaternion:function(t){var s=this.x,r=this.y,q=this.z,p=t.x,o=t.y,m=t.z,t=t.w,n=t*s+o*q-m*r,l=t*r+m*s-p*q,k=t*q+p*r-o*s,s=-p*s-o*r-m*q;this.x=n*t+s*-p+l*-m-k*-o;this.y=l*t+s*-o+k*-p-n*-m;this.z=k*t+s*-m+n*-o-l*-p;return this},transformDirection:function(f){var e=this.x,h=this.y,g=this.z,f=f.elements;this.x=f[0]*e+f[4]*h+f[8]*g;this.y=f[1]*e+f[5]*h+f[9]*g;this.z=f[2]*e+f[6]*h+f[10]*g;this.normalize();return this},divide:function(b){this.x/=b.x;this.y/=b.y;this.z/=b.z;return this},divideScalar:function(b){0!==b?(b=1/b,this.x*=b,this.y*=b,this.z*=b):this.z=this.y=this.x=0;return this},min:function(b){this.x>b.x&&(this.x=b.x);this.y>b.y&&(this.y=b.y);this.z>b.z&&(this.z=b.z);return this},max:function(b){this.x<b.x&&(this.x=b.x);this.y<b.y&&(this.y=b.y);this.z<b.z&&(this.z=b.z);return this},clamp:function(d,c){this.x<d.x?this.x=d.x:this.x>c.x&&(this.x=c.x);this.y<d.y?this.y=d.y:this.y>c.y&&(this.y=c.y);this.z<d.z?this.z=d.z:this.z>c.z&&(this.z=c.z);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(d){var c=this.length();0!==c&&d!==c&&this.multiplyScalar(d/c);return this},lerp:function(d,c){this.x+=(d.x-this.x)*c;this.y+=(d.y-this.y)*c;this.z+=(d.z-this.z)*c;return this},cross:function(g,f){if(void 0!==f){return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(g,f)}var j=this.x,i=this.y,h=this.z;this.x=i*g.z-h*g.y;this.y=h*g.x-j*g.z;this.z=j*g.y-i*g.x;return this},crossVectors:function(d,c){this.x=d.y*c.z-d.z*c.y;this.y=d.z*c.x-d.x*c.z;this.z=d.x*c.y-d.y*c.x;return this},angleTo:function(b){b=this.dot(b)/(this.length()*b.length());return Math.acos(THREE.Math.clamp(b,-1,1))},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},distanceToSquared:function(e){var d=this.x-e.x,f=this.y-e.y,e=this.z-e.z;return d*d+f*f+e*e},setEulerFromRotationMatrix:function(){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},setEulerFromQuaternion:function(){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(b){this.x=b.elements[12];this.y=b.elements[13];this.z=b.elements[14];return this},getScaleFromMatrix:function(e){var d=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),f=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),e=this.set(e.elements[8],e.elements[9],e.elements[10]).length();this.x=d;this.y=f;this.z=e;return this},getColumnFromMatrix:function(f,e){var h=4*f,g=e.elements;this.x=g[h];this.y=g[h+1];this.z=g[h+2];return this},equals:function(b){return b.x===this.x&&b.y===this.y&&b.z===this.z},fromArray:function(b){this.x=b[0];this.y=b[1];this.z=b[2];return this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var b=new THREE.Quaternion;return function(a){void 0===typeof a.order&&console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");a=b.setFromEuler(a);this.applyQuaternion(a);return this}}(),applyAxisAngle:function(){var b=new THREE.Quaternion;return function(a,f){var e=b.setFromAxisAngle(a,f);this.applyQuaternion(e);return this}}(),projectOnVector:function(){var b=new THREE.Vector3;return function(a){b.copy(a).normalize();a=this.dot(b);return this.copy(b).multiplyScalar(a)}}(),projectOnPlane:function(){var b=new THREE.Vector3;return function(a){b.copy(this).projectOnVector(a);return this.sub(b)}}(),reflect:function(){var b=new THREE.Vector3;return function(a){b.copy(this).projectOnVector(a).multiplyScalar(2);return this.subVectors(b,this)}}()});THREE.Vector4=function(f,e,h,g){this.x=f||0;this.y=e||0;this.z=h||0;this.w=void 0!==g?g:1};THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(f,e,h,g){this.x=f;this.y=e;this.z=h;this.w=g;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setZ:function(b){this.z=b;return this},setW:function(b){this.w=b;return this},setComponent:function(d,c){switch(d){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw Error("index is out of range: "+d)}},getComponent:function(b){switch(b){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+b)}},copy:function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=void 0!==b.w?b.w:1;return this},add:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(d,c)}this.x+=d.x;this.y+=d.y;this.z+=d.z;this.w+=d.w;return this},addScalar:function(b){this.x+=b;this.y+=b;this.z+=b;this.w+=b;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;this.z=d.z+c.z;this.w=d.w+c.w;return this},sub:function(d,c){if(void 0!==c){return console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(d,c)}this.x-=d.x;this.y-=d.y;this.z-=d.z;this.w-=d.w;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;this.z=d.z-c.z;this.w=d.w-c.w;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;this.z*=b;this.w*=b;return this},applyMatrix4:function(g){var f=this.x,j=this.y,i=this.z,h=this.w,g=g.elements;this.x=g[0]*f+g[4]*j+g[8]*i+g[12]*h;this.y=g[1]*f+g[5]*j+g[9]*i+g[13]*h;this.z=g[2]*f+g[6]*j+g[10]*i+g[14]*h;this.w=g[3]*f+g[7]*j+g[11]*i+g[15]*h;return this},divideScalar:function(b){0!==b?(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=b):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(d){this.w=2*Math.acos(d.w);var c=Math.sqrt(1-d.w*d.w);0.0001>c?(this.x=1,this.z=this.y=0):(this.x=d.x/c,this.y=d.y/c,this.z=d.z/c);return this},setAxisAngleFromRotationMatrix:function(t){var s,r,q,t=t.elements,p=t[0];q=t[4];var o=t[8],m=t[1],n=t[5],l=t[9];r=t[2];s=t[6];var k=t[10];if(0.01>Math.abs(q-m)&&0.01>Math.abs(o-r)&&0.01>Math.abs(l-s)){if(0.1>Math.abs(q+m)&&0.1>Math.abs(o+r)&&0.1>Math.abs(l+s)&&0.1>Math.abs(p+n+k-3)){return this.set(1,0,0,0),this}t=Math.PI;p=(p+1)/2;n=(n+1)/2;k=(k+1)/2;q=(q+m)/4;o=(o+r)/4;l=(l+s)/4;p>n&&p>k?0.01>p?(s=0,q=r=0.707106781):(s=Math.sqrt(p),r=q/s,q=o/s):n>k?0.01>n?(s=0.707106781,r=0,q=0.707106781):(r=Math.sqrt(n),s=q/r,q=l/r):0.01>k?(r=s=0.707106781,q=0):(q=Math.sqrt(k),s=o/q,r=l/q);this.set(s,r,q,t);return this}t=Math.sqrt((s-l)*(s-l)+(o-r)*(o-r)+(m-q)*(m-q));0.001>Math.abs(t)&&(t=1);this.x=(s-l)/t;this.y=(o-r)/t;this.z=(m-q)/t;this.w=Math.acos((p+n+k-1)/2);return this},min:function(b){this.x>b.x&&(this.x=b.x);this.y>b.y&&(this.y=b.y);this.z>b.z&&(this.z=b.z);this.w>b.w&&(this.w=b.w);return this},max:function(b){this.x<b.x&&(this.x=b.x);this.y<b.y&&(this.y=b.y);this.z<b.z&&(this.z=b.z);this.w<b.w&&(this.w=b.w);return this},clamp:function(d,c){this.x<d.x?this.x=d.x:this.x>c.x&&(this.x=c.x);this.y<d.y?this.y=d.y:this.y>c.y&&(this.y=c.y);this.z<d.z?this.z=d.z:this.z>c.z&&(this.z=c.z);this.w<d.w?this.w=d.w:this.w>c.w&&(this.w=c.w);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z+this.w*b.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(d){var c=this.length();0!==c&&d!==c&&this.multiplyScalar(d/c);return this},lerp:function(d,c){this.x+=(d.x-this.x)*c;this.y+=(d.y-this.y)*c;this.z+=(d.z-this.z)*c;this.w+=(d.w-this.w)*c;return this},equals:function(b){return b.x===this.x&&b.y===this.y&&b.z===this.z&&b.w===this.w},fromArray:function(b){this.x=b[0];this.y=b[1];this.z=b[2];this.w=b[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};THREE.Euler=function(f,e,h,g){this._x=f||0;this._y=e||0;this._z=h||0;this._order=g||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");THREE.Euler.DefaultOrder="XYZ";THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(b){this._x=b;this._updateQuaternion()},get y(){return this._y},set y(b){this._y=b;this._updateQuaternion()},get z(){return this._z},set z(b){this._z=b;this._updateQuaternion()},get order(){return this._order},set order(b){this._order=b;this._updateQuaternion()},set:function(f,e,h,g){this._x=f;this._y=e;this._z=h;this._order=g||this._order;this._updateQuaternion();return this},copy:function(b){this._x=b._x;this._y=b._y;this._z=b._z;this._order=b._order;this._updateQuaternion();return this},setFromRotationMatrix:function(B,A){function v(b){return Math.min(Math.max(b,-1),1)}var u=B.elements,t=u[0],s=u[4],q=u[8],r=u[1],p=u[5],o=u[9],n=u[2],k=u[6],u=u[10],A=A||this._order;"XYZ"===A?(this._y=Math.asin(v(q)),0.99999>Math.abs(q)?(this._x=Math.atan2(-o,u),this._z=Math.atan2(-s,t)):(this._x=Math.atan2(k,p),this._z=0)):"YXZ"===A?(this._x=Math.asin(-v(o)),0.99999>Math.abs(o)?(this._y=Math.atan2(q,u),this._z=Math.atan2(r,p)):(this._y=Math.atan2(-n,t),this._z=0)):"ZXY"===A?(this._x=Math.asin(v(k)),0.99999>Math.abs(k)?(this._y=Math.atan2(-n,u),this._z=Math.atan2(-s,p)):(this._y=0,this._z=Math.atan2(r,t))):"ZYX"===A?(this._y=Math.asin(-v(n)),0.99999>Math.abs(n)?(this._x=Math.atan2(k,u),this._z=Math.atan2(r,t)):(this._x=0,this._z=Math.atan2(-s,p))):"YZX"===A?(this._z=Math.asin(v(r)),0.99999>Math.abs(r)?(this._x=Math.atan2(-o,p),this._y=Math.atan2(-n,t)):(this._x=0,this._y=Math.atan2(q,u))):"XZY"===A?(this._z=Math.asin(-v(s)),0.99999>Math.abs(s)?(this._x=Math.atan2(k,p),this._y=Math.atan2(q,t)):(this._x=Math.atan2(-o,u),this._y=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+A);this._order=A;this._updateQuaternion();return this},setFromQuaternion:function(j,i,p){function o(b){return Math.min(Math.max(b,-1),1)}var n=j.x*j.x,m=j.y*j.y,k=j.z*j.z,l=j.w*j.w,i=i||this._order;"XYZ"===i?(this._x=Math.atan2(2*(j.x*j.w-j.y*j.z),l-n-m+k),this._y=Math.asin(o(2*(j.x*j.z+j.y*j.w))),this._z=Math.atan2(2*(j.z*j.w-j.x*j.y),l+n-m-k)):"YXZ"===i?(this._x=Math.asin(o(2*(j.x*j.w-j.y*j.z))),this._y=Math.atan2(2*(j.x*j.z+j.y*j.w),l-n-m+k),this._z=Math.atan2(2*(j.x*j.y+j.z*j.w),l-n+m-k)):"ZXY"===i?(this._x=Math.asin(o(2*(j.x*j.w+j.y*j.z))),this._y=Math.atan2(2*(j.y*j.w-j.z*j.x),l-n-m+k),this._z=Math.atan2(2*(j.z*j.w-j.x*j.y),l-n+m-k)):"ZYX"===i?(this._x=Math.atan2(2*(j.x*j.w+j.z*j.y),l-n-m+k),this._y=Math.asin(o(2*(j.y*j.w-j.x*j.z))),this._z=Math.atan2(2*(j.x*j.y+j.z*j.w),l+n-m-k)):"YZX"===i?(this._x=Math.atan2(2*(j.x*j.w-j.z*j.y),l-n+m-k),this._y=Math.atan2(2*(j.y*j.w-j.x*j.z),l+n-m-k),this._z=Math.asin(o(2*(j.x*j.y+j.z*j.w)))):"XZY"===i?(this._x=Math.atan2(2*(j.x*j.w+j.y*j.z),l-n+m-k),this._y=Math.atan2(2*(j.x*j.z+j.y*j.w),l+n-m-k),this._z=Math.asin(o(2*(j.z*j.w-j.x*j.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+i);this._order=i;!1!==p&&this._updateQuaternion();return this},reorder:function(){var b=new THREE.Quaternion;return function(a){b.setFromEuler(this);this.setFromQuaternion(b,a)}}(),fromArray:function(b){this._x=b[0];this._y=b[1];this._z=b[2];void 0!==b[3]&&(this._order=b[3]);this._updateQuaternion();return this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(b){return b._x===this._x&&b._y===this._y&&b._z===this._z&&b._order===this._order},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}};THREE.Line3=function(d,c){this.start=void 0!==d?d:new THREE.Vector3;this.end=void 0!==c?c:new THREE.Vector3};THREE.Line3.prototype={constructor:THREE.Line3,set:function(d,c){this.start.copy(d);this.end.copy(c);return this},copy:function(b){this.start.copy(b.start);this.end.copy(b.end);return this},center:function(b){return(b||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(b){return(b||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,d){var f=d||new THREE.Vector3;return this.delta(f).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(f,b){d.subVectors(f,this.start);c.subVectors(this.end,this.start);var a=c.dot(c),a=c.dot(d)/a;b&&(a=THREE.Math.clamp(a,0,1));return a}}(),closestPointToPoint:function(e,d,f){e=this.closestPointToPointParameter(e,d);f=f||new THREE.Vector3;return this.delta(f).multiplyScalar(e).add(this.start)},applyMatrix4:function(b){this.start.applyMatrix4(b);this.end.applyMatrix4(b);return this},equals:function(b){return b.start.equals(this.start)&&b.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}};THREE.Box2=function(d,c){this.min=void 0!==d?d:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==c?c:new THREE.Vector2(-Infinity,-Infinity)};THREE.Box2.prototype={constructor:THREE.Box2,set:function(d,c){this.min.copy(d);this.max.copy(c);return this},setFromPoints:function(f){if(0<f.length){var e=f[0];this.min.copy(e);this.max.copy(e);for(var h=1,g=f.length;h<g;h++){e=f[h],e.x<this.min.x?this.min.x=e.x:e.x>this.max.x&&(this.max.x=e.x),e.y<this.min.y?this.min.y=e.y:e.y>this.max.y&&(this.max.y=e.y)}}else{this.makeEmpty()}return this},setFromCenterAndSize:function(){var b=new THREE.Vector2;return function(a,f){var e=b.copy(f).multiplyScalar(0.5);this.min.copy(a).sub(e);this.max.copy(a).add(e);return this}}(),copy:function(b){this.min.copy(b.min);this.max.copy(b.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(b){return(b||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(b){return(b||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(b){this.min.min(b);this.max.max(b);return this},expandByVector:function(b){this.min.sub(b);this.max.add(b);return this},expandByScalar:function(b){this.min.addScalar(-b);this.max.addScalar(b);return this},containsPoint:function(b){return b.x<this.min.x||b.x>this.max.x||b.y<this.min.y||b.y>this.max.y?!1:!0},containsBox:function(b){return this.min.x<=b.min.x&&b.max.x<=this.max.x&&this.min.y<=b.min.y&&b.max.y<=this.max.y?!0:!1},getParameter:function(b){return new THREE.Vector2((b.x-this.min.x)/(this.max.x-this.min.x),(b.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(b){return b.max.x<this.min.x||b.min.x>this.max.x||b.max.y<this.min.y||b.min.y>this.max.y?!1:!0},clampPoint:function(d,c){return(c||new THREE.Vector2).copy(d).clamp(this.min,this.max)},distanceToPoint:function(){var b=new THREE.Vector2;return function(a){return b.copy(a).clamp(this.min,this.max).sub(a).length()}}(),intersect:function(b){this.min.max(b.min);this.max.min(b.max);return this},union:function(b){this.min.min(b.min);this.max.max(b.max);return this},translate:function(b){this.min.add(b);this.max.add(b);return this},equals:function(b){return b.min.equals(this.min)&&b.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(d,c){this.min=void 0!==d?d:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==c?c:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};THREE.Box3.prototype={constructor:THREE.Box3,set:function(d,c){this.min.copy(d);this.max.copy(c);return this},setFromPoints:function(f){if(0<f.length){var e=f[0];this.min.copy(e);this.max.copy(e);for(var h=1,g=f.length;h<g;h++){e=f[h],e.x<this.min.x?this.min.x=e.x:e.x>this.max.x&&(this.max.x=e.x),e.y<this.min.y?this.min.y=e.y:e.y>this.max.y&&(this.max.y=e.y),e.z<this.min.z?this.min.z=e.z:e.z>this.max.z&&(this.max.z=e.z)}}else{this.makeEmpty()}return this},setFromCenterAndSize:function(){var b=new THREE.Vector3;return function(a,f){var e=b.copy(f).multiplyScalar(0.5);this.min.copy(a).sub(e);this.max.copy(a).add(e);return this}}(),setFromObject:function(){var b=new THREE.Vector3;return function(a){var d=this;a.updateMatrixWorld(!0);this.makeEmpty();a.traverse(function(c){if(void 0!==c.geometry&&void 0!==c.geometry.vertices){for(var j=c.geometry.vertices,i=0,g=j.length;i<g;i++){b.copy(j[i]),b.applyMatrix4(c.matrixWorld),d.expandByPoint(b)}}});return this}}(),copy:function(b){this.min.copy(b.min);this.max.copy(b.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(b){return(b||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(b){return(b||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(b){this.min.min(b);this.max.max(b);return this},expandByVector:function(b){this.min.sub(b);this.max.add(b);return this},expandByScalar:function(b){this.min.addScalar(-b);this.max.addScalar(b);return this},containsPoint:function(b){return b.x<this.min.x||b.x>this.max.x||b.y<this.min.y||b.y>this.max.y||b.z<this.min.z||b.z>this.max.z?!1:!0},containsBox:function(b){return this.min.x<=b.min.x&&b.max.x<=this.max.x&&this.min.y<=b.min.y&&b.max.y<=this.max.y&&this.min.z<=b.min.z&&b.max.z<=this.max.z?!0:!1},getParameter:function(b){return new THREE.Vector3((b.x-this.min.x)/(this.max.x-this.min.x),(b.y-this.min.y)/(this.max.y-this.min.y),(b.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(b){return b.max.x<this.min.x||b.min.x>this.max.x||b.max.y<this.min.y||b.min.y>this.max.y||b.max.z<this.min.z||b.min.z>this.max.z?!1:!0},clampPoint:function(d,c){return(c||new THREE.Vector3).copy(d).clamp(this.min,this.max)},distanceToPoint:function(){var b=new THREE.Vector3;return function(a){return b.copy(a).clamp(this.min,this.max).sub(a).length()}}(),getBoundingSphere:function(){var b=new THREE.Vector3;return function(a){a=a||new THREE.Sphere;a.center=this.center();a.radius=0.5*this.size(b).length();return a}}(),intersect:function(b){this.min.max(b.min);this.max.min(b.max);return this},union:function(b){this.min.min(b.min);this.max.max(b.max);return this},applyMatrix4:function(){var b=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(a){b[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a);b[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a);b[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a);b[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a);b[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a);b[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a);b[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a);b[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a);this.makeEmpty();this.setFromPoints(b);return this}}(),translate:function(b){this.min.add(b);this.max.add(b);return this},equals:function(b){return b.min.equals(this.min)&&b.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};THREE.Matrix3=function(r,q,p,o,n,m,k,l,j){this.elements=new Float32Array(9);this.set(void 0!==r?r:1,q||0,p||0,o||0,void 0!==n?n:1,m||0,k||0,l||0,void 0!==j?j:1)};THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(t,s,r,q,p,o,m,n,l){var k=this.elements;k[0]=t;k[3]=s;k[6]=r;k[1]=q;k[4]=p;k[7]=o;k[2]=m;k[5]=n;k[8]=l;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(b){b=b.elements;this.set(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8]);return this},multiplyVector3:function(b){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return b.applyMatrix3(this)},multiplyVector3Array:function(){var b=new THREE.Vector3;return function(a){for(var f=0,e=a.length;f<e;f+=3){b.x=a[f],b.y=a[f+1],b.z=a[f+2],b.applyMatrix3(this),a[f]=b.x,a[f+1]=b.y,a[f+2]=b.z}return a}}(),multiplyScalar:function(d){var c=this.elements;c[0]*=d;c[3]*=d;c[6]*=d;c[1]*=d;c[4]*=d;c[7]*=d;c[2]*=d;c[5]*=d;c[8]*=d;return this},determinant:function(){var r=this.elements,q=r[0],p=r[1],o=r[2],n=r[3],m=r[4],k=r[5],l=r[6],j=r[7],r=r[8];return q*m*r-q*k*j-p*n*r+p*k*l+o*n*j-o*m*l},getInverse:function(f,e){var h=f.elements,g=this.elements;g[0]=h[10]*h[5]-h[6]*h[9];g[1]=-h[10]*h[1]+h[2]*h[9];g[2]=h[6]*h[1]-h[2]*h[5];g[3]=-h[10]*h[4]+h[6]*h[8];g[4]=h[10]*h[0]-h[2]*h[8];g[5]=-h[6]*h[0]+h[2]*h[4];g[6]=h[9]*h[4]-h[5]*h[8];g[7]=-h[9]*h[0]+h[1]*h[8];g[8]=h[5]*h[0]-h[1]*h[4];h=h[0]*g[0]+h[1]*g[3]+h[2]*g[6];if(0===h){if(e){throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0")}console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/h);return this},transpose:function(){var d,c=this.elements;d=c[1];c[1]=c[3];c[3]=d;d=c[2];c[2]=c[6];c[6]=d;d=c[5];c[5]=c[7];c[7]=d;return this},getNormalMatrix:function(b){this.getInverse(b).transpose();return this},transposeIntoArray:function(d){var c=this.elements;d[0]=c[0];d[1]=c[3];d[2]=c[6];d[3]=c[1];d[4]=c[4];d[5]=c[7];d[6]=c[2];d[7]=c[5];d[8]=c[8];return this},clone:function(){var b=this.elements;return new THREE.Matrix3(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8])}};THREE.Matrix4=function(K,J,I,H,G,F,D,E,C,B,A,v,u,s,L,o){var k=this.elements=new Float32Array(16);k[0]=void 0!==K?K:1;k[4]=J||0;k[8]=I||0;k[12]=H||0;k[1]=G||0;k[5]=void 0!==F?F:1;k[9]=D||0;k[13]=E||0;k[2]=C||0;k[6]=B||0;k[10]=void 0!==A?A:1;k[14]=v||0;k[3]=u||0;k[7]=s||0;k[11]=L||0;k[15]=void 0!==o?o:1};THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(K,J,I,H,G,F,D,E,C,B,A,v,u,s,L,o){var k=this.elements;k[0]=K;k[4]=J;k[8]=I;k[12]=H;k[1]=G;k[5]=F;k[9]=D;k[13]=E;k[2]=C;k[6]=B;k[10]=A;k[14]=v;k[3]=u;k[7]=s;k[11]=L;k[15]=o;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(b){this.elements.set(b.elements);return this},extractPosition:function(b){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(b)},copyPosition:function(d){var c=this.elements,d=d.elements;c[12]=d[12];c[13]=d[13];c[14]=d[14];return this},extractRotation:function(){var b=new THREE.Vector3;return function(a){var j=this.elements,a=a.elements,i=1/b.set(a[0],a[1],a[2]).length(),h=1/b.set(a[4],a[5],a[6]).length(),g=1/b.set(a[8],a[9],a[10]).length();j[0]=a[0]*i;j[1]=a[1]*i;j[2]=a[2]*i;j[4]=a[4]*h;j[5]=a[5]*h;j[6]=a[6]*h;j[8]=a[8]*g;j[9]=a[9]*g;j[10]=a[10]*g;return this}}(),makeRotationFromEuler:function(v){void 0===typeof v.order&&console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var u=this.elements,t=v.x,s=v.y,r=v.z,q=Math.cos(t),t=Math.sin(t),o=Math.cos(s),s=Math.sin(s),p=Math.cos(r),r=Math.sin(r);if(void 0===v.order||"XYZ"===v.order){var v=q*p,n=q*r,m=t*p,k=t*r;u[0]=o*p;u[4]=-o*r;u[8]=s;u[1]=n+m*s;u[5]=v-k*s;u[9]=-t*o;u[2]=k-v*s;u[6]=m+n*s;u[10]=q*o}else{"YXZ"===v.order?(v=o*p,n=o*r,m=s*p,k=s*r,u[0]=v+k*t,u[4]=m*t-n,u[8]=q*s,u[1]=q*r,u[5]=q*p,u[9]=-t,u[2]=n*t-m,u[6]=k+v*t,u[10]=q*o):"ZXY"===v.order?(v=o*p,n=o*r,m=s*p,k=s*r,u[0]=v-k*t,u[4]=-q*r,u[8]=m+n*t,u[1]=n+m*t,u[5]=q*p,u[9]=k-v*t,u[2]=-q*s,u[6]=t,u[10]=q*o):"ZYX"===v.order?(v=q*p,n=q*r,m=t*p,k=t*r,u[0]=o*p,u[4]=m*s-n,u[8]=v*s+k,u[1]=o*r,u[5]=k*s+v,u[9]=n*s-m,u[2]=-s,u[6]=t*o,u[10]=q*o):"YZX"===v.order?(v=q*o,n=q*s,m=t*o,k=t*s,u[0]=o*p,u[4]=k-v*r,u[8]=m*r+n,u[1]=r,u[5]=q*p,u[9]=-t*p,u[2]=-s*p,u[6]=n*r+m,u[10]=v-k*r):"XZY"===v.order&&(v=q*o,n=q*s,m=t*o,k=t*s,u[0]=o*p,u[4]=-r,u[8]=s*p,u[1]=v*r+k,u[5]=q*p,u[9]=n*r-m,u[2]=m*r-n,u[6]=t*p,u[10]=k*r+v)}u[3]=0;u[7]=0;u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return this},setRotationFromQuaternion:function(b){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(b)},makeRotationFromQuaternion:function(v){var u=this.elements,t=v.x,s=v.y,r=v.z,q=v.w,o=t+t,p=s+s,n=r+r,v=t*o,m=t*p,t=t*n,k=s*p,s=s*n,r=r*n,o=q*o,p=q*p,q=q*n;u[0]=1-(k+r);u[4]=m-q;u[8]=t+p;u[1]=m+q;u[5]=1-(v+r);u[9]=s-o;u[2]=t-p;u[6]=s+o;u[10]=1-(v+k);u[3]=0;u[7]=0;u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return this},lookAt:function(){var e=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Vector3;return function(g,c,b){var a=this.elements;f.subVectors(g,c).normalize();0===f.length()&&(f.z=1);e.crossVectors(b,f).normalize();0===e.length()&&(f.x+=0.0001,e.crossVectors(b,f).normalize());d.crossVectors(f,e);a[0]=e.x;a[4]=d.x;a[8]=f.x;a[1]=e.y;a[5]=d.y;a[9]=f.y;a[2]=e.z;a[6]=d.z;a[10]=f.z;return this}}(),multiply:function(d,c){return void 0!==c?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(d,c)):this.multiplyMatrices(this,d)},multiplyMatrices:function(at,ar){var aq=at.elements,ap=ar.elements,ao=this.elements,an=aq[0],al=aq[4],am=aq[8],ak=aq[12],aj=aq[1],ai=aq[5],ah=aq[9],ag=aq[13],af=aq[2],X=aq[6],ad=aq[10],ab=aq[14],Y=aq[3],W=aq[7],O=aq[11],aq=aq[15],aa=ap[0],V=ap[4],T=ap[8],R=ap[12],U=ap[1],ae=ap[5],E=ap[9],ac=ap[13],Q=ap[2],o=ap[6],P=ap[10],v=ap[14],S=ap[3],k=ap[7],D=ap[11],ap=ap[15];ao[0]=an*aa+al*U+am*Q+ak*S;ao[4]=an*V+al*ae+am*o+ak*k;ao[8]=an*T+al*E+am*P+ak*D;ao[12]=an*R+al*ac+am*v+ak*ap;ao[1]=aj*aa+ai*U+ah*Q+ag*S;ao[5]=aj*V+ai*ae+ah*o+ag*k;ao[9]=aj*T+ai*E+ah*P+ag*D;ao[13]=aj*R+ai*ac+ah*v+ag*ap;ao[2]=af*aa+X*U+ad*Q+ab*S;ao[6]=af*V+X*ae+ad*o+ab*k;ao[10]=af*T+X*E+ad*P+ab*D;ao[14]=af*R+X*ac+ad*v+ab*ap;ao[3]=Y*aa+W*U+O*Q+aq*S;ao[7]=Y*V+W*ae+O*o+aq*k;ao[11]=Y*T+W*E+O*P+aq*D;ao[15]=Y*R+W*ac+O*v+aq*ap;return this},multiplyToArray:function(f,e,h){var g=this.elements;this.multiplyMatrices(f,e);h[0]=g[0];h[1]=g[1];h[2]=g[2];h[3]=g[3];h[4]=g[4];h[5]=g[5];h[6]=g[6];h[7]=g[7];h[8]=g[8];h[9]=g[9];h[10]=g[10];h[11]=g[11];h[12]=g[12];h[13]=g[13];h[14]=g[14];h[15]=g[15];return this},multiplyScalar:function(d){var c=this.elements;c[0]*=d;c[4]*=d;c[8]*=d;c[12]*=d;c[1]*=d;c[5]*=d;c[9]*=d;c[13]*=d;c[2]*=d;c[6]*=d;c[10]*=d;c[14]*=d;c[3]*=d;c[7]*=d;c[11]*=d;c[15]*=d;return this},multiplyVector3:function(b){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return b.applyProjection(this)},multiplyVector4:function(b){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return b.applyMatrix4(this)},multiplyVector3Array:function(){var b=new THREE.Vector3;return function(a){for(var f=0,e=a.length;f<e;f+=3){b.x=a[f],b.y=a[f+1],b.z=a[f+2],b.applyProjection(this),a[f]=b.x,a[f+1]=b.y,a[f+2]=b.z}return a}}(),rotateAxis:function(b){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");b.transformDirection(this)},crossVector:function(b){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return b.applyMatrix4(this)},determinant:function(){var D=this.elements,C=D[0],B=D[4],A=D[8],v=D[12],u=D[1],s=D[5],t=D[9],r=D[13],q=D[2],p=D[6],o=D[10],k=D[14];return D[3]*(+v*t*p-A*r*p-v*s*o+B*r*o+A*s*k-B*t*k)+D[7]*(+C*t*k-C*r*o+v*u*o-A*u*k+A*r*q-v*t*q)+D[11]*(+C*r*p-C*s*k-v*u*p+B*u*k+v*s*q-B*r*q)+D[15]*(-A*s*q-C*t*p+C*s*o+A*u*p-B*u*o+B*t*q)},transpose:function(){var d=this.elements,c;c=d[1];d[1]=d[4];d[4]=c;c=d[2];d[2]=d[8];d[8]=c;c=d[6];d[6]=d[9];d[9]=c;c=d[3];d[3]=d[12];d[12]=c;c=d[7];d[7]=d[13];d[13]=c;c=d[11];d[11]=d[14];d[14]=c;return this},flattenToArray:function(d){var c=this.elements;d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];d[4]=c[4];d[5]=c[5];d[6]=c[6];d[7]=c[7];d[8]=c[8];d[9]=c[9];d[10]=c[10];d[11]=c[11];d[12]=c[12];d[13]=c[13];d[14]=c[14];d[15]=c[15];return d},flattenToArrayOffset:function(e,d){var f=this.elements;e[d]=f[0];e[d+1]=f[1];e[d+2]=f[2];e[d+3]=f[3];e[d+4]=f[4];e[d+5]=f[5];e[d+6]=f[6];e[d+7]=f[7];e[d+8]=f[8];e[d+9]=f[9];e[d+10]=f[10];e[d+11]=f[11];e[d+12]=f[12];e[d+13]=f[13];e[d+14]=f[14];e[d+15]=f[15];return e},getPosition:function(){var b=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var a=this.elements;return b.set(a[12],a[13],a[14])}}(),setPosition:function(d){var c=this.elements;c[12]=d.x;c[13]=d.y;c[14]=d.z;return this},getInverse:function(Q,P){var O=this.elements,N=Q.elements,L=N[0],K=N[4],I=N[8],J=N[12],H=N[1],G=N[5],F=N[9],E=N[13],D=N[2],C=N[6],o=N[10],B=N[14],A=N[3],v=N[7],k=N[11],N=N[15];O[0]=F*B*v-E*o*v+E*C*k-G*B*k-F*C*N+G*o*N;O[4]=J*o*v-I*B*v-J*C*k+K*B*k+I*C*N-K*o*N;O[8]=I*E*v-J*F*v+J*G*k-K*E*k-I*G*N+K*F*N;O[12]=J*F*C-I*E*C-J*G*o+K*E*o+I*G*B-K*F*B;O[1]=E*o*A-F*B*A-E*D*k+H*B*k+F*D*N-H*o*N;O[5]=I*B*A-J*o*A+J*D*k-L*B*k-I*D*N+L*o*N;O[9]=J*F*A-I*E*A-J*H*k+L*E*k+I*H*N-L*F*N;O[13]=I*E*D-J*F*D+J*H*o-L*E*o-I*H*B+L*F*B;O[2]=G*B*A-E*C*A+E*D*v-H*B*v-G*D*N+H*C*N;O[6]=J*C*A-K*B*A-J*D*v+L*B*v+K*D*N-L*C*N;O[10]=K*E*A-J*G*A+J*H*v-L*E*v-K*H*N+L*G*N;O[14]=J*G*D-K*E*D-J*H*C+L*E*C+K*H*B-L*G*B;O[3]=F*C*A-G*o*A-F*D*v+H*o*v+G*D*k-H*C*k;O[7]=K*o*A-I*C*A+I*D*v-L*o*v-K*D*k+L*C*k;O[11]=I*G*A-K*F*A-I*H*v+L*F*v+K*H*k-L*G*k;O[15]=K*F*D-I*G*D+I*H*C-L*F*C-K*H*o+L*G*o;O=L*O[0]+H*O[4]+D*O[8]+A*O[12];if(0==O){if(P){throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0")}console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/O);return this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(f){var e=this.elements,h=f.x,g=f.y,f=f.z;e[0]*=h;e[4]*=g;e[8]*=f;e[1]*=h;e[5]*=g;e[9]*=f;e[2]*=h;e[6]*=g;e[10]*=f;e[3]*=h;e[7]*=g;e[11]*=f;return this},getMaxScaleOnAxis:function(){var b=this.elements;return Math.sqrt(Math.max(b[0]*b[0]+b[1]*b[1]+b[2]*b[2],Math.max(b[4]*b[4]+b[5]*b[5]+b[6]*b[6],b[8]*b[8]+b[9]*b[9]+b[10]*b[10])))},makeTranslation:function(e,d,f){this.set(1,0,0,e,0,1,0,d,0,0,1,f,0,0,0,1);return this},makeRotationX:function(d){var c=Math.cos(d),d=Math.sin(d);this.set(1,0,0,0,0,c,-d,0,0,d,c,0,0,0,0,1);return this},makeRotationY:function(d){var c=Math.cos(d),d=Math.sin(d);this.set(c,0,d,0,0,1,0,0,-d,0,c,0,0,0,0,1);return this},makeRotationZ:function(d){var c=Math.cos(d),d=Math.sin(d);this.set(c,-d,0,0,d,c,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(t,s){var r=Math.cos(s),q=Math.sin(s),p=1-r,o=t.x,m=t.y,n=t.z,l=p*o,k=p*m;this.set(l*o+r,l*m-q*n,l*n+q*m,0,l*m+q*n,k*m+r,k*n-q*o,0,l*n-q*m,k*n+q*o,p*n*n+r,0,0,0,0,1);return this},makeScale:function(e,d,f){this.set(e,0,0,0,0,d,0,0,0,0,f,0,0,0,0,1);return this},compose:function(e,d,f){this.makeRotationFromQuaternion(d);this.scale(f);this.setPosition(e);return this},decompose:function(){var d=new THREE.Vector3,c=new THREE.Matrix4;return function(p,o,n){var m=this.elements,k=d.set(m[0],m[1],m[2]).length(),l=d.set(m[4],m[5],m[6]).length(),b=d.set(m[8],m[9],m[10]).length();p.x=m[12];p.y=m[13];p.z=m[14];c.elements.set(this.elements);var p=1/k,m=1/l,a=1/b;c.elements[0]*=p;c.elements[1]*=p;c.elements[2]*=p;c.elements[4]*=m;c.elements[5]*=m;c.elements[6]*=m;c.elements[8]*=a;c.elements[9]*=a;c.elements[10]*=a;o.setFromRotationMatrix(c);n.x=k;n.y=l;n.z=b;return this}}(),makeFrustum:function(i,g,n,m,l,k){var j=this.elements;j[0]=2*l/(g-i);j[4]=0;j[8]=(g+i)/(g-i);j[12]=0;j[1]=0;j[5]=2*l/(m-n);j[9]=(m+n)/(m-n);j[13]=0;j[2]=0;j[6]=0;j[10]=-(k+l)/(k-l);j[14]=-2*k*l/(k-l);j[3]=0;j[7]=0;j[11]=-1;j[15]=0;return this},makePerspective:function(g,f,j,i){var g=j*Math.tan(THREE.Math.degToRad(0.5*g)),h=-g;return this.makeFrustum(h*f,g*f,h,g,j,i)},makeOrthographic:function(t,s,r,q,p,o){var m=this.elements,n=s-t,l=r-q,k=o-p;m[0]=2/n;m[4]=0;m[8]=0;m[12]=-((s+t)/n);m[1]=0;m[5]=2/l;m[9]=0;m[13]=-((r+q)/l);m[2]=0;m[6]=0;m[10]=-2/k;m[14]=-((o+p)/k);m[3]=0;m[7]=0;m[11]=0;m[15]=1;return this},fromArray:function(b){this.elements.set(b);return this},toArray:function(){var b=this.elements;return[b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10],b[11],b[12],b[13],b[14],b[15]]},clone:function(){var b=this.elements;return new THREE.Matrix4(b[0],b[4],b[8],b[12],b[1],b[5],b[9],b[13],b[2],b[6],b[10],b[14],b[3],b[7],b[11],b[15])}};THREE.Ray=function(d,c){this.origin=void 0!==d?d:new THREE.Vector3;this.direction=void 0!==c?c:new THREE.Vector3};THREE.Ray.prototype={constructor:THREE.Ray,set:function(d,c){this.origin.copy(d);this.direction.copy(c);return this},copy:function(b){this.origin.copy(b.origin);this.direction.copy(b.direction);return this},at:function(d,c){return(c||new THREE.Vector3).copy(this.direction).multiplyScalar(d).add(this.origin)},recast:function(){var b=new THREE.Vector3;return function(a){this.origin.copy(this.at(a,b));return this}}(),closestPointToPoint:function(f,e){var h=e||new THREE.Vector3;h.subVectors(f,this.origin);var g=h.dot(this.direction);return 0>g?h.copy(this.origin):h.copy(this.direction).multiplyScalar(g).add(this.origin)},distanceToPoint:function(){var b=new THREE.Vector3;return function(a){var d=b.subVectors(a,this.origin).dot(this.direction);if(0>d){return this.origin.distanceTo(a)}b.copy(this.direction).multiplyScalar(d).add(this.origin);return b.distanceTo(a)}}(),distanceSqToSegment:function(D,C,B,A){var v=D.clone().add(C).multiplyScalar(0.5),u=C.clone().sub(D).normalize(),s=0.5*D.distanceTo(C),t=this.origin.clone().sub(v),D=-this.direction.dot(u),C=t.dot(this.direction),r=-t.dot(u),q=t.lengthSq(),p=Math.abs(1-D*D),o,k;0<=p?(t=D*r-C,o=D*C-r,k=s*p,0<=t?o>=-k?o<=k?(s=1/p,t*=s,o*=s,D=t*(t+D*o+2*C)+o*(D*t+o+2*r)+q):(o=s,t=Math.max(0,-(D*o+C)),D=-t*t+o*(o+2*r)+q):(o=-s,t=Math.max(0,-(D*o+C)),D=-t*t+o*(o+2*r)+q):o<=-k?(t=Math.max(0,-(-D*s+C)),o=0<t?-s:Math.min(Math.max(-s,-r),s),D=-t*t+o*(o+2*r)+q):o<=k?(t=0,o=Math.min(Math.max(-s,-r),s),D=o*(o+2*r)+q):(t=Math.max(0,-(D*s+C)),o=0<t?s:Math.min(Math.max(-s,-r),s),D=-t*t+o*(o+2*r)+q)):(o=0<D?-s:s,t=Math.max(0,-(D*o+C)),D=-t*t+o*(o+2*r)+q);B&&B.copy(this.direction.clone().multiplyScalar(t).add(this.origin));A&&A.copy(u.clone().multiplyScalar(o).add(v));return D},isIntersectionSphere:function(b){return this.distanceToPoint(b.center)<=b.radius},isIntersectionPlane:function(d){var c=d.distanceToPoint(this.origin);return 0===c||0>d.normal.dot(this.direction)*c?!0:!1},distanceToPlane:function(d){var c=d.normal.dot(this.direction);if(0==c){return 0==d.distanceToPoint(this.origin)?0:null}d=-(this.origin.dot(d.normal)+d.constant)/c;return 0<=d?d:null},intersectPlane:function(e,d){var f=this.distanceToPlane(e);return null===f?null:this.at(f,d)},applyMatrix4:function(b){this.direction.add(this.origin).applyMatrix4(b);this.origin.applyMatrix4(b);this.direction.sub(this.origin);return this},equals:function(b){return b.origin.equals(this.origin)&&b.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}};THREE.Sphere=function(d,c){this.center=void 0!==d?d:new THREE.Vector3;this.radius=void 0!==c?c:0};THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(d,c){this.center.copy(d);this.radius=c;return this},setFromPoints:function(g){for(var f,j=0,i=0,h=g.length;i<h;i++){f=g[i].lengthSq(),j=Math.max(j,f)}this.center.set(0,0,0);this.radius=Math.sqrt(j);return this},copy:function(b){this.center.copy(b.center);this.radius=b.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(b){return b.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(b){return b.distanceTo(this.center)-this.radius},intersectsSphere:function(d){var c=this.radius+d.radius;return d.center.distanceToSquared(this.center)<=c*c},clampPoint:function(f,e){var h=this.center.distanceToSquared(f),g=e||new THREE.Vector3;g.copy(f);h>this.radius*this.radius&&(g.sub(this.center).normalize(),g.multiplyScalar(this.radius).add(this.center));return g},getBoundingBox:function(b){b=b||new THREE.Box3;b.set(this.center,this.center);b.expandByScalar(this.radius);return b},applyMatrix4:function(b){this.center.applyMatrix4(b);this.radius*=b.getMaxScaleOnAxis();return this},translate:function(b){this.center.add(b);return this},equals:function(b){return b.center.equals(this.center)&&b.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};THREE.Frustum=function(h,g,l,k,j,i){this.planes=[void 0!==h?h:new THREE.Plane,void 0!==g?g:new THREE.Plane,void 0!==l?l:new THREE.Plane,void 0!==k?k:new THREE.Plane,void 0!==j?j:new THREE.Plane,void 0!==i?i:new THREE.Plane]};THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(i,g,n,m,l,k){var j=this.planes;j[0].copy(i);j[1].copy(g);j[2].copy(n);j[3].copy(m);j[4].copy(l);j[5].copy(k);return this},copy:function(e){for(var d=this.planes,f=0;6>f;f++){d[f].copy(e.planes[f])}return this},setFromMatrix:function(K){var J=this.planes,I=K.elements,K=I[0],H=I[1],G=I[2],F=I[3],D=I[4],E=I[5],C=I[6],B=I[7],A=I[8],v=I[9],u=I[10],s=I[11],L=I[12],o=I[13],k=I[14],I=I[15];J[0].setComponents(F-K,B-D,s-A,I-L).normalize();J[1].setComponents(F+K,B+D,s+A,I+L).normalize();J[2].setComponents(F+H,B+E,s+v,I+o).normalize();J[3].setComponents(F-H,B-E,s-v,I-o).normalize();J[4].setComponents(F-G,B-C,s-u,I-k).normalize();J[5].setComponents(F+G,B+C,s+u,I+k).normalize();return this},intersectsObject:function(){var b=new THREE.Vector3;return function(a){var f=a.geometry,a=a.matrixWorld;null===f.boundingSphere&&f.computeBoundingSphere();f=-f.boundingSphere.radius*a.getMaxScaleOnAxis();b.getPositionFromMatrix(a);for(var a=this.planes,e=0;6>e;e++){if(a[e].distanceToPoint(b)<f){return !1}}return !0}}(),intersectsSphere:function(f){for(var e=this.planes,h=f.center,f=-f.radius,g=0;6>g;g++){if(e[g].distanceToPoint(h)<f){return !1}}return !0},intersectsBox:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(j){for(var i=this.planes,g=0;6>g;g++){var b=i[g];d.x=0<b.normal.x?j.min.x:j.max.x;c.x=0<b.normal.x?j.max.x:j.min.x;d.y=0<b.normal.y?j.min.y:j.max.y;c.y=0<b.normal.y?j.max.y:j.min.y;d.z=0<b.normal.z?j.min.z:j.max.z;c.z=0<b.normal.z?j.max.z:j.min.z;var a=b.distanceToPoint(d),b=b.distanceToPoint(c);if(0>a&&0>b){return !1}}return !0}}(),containsPoint:function(e){for(var d=this.planes,f=0;6>f;f++){if(0>d[f].distanceToPoint(e)){return !1}}return !0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Plane=function(d,c){this.normal=void 0!==d?d:new THREE.Vector3(1,0,0);this.constant=void 0!==c?c:0};THREE.Plane.prototype={constructor:THREE.Plane,set:function(d,c){this.normal.copy(d);this.constant=c;return this},setComponents:function(f,e,h,g){this.normal.set(f,e,h);this.constant=g;return this},setFromNormalAndCoplanarPoint:function(d,c){this.normal.copy(d);this.constant=-c.dot(this.normal);return this},setFromCoplanarPoints:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(f,b,a){b=d.subVectors(a,b).cross(c.subVectors(f,b)).normalize();this.setFromNormalAndCoplanarPoint(b,f);return this}}(),copy:function(b){this.normal.copy(b.normal);this.constant=b.constant;return this},normalize:function(){var b=1/this.normal.length();this.normal.multiplyScalar(b);this.constant*=b;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(b){return this.normal.dot(b)+this.constant},distanceToSphere:function(b){return this.distanceToPoint(b.center)-b.radius},projectPoint:function(d,c){return this.orthoPoint(d,c).sub(d).negate()},orthoPoint:function(e,d){var f=this.distanceToPoint(e);return(d||new THREE.Vector3).copy(this.normal).multiplyScalar(f)},isIntersectionLine:function(d){var c=this.distanceToPoint(d.start),d=this.distanceToPoint(d.end);return 0>c&&0<d||0>d&&0<c},intersectLine:function(){var b=new THREE.Vector3;return function(a,j){var i=j||new THREE.Vector3,h=a.delta(b),g=this.normal.dot(h);if(0==g){if(0==this.distanceToPoint(a.start)){return i.copy(a.start)}}else{return g=-(a.start.dot(this.normal)+this.constant)/g,0>g||1<g?void 0:i.copy(h).multiplyScalar(g).add(a.start)}}}(),coplanarPoint:function(b){return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(h,g){var g=g||(new THREE.Matrix3).getNormalMatrix(h),b=d.copy(this.normal).applyMatrix3(g),a=this.coplanarPoint(c);a.applyMatrix4(h);this.setFromNormalAndCoplanarPoint(b,a);return this}}(),translate:function(b){this.constant-=b.dot(this.normal);return this},equals:function(b){return b.normal.equals(this.normal)&&b.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};THREE.Math={PI2:2*Math.PI,generateUUID:function(){var f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e=Array(36),h=0,g;return function(){for(var a=0;36>a;a++){8==a||13==a||18==a||23==a?e[a]="-":14==a?e[a]="4":(2>=h&&(h=33554432+16777216*Math.random()|0),g=h&15,h>>=4,e[a]=f[19==a?g&3|8:g])}return e.join("")}}(),clamp:function(e,d,f){return e<d?d:e>f?f:e},clampBottom:function(d,c){return d<c?c:d},mapLinear:function(g,f,j,i,h){return i+(g-f)*(h-i)/(j-f)},smoothstep:function(e,d,f){if(e<=d){return 0}if(e>=f){return 1}e=(e-d)/(f-d);return e*e*(3-2*e)},smootherstep:function(e,d,f){if(e<=d){return 0}if(e>=f){return 1}e=(e-d)/(f-d);return e*e*e*(e*(6*e-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(d,c){return d+Math.floor(Math.random()*(c-d+1))},randFloat:function(d,c){return d+Math.random()*(c-d)},randFloatSpread:function(b){return b*(0.5-Math.random())},sign:function(b){return 0>b?-1:0<b?1:0},degToRad:function(){var b=Math.PI/180;return function(a){return a*b}}(),radToDeg:function(){var b=180/Math.PI;return function(a){return a*b}}()};THREE.Spline=function(D){function C(i,g,E,n,m,l,j){i=0.5*(E-i);n=0.5*(n-g);return(2*(g-E)+i+n)*j+(-3*(g-E)-2*i-n)*l+i*m+g}this.points=D;var B=[],A={x:0,y:0,z:0},v,u,s,t,r,q,p,o,k;this.initFromArray=function(d){this.points=[];for(var c=0;c<d.length;c++){this.points[c]={x:d[c][0],y:d[c][1],z:d[c][2]}}};this.getPoint=function(b){v=(this.points.length-1)*b;u=Math.floor(v);s=v-u;B[0]=0===u?u:u-1;B[1]=u;B[2]=u>this.points.length-2?this.points.length-1:u+1;B[3]=u>this.points.length-3?this.points.length-1:u+2;q=this.points[B[0]];p=this.points[B[1]];o=this.points[B[2]];k=this.points[B[3]];t=s*s;r=s*t;A.x=C(q.x,p.x,o.x,k.x,s,t,r);A.y=C(q.y,p.y,o.y,k.y,s,t,r);A.z=C(q.z,p.z,o.z,k.z,s,t,r);return A};this.getControlPointsArray=function(){var f,e,h=this.points.length,g=[];for(f=0;f<h;f++){e=this.points[f],g[f]=[e.x,e.y,e.z]}return g};this.getLength=function(I){var H,G,F,E=H=H=0,n=new THREE.Vector3,l=new THREE.Vector3,m=[],j=0;m[0]=0;I||(I=100);G=this.points.length*I;n.copy(this.points[0]);for(I=1;I<G;I++){H=I/G,F=this.getPoint(H),l.copy(F),j+=l.distanceTo(n),n.copy(F),H*=this.points.length-1,H=Math.floor(H),H!=E&&(m[H]=j,E=H)}m[m.length]=j;return{chunks:m,total:j}};this.reparametrizeByArcLength=function(K){var J,I,H,G,F,n,E=[],m=new THREE.Vector3,l=this.getLength();E.push(m.copy(this.points[0]).clone());for(J=1;J<this.points.length;J++){I=l.chunks[J]-l.chunks[J-1];n=Math.ceil(K*I/l.total);G=(J-1)/(this.points.length-1);F=J/(this.points.length-1);for(I=1;I<n-1;I++){H=G+I*(1/n)*(F-G),H=this.getPoint(H),E.push(m.copy(H).clone())}E.push(m.copy(this.points[J]).clone())}this.points=E}};THREE.Triangle=function(e,d,f){this.a=void 0!==e?e:new THREE.Vector3;this.b=void 0!==d?d:new THREE.Vector3;this.c=void 0!==f?f:new THREE.Vector3};THREE.Triangle.normal=function(){var b=new THREE.Vector3;return function(a,h,g,f){f=f||new THREE.Vector3;f.subVectors(g,h);b.subVectors(a,h);f.cross(b);a=f.lengthSq();return 0<a?f.multiplyScalar(1/Math.sqrt(a)):f.set(0,0,0)}}();THREE.Triangle.barycoordFromPoint=function(){var e=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Vector3;return function(n,m,l,c,k){e.subVectors(c,m);d.subVectors(l,m);f.subVectors(n,m);var n=e.dot(e),m=e.dot(d),l=e.dot(f),b=d.dot(d),c=d.dot(f),a=n*b-m*m,k=k||new THREE.Vector3;if(0==a){return k.set(-2,-1,-1)}a=1/a;b=(b*l-m*c)*a;n=(n*c-m*l)*a;return k.set(1-b-n,n,b)}}();THREE.Triangle.containsPoint=function(){var b=new THREE.Vector3;return function(a,h,g,f){a=THREE.Triangle.barycoordFromPoint(a,h,g,f,b);return 0<=a.x&&0<=a.y&&1>=a.x+a.y}}();THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(e,d,f){this.a.copy(e);this.b.copy(d);this.c.copy(f);return this},setFromPointsAndIndices:function(f,e,h,g){this.a.copy(f[e]);this.b.copy(f[h]);this.c.copy(f[g]);return this},copy:function(b){this.a.copy(b.a);this.b.copy(b.b);this.c.copy(b.c);return this},area:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(){d.subVectors(this.c,this.b);c.subVectors(this.a,this.b);return 0.5*d.cross(c).length()}}(),midpoint:function(b){return(b||new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(b){return THREE.Triangle.normal(this.a,this.b,this.c,b)},plane:function(b){return(b||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(d,c){return THREE.Triangle.barycoordFromPoint(d,this.a,this.b,this.c,c)},containsPoint:function(b){return THREE.Triangle.containsPoint(b,this.a,this.b,this.c)},equals:function(b){return b.a.equals(this.a)&&b.b.equals(this.b)&&b.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Vertex=function(b){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return b};THREE.UV=function(d,c){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(d,c)};THREE.Clock=function(b){this.autoStart=void 0!==b?b:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var d=0;this.autoStart&&!this.running&&this.start();if(this.running){var c=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),d=0.001*(c-this.oldTime);this.oldTime=c;this.elapsedTime+=d}return d}};THREE.EventDispatcher=function(){};THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(b){b.addEventListener=THREE.EventDispatcher.prototype.addEventListener;b.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;b.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;b.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,d){void 0===this._listeners&&(this._listeners={});var f=this._listeners;void 0===f[e]&&(f[e]=[]);-1===f[e].indexOf(d)&&f[e].push(d)},hasEventListener:function(e,d){if(void 0===this._listeners){return !1}var f=this._listeners;return void 0!==f[e]&&-1!==f[e].indexOf(d)?!0:!1},removeEventListener:function(f,e){if(void 0!==this._listeners){var h=this._listeners,g=h[f].indexOf(e);-1!==g&&h[f].splice(g,1)}},dispatchEvent:function(f){if(void 0!==this._listeners){var e=this._listeners[f.type];if(void 0!==e){f.target=this;for(var h=0,g=e.length;h<g;h++){e[h].call(this,f)}}}}};(function(t){t.Raycaster=function(a,h,g,f){this.ray=new t.Ray(a,h);0<this.ray.direction.lengthSq()&&this.ray.direction.normalize();this.near=g||0;this.far=f||Infinity};var s=new t.Sphere,r=new t.Ray,q=new t.Plane,p=new t.Vector3,o=new t.Vector3,m=new t.Matrix4,n=function(d,c){return d.distance-c.distance},l=function(R,Q,P){if(R instanceof t.Particle){o.getPositionFromMatrix(R.matrixWorld);var O=Q.ray.distanceToPoint(o);if(O>R.scale.x){return P}P.push({distance:O,point:R.position,face:null,object:R})}else{if(R instanceof t.LOD){o.getPositionFromMatrix(R.matrixWorld),O=Q.ray.origin.distanceTo(o),l(R.getObjectForDistance(O),Q,P)}else{if(R instanceof t.Mesh){O=R.geometry;o.getPositionFromMatrix(R.matrixWorld);null===O.boundingSphere&&O.computeBoundingSphere();s.set(o,O.boundingSphere.radius*R.matrixWorld.getMaxScaleOnAxis());if(!1===Q.ray.isIntersectionSphere(s)){return P}var i=O.vertices;if(O instanceof t.BufferGeometry){var L=R.material;if(void 0===L||!1===O.dynamic){return P}var E=R.material instanceof t.MeshFaceMaterial,v=!0===E?R.material.materials:null,h=R.material.side,b,D,f=Q.precision;m.getInverse(R.matrixWorld);r.copy(Q.ray).applyMatrix4(m);var d,i=!1;O.attributes.index&&(i=!0);v=new t.Vector3;d=new t.Vector3;var c=new t.Vector3;new t.Vector3;new t.Vector3;for(var e=0;e<O.offsets.length;++e){for(var N=O.offsets[e].start,a=O.offsets[e].index,E=N,J=N+O.offsets[e].count;E<J;E+=3){if(i?(h=a+O.attributes.index.array[E],b=a+O.attributes.index.array[E+1],D=a+O.attributes.index.array[E+2]):(h=a,b=a+1,D=a+2),v.set(O.attributes.position.array[3*h],O.attributes.position.array[3*h+1],O.attributes.position.array[3*h+2]),d.set(O.attributes.position.array[3*b],O.attributes.position.array[3*b+1],O.attributes.position.array[3*b+2]),c.set(O.attributes.position.array[3*D],O.attributes.position.array[3*D+1],O.attributes.position.array[3*D+2]),q.setFromCoplanarPoints(v,d,c),N=r.distanceToPlane(q),!(N<f)&&null!==N){h=L.side;if(h!==t.DoubleSide&&(b=r.direction.dot(q.normal),!(h===t.FrontSide?0>b:0<b))){continue}N<Q.near||N>Q.far||(p=r.at(N,p),!1!==t.Triangle.containsPoint(p,v,d,c)&&P.push({distance:N,point:Q.ray.at(N),face:null,faceIndex:null,object:R}))}}}}else{if(O instanceof t.Geometry){E=R.material instanceof t.MeshFaceMaterial;v=!0===E?R.material.materials:null;f=Q.precision;m.getInverse(R.matrixWorld);r.copy(Q.ray).applyMatrix4(m);c=0;for(d=O.faces.length;c<d;c++){if(e=O.faces[c],L=!0===E?v[e.materialIndex]:R.material,void 0!==L&&(q.setFromNormalAndCoplanarPoint(e.normal,i[e.a]),N=r.distanceToPlane(q),!(N<f)&&null!==N)){h=L.side;if(h!==t.DoubleSide&&(b=r.direction.dot(q.normal),!(h===t.FrontSide?0>b:0<b))){continue}if(!(N<Q.near||N>Q.far)){p=r.at(N,p);if(e instanceof t.Face3){if(h=i[e.a],b=i[e.b],D=i[e.c],!1===t.Triangle.containsPoint(p,h,b,D)){continue}}else{if(e instanceof t.Face4){if(h=i[e.a],b=i[e.b],D=i[e.c],L=i[e.d],!1===t.Triangle.containsPoint(p,h,b,L)&&!1===t.Triangle.containsPoint(p,b,D,L)){continue}}else{throw Error("face type not supported")}}P.push({distance:N,point:Q.ray.at(N),face:e,faceIndex:c,object:R})}}}}}}else{if(R instanceof t.Line){f=Q.linePrecision;f*=f;O=R.geometry;null===O.boundingSphere&&O.computeBoundingSphere();o.getPositionFromMatrix(R.matrixWorld);s.set(o,O.boundingSphere.radius*R.matrixWorld.getMaxScaleOnAxis());if(!1===Q.ray.isIntersectionSphere(s)){return P}m.getInverse(R.matrixWorld);r.copy(Q.ray).applyMatrix4(m);r.direction.normalize();i=O.vertices;L=i.length;N=new t.Vector3;h=new t.Vector3;b=R.type===t.LineStrip?1:2;for(E=0;E<L-1;E+=b){r.distanceSqToSegment(i[E],i[E+1],h,N)<=f&&(O=r.origin.distanceTo(h),Q.near<=O&&O<=Q.far&&P.push({distance:O,point:N.clone().applyMatrix4(R.matrixWorld),face:null,faceIndex:null,object:R}))}}}}}},k=function(g,f,j){for(var g=g.getDescendants(),i=0,h=g.length;i<h;i++){l(g[i],f,j)}};t.Raycaster.prototype.precision=0.0001;t.Raycaster.prototype.linePrecision=1;t.Raycaster.prototype.set=function(d,c){this.ray.set(d,c);0<this.ray.direction.length()&&this.ray.direction.normalize()};t.Raycaster.prototype.intersectObject=function(e,d){var f=[];!0===d&&k(e,this,f);l(e,this,f);f.sort(n);return f};t.Raycaster.prototype.intersectObjects=function(g,f){for(var j=[],i=0,h=g.length;i<h;i++){l(g[i],this,j),!0===f&&k(g[i],this,j)}j.sort(n);return j}})(THREE);THREE.Object3D=function(){this.id=THREE.Object3DIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Euler;this.quaternion=new THREE.Quaternion;this.scale=new THREE.Vector3(1,1,1);this.rotation._quaternion=this.quaternion;this.quaternion._euler=this.rotation;this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.visible=this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.userData={};this.renderBitmask=0};THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrder(){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");return this.rotation.order},set eulerOrder(b){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");this.rotation.order=b},get useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(b){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(){var b=new THREE.Matrix4;return function(a){this.matrix.multiplyMatrices(a,this.matrix);this.position.getPositionFromMatrix(this.matrix);this.scale.getScaleFromMatrix(this.matrix);b.extractRotation(this.matrix);this.quaternion.setFromRotationMatrix(b)}}(),setRotationFromAxisAngle:function(d,c){this.quaternion.setFromAxisAngle(d,c)},setRotationFromEuler:function(b){this.quaternion.setFromEuler(b,!0)},setRotationFromMatrix:function(b){this.quaternion.setFromRotationMatrix(b)},setRotationFromQuaternion:function(b){this.quaternion.copy(b)},rotateOnAxis:function(){var b=new THREE.Quaternion;return function(a,d){b.setFromAxisAngle(a,d);this.quaternion.multiply(b);return this}}(),rotateX:function(){var b=new THREE.Vector3(1,0,0);return function(a){return this.rotateOnAxis(b,a)}}(),rotateY:function(){var b=new THREE.Vector3(0,1,0);return function(a){return this.rotateOnAxis(b,a)}}(),rotateZ:function(){var b=new THREE.Vector3(0,0,1);return function(a){return this.rotateOnAxis(b,a)}}(),translateOnAxis:function(){var b=new THREE.Vector3;return function(a,d){b.copy(a);b.applyQuaternion(this.quaternion);this.position.add(b.multiplyScalar(d));return this}}(),translate:function(d,c){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");return this.translateOnAxis(c,d)},translateX:function(){var b=new THREE.Vector3(1,0,0);return function(a){return this.translateOnAxis(b,a)}}(),translateY:function(){var b=new THREE.Vector3(0,1,0);return function(a){return this.translateOnAxis(b,a)}}(),translateZ:function(){var b=new THREE.Vector3(0,0,1);return function(a){return this.translateOnAxis(b,a)}}(),localToWorld:function(b){return b.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var b=new THREE.Matrix4;return function(a){return a.applyMatrix4(b.getInverse(this.matrixWorld))}}(),lookAt:function(){var b=new THREE.Matrix4;return function(a){b.lookAt(a,this.position,this.up);this.quaternion.setFromRotationMatrix(b)}}(),add:function(d){if(d===this){console.warn("THREE.Object3D.add: An object can't be added as a child of itself.")}else{if(d instanceof THREE.Object3D){void 0!==d.parent&&d.parent.remove(d);d.parent=this;d.dispatchEvent({type:"added"});this.children.push(d);for(var c=this;void 0!==c.parent;){c=c.parent}void 0!==c&&c instanceof THREE.Scene&&c.__addObject(d)}}},remove:function(d){var c=this.children.indexOf(d);if(-1!==c){d.parent=void 0;d.dispatchEvent({type:"removed"});this.children.splice(c,1);for(c=this;void 0!==c.parent;){c=c.parent}void 0!==c&&c instanceof THREE.Scene&&c.__removeObject(d)}},traverse:function(e){e(this);for(var d=0,f=this.children.length;d<f;d++){this.children[d].traverse(e)}},getObjectById:function(g,f){for(var j=0,i=this.children.length;j<i;j++){var h=this.children[j];if(h.id===g||!0===f&&(h=h.getObjectById(g,f),void 0!==h)){return h}}},getObjectByName:function(g,f){for(var j=0,i=this.children.length;j<i;j++){var h=this.children[j];if(h.name===g||!0===f&&(h=h.getObjectByName(g,f),void 0!==h)){return h}}},getChildByName:function(d,c){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(d,c)},getDescendants:function(e){void 0===e&&(e=[]);Array.prototype.push.apply(e,this.children);for(var d=0,f=this.children.length;d<f;d++){this.children[d].getDescendants(e)}return e},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===e){void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0}for(var d=0,f=this.children.length;d<f;d++){this.children[d].updateMatrixWorld(e)}},clone:function(e,d){void 0===e&&(e=new THREE.Object3D);void 0===d&&(d=!0);e.name=this.name;e.up.copy(this.up);e.position.copy(this.position);e.quaternion.copy(this.quaternion);e.scale.copy(this.scale);e.renderDepth=this.renderDepth;e.rotationAutoUpdate=this.rotationAutoUpdate;e.matrix.copy(this.matrix);e.matrixWorld.copy(this.matrixWorld);e.matrixAutoUpdate=this.matrixAutoUpdate;e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;e.visible=this.visible;e.castShadow=this.castShadow;e.receiveShadow=this.receiveShadow;e.frustumCulled=this.frustumCulled;e.userData=JSON.parse(JSON.stringify(this.userData));if(!0===d){for(var f=0;f<this.children.length;f++){e.add(this.children[f].clone())}}return e}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;THREE.Projector=function(){function aG(){if(ay===av){var b=new THREE.RenderableVertex;ax.push(b);av++;ay++;return b}return ax[ay++]}function aF(d,c){return d.z!==c.z?c.z-d.z:d.id!==c.id?d.id-c.id:0}function aE(j,i){var r=0,q=1,p=j.z+j.w,n=i.z+i.w,l=-j.z+j.w,m=-i.z+i.w;if(0<=p&&0<=n&&0<=l&&0<=m){return !0}if(0>p&&0>n||0>l&&0>m){return !1}0>p?r=Math.max(r,p/(p-n)):0>n&&(q=Math.min(q,p/(p-n)));0>l?r=Math.max(r,l/(l-m)):0>m&&(q=Math.min(q,l/(l-m)));if(q<r){return !1}j.lerp(i,r);i.lerp(j,1-q);return !0}var aD,aC,aB=[],az=0,aA,ay,ax=[],av=0,au,at,ar=[],an=0,aq,ap=[],ao=0,am,aj,af=[],ad=0,ab,Y,ac=[],ah=0,W={objects:[],sprites:[],lights:[],elements:[]},ag=new THREE.Vector3,X=new THREE.Vector4,S=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),ak=new THREE.Box3,T=Array(3),al=Array(4),o=new THREE.Matrix4,U=new THREE.Matrix4,ai,aw=new THREE.Matrix4,aa=new THREE.Matrix3,R=new THREE.Matrix3,v=new THREE.Vector3,P=new THREE.Frustum,Q=new THREE.Vector4,ae=new THREE.Vector4;this.projectVector=function(d,c){c.matrixWorldInverse.getInverse(c.matrixWorld);U.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);return d.applyProjection(U)};this.unprojectVector=function(d,c){c.projectionMatrixInverse.getInverse(c.projectionMatrix);U.multiplyMatrices(c.matrixWorld,c.projectionMatrixInverse);return d.applyProjection(U)};this.pickingRay=function(e,d){e.z=-1;var f=new THREE.Vector3(e.x,e.y,1);this.unprojectVector(e,d);this.unprojectVector(f,d);f.sub(e).normalize();return new THREE.Raycaster(e,f)};var E=function(d){if(aC===az){var c=new THREE.RenderableObject;aB.push(c);az++;aC++;aD=c}else{aD=aB[aC++]}aD.id=d.id;aD.object=d;null!==d.renderDepth?aD.z=d.renderDepth:(ag.getPositionFromMatrix(d.matrixWorld),ag.applyProjection(U),aD.z=ag.z);return aD},k=function(e){if(!1!==e.visible){e instanceof THREE.Light?W.lights.push(e):e instanceof THREE.Mesh||e instanceof THREE.Line?(!1===e.frustumCulled||!0===P.intersectsObject(e))&&W.objects.push(E(e)):(e instanceof THREE.Sprite||e instanceof THREE.Particle)&&W.sprites.push(E(e));for(var d=0,f=e.children.length;d<f;d++){k(e.children[d])}}};this.projectScene=function(C,A,t,p){var c=!1,j,m,G,e,F,i,g,b,u,D,q,n,r;Y=aj=aq=at=0;W.elements.length=0;!0===C.autoUpdate&&C.updateMatrixWorld();void 0===A.parent&&A.updateMatrixWorld();o.copy(A.matrixWorldInverse.getInverse(A.matrixWorld));U.multiplyMatrices(A.projectionMatrix,o);R.getNormalMatrix(o);P.setFromMatrix(U);aC=0;W.objects.length=0;W.sprites.length=0;W.lights.length=0;k(C);!0===t&&W.objects.sort(aF);C=0;for(t=W.objects.length;C<t;C++){if(b=W.objects[C].object,ai=b.matrixWorld,ay=0,b instanceof THREE.Mesh){u=b.geometry;G=u.vertices;D=u.faces;u=u.faceVertexUvs;aa.getNormalMatrix(ai);n=b.material instanceof THREE.MeshFaceMaterial;r=!0===n?b.material:null;j=0;for(m=G.length;j<m;j++){aA=aG();aA.positionWorld.copy(G[j]).applyMatrix4(ai);aA.positionScreen.copy(aA.positionWorld).applyMatrix4(U);var a=1/aA.positionScreen.w;aA.positionScreen.x*=a;aA.positionScreen.y*=a;aA.positionScreen.z*=a;aA.visible=!(-1>aA.positionScreen.x||1<aA.positionScreen.x||-1>aA.positionScreen.y||1<aA.positionScreen.y||-1>aA.positionScreen.z||1<aA.positionScreen.z)}G=0;for(j=D.length;G<j;G++){if(m=D[G],a=!0===n?r.materials[m.materialIndex]:b.material,void 0!==a){i=a.side;if(m instanceof THREE.Face3){if(e=ax[m.a],F=ax[m.b],g=ax[m.c],T[0]=e.positionScreen,T[1]=F.positionScreen,T[2]=g.positionScreen,!0===e.visible||!0===F.visible||!0===g.visible||S.isIntersectionBox(ak.setFromPoints(T))){if(c=0>(g.positionScreen.x-e.positionScreen.x)*(F.positionScreen.y-e.positionScreen.y)-(g.positionScreen.y-e.positionScreen.y)*(F.positionScreen.x-e.positionScreen.x),i===THREE.DoubleSide||c===(i===THREE.FrontSide)){at===an?(q=new THREE.RenderableFace3,ar.push(q),an++,at++,au=q):au=ar[at++],au.id=b.id,au.v1.copy(e),au.v2.copy(F),au.v3.copy(g)}else{continue}}else{continue}}else{if(m instanceof THREE.Face4){if(e=ax[m.a],F=ax[m.b],g=ax[m.c],q=ax[m.d],al[0]=e.positionScreen,al[1]=F.positionScreen,al[2]=g.positionScreen,al[3]=q.positionScreen,!0===e.visible||!0===F.visible||!0===g.visible||!0===q.visible||S.isIntersectionBox(ak.setFromPoints(al))){if(c=0>(q.positionScreen.x-e.positionScreen.x)*(F.positionScreen.y-e.positionScreen.y)-(q.positionScreen.y-e.positionScreen.y)*(F.positionScreen.x-e.positionScreen.x)||0>(F.positionScreen.x-g.positionScreen.x)*(q.positionScreen.y-g.positionScreen.y)-(F.positionScreen.y-g.positionScreen.y)*(q.positionScreen.x-g.positionScreen.x),i===THREE.DoubleSide||c===(i===THREE.FrontSide)){if(aq===ao){var s=new THREE.RenderableFace4;ap.push(s);ao++;aq++;au=s}else{au=ap[aq++]}au.id=b.id;au.v1.copy(e);au.v2.copy(F);au.v3.copy(g);au.v4.copy(q)}else{continue}}else{continue}}}au.normalModel.copy(m.normal);!1===c&&(i===THREE.BackSide||i===THREE.DoubleSide)&&au.normalModel.negate();au.normalModel.applyMatrix3(aa).normalize();au.normalModelView.copy(au.normalModel).applyMatrix3(R);au.centroidModel.copy(m.centroid).applyMatrix4(ai);g=m.vertexNormals;e=0;for(F=g.length;e<F;e++){q=au.vertexNormalsModel[e],q.copy(g[e]),!1===c&&(i===THREE.BackSide||i===THREE.DoubleSide)&&q.negate(),q.applyMatrix3(aa).normalize(),au.vertexNormalsModelView[e].copy(q).applyMatrix3(R)}au.vertexNormalsLength=g.length;e=0;for(F=u.length;e<F;e++){if(q=u[e][G],void 0!==q){i=0;for(g=q.length;i<g;i++){au.uvs[e][i]=q[i]}}}au.color=m.color;au.material=a;v.copy(au.centroidModel).applyProjection(U);au.z=v.z;W.elements.push(au)}}}else{if(b instanceof THREE.Line){aw.multiplyMatrices(U,ai);G=b.geometry.vertices;e=aG();e.positionScreen.copy(G[0]).applyMatrix4(aw);D=b.type===THREE.LinePieces?2:1;j=1;for(m=G.length;j<m;j++){e=aG(),e.positionScreen.copy(G[j]).applyMatrix4(aw),0<(j+1)%D||(F=ax[ay-2],Q.copy(e.positionScreen),ae.copy(F.positionScreen),!0===aE(Q,ae)&&(Q.multiplyScalar(1/Q.w),ae.multiplyScalar(1/ae.w),aj===ad?(u=new THREE.RenderableLine,af.push(u),ad++,aj++,am=u):am=af[aj++],am.id=b.id,am.v1.positionScreen.copy(Q),am.v2.positionScreen.copy(ae),am.z=Math.max(Q.z,ae.z),am.material=b.material,b.material.vertexColors===THREE.VertexColors&&(am.vertexColors[0].copy(b.geometry.colors[j]),am.vertexColors[1].copy(b.geometry.colors[j-1])),W.elements.push(am)))}}}}C=0;for(t=W.sprites.length;C<t;C++){b=W.sprites[C].object,ai=b.matrixWorld,b instanceof THREE.Particle&&(X.set(ai.elements[12],ai.elements[13],ai.elements[14],1),X.applyMatrix4(U),a=1/X.w,X.z*=a,0<X.z&&1>X.z&&(Y===ah?(c=new THREE.RenderableParticle,ac.push(c),ah++,Y++,ab=c):ab=ac[Y++],ab.id=b.id,ab.x=X.x*a,ab.y=X.y*a,ab.z=X.z,ab.object=b,ab.rotation=b.rotation.z,ab.scale.x=b.scale.x*Math.abs(ab.x-(X.x+A.projectionMatrix.elements[0])/(X.w+A.projectionMatrix.elements[12])),ab.scale.y=b.scale.y*Math.abs(ab.y-(X.y+A.projectionMatrix.elements[5])/(X.w+A.projectionMatrix.elements[13])),ab.material=b.material,W.elements.push(ab)))}!0===p&&W.elements.sort(aF);return W}};THREE.Face3=function(h,g,l,k,j,i){this.a=h;this.b=g;this.c=l;this.normal=k instanceof THREE.Vector3?k:new THREE.Vector3;this.vertexNormals=k instanceof Array?k:[];this.color=j instanceof THREE.Color?j:new THREE.Color;this.vertexColors=j instanceof Array?j:[];this.vertexTangents=[];this.materialIndex=void 0!==i?i:0;this.centroid=new THREE.Vector3};THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var e=new THREE.Face3(this.a,this.b,this.c);e.normal.copy(this.normal);e.color.copy(this.color);e.centroid.copy(this.centroid);e.materialIndex=this.materialIndex;var d,f;d=0;for(f=this.vertexNormals.length;d<f;d++){e.vertexNormals[d]=this.vertexNormals[d].clone()}d=0;for(f=this.vertexColors.length;d<f;d++){e.vertexColors[d]=this.vertexColors[d].clone()}d=0;for(f=this.vertexTangents.length;d<f;d++){e.vertexTangents[d]=this.vertexTangents[d].clone()}return e}};THREE.Face4=function(i,g,n,m,l,k,j){this.a=i;this.b=g;this.c=n;this.d=m;this.normal=l instanceof THREE.Vector3?l:new THREE.Vector3;this.vertexNormals=l instanceof Array?l:[];this.color=k instanceof THREE.Color?k:new THREE.Color;this.vertexColors=k instanceof Array?k:[];this.vertexTangents=[];this.materialIndex=void 0!==j?j:0;this.centroid=new THREE.Vector3};THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var e=new THREE.Face4(this.a,this.b,this.c,this.d);e.normal.copy(this.normal);e.color.copy(this.color);e.centroid.copy(this.centroid);e.materialIndex=this.materialIndex;var d,f;d=0;for(f=this.vertexNormals.length;d<f;d++){e.vertexNormals[d]=this.vertexNormals[d].clone()}d=0;for(f=this.vertexColors.length;d<f;d++){e.vertexColors[d]=this.vertexColors[d].clone()}d=0;for(f=this.vertexTangents.length;d<f;d++){e.vertexTangents[d]=this.vertexTangents[d].clone()}return e}};THREE.Geometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.vertices=[];this.colors=[];this.normals=[];this.faces=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1};THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(i){for(var g=(new THREE.Matrix3).getNormalMatrix(i),n=0,m=this.vertices.length;n<m;n++){this.vertices[n].applyMatrix4(i)}n=0;for(m=this.faces.length;n<m;n++){var l=this.faces[n];l.normal.applyMatrix3(g).normalize();for(var k=0,j=l.vertexNormals.length;k<j;k++){l.vertexNormals[k].applyMatrix3(g).normalize()}l.centroid.applyMatrix4(i)}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox();this.boundingSphere instanceof THREE.Sphere&&this.computeBoundingSphere()},computeCentroids:function(){var e,d,f;e=0;for(d=this.faces.length;e<d;e++){f=this.faces[e],f.centroid.set(0,0,0),f instanceof THREE.Face3?(f.centroid.add(this.vertices[f.a]),f.centroid.add(this.vertices[f.b]),f.centroid.add(this.vertices[f.c]),f.centroid.divideScalar(3)):f instanceof THREE.Face4&&(f.centroid.add(this.vertices[f.a]),f.centroid.add(this.vertices[f.b]),f.centroid.add(this.vertices[f.c]),f.centroid.add(this.vertices[f.d]),f.centroid.divideScalar(4))}},computeFaceNormals:function(){for(var i=new THREE.Vector3,g=new THREE.Vector3,n=0,m=this.faces.length;n<m;n++){var l=this.faces[n],k=this.vertices[l.a],j=this.vertices[l.b];i.subVectors(this.vertices[l.c],j);g.subVectors(k,j);i.cross(g);i.normalize();l.normal.copy(i)}},computeVertexNormals:function(D){var C,B,A,v;if(void 0===this.__tmpVertices){v=this.__tmpVertices=Array(this.vertices.length);C=0;for(B=this.vertices.length;C<B;C++){v[C]=new THREE.Vector3}C=0;for(B=this.faces.length;C<B;C++){A=this.faces[C],A instanceof THREE.Face3?A.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:A instanceof THREE.Face4&&(A.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}}else{v=this.__tmpVertices;C=0;for(B=this.vertices.length;C<B;C++){v[C].set(0,0,0)}}if(D){var u,s,t,r=new THREE.Vector3,q=new THREE.Vector3,p=new THREE.Vector3,o=new THREE.Vector3,k=new THREE.Vector3;C=0;for(B=this.faces.length;C<B;C++){A=this.faces[C],A instanceof THREE.Face3?(D=this.vertices[A.a],u=this.vertices[A.b],s=this.vertices[A.c],r.subVectors(s,u),q.subVectors(D,u),r.cross(q),v[A.a].add(r),v[A.b].add(r),v[A.c].add(r)):A instanceof THREE.Face4&&(D=this.vertices[A.a],u=this.vertices[A.b],s=this.vertices[A.c],t=this.vertices[A.d],p.subVectors(t,u),q.subVectors(D,u),p.cross(q),v[A.a].add(p),v[A.b].add(p),v[A.d].add(p),o.subVectors(t,s),k.subVectors(u,s),o.cross(k),v[A.b].add(o),v[A.c].add(o),v[A.d].add(o))}}else{C=0;for(B=this.faces.length;C<B;C++){A=this.faces[C],A instanceof THREE.Face3?(v[A.a].add(A.normal),v[A.b].add(A.normal),v[A.c].add(A.normal)):A instanceof THREE.Face4&&(v[A.a].add(A.normal),v[A.b].add(A.normal),v[A.c].add(A.normal),v[A.d].add(A.normal))}}C=0;for(B=this.vertices.length;C<B;C++){v[C].normalize()}C=0;for(B=this.faces.length;C<B;C++){A=this.faces[C],A instanceof THREE.Face3?(A.vertexNormals[0].copy(v[A.a]),A.vertexNormals[1].copy(v[A.b]),A.vertexNormals[2].copy(v[A.c])):A instanceof THREE.Face4&&(A.vertexNormals[0].copy(v[A.a]),A.vertexNormals[1].copy(v[A.b]),A.vertexNormals[2].copy(v[A.c]),A.vertexNormals[3].copy(v[A.d]))}},computeMorphNormals:function(){var t,s,r,q,p;r=0;for(q=this.faces.length;r<q;r++){p=this.faces[r];p.__originalFaceNormal?p.__originalFaceNormal.copy(p.normal):p.__originalFaceNormal=p.normal.clone();p.__originalVertexNormals||(p.__originalVertexNormals=[]);t=0;for(s=p.vertexNormals.length;t<s;t++){p.__originalVertexNormals[t]?p.__originalVertexNormals[t].copy(p.vertexNormals[t]):p.__originalVertexNormals[t]=p.vertexNormals[t].clone()}}var o=new THREE.Geometry;o.faces=this.faces;t=0;for(s=this.morphTargets.length;t<s;t++){if(!this.morphNormals[t]){this.morphNormals[t]={};this.morphNormals[t].faceNormals=[];this.morphNormals[t].vertexNormals=[];var m=this.morphNormals[t].faceNormals,n=this.morphNormals[t].vertexNormals,l,k;r=0;for(q=this.faces.length;r<q;r++){p=this.faces[r],l=new THREE.Vector3,k=p instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},m.push(l),n.push(k)}}m=this.morphNormals[t];o.vertices=this.morphTargets[t].vertices;o.computeFaceNormals();o.computeVertexNormals();r=0;for(q=this.faces.length;r<q;r++){p=this.faces[r],l=m.faceNormals[r],k=m.vertexNormals[r],l.copy(p.normal),p instanceof THREE.Face3?(k.a.copy(p.vertexNormals[0]),k.b.copy(p.vertexNormals[1]),k.c.copy(p.vertexNormals[2])):(k.a.copy(p.vertexNormals[0]),k.b.copy(p.vertexNormals[1]),k.c.copy(p.vertexNormals[2]),k.d.copy(p.vertexNormals[3]))}}r=0;for(q=this.faces.length;r<q;r++){p=this.faces[r],p.normal=p.__originalFaceNormal,p.vertexNormals=p.__originalVertexNormals}},computeTangents:function(){function ao(h,g,n,l,j,i,m){ai=h.vertices[g];ag=h.vertices[n];af=h.vertices[l];ae=ah[j];ad=ah[i];ac=ah[m];ab=ag.x-ai.x;U=af.x-ai.x;Z=ag.y-ai.y;X=af.y-ai.y;V=ag.z-ai.z;T=af.z-ai.z;D=ad.x-ae.x;W=ac.x-ae.x;S=ad.y-ae.y;Q=ac.y-ae.y;O=1/(D*Q-W*S);Y.set((Q*ab-S*U)*O,(Q*Z-S*X)*O,(Q*V-S*T)*O);L.set((D*U-W*ab)*O,(D*X-W*Z)*O,(D*T-W*V)*O);aa[g].add(Y);aa[n].add(Y);aa[l].add(Y);v[g].add(L);v[n].add(L);v[l].add(L)}var an,am,al,ak,aj,ah,ai,ag,af,ae,ad,ac,ab,U,Z,X,V,T,D,W,S,Q,O,R,aa=[],v=[],Y=new THREE.Vector3,L=new THREE.Vector3,k=new THREE.Vector3,E=new THREE.Vector3,o=new THREE.Vector3;an=0;for(am=this.vertices.length;an<am;an++){aa[an]=new THREE.Vector3,v[an]=new THREE.Vector3}an=0;for(am=this.faces.length;an<am;an++){aj=this.faces[an],ah=this.faceVertexUvs[0][an],aj instanceof THREE.Face3?ao(this,aj.a,aj.b,aj.c,0,1,2):aj instanceof THREE.Face4&&(ao(this,aj.a,aj.b,aj.d,0,1,3),ao(this,aj.b,aj.c,aj.d,1,2,3))}var P=["a","b","c","d"];an=0;for(am=this.faces.length;an<am;an++){aj=this.faces[an];for(al=0;al<aj.vertexNormals.length;al++){o.copy(aj.vertexNormals[al]),ak=aj[P[al]],R=aa[ak],k.copy(R),k.sub(o.multiplyScalar(o.dot(R))).normalize(),E.crossVectors(aj.vertexNormals[al],R),ak=E.dot(v[ak]),ak=0>ak?-1:1,aj.vertexTangents[al]=new THREE.Vector4(k.x,k.y,k.z,ak)}}this.hasTangents=!0},computeLineDistances:function(){for(var f=0,e=this.vertices,h=0,g=e.length;h<g;h++){0<h&&(f+=e[h].distanceTo(e[h-1])),this.lineDistances[h]=f}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var v={},u=[],t=[],s,r=Math.pow(10,4),q,o,p,n,m;this.__tmpVertices=void 0;q=0;for(o=this.vertices.length;q<o;q++){s=this.vertices[q],s=Math.round(s.x*r)+"_"+Math.round(s.y*r)+"_"+Math.round(s.z*r),void 0===v[s]?(v[s]=q,u.push(this.vertices[q]),t[q]=u.length-1):t[q]=t[v[s]]}r=[];q=0;for(o=this.faces.length;q<o;q++){if(v=this.faces[q],v instanceof THREE.Face3){v.a=t[v.a];v.b=t[v.b];v.c=t[v.c];p=[v.a,v.b,v.c];s=-1;for(n=0;3>n;n++){if(p[n]==p[(n+1)%3]){r.push(q);break}}}else{if(v instanceof THREE.Face4){v.a=t[v.a];v.b=t[v.b];v.c=t[v.c];v.d=t[v.d];p=[v.a,v.b,v.c,v.d];s=-1;for(n=0;4>n;n++){p[n]==p[(n+1)%4]&&(0<=s&&r.push(q),s=n)}if(0<=s){p.splice(s,1);var k=new THREE.Face3(p[0],p[1],p[2],v.normal,v.color,v.materialIndex);p=0;for(n=this.faceVertexUvs.length;p<n;p++){(m=this.faceVertexUvs[p][q])&&m.splice(s,1)}v.vertexNormals&&0<v.vertexNormals.length&&(k.vertexNormals=v.vertexNormals,k.vertexNormals.splice(s,1));v.vertexColors&&0<v.vertexColors.length&&(k.vertexColors=v.vertexColors,k.vertexColors.splice(s,1));this.faces[q]=k}}}}for(q=r.length-1;0<=q;q--){this.faces.splice(q,1);p=0;for(n=this.faceVertexUvs.length;p<n;p++){this.faceVertexUvs[p].splice(q,1)}}t=this.vertices.length-u.length;this.vertices=u;return t},clone:function(){for(var j=new THREE.Geometry,i=this.vertices,p=0,o=i.length;p<o;p++){j.vertices.push(i[p].clone())}i=this.faces;p=0;for(o=i.length;p<o;p++){j.faces.push(i[p].clone())}i=this.faceVertexUvs[0];p=0;for(o=i.length;p<o;p++){for(var n=i[p],m=[],k=0,l=n.length;k<l;k++){m.push(new THREE.Vector2(n[k].x,n[k].y))}j.faceVertexUvs[0].push(m)}return j},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount=0;THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.attributes={};this.dynamic=!1;this.offsets=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.morphTargets=[]};THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,applyMatrix:function(e){var d,f;this.attributes.position&&(d=this.attributes.position.array);this.attributes.normal&&(f=this.attributes.normal.array);void 0!==d&&(e.multiplyVector3Array(d),this.verticesNeedUpdate=!0);void 0!==f&&((new THREE.Matrix3).getNormalMatrix(e).multiplyVector3Array(f),this.normalizeNormals(),this.normalsNeedUpdate=!0)},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var i=this.attributes.position.array;if(i){var g=this.boundingBox,n,m,l;3<=i.length&&(g.min.x=g.max.x=i[0],g.min.y=g.max.y=i[1],g.min.z=g.max.z=i[2]);for(var k=3,j=i.length;k<j;k+=3){n=i[k],m=i[k+1],l=i[k+2],n<g.min.x?g.min.x=n:n>g.max.x&&(g.max.x=n),m<g.min.y?g.min.y=m:m>g.max.y&&(g.max.y=m),l<g.min.z?g.min.z=l:l>g.max.z&&(g.max.z=l)}}if(void 0===i||0===i.length){this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)}},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var i=this.attributes.position.array;if(i){for(var g,n=0,m,l,k=0,j=i.length;k<j;k+=3){g=i[k],m=i[k+1],l=i[k+2],g=g*g+m*m+l*l,g>n&&(n=g)}this.boundingSphere.radius=Math.sqrt(n)}},computeVertexNormals:function(){if(this.attributes.position){var R,Q,P,O;R=this.attributes.position.array.length;if(void 0===this.attributes.normal){this.attributes.normal={itemSize:3,array:new Float32Array(R)}}else{R=0;for(Q=this.attributes.normal.array.length;R<Q;R++){this.attributes.normal.array[R]=0}}var N=this.attributes.position.array,L=this.attributes.normal.array,J,K,I,H,G,F,E=new THREE.Vector3,D=new THREE.Vector3,v=new THREE.Vector3,C=new THREE.Vector3,B=new THREE.Vector3;if(this.attributes.index){var A=this.attributes.index.array,o=this.offsets;P=0;for(O=o.length;P<O;++P){Q=o[P].start;J=o[P].count;var k=o[P].index;R=Q;for(Q+=J;R<Q;R+=3){J=k+A[R],K=k+A[R+1],I=k+A[R+2],H=N[3*J],G=N[3*J+1],F=N[3*J+2],E.set(H,G,F),H=N[3*K],G=N[3*K+1],F=N[3*K+2],D.set(H,G,F),H=N[3*I],G=N[3*I+1],F=N[3*I+2],v.set(H,G,F),C.subVectors(v,D),B.subVectors(E,D),C.cross(B),L[3*J]+=C.x,L[3*J+1]+=C.y,L[3*J+2]+=C.z,L[3*K]+=C.x,L[3*K+1]+=C.y,L[3*K+2]+=C.z,L[3*I]+=C.x,L[3*I+1]+=C.y,L[3*I+2]+=C.z}}}else{R=0;for(Q=N.length;R<Q;R+=9){H=N[R],G=N[R+1],F=N[R+2],E.set(H,G,F),H=N[R+3],G=N[R+4],F=N[R+5],D.set(H,G,F),H=N[R+6],G=N[R+7],F=N[R+8],v.set(H,G,F),C.subVectors(v,D),B.subVectors(E,D),C.cross(B),L[R]=C.x,L[R+1]=C.y,L[R+2]=C.z,L[R+3]=C.x,L[R+4]=C.y,L[R+5]=C.z,L[R+6]=C.x,L[R+7]=C.y,L[R+8]=C.z}}this.normalizeNormals();this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var h=this.attributes.normal.array,g,l,k,j=0,i=h.length;j<i;j+=3){g=h[j],l=h[j+1],k=h[j+2],g=1/Math.sqrt(g*g+l*l+k*k),h[j]*=g,h[j+1]*=g,h[j+2]*=g}},computeTangents:function(){function aA(b){ap.x=ax[3*b];ap.y=ax[3*b+1];ap.z=ax[3*b+2];U.copy(ap);o=au[b];Q.copy(o);Q.sub(ap.multiplyScalar(ap.dot(o))).normalize();ac.crossVectors(U,o);v=ac.dot(ar[b]);D=0>v?-1:1;at[4*b]=Q.x;at[4*b+1]=Q.y;at[4*b+2]=Q.z;at[4*b+3]=D}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv){console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()")}else{var az=this.attributes.index.array,ay=this.attributes.position.array,ax=this.attributes.normal.array,aw=this.attributes.uv.array,av=ay.length/3;void 0===this.attributes.tangent&&(this.attributes.tangent={itemSize:4,array:new Float32Array(4*av)});for(var at=this.attributes.tangent.array,au=[],ar=[],aq=0;aq<av;aq++){au[aq]=new THREE.Vector3,ar[aq]=new THREE.Vector3}var ao,an,am,al,ah,ak,aj,ai,ag,ad,Y,X,V,T,W,av=new THREE.Vector3,aq=new THREE.Vector3,ab,R,aa,S,E,ae,P,af=this.offsets;aa=0;for(S=af.length;aa<S;++aa){R=af[aa].start;E=af[aa].count;var k=af[aa].index;ab=R;for(R+=E;ab<R;ab+=3){E=k+az[ab],ae=k+az[ab+1],P=k+az[ab+2],ao=ay[3*E],an=ay[3*E+1],am=ay[3*E+2],al=ay[3*ae],ah=ay[3*ae+1],ak=ay[3*ae+2],aj=ay[3*P],ai=ay[3*P+1],ag=ay[3*P+2],ad=aw[2*E],Y=aw[2*E+1],X=aw[2*ae],V=aw[2*ae+1],T=aw[2*P],W=aw[2*P+1],al-=ao,ao=aj-ao,ah-=an,an=ai-an,ak-=am,am=ag-am,X-=ad,ad=T-ad,V-=Y,Y=W-Y,W=1/(X*Y-ad*V),av.set((Y*al-V*ao)*W,(Y*ah-V*an)*W,(Y*ak-V*am)*W),aq.set((X*ao-ad*al)*W,(X*an-ad*ah)*W,(X*am-ad*ak)*W),au[E].add(av),au[ae].add(av),au[P].add(av),ar[E].add(aq),ar[ae].add(aq),ar[P].add(aq)}}var Q=new THREE.Vector3,ac=new THREE.Vector3,ap=new THREE.Vector3,U=new THREE.Vector3,D,o,v;aa=0;for(S=af.length;aa<S;++aa){R=af[aa].start;E=af[aa].count;k=af[aa].index;ab=R;for(R+=E;ab<R;ab+=3){E=k+az[ab],ae=k+az[ab+1],P=k+az[ab+2],aA(E),aA(ae),aA(P)}}this.tangentsNeedUpdate=this.hasTangents=!0}},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4;this.projectionMatrixInverse=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.lookAt=function(){var b=new THREE.Matrix4;return function(a){b.lookAt(this.position,a,this.up);this.quaternion.setFromRotationMatrix(b)}}();THREE.OrthographicCamera=function(h,g,l,k,j,i){THREE.Camera.call(this);this.left=h;this.right=g;this.top=l;this.bottom=k;this.near=void 0!==j?j:0.1;this.far=void 0!==i?i:2000;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};THREE.PerspectiveCamera=function(f,e,h,g){THREE.Camera.call(this);this.fov=void 0!==f?f:50;this.aspect=void 0!==e?e:1;this.near=void 0!==h?h:0.1;this.far=void 0!==g?g:2000;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.setLens=function(d,c){void 0===c&&(c=24);this.fov=2*THREE.Math.radToDeg(Math.atan(c/(2*d)));this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(h,g,l,k,j,i){this.fullWidth=h;this.fullHeight=g;this.x=l;this.y=k;this.width=j;this.height=i;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var f=this.fullWidth/this.fullHeight,e=Math.tan(THREE.Math.degToRad(0.5*this.fov))*this.near,h=-e,g=f*h,f=Math.abs(f*e-g),h=Math.abs(e-h);this.projectionMatrix.makeFrustum(g+this.x*f/this.fullWidth,g+(this.x+this.width)*f/this.fullWidth,e-(this.y+this.height)*h/this.fullHeight,e-this.y*h/this.fullHeight,this.near,this.far)}else{this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)}};THREE.Light=function(b){THREE.Object3D.call(this);this.color=new THREE.Color(b)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.clone=function(b){void 0===b&&(b=new THREE.Light);THREE.Object3D.prototype.clone.call(this,b);b.color.copy(this.color);return b};THREE.AmbientLight=function(b){THREE.Light.call(this,b)};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.clone=function(){var b=new THREE.AmbientLight;THREE.Light.prototype.clone.call(this,b);return b};THREE.AreaLight=function(d,c){THREE.Light.call(this,d);this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=void 0!==c?c:1;this.height=this.width=1;this.constantAttenuation=1.5;this.linearAttenuation=0.5;this.quadraticAttenuation=0.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);THREE.DirectionalLight=function(d,c){THREE.Light.call(this,d);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==c?c:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5000;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=!1;this.shadowCascadeOffset=new THREE.Vector3(0,0,-1000);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);THREE.DirectionalLight.prototype.clone=function(){var b=new THREE.DirectionalLight;THREE.Light.prototype.clone.call(this,b);b.target=this.target.clone();b.intensity=this.intensity;b.castShadow=this.castShadow;b.onlyShadow=this.onlyShadow;return b};THREE.HemisphereLight=function(e,d,f){THREE.Light.call(this,e);this.position.set(0,100,0);this.groundColor=new THREE.Color(d);this.intensity=void 0!==f?f:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);THREE.HemisphereLight.prototype.clone=function(){var b=new THREE.PointLight;THREE.Light.prototype.clone.call(this,b);b.groundColor.copy(this.groundColor);b.intensity=this.intensity;return b};THREE.PointLight=function(e,d,f){THREE.Light.call(this,e);this.intensity=void 0!==d?d:1;this.distance=void 0!==f?f:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);THREE.PointLight.prototype.clone=function(){var b=new THREE.PointLight;THREE.Light.prototype.clone.call(this,b);b.intensity=this.intensity;b.distance=this.distance;return b};THREE.SpotLight=function(g,f,j,i,h){THREE.Light.call(this,g);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==f?f:1;this.distance=void 0!==j?j:0;this.angle=void 0!==i?i:Math.PI/3;this.exponent=void 0!==h?h:10;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5000;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.clone=function(){var b=new THREE.SpotLight;THREE.Light.prototype.clone.call(this,b);b.target=this.target.clone();b.intensity=this.intensity;b.distance=this.distance;b.angle=this.angle;b.exponent=this.exponent;b.castShadow=this.castShadow;b.onlyShadow=this.onlyShadow;return b};THREE.Loader=function(b){this.statusDomElement=(this.showStatus=b)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var b=document.createElement("div");b.style.position="absolute";b.style.right="0px";b.style.top="0px";b.style.fontSize="0.8em";b.style.textAlign="left";b.style.background="rgba(0,0,0,0.25)";b.style.color="#fff";b.style.width="120px";b.style.padding="0.5em 0.5em 0.5em 0.5em";b.style.zIndex=1000;b.innerHTML="Loading ...";return b},updateProgress:function(d){var c="Loaded ",c=d.total?c+((100*d.loaded/d.total).toFixed(0)+"%"):c+((d.loaded/1000).toFixed(2)+" KB");this.statusDomElement.innerHTML=c},extractUrlBase:function(b){b=b.split("/");b.pop();return(1>b.length?".":b.join("/"))+"/"},initMaterials:function(f,e){for(var h=[],g=0;g<f.length;++g){h[g]=THREE.Loader.prototype.createMaterial(f[g],e)}return h},needsTangents:function(e){for(var d=0,f=e.length;d<f;d++){if(e[d] instanceof THREE.ShaderMaterial){return !0}}return !1},createMaterial:function(t,s){function r(b){b=Math.log(b)/Math.LN2;return Math.floor(b)==b}function q(b){b=Math.log(b)/Math.LN2;return Math.pow(2,Math.round(b))}function p(E,B,A,v,h,d,b){var G=/\.dds$/i.test(A),F=s+"/"+A;if(G){var D=THREE.ImageUtils.loadCompressedTexture(F);E[B]=D}else{D=document.createElement("canvas"),E[B]=new THREE.Texture(D)}E[B].sourceFile=A;v&&(E[B].repeat.set(v[0],v[1]),1!==v[0]&&(E[B].wrapS=THREE.RepeatWrapping),1!==v[1]&&(E[B].wrapT=THREE.RepeatWrapping));h&&E[B].offset.set(h[0],h[1]);d&&(A={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==A[d[0]]&&(E[B].wrapS=A[d[0]]),void 0!==A[d[1]]&&(E[B].wrapT=A[d[1]]));b&&(E[B].anisotropy=b);if(!G){var c=E[B],E=new Image;E.onload=function(){if(!r(this.width)||!r(this.height)){var f=q(this.width),e=q(this.height);c.image.width=f;c.image.height=e;c.image.getContext("2d").drawImage(this,0,0,f,e)}else{c.image=this}c.needsUpdate=!0};E.crossOrigin=m.crossOrigin;E.src=F}}function o(b){return(255*b[0]<<16)+(255*b[1]<<8)+255*b[2]}var m=this,n="MeshLambertMaterial",l={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(t.shading){var k=t.shading.toLowerCase();"phong"===k?n="MeshPhongMaterial":"basic"===k&&(n="MeshBasicMaterial")}void 0!==t.blending&&void 0!==THREE[t.blending]&&(l.blending=THREE[t.blending]);if(void 0!==t.transparent||1>t.opacity){l.transparent=t.transparent}void 0!==t.depthTest&&(l.depthTest=t.depthTest);void 0!==t.depthWrite&&(l.depthWrite=t.depthWrite);void 0!==t.visible&&(l.visible=t.visible);void 0!==t.flipSided&&(l.side=THREE.BackSide);void 0!==t.doubleSided&&(l.side=THREE.DoubleSide);void 0!==t.wireframe&&(l.wireframe=t.wireframe);void 0!==t.vertexColors&&("face"===t.vertexColors?l.vertexColors=THREE.FaceColors:t.vertexColors&&(l.vertexColors=THREE.VertexColors));t.colorDiffuse?l.color=o(t.colorDiffuse):t.DbgColor&&(l.color=t.DbgColor);t.colorSpecular&&(l.specular=o(t.colorSpecular));t.colorAmbient&&(l.ambient=o(t.colorAmbient));t.transparency&&(l.opacity=t.transparency);t.specularCoef&&(l.shininess=t.specularCoef);t.mapDiffuse&&s&&p(l,"map",t.mapDiffuse,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);t.mapLight&&s&&p(l,"lightMap",t.mapLight,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);t.mapBump&&s&&p(l,"bumpMap",t.mapBump,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);t.mapNormal&&s&&p(l,"normalMap",t.mapNormal,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);t.mapSpecular&&s&&p(l,"specularMap",t.mapSpecular,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);t.mapBumpScale&&(l.bumpScale=t.mapBumpScale);t.mapNormal?(n=THREE.ShaderLib.normalmap,k=THREE.UniformsUtils.clone(n.uniforms),k.tNormal.value=l.normalMap,t.mapNormalFactor&&k.uNormalScale.value.set(t.mapNormalFactor,t.mapNormalFactor),l.map&&(k.tDiffuse.value=l.map,k.enableDiffuse.value=!0),l.specularMap&&(k.tSpecular.value=l.specularMap,k.enableSpecular.value=!0),l.lightMap&&(k.tAO.value=l.lightMap,k.enableAO.value=!0),k.uDiffuseColor.value.setHex(l.color),k.uSpecularColor.value.setHex(l.specular),k.uAmbientColor.value.setHex(l.ambient),k.uShininess.value=l.shininess,void 0!==l.opacity&&(k.uOpacity.value=l.opacity),n=new THREE.ShaderMaterial({fragmentShader:n.fragmentShader,vertexShader:n.vertexShader,uniforms:k,lights:!0,fog:!0}),l.transparent&&(n.transparent=!0)):n=new THREE[n](l);void 0!==t.DbgName&&(n.name=t.DbgName);return n}};THREE.XHRLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(h,g,l,k){var j=this,i=new XMLHttpRequest;void 0!==g&&i.addEventListener("load",function(a){j.manager.itemEnd(h);g(a.target.responseText)},!1);void 0!==l&&i.addEventListener("progress",function(b){l(b)},!1);void 0!==k&&i.addEventListener("error",function(b){k(b)},!1);void 0!==this.crossOrigin&&(i.crossOrigin=this.crossOrigin);i.open("GET",h,!0);i.send(null);j.manager.itemStart(h)},setCrossOrigin:function(b){this.crossOrigin=b}};THREE.ImageLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(h,g,l,k){var j=this,i=document.createElement("img");void 0!==g&&i.addEventListener("load",function(){j.manager.itemEnd(h);g(this)},!1);void 0!==l&&i.addEventListener("progress",function(b){l(b)},!1);void 0!==k&&i.addEventListener("error",function(b){k(b)},!1);void 0!==this.crossOrigin&&(i.crossOrigin=this.crossOrigin);i.src=h;j.manager.itemStart(h)},setCrossOrigin:function(b){this.crossOrigin=b}};THREE.JSONLoader=function(b){THREE.Loader.call(this,b);this.withCredentials=!1};THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype);THREE.JSONLoader.prototype.load=function(e,d,f){f=f&&"string"===typeof f?f:this.extractUrlBase(e);this.onLoadStart();this.loadAjaxJSON(this,e,d,f)};THREE.JSONLoader.prototype.loadAjaxJSON=function(i,g,n,m,l){var k=new XMLHttpRequest,j=0;k.onreadystatechange=function(){if(k.readyState===k.DONE){if(200===k.status||0===k.status){if(k.responseText){var a=JSON.parse(k.responseText),a=i.parse(a,m);n(a.geometry,a.materials)}else{console.warn("THREE.JSONLoader: ["+g+"] seems to be unreachable or file there is empty")}i.onLoadComplete()}else{console.error("THREE.JSONLoader: Couldn't load ["+g+"] ["+k.status+"]")}}else{k.readyState===k.LOADING?l&&(0===j&&(j=k.getResponseHeader("Content-Length")),l({total:j,loaded:k.responseText.length})):k.readyState===k.HEADERS_RECEIVED&&void 0!==l&&(j=k.getResponseHeader("Content-Length"))}};k.open("GET",g,!0);k.withCredentials=this.withCredentials;k.send(null)};THREE.JSONLoader.prototype.parse=function(X,W){var V=new THREE.Geometry,U=void 0!==X.scale?1/X.scale:1,T,S,Q,R,P,O,N,L,K,J,B,I,G,D,A,k=X.faces;J=X.vertices;var E=X.normals,v=X.colors,o=0;if(void 0!==X.uvs){for(T=0;T<X.uvs.length;T++){X.uvs[T].length&&o++}for(T=0;T<o;T++){V.faceUvs[T]=[],V.faceVertexUvs[T]=[]}}R=0;for(P=J.length;R<P;){O=new THREE.Vector3,O.x=J[R++]*U,O.y=J[R++]*U,O.z=J[R++]*U,V.vertices.push(O)}R=0;for(P=k.length;R<P;){J=k[R++];O=J&1;Q=J&2;T=J&4;S=J&8;L=J&16;N=J&32;B=J&64;J&=128;O?(I=new THREE.Face4,I.a=k[R++],I.b=k[R++],I.c=k[R++],I.d=k[R++],O=4):(I=new THREE.Face3,I.a=k[R++],I.b=k[R++],I.c=k[R++],O=3);Q&&(Q=k[R++],I.materialIndex=Q);Q=V.faces.length;if(T){for(T=0;T<o;T++){G=X.uvs[T],K=k[R++],A=G[2*K],K=G[2*K+1],V.faceUvs[T][Q]=new THREE.Vector2(A,K)}}if(S){for(T=0;T<o;T++){G=X.uvs[T];D=[];for(S=0;S<O;S++){K=k[R++],A=G[2*K],K=G[2*K+1],D[S]=new THREE.Vector2(A,K)}V.faceVertexUvs[T][Q]=D}}L&&(L=3*k[R++],S=new THREE.Vector3,S.x=E[L++],S.y=E[L++],S.z=E[L],I.normal=S);if(N){for(T=0;T<O;T++){L=3*k[R++],S=new THREE.Vector3,S.x=E[L++],S.y=E[L++],S.z=E[L],I.vertexNormals.push(S)}}B&&(N=k[R++],N=new THREE.Color(v[N]),I.color=N);if(J){for(T=0;T<O;T++){N=k[R++],N=new THREE.Color(v[N]),I.vertexColors.push(N)}}V.faces.push(I)}if(X.skinWeights){R=0;for(P=X.skinWeights.length;R<P;R+=2){k=X.skinWeights[R],E=X.skinWeights[R+1],V.skinWeights.push(new THREE.Vector4(k,E,0,0))}}if(X.skinIndices){R=0;for(P=X.skinIndices.length;R<P;R+=2){k=X.skinIndices[R],E=X.skinIndices[R+1],V.skinIndices.push(new THREE.Vector4(k,E,0,0))}}V.bones=X.bones;V.animation=X.animation;if(void 0!==X.morphTargets){R=0;for(P=X.morphTargets.length;R<P;R++){V.morphTargets[R]={};V.morphTargets[R].name=X.morphTargets[R].name;V.morphTargets[R].vertices=[];v=V.morphTargets[R].vertices;o=X.morphTargets[R].vertices;k=0;for(E=o.length;k<E;k+=3){J=new THREE.Vector3,J.x=o[k]*U,J.y=o[k+1]*U,J.z=o[k+2]*U,v.push(J)}}}if(void 0!==X.morphColors){R=0;for(P=X.morphColors.length;R<P;R++){V.morphColors[R]={};V.morphColors[R].name=X.morphColors[R].name;V.morphColors[R].colors=[];E=V.morphColors[R].colors;v=X.morphColors[R].colors;U=0;for(k=v.length;U<k;U+=3){o=new THREE.Color(16755200),o.setRGB(v[U],v[U+1],v[U+2]),E.push(o)}}}V.computeCentroids();V.computeFaceNormals();V.computeBoundingSphere();if(void 0===X.materials){return{geometry:V}}U=this.initMaterials(X.materials,W);this.needsTangents(U)&&V.computeTangents();return{geometry:V,materials:U}};THREE.LoadingManager=function(h,g,l){var k=this,j=0,i=0;this.onLoad=h;this.onProgress=g;this.onError=l;this.itemStart=function(){i++};this.itemEnd=function(b){j++;if(void 0!==k.onProgress){k.onProgress(b,j,i)}if(j===i&&void 0!==k.onLoad){k.onLoad()}}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.GeometryLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,load:function(f,e){var h=this,g=new THREE.XHRLoader;g.setCrossOrigin(this.crossOrigin);g.load(f,function(b){e(h.parse(JSON.parse(b)))})},setCrossOrigin:function(b){this.crossOrigin=b},parse:function(){}};THREE.MaterialLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(f,e){var h=this,g=new THREE.XHRLoader;g.setCrossOrigin(this.crossOrigin);g.load(f,function(b){e(h.parse(JSON.parse(b)))})},setCrossOrigin:function(b){this.crossOrigin=b},parse:function(d){var c;switch(d.type){case"MeshBasicMaterial":c=new THREE.MeshBasicMaterial({color:d.color,opacity:d.opacity,transparent:d.transparent,wireframe:d.wireframe});break;case"MeshLambertMaterial":c=new THREE.MeshLambertMaterial({color:d.color,ambient:d.ambient,emissive:d.emissive,opacity:d.opacity,transparent:d.transparent,wireframe:d.wireframe});break;case"MeshPhongMaterial":c=new THREE.MeshPhongMaterial({color:d.color,ambient:d.ambient,emissive:d.emissive,specular:d.specular,shininess:d.shininess,opacity:d.opacity,transparent:d.transparent,wireframe:d.wireframe});break;case"MeshNormalMaterial":c=new THREE.MeshNormalMaterial({opacity:d.opacity,transparent:d.transparent,wireframe:d.wireframe});break;case"MeshDepthMaterial":c=new THREE.MeshDepthMaterial({opacity:d.opacity,transparent:d.transparent,wireframe:d.wireframe})}void 0!==d.vertexColors&&(c.vertexColors=d.vertexColors);return c}};THREE.ObjectLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(f,e){var h=this,g=new THREE.XHRLoader(h.manager);g.setCrossOrigin(this.crossOrigin);g.load(f,function(b){e(h.parse(JSON.parse(b)))})},setCrossOrigin:function(b){this.crossOrigin=b},parse:function(e){var d=this.parseGeometries(e.geometries),f=this.parseMaterials(e.materials);return this.parseObject(e.object,d,f)},parseGeometries:function(i){var g={};if(void 0!==i){for(var n=new THREE.JSONLoader,m=0,l=i.length;m<l;m++){var k,j=i[m];switch(j.type){case"PlaneGeometry":k=new THREE.PlaneGeometry(j.width,j.height,j.widthSegments,j.heightSegments);break;case"CubeGeometry":k=new THREE.CubeGeometry(j.width,j.height,j.depth,j.widthSegments,j.heightSegments,j.depthSegments);break;case"CylinderGeometry":k=new THREE.CylinderGeometry(j.radiusTop,j.radiusBottom,j.height,j.radiusSegments,j.heightSegments,j.openEnded);break;case"SphereGeometry":k=new THREE.SphereGeometry(j.radius,j.widthSegments,j.heightSegments,j.phiStart,j.phiLength,j.thetaStart,j.thetaLength);break;case"IcosahedronGeometry":k=new THREE.IcosahedronGeometry(j.radius,j.detail);break;case"TorusGeometry":k=new THREE.TorusGeometry(j.radius,j.tube,j.radialSegments,j.tubularSegments,j.arc);break;case"TorusKnotGeometry":k=new THREE.TorusKnotGeometry(j.radius,j.tube,j.radialSegments,j.tubularSegments,j.p,j.q,j.heightScale);break;case"Geometry":k=n.parse(j.data).geometry}k.uuid=j.uuid;void 0!==j.name&&(k.name=j.name);g[j.uuid]=k}}return g},parseMaterials:function(i){var g={};if(void 0!==i){for(var n=new THREE.MaterialLoader,m=0,l=i.length;m<l;m++){var k=i[m],j=n.parse(k);j.uuid=k.uuid;void 0!==k.name&&(j.name=k.name);g[k.uuid]=j}}return g},parseObject:function(){var b=new THREE.Matrix4;return function(a,l,k){var j;switch(a.type){case"Scene":j=new THREE.Scene;break;case"PerspectiveCamera":j=new THREE.PerspectiveCamera(a.fov,a.aspect,a.near,a.far);break;case"OrthographicCamera":j=new THREE.OrthographicCamera(a.left,a.right,a.top,a.bottom,a.near,a.far);break;case"AmbientLight":j=new THREE.AmbientLight(a.color);break;case"DirectionalLight":j=new THREE.DirectionalLight(a.color,a.intensity);break;case"PointLight":j=new THREE.PointLight(a.color,a.intensity,a.distance);break;case"SpotLight":j=new THREE.SpotLight(a.color,a.intensity,a.distance,a.angle,a.exponent);break;case"HemisphereLight":j=new THREE.HemisphereLight(a.color,a.groundColor,a.intensity);break;case"Mesh":j=l[a.geometry];var i=k[a.material];void 0===j&&console.error("THREE.ObjectLoader: Undefined geometry "+a.geometry);void 0===i&&console.error("THREE.ObjectLoader: Undefined material "+a.material);j=new THREE.Mesh(j,i);break;default:j=new THREE.Object3D}j.uuid=a.uuid;void 0!==a.name&&(j.name=a.name);void 0!==a.matrix?(b.fromArray(a.matrix),b.decompose(j.position,j.quaternion,j.scale)):(void 0!==a.position&&j.position.fromArray(a.position),void 0!==a.rotation&&j.rotation.fromArray(a.rotation),void 0!==a.scale&&j.scale.fromArray(a.scale));void 0!==a.visible&&(j.visible=a.visible);void 0!==a.userData&&(j.userData=a.userData);if(void 0!==a.children){for(var g in a.children){j.add(this.parseObject(a.children[g],l,k))}}return j}}()};THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){};this.geometryHandlers={};this.hierarchyHandlers={};this.addGeometryHandler("ascii",THREE.JSONLoader)};THREE.SceneLoader.prototype={constructor:THREE.SceneLoader,load:function(f,e){var h=this,g=new THREE.XHRLoader(h.manager);g.setCrossOrigin(this.crossOrigin);g.load(f,function(a){h.parse(JSON.parse(a),e,f)})},setCrossOrigin:function(b){this.crossOrigin=b},addGeometryHandler:function(d,c){this.geometryHandlers[d]={loaderClass:c}},addHierarchyHandler:function(d,c){this.hierarchyHandlers[d]={loaderClass:c}},parse:function(at,ar,aq){function ap(d,c){return"relativeToHTML"==c?d:ag+"/"+d}function ao(){an(ae.scene,ac.objects)}function an(C,B){var u,t,q,p,m,g,f;for(f in B){var d=ae.objects[f],H=B[f];if(void 0===d){if(H.type&&H.type in ah.hierarchyHandlers){if(void 0===H.loading){t={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};q={};for(var A in H){A in t||(q[A]=H[A])}X=ae.materials[H.material];H.loading=!0;t=ah.hierarchyHandlers[H.type].loaderObject;t.options?t.load(ap(H.url,ac.urlBaseType),am(f,C,X,H)):t.load(ap(H.url,ac.urlBaseType),am(f,C,X,H),q)}}else{if(void 0!==H.geometry){if(af=ae.geometries[H.geometry]){d=!1;X=ae.materials[H.material];d=X instanceof THREE.ShaderMaterial;q=H.position;p=H.rotation;m=H.scale;u=H.matrix;g=H.quaternion;H.material||(X=new THREE.MeshFaceMaterial(ae.face_materials[H.geometry]));X instanceof THREE.MeshFaceMaterial&&0===X.materials.length&&(X=new THREE.MeshFaceMaterial(ae.face_materials[H.geometry]));if(X instanceof THREE.MeshFaceMaterial){for(t=0;t<X.materials.length;t++){d=d||X.materials[t] instanceof THREE.ShaderMaterial}}d&&af.computeTangents();H.skin?d=new THREE.SkinnedMesh(af,X):H.morph?(d=new THREE.MorphAnimMesh(af,X),void 0!==H.duration&&(d.duration=H.duration),void 0!==H.time&&(d.time=H.time),void 0!==H.mirroredLoop&&(d.mirroredLoop=H.mirroredLoop),X.morphNormals&&af.computeMorphNormals()):d=new THREE.Mesh(af,X);d.name=f;u?(d.matrixAutoUpdate=!1,d.matrix.set(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8],u[9],u[10],u[11],u[12],u[13],u[14],u[15])):(d.position.fromArray(q),g?d.quaternion.fromArray(g):d.rotation.fromArray(p),d.scale.fromArray(m));d.visible=H.visible;d.castShadow=H.castShadow;d.receiveShadow=H.receiveShadow;C.add(d);ae.objects[f]=d}}else{"DirectionalLight"===H.type||"PointLight"===H.type||"AmbientLight"===H.type?(O=void 0!==H.color?H.color:16777215,aa=void 0!==H.intensity?H.intensity:1,"DirectionalLight"===H.type?(q=H.direction,W=new THREE.DirectionalLight(O,aa),W.position.fromArray(q),H.target&&(E.push({object:W,targetName:H.target}),W.target=null)):"PointLight"===H.type?(q=H.position,t=H.distance,W=new THREE.PointLight(O,aa,t),W.position.fromArray(q)):"AmbientLight"===H.type&&(W=new THREE.AmbientLight(O)),C.add(W),W.name=f,ae.lights[f]=W,ae.objects[f]=W):"PerspectiveCamera"===H.type||"OrthographicCamera"===H.type?(q=H.position,p=H.rotation,g=H.quaternion,"PerspectiveCamera"===H.type?ad=new THREE.PerspectiveCamera(H.fov,H.aspect,H.near,H.far):"OrthographicCamera"===H.type&&(ad=new THREE.OrthographicCamera(H.left,H.right,H.top,H.bottom,H.near,H.far)),ad.name=f,ad.position.fromArray(q),void 0!==g?ad.quaternion.fromArray(g):void 0!==p&&ad.rotation.fromArray(p),C.add(ad),ae.cameras[f]=ad,ae.objects[f]=ad):(q=H.position,p=H.rotation,m=H.scale,g=H.quaternion,d=new THREE.Object3D,d.name=f,d.position.fromArray(q),g?d.quaternion.fromArray(g):d.rotation.fromArray(p),d.scale.fromArray(m),d.visible=void 0!==H.visible?H.visible:!1,C.add(d),ae.objects[f]=d,ae.empties[f]=d)}}if(d){if(void 0!==H.userData){for(var G in H.userData){d.userData[G]=H.userData[G]}}if(void 0!==H.groups){for(t=0;t<H.groups.length;t++){q=H.groups[t],void 0===ae.groups[q]&&(ae.groups[q]=[]),ae.groups[q].push(f)}}}}void 0!==d&&void 0!==H.children&&an(d,H.children)}}function al(b){return function(a,d){a.name=b;ae.geometries[b]=a;ae.face_materials[b]=d;ao();V-=1;ah.onLoadComplete();aj()}}function am(f,e,h,g){return function(j){var j=j.content?j.content:j.dae?j.scene:j,c=g.rotation,d=g.quaternion,b=g.scale;j.position.fromArray(g.position);d?j.quaternion.fromArray(d):j.rotation.fromArray(c);j.scale.fromArray(b);h&&j.traverse(function(i){i.material=h});var a=void 0!==g.visible?g.visible:!0;j.traverse(function(i){i.visible=a});e.add(j);j.name=f;ae.objects[f]=j;ao();V-=1;ah.onLoadComplete();aj()}}function ak(b){return function(a,d){a.name=b;ae.geometries[b]=a;ae.face_materials[b]=d}}function aj(){ah.callbackProgress({totalModels:R,totalTextures:U,loadedModels:R-V,loadedTextures:U-T},ae);ah.onLoadProgress();if(0===V&&0===T){for(var b=0;b<E.length;b++){var f=E[b],e=ae.objects[f.targetName];e?f.object.target=e:(f.object.target=new THREE.Object3D,ae.scene.add(f.object.target));f.object.target.userData.targetInverse=f.object}ar(ae)}}function ai(e,d){d(e);if(void 0!==e.children){for(var f in e.children){ai(e.children[f],d)}}}var ah=this,ag=THREE.Loader.prototype.extractUrlBase(aq),af,X,ad,ab,Y,W,O,aa,V,T,R,U,ae,E=[],ac=at,Q;for(Q in this.geometryHandlers){at=this.geometryHandlers[Q].loaderClass,this.geometryHandlers[Q].loaderObject=new at}for(Q in this.hierarchyHandlers){at=this.hierarchyHandlers[Q].loaderClass,this.hierarchyHandlers[Q].loaderObject=new at}T=V=0;ae={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}};if(ac.transform&&(Q=ac.transform.position,at=ac.transform.rotation,aq=ac.transform.scale,Q&&ae.scene.position.fromArray(Q),at&&ae.scene.rotation.fromArray(at),aq&&ae.scene.scale.fromArray(aq),Q||at||aq)){ae.scene.updateMatrix(),ae.scene.updateMatrixWorld()}Q=function(b){return function(){T-=b;aj();ah.onLoadComplete()}};for(var o in ac.fogs){at=ac.fogs[o],"linear"===at.type?ab=new THREE.Fog(0,at.near,at.far):"exp2"===at.type&&(ab=new THREE.FogExp2(0,at.density)),at=at.color,ab.color.setRGB(at[0],at[1],at[2]),ae.fogs[o]=ab}for(var P in ac.geometries){ab=ac.geometries[P],ab.type in this.geometryHandlers&&(V+=1,ah.onLoadStart())}for(var v in ac.objects){ai(ac.objects[v],function(b){b.type&&b.type in ah.hierarchyHandlers&&(V+=1,ah.onLoadStart())})}R=V;for(P in ac.geometries){if(ab=ac.geometries[P],"cube"===ab.type){af=new THREE.CubeGeometry(ab.width,ab.height,ab.depth,ab.widthSegments,ab.heightSegments,ab.depthSegments),af.name=P,ae.geometries[P]=af}else{if("plane"===ab.type){af=new THREE.PlaneGeometry(ab.width,ab.height,ab.widthSegments,ab.heightSegments),af.name=P,ae.geometries[P]=af}else{if("sphere"===ab.type){af=new THREE.SphereGeometry(ab.radius,ab.widthSegments,ab.heightSegments),af.name=P,ae.geometries[P]=af}else{if("cylinder"===ab.type){af=new THREE.CylinderGeometry(ab.topRad,ab.botRad,ab.height,ab.radSegs,ab.heightSegs),af.name=P,ae.geometries[P]=af}else{if("torus"===ab.type){af=new THREE.TorusGeometry(ab.radius,ab.tube,ab.segmentsR,ab.segmentsT),af.name=P,ae.geometries[P]=af}else{if("icosahedron"===ab.type){af=new THREE.IcosahedronGeometry(ab.radius,ab.subdivisions),af.name=P,ae.geometries[P]=af}else{if(ab.type in this.geometryHandlers){v={};for(Y in ab){"type"!==Y&&"url"!==Y&&(v[Y]=ab[Y])}this.geometryHandlers[ab.type].loaderObject.load(ap(ab.url,ac.urlBaseType),al(P),v)}else{"embedded"===ab.type&&(v=ac.embeds[ab.id],v.metadata=ac.metadata,v&&(v=this.geometryHandlers.ascii.loaderObject.parse(v,""),ak(P)(v.geometry,v.materials)))}}}}}}}}for(var S in ac.textures){if(P=ac.textures[S],P.url instanceof Array){T+=P.url.length;for(Y=0;Y<P.url.length;Y++){ah.onLoadStart()}}else{T+=1,ah.onLoadStart()}}U=T;for(S in ac.textures){P=ac.textures[S];void 0!==P.mapping&&void 0!==THREE[P.mapping]&&(P.mapping=new THREE[P.mapping]);if(P.url instanceof Array){v=P.url.length;ab=[];for(Y=0;Y<v;Y++){ab[Y]=ap(P.url[Y],ac.urlBaseType)}Y=(Y=/\.dds$/i.test(ab[0]))?THREE.ImageUtils.loadCompressedTextureCube(ab,P.mapping,Q(v)):THREE.ImageUtils.loadTextureCube(ab,P.mapping,Q(v))}else{Y=/\.dds$/i.test(P.url),v=ap(P.url,ac.urlBaseType),ab=Q(1),Y=Y?THREE.ImageUtils.loadCompressedTexture(v,P.mapping,ab):THREE.ImageUtils.loadTexture(v,P.mapping,ab),void 0!==THREE[P.minFilter]&&(Y.minFilter=THREE[P.minFilter]),void 0!==THREE[P.magFilter]&&(Y.magFilter=THREE[P.magFilter]),P.anisotropy&&(Y.anisotropy=P.anisotropy),P.repeat&&(Y.repeat.set(P.repeat[0],P.repeat[1]),1!==P.repeat[0]&&(Y.wrapS=THREE.RepeatWrapping),1!==P.repeat[1]&&(Y.wrapT=THREE.RepeatWrapping)),P.offset&&Y.offset.set(P.offset[0],P.offset[1]),P.wrap&&(v={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==v[P.wrap[0]]&&(Y.wrapS=v[P.wrap[0]]),void 0!==v[P.wrap[1]]&&(Y.wrapT=v[P.wrap[1]]))}ae.textures[S]=Y}var k,D;for(k in ac.materials){S=ac.materials[k];for(D in S.parameters){"envMap"===D||"map"===D||"lightMap"===D||"bumpMap"===D?S.parameters[D]=ae.textures[S.parameters[D]]:"shading"===D?S.parameters[D]="flat"===S.parameters[D]?THREE.FlatShading:THREE.SmoothShading:"side"===D?S.parameters[D]="double"==S.parameters[D]?THREE.DoubleSide:"back"==S.parameters[D]?THREE.BackSide:THREE.FrontSide:"blending"===D?S.parameters[D]=S.parameters[D] in THREE?THREE[S.parameters[D]]:THREE.NormalBlending:"combine"===D?S.parameters[D]=S.parameters[D] in THREE?THREE[S.parameters[D]]:THREE.MultiplyOperation:"vertexColors"===D?"face"==S.parameters[D]?S.parameters[D]=THREE.FaceColors:S.parameters[D]&&(S.parameters[D]=THREE.VertexColors):"wrapRGB"===D&&(Q=S.parameters[D],S.parameters[D]=new THREE.Vector3(Q[0],Q[1],Q[2]))}void 0!==S.parameters.opacity&&1>S.parameters.opacity&&(S.parameters.transparent=!0);S.parameters.normalMap?(Q=THREE.ShaderLib.normalmap,P=THREE.UniformsUtils.clone(Q.uniforms),Y=S.parameters.color,v=S.parameters.specular,ab=S.parameters.ambient,o=S.parameters.shininess,P.tNormal.value=ae.textures[S.parameters.normalMap],S.parameters.normalScale&&P.uNormalScale.value.set(S.parameters.normalScale[0],S.parameters.normalScale[1]),S.parameters.map&&(P.tDiffuse.value=S.parameters.map,P.enableDiffuse.value=!0),S.parameters.envMap&&(P.tCube.value=S.parameters.envMap,P.enableReflection.value=!0,P.uReflectivity.value=S.parameters.reflectivity),S.parameters.lightMap&&(P.tAO.value=S.parameters.lightMap,P.enableAO.value=!0),S.parameters.specularMap&&(P.tSpecular.value=ae.textures[S.parameters.specularMap],P.enableSpecular.value=!0),S.parameters.displacementMap&&(P.tDisplacement.value=ae.textures[S.parameters.displacementMap],P.enableDisplacement.value=!0,P.uDisplacementBias.value=S.parameters.displacementBias,P.uDisplacementScale.value=S.parameters.displacementScale),P.uDiffuseColor.value.setHex(Y),P.uSpecularColor.value.setHex(v),P.uAmbientColor.value.setHex(ab),P.uShininess.value=o,S.parameters.opacity&&(P.uOpacity.value=S.parameters.opacity),X=new THREE.ShaderMaterial({fragmentShader:Q.fragmentShader,vertexShader:Q.vertexShader,uniforms:P,lights:!0,fog:!0})):X=new THREE[S.type](S.parameters);X.name=k;ae.materials[k]=X}for(k in ac.materials){if(S=ac.materials[k],S.parameters.materials){D=[];for(Y=0;Y<S.parameters.materials.length;Y++){D.push(ae.materials[S.parameters.materials[Y]])}ae.materials[k].materials=D}}ao();ae.cameras&&ac.defaults.camera&&(ae.currentCamera=ae.cameras[ac.defaults.camera]);ae.fogs&&ac.defaults.fog&&(ae.scene.fog=ae.fogs[ac.defaults.fog]);ah.callbackSync(ae);aj()}};THREE.TextureLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(e,d){var f=new THREE.ImageLoader(this.manager);f.setCrossOrigin(this.crossOrigin);f.load(e,function(b){b=new THREE.Texture(b);b.needsUpdate=!0;void 0!==d&&d(b)})},setCrossOrigin:function(b){this.crossOrigin=b}};THREE.Material=function(){this.id=THREE.MaterialIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.needsUpdate=this.visible=!0};THREE.Material.prototype={constructor:THREE.Material,setValues:function(f){if(void 0!==f){for(var e in f){var h=f[e];if(void 0===h){console.warn("THREE.Material: '"+e+"' parameter is undefined.")}else{if(e in this){var g=this[e];g instanceof THREE.Color?g.set(h):g instanceof THREE.Vector3&&h instanceof THREE.Vector3?g.copy(h):this[e]="overdraw"==e?Number(h):h}}}}},clone:function(b){void 0===b&&(b=new THREE.Material);b.name=this.name;b.side=this.side;b.opacity=this.opacity;b.transparent=this.transparent;b.blending=this.blending;b.blendSrc=this.blendSrc;b.blendDst=this.blendDst;b.blendEquation=this.blendEquation;b.depthTest=this.depthTest;b.depthWrite=this.depthWrite;b.polygonOffset=this.polygonOffset;b.polygonOffsetFactor=this.polygonOffsetFactor;b.polygonOffsetUnits=this.polygonOffsetUnits;b.alphaTest=this.alphaTest;b.overdraw=this.overdraw;b.visible=this.visible;return b},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.setValues(b)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineBasicMaterial.prototype.clone=function(){var b=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.linewidth=this.linewidth;b.linecap=this.linecap;b.linejoin=this.linejoin;b.vertexColors=this.vertexColors;b.fog=this.fog;return b};THREE.LineDashedMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(b)};THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.clone=function(){var b=new THREE.LineDashedMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.linewidth=this.linewidth;b.scale=this.scale;b.dashSize=this.dashSize;b.gapSize=this.gapSize;b.vertexColors=this.vertexColors;b.fog=this.fog;return b};THREE.MeshBasicMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(b)};THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshBasicMaterial.prototype.clone=function(){var b=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.map=this.map;b.lightMap=this.lightMap;b.specularMap=this.specularMap;b.envMap=this.envMap;b.combine=this.combine;b.reflectivity=this.reflectivity;b.refractionRatio=this.refractionRatio;b.fog=this.fog;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.wireframeLinecap=this.wireframeLinecap;b.wireframeLinejoin=this.wireframeLinejoin;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;return b};THREE.MeshLambertMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(b)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshLambertMaterial.prototype.clone=function(){var b=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.ambient.copy(this.ambient);b.emissive.copy(this.emissive);b.wrapAround=this.wrapAround;b.wrapRGB.copy(this.wrapRGB);b.map=this.map;b.lightMap=this.lightMap;b.specularMap=this.specularMap;b.envMap=this.envMap;b.combine=this.combine;b.reflectivity=this.reflectivity;b.refractionRatio=this.refractionRatio;b.fog=this.fog;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.wireframeLinecap=this.wireframeLinecap;b.wireframeLinejoin=this.wireframeLinejoin;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;b.morphNormals=this.morphNormals;return b};THREE.MeshPhongMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.metal=!1;this.perPixel=!0;this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(b)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshPhongMaterial.prototype.clone=function(){var b=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.ambient.copy(this.ambient);b.emissive.copy(this.emissive);b.specular.copy(this.specular);b.shininess=this.shininess;b.metal=this.metal;b.perPixel=this.perPixel;b.wrapAround=this.wrapAround;b.wrapRGB.copy(this.wrapRGB);b.map=this.map;b.lightMap=this.lightMap;b.bumpMap=this.bumpMap;b.bumpScale=this.bumpScale;b.normalMap=this.normalMap;b.normalScale.copy(this.normalScale);b.specularMap=this.specularMap;b.envMap=this.envMap;b.combine=this.combine;b.reflectivity=this.reflectivity;b.refractionRatio=this.refractionRatio;b.fog=this.fog;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.wireframeLinecap=this.wireframeLinecap;b.wireframeLinejoin=this.wireframeLinejoin;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;b.morphNormals=this.morphNormals;return b};THREE.MeshDepthMaterial=function(b){THREE.Material.call(this);this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(b)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var b=new THREE.MeshDepthMaterial;THREE.Material.prototype.clone.call(this,b);b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;return b};THREE.MeshNormalMaterial=function(b){THREE.Material.call(this,b);this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(b)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var b=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,b);b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;return b};THREE.MeshFaceMaterial=function(b){this.materials=b instanceof Array?b:[]};THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))};THREE.ParticleBasicMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.vertexColors=!1;this.fog=!0;this.setValues(b)};THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ParticleBasicMaterial.prototype.clone=function(){var b=new THREE.ParticleBasicMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.map=this.map;b.size=this.size;b.sizeAttenuation=this.sizeAttenuation;b.vertexColors=this.vertexColors;b.fog=this.fog;return b};THREE.ParticleCanvasMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.program=function(){};this.setValues(b)};THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ParticleCanvasMaterial.prototype.clone=function(){var b=new THREE.ParticleCanvasMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.program=this.program;return b};THREE.ShaderMaterial=function(b){THREE.Material.call(this);this.vertexShader=this.fragmentShader="void main() {}";this.uniforms={};this.defines={};this.attributes=null;this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(b)};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ShaderMaterial.prototype.clone=function(){var b=new THREE.ShaderMaterial;THREE.Material.prototype.clone.call(this,b);b.fragmentShader=this.fragmentShader;b.vertexShader=this.vertexShader;b.uniforms=THREE.UniformsUtils.clone(this.uniforms);b.attributes=this.attributes;b.defines=this.defines;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.fog=this.fog;b.lights=this.lights;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;b.morphNormals=this.morphNormals;return b};THREE.SpriteMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=new THREE.Texture;this.useScreenCoordinates=!0;this.depthTest=!this.useScreenCoordinates;this.sizeAttenuation=!this.useScreenCoordinates;this.scaleByViewport=!this.sizeAttenuation;this.alignment=THREE.SpriteAlignment.center.clone();this.fog=!1;this.uvOffset=new THREE.Vector2(0,0);this.uvScale=new THREE.Vector2(1,1);this.setValues(b);b=b||{};void 0===b.depthTest&&(this.depthTest=!this.useScreenCoordinates);void 0===b.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates);void 0===b.scaleByViewport&&(this.scaleByViewport=!this.sizeAttenuation)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteMaterial.prototype.clone=function(){var b=new THREE.SpriteMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.map=this.map;b.useScreenCoordinates=this.useScreenCoordinates;b.sizeAttenuation=this.sizeAttenuation;b.scaleByViewport=this.scaleByViewport;b.alignment.copy(this.alignment);b.uvOffset.copy(this.uvOffset);b.uvScale.copy(this.uvScale);b.fog=this.fog;return b};THREE.SpriteAlignment={};THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1);THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1);THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1);THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0);THREE.SpriteAlignment.center=new THREE.Vector2(0,0);THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0);THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1);THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1);THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1);THREE.Texture=function(r,q,p,o,n,m,k,l,j){this.id=THREE.TextureIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.image=r;this.mipmaps=[];this.mapping=void 0!==q?q:new THREE.UVMapping;this.wrapS=void 0!==p?p:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==o?o:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==n?n:THREE.LinearFilter;this.minFilter=void 0!==m?m:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==j?j:1;this.format=void 0!==k?k:THREE.RGBAFormat;this.type=void 0!==l?l:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.needsUpdate=!1;this.onUpdate=null};THREE.Texture.prototype={constructor:THREE.Texture,clone:function(b){void 0===b&&(b=new THREE.Texture);b.image=this.image;b.mipmaps=this.mipmaps.slice(0);b.mapping=this.mapping;b.wrapS=this.wrapS;b.wrapT=this.wrapT;b.magFilter=this.magFilter;b.minFilter=this.minFilter;b.anisotropy=this.anisotropy;b.format=this.format;b.type=this.type;b.offset.copy(this.offset);b.repeat.copy(this.repeat);b.generateMipmaps=this.generateMipmaps;b.premultiplyAlpha=this.premultiplyAlpha;b.flipY=this.flipY;b.unpackAlignment=this.unpackAlignment;return b},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.CompressedTexture=function(v,u,t,s,r,q,o,p,n,m,k){THREE.Texture.call(this,null,q,o,p,n,m,s,r,k);this.image={width:u,height:t};this.mipmaps=v;this.generateMipmaps=!1};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.clone=function(){var b=new THREE.CompressedTexture;THREE.Texture.prototype.clone.call(this,b);return b};THREE.DataTexture=function(v,u,t,s,r,q,o,p,n,m,k){THREE.Texture.call(this,null,q,o,p,n,m,s,r,k);this.image={data:v,width:u,height:t}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.clone=function(){var b=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,b);return b};THREE.Particle=function(b){THREE.Object3D.call(this);this.material=b};THREE.Particle.prototype=Object.create(THREE.Object3D.prototype);THREE.Particle.prototype.clone=function(b){void 0===b&&(b=new THREE.Particle(this.material));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.ParticleSystem=function(d,c){THREE.Object3D.call(this);this.geometry=void 0!==d?d:new THREE.Geometry;this.material=void 0!==c?c:new THREE.ParticleBasicMaterial({color:16777215*Math.random()});this.frustumCulled=this.sortParticles=!1};THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype);THREE.ParticleSystem.prototype.clone=function(b){void 0===b&&(b=new THREE.ParticleSystem(this.geometry,this.material));b.sortParticles=this.sortParticles;THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Line=function(e,d,f){THREE.Object3D.call(this);this.geometry=void 0!==e?e:new THREE.Geometry;this.material=void 0!==d?d:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==f?f:THREE.LineStrip};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.clone=function(b){void 0===b&&(b=new THREE.Line(this.geometry,this.material,this.type));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Mesh=function(d,c){THREE.Object3D.call(this);this.geometry=void 0!==d?d:new THREE.Geometry;this.material=void 0!==c?c:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var d=0,c=this.geometry.morphTargets.length;d<c;d++){this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[d].name]=d}}};THREE.Mesh.prototype.getMorphTargetIndexByName=function(b){if(void 0!==this.morphTargetDictionary[b]){return this.morphTargetDictionary[b]}console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+b+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(b){void 0===b&&(b=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Bone=function(b){THREE.Object3D.call(this);this.skin=b;this.skinMatrix=new THREE.Matrix4};THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(f,e){this.matrixAutoUpdate&&(e|=this.updateMatrix());if(e||this.matrixWorldNeedsUpdate){f?this.skinMatrix.multiplyMatrices(f,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0}var h,g=this.children.length;for(h=0;h<g;h++){this.children[h].update(this.skinMatrix,e)}};THREE.SkinnedMesh=function(h,g,l){THREE.Mesh.call(this,h,g);this.useVertexTexture=void 0!==l?l:!0;this.identityMatrix=new THREE.Matrix4;this.bones=[];this.boneMatrices=[];var k,j,i;if(this.geometry&&void 0!==this.geometry.bones){for(h=0;h<this.geometry.bones.length;h++){l=this.geometry.bones[h],k=l.pos,j=l.rotq,i=l.scl,g=this.addBone(),g.name=l.name,g.position.set(k[0],k[1],k[2]),g.quaternion.set(j[0],j[1],j[2],j[3]),void 0!==i?g.scale.set(i[0],i[1],i[2]):g.scale.set(1,1,1)}for(h=0;h<this.bones.length;h++){l=this.geometry.bones[h],g=this.bones[h],-1===l.parent?this.add(g):this.bones[l.parent].add(g)}h=this.bones.length;this.useVertexTexture?(this.boneTextureHeight=this.boneTextureWidth=h=256<h?64:64<h?32:16<h?16:8,this.boneMatrices=new Float32Array(4*this.boneTextureWidth*this.boneTextureHeight),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*h);this.pose()}};THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.addBone=function(b){void 0===b&&(b=new THREE.Bone(this));this.bones.push(b);return b};THREE.SkinnedMesh.prototype.updateMatrixWorld=function(){var b=new THREE.Matrix4;return function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a){this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1}for(var a=0,f=this.children.length;a<f;a++){var e=this.children[a];e instanceof THREE.Bone?e.update(this.identityMatrix,!1):e.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[];a=0;for(f=this.bones.length;a<f;a++){e=new THREE.Matrix4,e.getInverse(this.bones[a].skinMatrix),this.boneInverses.push(e)}}a=0;for(f=this.bones.length;a<f;a++){b.multiplyMatrices(this.bones[a].skinMatrix,this.boneInverses[a]),b.flattenToArrayOffset(this.boneMatrices,16*a)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}();THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);this.normalizeSkinWeights()};THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry){for(var e=0;e<this.geometry.skinIndices.length;e++){var d=this.geometry.skinWeights[e],f=1/d.lengthManhattan();Infinity!==f?d.multiplyScalar(f):d.set(1)}}};THREE.SkinnedMesh.prototype.clone=function(b){void 0===b&&(b=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture));THREE.Mesh.prototype.clone.call(this,b);return b};THREE.MorphAnimMesh=function(d,c){THREE.Mesh.call(this,d,c);this.duration=1000;this.mirroredLoop=!1;this.currentKeyframe=this.lastKeyframe=this.time=0;this.direction=1;this.directionBackwards=!1;this.setFrameRange(0,this.geometry.morphTargets.length-1)};THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphAnimMesh.prototype.setFrameRange=function(d,c){this.startKeyframe=d;this.endKeyframe=c;this.length=this.endKeyframe-this.startKeyframe+1};THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=!1};THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=!0};THREE.MorphAnimMesh.prototype.parseAnimations=function(){var j=this.geometry;j.animations||(j.animations={});for(var i,p=j.animations,o=/([a-z]+)(\d+)/,n=0,m=j.morphTargets.length;n<m;n++){var k=j.morphTargets[n].name.match(o);if(k&&1<k.length){k=k[1];p[k]||(p[k]={start:Infinity,end:-Infinity});var l=p[k];n<l.start&&(l.start=n);n>l.end&&(l.end=n);i||(i=k)}}j.firstAnimation=i};THREE.MorphAnimMesh.prototype.setAnimationLabel=function(e,d,f){this.geometry.animations||(this.geometry.animations={});this.geometry.animations[e]={start:d,end:f}};THREE.MorphAnimMesh.prototype.playAnimation=function(e,d){var f=this.geometry.animations[e];f?(this.setFrameRange(f.start,f.end),this.duration=1000*((f.end-f.start)/d),this.time=0):console.warn("animation["+e+"] undefined")};THREE.MorphAnimMesh.prototype.updateAnimation=function(d){var c=this.duration/this.length;this.time+=this.direction*d;if(this.mirroredLoop){if(this.time>this.duration||0>this.time){this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time&&(this.time=0,this.directionBackwards=!1)}}else{this.time%=this.duration,0>this.time&&(this.time+=this.duration)}d=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/c),0,this.length-1);d!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[d]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=d);c=this.time%c/c;this.directionBackwards&&(c=1-c);this.morphTargetInfluences[this.currentKeyframe]=c;this.morphTargetInfluences[this.lastKeyframe]=1-c};THREE.MorphAnimMesh.prototype.clone=function(b){void 0===b&&(b=new THREE.MorphAnimMesh(this.geometry,this.material));b.duration=this.duration;b.mirroredLoop=this.mirroredLoop;b.time=this.time;b.lastKeyframe=this.lastKeyframe;b.currentKeyframe=this.currentKeyframe;b.direction=this.direction;b.directionBackwards=this.directionBackwards;THREE.Mesh.prototype.clone.call(this,b);return b};THREE.Ribbon=function(d,c){THREE.Object3D.call(this);this.geometry=d;this.material=c};THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype);THREE.Ribbon.prototype.clone=function(b){void 0===b&&(b=new THREE.Ribbon(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.addLevel=function(e,d){void 0===d&&(d=0);for(var d=Math.abs(d),f=0;f<this.objects.length&&!(d<this.objects[f].distance);f++){}this.objects.splice(f,0,{distance:d,object:e});this.add(e)};THREE.LOD.prototype.getObjectForDistance=function(e){for(var d=1,f=this.objects.length;d<f&&!(e<this.objects[d].distance);d++){}return this.objects[d-1].object};THREE.LOD.prototype.update=function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(f){if(1<this.objects.length){d.getPositionFromMatrix(f.matrixWorld);c.getPositionFromMatrix(this.matrixWorld);f=d.distanceTo(c);this.objects[0].object.visible=!0;for(var b=1,a=this.objects.length;b<a;b++){if(f>=this.objects[b].distance){this.objects[b-1].object.visible=!1,this.objects[b].object.visible=!0}else{break}}for(;b<a;b++){this.objects[b].object.visible=!1}}}}();THREE.LOD.prototype.clone=function(){};THREE.Sprite=function(b){THREE.Object3D.call(this);this.material=void 0!==b?b:new THREE.SpriteMaterial;this.rotation3d=this.rotation;this.rotation=0};THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation,this.rotation3d.order);this.quaternion.setFromEuler(this.rotation3d);this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0};THREE.Sprite.prototype.clone=function(b){void 0===b&&(b=new THREE.Sprite(this.material));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Scene=function(){THREE.Object3D.call(this);this.overrideMaterial=this.fog=null;this.autoUpdate=!0;this.matrixAutoUpdate=!1;this.__objects=[];this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);THREE.Scene.prototype.__addObject=function(d){if(d instanceof THREE.Light){-1===this.__lights.indexOf(d)&&this.__lights.push(d),d.target&&void 0===d.target.parent&&this.add(d.target)}else{if(!(d instanceof THREE.Camera||d instanceof THREE.Bone)&&-1===this.__objects.indexOf(d)){this.__objects.push(d);this.__objectsAdded.push(d);var c=this.__objectsRemoved.indexOf(d);-1!==c&&this.__objectsRemoved.splice(c,1)}}for(c=0;c<d.children.length;c++){this.__addObject(d.children[c])}};THREE.Scene.prototype.__removeObject=function(d){if(d instanceof THREE.Light){var c=this.__lights.indexOf(d);-1!==c&&this.__lights.splice(c,1)}else{d instanceof THREE.Camera||(c=this.__objects.indexOf(d),-1!==c&&(this.__objects.splice(c,1),this.__objectsRemoved.push(d),c=this.__objectsAdded.indexOf(d),-1!==c&&this.__objectsAdded.splice(c,1)))}for(c=0;c<d.children.length;c++){this.__removeObject(d.children[c])}};THREE.Scene.prototype.clone=function(b){void 0===b&&(b=new THREE.Scene);THREE.Object3D.prototype.clone.call(this,b);null!==this.fog&&(b.fog=this.fog.clone());null!==this.overrideMaterial&&(b.overrideMaterial=this.overrideMaterial.clone());b.autoUpdate=this.autoUpdate;b.matrixAutoUpdate=this.matrixAutoUpdate;return b};THREE.Fog=function(e,d,f){this.name="";this.color=new THREE.Color(e);this.near=void 0!==d?d:1;this.far=void 0!==f?f:1000};THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(d,c){this.name="";this.color=new THREE.Color(d);this.density=void 0!==c?c:0.00025};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};THREE.CanvasRenderer=function(aS){function aR(j,i,q){for(var p=0,n=a8.length;p<n;p++){var m=a8[p];ag.copy(m.color);if(m instanceof THREE.DirectionalLight){var k=at.getPositionFromMatrix(m.matrixWorld).normalize(),l=i.dot(k);0>=l||(l*=m.intensity,q.add(ag.multiplyScalar(l)))}else{m instanceof THREE.PointLight&&(k=at.getPositionFromMatrix(m.matrixWorld),l=i.dot(at.subVectors(k,j).normalize()),0>=l||(l*=0==m.distance?1:1-Math.min(j.distanceTo(k)/m.distance,1),0!=l&&(l*=m.intensity,q.add(ag.multiplyScalar(l)))))}}}function aQ(d,k,j,b,i,g,f,h){bf.info.render.vertices+=3;bf.info.render.faces++;aC(h.opacity);aB(h.blending);br=d.positionScreen.x;bo=d.positionScreen.y;bu=k.positionScreen.x;ai=k.positionScreen.y;aZ=j.positionScreen.x;bl=j.positionScreen.y;aO(br,bo,bu,ai,aZ,bl);(h instanceof THREE.MeshLambertMaterial||h instanceof THREE.MeshPhongMaterial)&&null===h.map?(ap.copy(h.color),ah.copy(h.emissive),h.vertexColors===THREE.FaceColors&&ap.multiply(f.color),!1===h.wireframe&&h.shading==THREE.SmoothShading&&3==f.vertexNormalsLength?(bz.copy(aF),aj.copy(aF),aU.copy(aF),aR(f.v1.positionWorld,f.vertexNormalsModel[0],bz),aR(f.v2.positionWorld,f.vertexNormalsModel[1],aj),aR(f.v3.positionWorld,f.vertexNormalsModel[2],aU),bz.multiply(ap).add(ah),aj.multiply(ap).add(ah),aU.multiply(ap).add(ah),af.addColors(aj,aU).multiplyScalar(0.5),bv=aG(bz,aj,aU,af),aH(br,bo,bu,ai,aZ,bl,0,0,1,0,0,1,bv)):(aI.copy(aF),aR(f.centroidModel,f.normalModel,aI),aI.multiply(ap).add(ah),!0===h.wireframe?aL(aI,h.wireframeLinewidth,h.wireframeLinecap,h.wireframeLinejoin):aJ(aI))):h instanceof THREE.MeshBasicMaterial||h instanceof THREE.MeshLambertMaterial||h instanceof THREE.MeshPhongMaterial?null!==h.map?h.map.mapping instanceof THREE.UVMapping&&(by=f.uvs[0],aK(br,bo,bu,ai,aZ,bl,by[b].x,by[b].y,by[i].x,by[i].y,by[g].x,by[g].y,h.map)):null!==h.envMap?h.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(at.copy(f.vertexNormalsModelView[b]),a7=0.5*at.x+0.5,bp=0.5*at.y+0.5,at.copy(f.vertexNormalsModelView[i]),bc=0.5*at.x+0.5,aE=0.5*at.y+0.5,at.copy(f.vertexNormalsModelView[g]),ad=0.5*at.x+0.5,Q=0.5*at.y+0.5,aK(br,bo,bu,ai,aZ,bl,a7,bp,bc,aE,ad,Q,h.envMap)):(aI.copy(h.color),h.vertexColors===THREE.FaceColors&&aI.multiply(f.color),!0===h.wireframe?aL(aI,h.wireframeLinewidth,h.wireframeLinecap,h.wireframeLinejoin):aJ(aI)):h instanceof THREE.MeshDepthMaterial?(P=be.near,o=be.far,bz.r=bz.g=bz.b=1-aq(d.positionScreen.z*d.positionScreen.w,P,o),aj.r=aj.g=aj.b=1-aq(k.positionScreen.z*k.positionScreen.w,P,o),aU.r=aU.g=aU.b=1-aq(j.positionScreen.z*j.positionScreen.w,P,o),af.addColors(aj,aU).multiplyScalar(0.5),bv=aG(bz,aj,aU,af),aH(br,bo,bu,ai,aZ,bl,0,0,1,0,0,1,bv)):h instanceof THREE.MeshNormalMaterial&&(h.shading==THREE.FlatShading?(d=f.normalModelView,aI.setRGB(d.x,d.y,d.z).multiplyScalar(0.5).addScalar(0.5),!0===h.wireframe?aL(aI,h.wireframeLinewidth,h.wireframeLinecap,h.wireframeLinejoin):aJ(aI)):h.shading==THREE.SmoothShading&&(d=f.vertexNormalsModelView[b],bz.setRGB(d.x,d.y,d.z).multiplyScalar(0.5).addScalar(0.5),d=f.vertexNormalsModelView[i],aj.setRGB(d.x,d.y,d.z).multiplyScalar(0.5).addScalar(0.5),d=f.vertexNormalsModelView[g],aU.setRGB(d.x,d.y,d.z).multiplyScalar(0.5).addScalar(0.5),af.addColors(aj,aU).multiplyScalar(0.5),bv=aG(bz,aj,aU,af),aH(br,bo,bu,ai,aZ,bl,0,0,1,0,0,1,bv)))}function aO(h,g,l,k,j,i){ar.beginPath();ar.moveTo(h,g);ar.lineTo(l,k);ar.lineTo(j,i);ar.closePath()}function aM(j,i,q,p,n,m,k,l){ar.beginPath();ar.moveTo(j,i);ar.lineTo(q,p);ar.lineTo(n,m);ar.lineTo(k,l);ar.closePath()}function aL(f,e,h,g){aA(e);aw(h);az(g);ay(f.getStyle());ar.stroke();ao.expandByScalar(2*e)}function aJ(b){ax(b.getStyle());ar.fill()}function aK(O,N,L,K,J,I,H,D,G,F,B,C,A){if(!(A instanceof THREE.DataTexture||void 0===A.image||0==A.image.width)){if(!0===A.needsUpdate){var u=A.wrapS==THREE.RepeatWrapping,s=A.wrapT==THREE.RepeatWrapping;aP[A.id]=ar.createPattern(A.image,!0===u&&!0===s?"repeat":!0===u&&!1===s?"repeat-x":!1===u&&!0===s?"repeat-y":"no-repeat");A.needsUpdate=!1}void 0===aP[A.id]?ax("rgba(0,0,0,1)"):ax(aP[A.id]);var u=A.offset.x/A.repeat.x,s=A.offset.y/A.repeat.y,h=A.image.width*A.repeat.x,T=A.image.height*A.repeat.y,H=(H+u)*h,D=(1-D+s)*T,L=L-O,K=K-N,J=J-O,I=I-N,G=(G+u)*h-H,F=(1-F+s)*T-D,B=(B+u)*h-H,C=(1-C+s)*T-D,u=G*C-B*F;0===u?(void 0===bt[A.id]&&(N=document.createElement("canvas"),N.width=A.image.width,N.height=A.image.height,N=N.getContext("2d"),N.drawImage(A.image,0,0),bt[A.id]=N.getImageData(0,0,A.image.width,A.image.height).data),N=bt[A.id],H=4*(Math.floor(H)+Math.floor(D)*A.image.width),aI.setRGB(N[H]/255,N[H+1]/255,N[H+2]/255),aJ(aI)):(u=1/u,A=(C*L-F*J)*u,F=(C*K-F*I)*u,L=(G*J-B*L)*u,K=(G*I-B*K)*u,O=O-A*H-L*D,H=N-F*H-K*D,ar.save(),ar.transform(A,F,L,K,O,H),ar.fill(),ar.restore())}}function aH(K,J,I,H,G,F,C,D,u,B,A,s,t){var r,q;r=t.width-1;q=t.height-1;C*=r;D*=q;I-=K;H-=J;G-=K;F-=J;u=u*r-C;B=B*q-D;A=A*r-C;s=s*q-D;q=1/(u*s-A*B);r=(s*I-B*G)*q;B=(s*H-B*F)*q;I=(u*G-A*I)*q;H=(u*F-A*H)*q;K=K-r*C-I*D;J=J-B*C-H*D;ar.save();ar.transform(r,B,I,H,K,J);ar.clip();ar.drawImage(t,0,0);ar.restore()}function aG(f,e,h,g){an[0]=255*f.r|0;an[1]=255*f.g|0;an[2]=255*f.b|0;an[4]=255*e.r|0;an[5]=255*e.g|0;an[6]=255*e.b|0;an[8]=255*h.r|0;an[9]=255*h.g|0;an[10]=255*h.b|0;an[12]=255*g.r|0;an[13]=255*g.g|0;an[14]=255*g.b|0;bm.putImageData(al,0,0);Y.drawImage(bw,0,0);return v}function aD(h,g,l){var k=g.x-h.x,j=g.y-h.y,i=k*k+j*j;0!==i&&(l/=Math.sqrt(i),k*=l,j*=l,g.x+=k,g.y+=j,h.x-=k,h.y-=j)}function aC(b){aW!==b&&(aW=ar.globalAlpha=b)}function aB(b){a3!==b&&(b===THREE.NormalBlending?ar.globalCompositeOperation="source-over":b===THREE.AdditiveBlending?ar.globalCompositeOperation="lighter":b===THREE.SubtractiveBlending&&(ar.globalCompositeOperation="darker"),a3=b)}function aA(b){bj!==b&&(bj=ar.lineWidth=b)}function aw(b){a0!==b&&(a0=ar.lineCap=b)}function az(b){U!==b&&(U=ar.lineJoin=b)}function ay(b){am!==b&&(am=ar.strokeStyle=b)}function ax(b){aV!==b&&(aV=ar.fillStyle=b)}function av(d,c){if(W!==d||ae!==c){ar.setLineDash([d,c]),W=d,ae=c}}console.log("THREE.CanvasRenderer",THREE.REVISION);var aq=THREE.Math.smoothstep,aS=aS||{},bf=this,bb,a9,a8,ba=new THREE.Projector,bh=void 0!==aS.canvas?aS.canvas:document.createElement("canvas"),a4,bg,a5,a1,ar=bh.getContext("2d"),a2=new THREE.Color(0),au=0,aW=1,a3=0,am=null,aV=null,bj=null,a0=null,U=null,W=null,ae=0,be,aY,S,ac,R,ak=new THREE.RenderableVertex,aT=new THREE.RenderableVertex,br,bo,bu,ai,aZ,bl,bd,a6,aX,E,bk,bx,aI=new THREE.Color,bz=new THREE.Color,aj=new THREE.Color,aU=new THREE.Color,af=new THREE.Color,ap=new THREE.Color,ah=new THREE.Color,ag=new THREE.Color,aP={},bt={},P,o,bv,by,a7,bp,bc,aE,ad,Q,bs=new THREE.Box2,aN=new THREE.Box2,ao=new THREE.Box2,aF=new THREE.Color,bq=new THREE.Color,bi=new THREE.Color,at=new THREE.Vector3,bw,bm,al,an,v,Y,bn=16;bw=document.createElement("canvas");bw.width=bw.height=2;bm=bw.getContext("2d");bm.fillStyle="rgba(0,0,0,1)";bm.fillRect(0,0,2,2);al=bm.getImageData(0,0,2,2);an=al.data;v=document.createElement("canvas");v.width=v.height=bn;Y=v.getContext("2d");Y.translate(-bn/2,-bn/2);Y.scale(bn,bn);bn--;void 0===ar.setLineDash&&(ar.setLineDash=void 0!==ar.mozDash?function(b){ar.mozDash=null!==b[0]?b:null}:function(){});this.domElement=bh;this.devicePixelRatio=void 0!==aS.devicePixelRatio?aS.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.setSize=function(e,d,f){a4=e*this.devicePixelRatio;bg=d*this.devicePixelRatio;a5=Math.floor(a4/2);a1=Math.floor(bg/2);bh.width=a4;bh.height=bg;1!==this.devicePixelRatio&&!1!==f&&(bh.style.width=e+"px",bh.style.height=d+"px");bs.set(new THREE.Vector2(-a5,-a1),new THREE.Vector2(a5,a1));aN.set(new THREE.Vector2(-a5,-a1),new THREE.Vector2(a5,a1));aW=1;a3=0;U=a0=bj=aV=am=null};this.setClearColor=function(d,c){a2.set(d);au=void 0!==c?c:1;aN.set(new THREE.Vector2(-a5,-a1),new THREE.Vector2(a5,a1))};this.setClearColorHex=function(d,c){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(d,c)};this.getMaxAnisotropy=function(){return 0};this.clear=function(){ar.setTransform(1,0,0,-1,a5,a1);!1===aN.empty()&&(aN.intersect(bs),aN.expandByScalar(2),1>au&&ar.clearRect(aN.min.x|0,aN.min.y|0,aN.max.x-aN.min.x|0,aN.max.y-aN.min.y|0),0<au&&(aB(THREE.NormalBlending),aC(1),ax("rgba("+Math.floor(255*a2.r)+","+Math.floor(255*a2.g)+","+Math.floor(255*a2.b)+","+au+")"),ar.fillRect(aN.min.x|0,aN.min.y|0,aN.max.x-aN.min.x|0,aN.max.y-aN.min.y|0)),aN.makeEmpty())};this.render=function(q,m){if(!1===m instanceof THREE.Camera){console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.")}else{!0===this.autoClear&&this.clear();ar.setTransform(1,0,0,-1,a5,a1);bf.info.render.vertices=0;bf.info.render.faces=0;bb=ba.projectScene(q,m,this.sortObjects,this.sortElements);a9=bb.elements;a8=bb.lights;be=m;aF.setRGB(0,0,0);bq.setRGB(0,0,0);bi.setRGB(0,0,0);for(var i=0,d=a8.length;i<d;i++){var s=a8[i],b=s.color;s instanceof THREE.AmbientLight?aF.add(b):s instanceof THREE.DirectionalLight?bq.add(b):s instanceof THREE.PointLight&&bi.add(b)}i=0;for(d=a9.length;i<d;i++){var h=a9[i],s=h.material;if(!(void 0===s||!1===s.visible)){ao.makeEmpty();if(h instanceof THREE.RenderableParticle){aY=h;aY.x*=a5;aY.y*=a1;b=aY;aC(s.opacity);aB(s.blending);var r=void 0,l=void 0,p=void 0,f=void 0,j=void 0,t=void 0,n=void 0;s instanceof THREE.ParticleBasicMaterial?null===s.map?(p=h.object.scale.x,f=h.object.scale.y,p*=h.scale.x*a5,f*=h.scale.y*a1,ao.min.set(b.x-p,b.y-f),ao.max.set(b.x+p,b.y+f),!1===bs.isIntersectionBox(ao)?ao.makeEmpty():(ax(s.color.getStyle()),ar.save(),ar.translate(b.x,b.y),ar.rotate(-h.rotation),ar.scale(p,f),ar.fillRect(-1,-1,2,2),ar.restore())):(j=s.map.image,t=j.width>>1,n=j.height>>1,p=h.scale.x*a5,f=h.scale.y*a1,r=p*t,l=f*n,ao.min.set(b.x-r,b.y-l),ao.max.set(b.x+r,b.y+l),!1===bs.isIntersectionBox(ao)?ao.makeEmpty():(ar.save(),ar.translate(b.x,b.y),ar.rotate(-h.rotation),ar.scale(p,-f),ar.translate(-t,-n),ar.drawImage(j,0,0),ar.restore())):s instanceof THREE.ParticleCanvasMaterial&&(r=h.scale.x*a5,l=h.scale.y*a1,ao.min.set(b.x-r,b.y-l),ao.max.set(b.x+r,b.y+l),!1===bs.isIntersectionBox(ao)?ao.makeEmpty():(ay(s.color.getStyle()),ax(s.color.getStyle()),ar.save(),ar.translate(b.x,b.y),ar.rotate(-h.rotation),ar.scale(r,l),s.program(ar),ar.restore()))}else{if(h instanceof THREE.RenderableLine){if(aY=h.v1,S=h.v2,aY.positionScreen.x*=a5,aY.positionScreen.y*=a1,S.positionScreen.x*=a5,S.positionScreen.y*=a1,ao.setFromPoints([aY.positionScreen,S.positionScreen]),!0===bs.isIntersectionBox(ao)){if(b=aY,r=S,aC(s.opacity),aB(s.blending),ar.beginPath(),ar.moveTo(b.positionScreen.x,b.positionScreen.y),ar.lineTo(r.positionScreen.x,r.positionScreen.y),s instanceof THREE.LineBasicMaterial){aA(s.linewidth);aw(s.linecap);az(s.linejoin);if(s.vertexColors!==THREE.VertexColors){ay(s.color.getStyle())}else{if(l=h.vertexColors[0].getStyle(),h=h.vertexColors[1].getStyle(),l===h){ay(l)}else{try{var e=ar.createLinearGradient(b.positionScreen.x,b.positionScreen.y,r.positionScreen.x,r.positionScreen.y);e.addColorStop(0,l);e.addColorStop(1,h)}catch(c){e=l}ay(e)}}ar.stroke();ao.expandByScalar(2*s.linewidth)}else{s instanceof THREE.LineDashedMaterial&&(aA(s.linewidth),aw(s.linecap),az(s.linejoin),ay(s.color.getStyle()),av(s.dashSize,s.gapSize),ar.stroke(),ao.expandByScalar(2*s.linewidth),av(null,null))}}}else{if(h instanceof THREE.RenderableFace3){aY=h.v1;S=h.v2;ac=h.v3;if(-1>aY.positionScreen.z||1<aY.positionScreen.z){continue}if(-1>S.positionScreen.z||1<S.positionScreen.z){continue}if(-1>ac.positionScreen.z||1<ac.positionScreen.z){continue}aY.positionScreen.x*=a5;aY.positionScreen.y*=a1;S.positionScreen.x*=a5;S.positionScreen.y*=a1;ac.positionScreen.x*=a5;ac.positionScreen.y*=a1;0<s.overdraw&&(aD(aY.positionScreen,S.positionScreen,s.overdraw),aD(S.positionScreen,ac.positionScreen,s.overdraw),aD(ac.positionScreen,aY.positionScreen,s.overdraw));ao.setFromPoints([aY.positionScreen,S.positionScreen,ac.positionScreen]);!0===bs.isIntersectionBox(ao)&&aQ(aY,S,ac,0,1,2,h,s)}else{if(h instanceof THREE.RenderableFace4){aY=h.v1;S=h.v2;ac=h.v3;R=h.v4;if(-1>aY.positionScreen.z||1<aY.positionScreen.z){continue}if(-1>S.positionScreen.z||1<S.positionScreen.z){continue}if(-1>ac.positionScreen.z||1<ac.positionScreen.z){continue}if(-1>R.positionScreen.z||1<R.positionScreen.z){continue}aY.positionScreen.x*=a5;aY.positionScreen.y*=a1;S.positionScreen.x*=a5;S.positionScreen.y*=a1;ac.positionScreen.x*=a5;ac.positionScreen.y*=a1;R.positionScreen.x*=a5;R.positionScreen.y*=a1;ak.positionScreen.copy(S.positionScreen);aT.positionScreen.copy(R.positionScreen);0<s.overdraw&&(aD(aY.positionScreen,S.positionScreen,s.overdraw),aD(S.positionScreen,R.positionScreen,s.overdraw),aD(R.positionScreen,aY.positionScreen,s.overdraw),aD(ac.positionScreen,ak.positionScreen,s.overdraw),aD(ac.positionScreen,aT.positionScreen,s.overdraw));ao.setFromPoints([aY.positionScreen,S.positionScreen,ac.positionScreen,R.positionScreen]);!0===bs.isIntersectionBox(ao)&&(b=aY,r=S,l=ac,p=R,f=ak,j=aT,bf.info.render.vertices+=4,bf.info.render.faces++,aC(s.opacity),aB(s.blending),void 0!==s.map&&null!==s.map||void 0!==s.envMap&&null!==s.envMap?(aQ(b,r,p,0,1,3,h,s),aQ(f,l,j,1,2,3,h,s)):(br=b.positionScreen.x,bo=b.positionScreen.y,bu=r.positionScreen.x,ai=r.positionScreen.y,aZ=l.positionScreen.x,bl=l.positionScreen.y,bd=p.positionScreen.x,a6=p.positionScreen.y,aX=f.positionScreen.x,E=f.positionScreen.y,bk=j.positionScreen.x,bx=j.positionScreen.y,s instanceof THREE.MeshLambertMaterial||s instanceof THREE.MeshPhongMaterial?(ap.copy(s.color),ah.copy(s.emissive),s.vertexColors===THREE.FaceColors&&ap.multiply(h.color),!1===s.wireframe&&s.shading==THREE.SmoothShading&&4==h.vertexNormalsLength?(bz.copy(aF),aj.copy(aF),aU.copy(aF),af.copy(aF),aR(h.v1.positionWorld,h.vertexNormalsModel[0],bz),aR(h.v2.positionWorld,h.vertexNormalsModel[1],aj),aR(h.v4.positionWorld,h.vertexNormalsModel[3],aU),aR(h.v3.positionWorld,h.vertexNormalsModel[2],af),bz.multiply(ap).add(ah),aj.multiply(ap).add(ah),aU.multiply(ap).add(ah),af.multiply(ap).add(ah),bv=aG(bz,aj,aU,af),aO(br,bo,bu,ai,bd,a6),aH(br,bo,bu,ai,bd,a6,0,0,1,0,0,1,bv),aO(aX,E,aZ,bl,bk,bx),aH(aX,E,aZ,bl,bk,bx,1,0,1,1,0,1,bv)):(aI.copy(aF),aR(h.centroidModel,h.normalModel,aI),aI.multiply(ap).add(ah),aM(br,bo,bu,ai,aZ,bl,bd,a6),!0===s.wireframe?aL(aI,s.wireframeLinewidth,s.wireframeLinecap,s.wireframeLinejoin):aJ(aI))):s instanceof THREE.MeshBasicMaterial?(aI.copy(s.color),s.vertexColors===THREE.FaceColors&&aI.multiply(h.color),aM(br,bo,bu,ai,aZ,bl,bd,a6),!0===s.wireframe?aL(aI,s.wireframeLinewidth,s.wireframeLinecap,s.wireframeLinejoin):aJ(aI)):s instanceof THREE.MeshNormalMaterial?(b=void 0,s.shading==THREE.FlatShading?(b=h.normalModelView,aI.setRGB(b.x,b.y,b.z).multiplyScalar(0.5).addScalar(0.5),aM(br,bo,bu,ai,aZ,bl,bd,a6),!0===s.wireframe?aL(aI,s.wireframeLinewidth,s.wireframeLinecap,s.wireframeLinejoin):aJ(aI)):s.shading==THREE.SmoothShading&&(b=h.vertexNormalsModelView[0],bz.setRGB(b.x,b.y,b.z).multiplyScalar(0.5).addScalar(0.5),b=h.vertexNormalsModelView[1],aj.setRGB(b.x,b.y,b.z).multiplyScalar(0.5).addScalar(0.5),b=h.vertexNormalsModelView[3],aU.setRGB(b.x,b.y,b.z).multiplyScalar(0.5).addScalar(0.5),b=h.vertexNormalsModelView[2],af.setRGB(b.x,b.y,b.z).multiplyScalar(0.5).addScalar(0.5),bv=aG(bz,aj,aU,af),aO(br,bo,bu,ai,bd,a6),aH(br,bo,bu,ai,bd,a6,0,0,1,0,0,1,bv),aO(aX,E,aZ,bl,bk,bx),aH(aX,E,aZ,bl,bk,bx,1,0,1,1,0,1,bv))):s instanceof THREE.MeshDepthMaterial&&(P=be.near,o=be.far,bz.r=bz.g=bz.b=1-aq(b.positionScreen.z*b.positionScreen.w,P,o),aj.r=aj.g=aj.b=1-aq(r.positionScreen.z*r.positionScreen.w,P,o),aU.r=aU.g=aU.b=1-aq(p.positionScreen.z*p.positionScreen.w,P,o),af.r=af.g=af.b=1-aq(l.positionScreen.z*l.positionScreen.w,P,o),bv=aG(bz,aj,aU,af),aO(br,bo,bu,ai,bd,a6),aH(br,bo,bu,ai,bd,a6,0,0,1,0,0,1,bv),aO(aX,E,aZ,bl,bk,bx),aH(aX,E,aZ,bl,bk,bx,1,0,1,1,0,1,bv))))}}}}aN.union(ao)}}ar.setTransform(1,0,0,1,0,0)}}};THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif",envmap_pars_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif",envmap_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif",map_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",lights_phong_pars_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif",lights_phong_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, N_BONE_PIXEL_X );\nfloat y = floor( j / N_BONE_PIXEL_X );\nconst float dx = 1.0 / N_BONE_PIXEL_X;\nconst float dy = 1.0 / N_BONE_PIXEL_Y;\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif",skinbase_vertex:"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif",default_vertex:"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix \t+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif",defaultnormal_vertex:"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"};THREE.UniformsUtils={merge:function(g){var f,j,i,h={};for(f=0;f<g.length;f++){for(j in i=this.clone(g[f]),i){h[j]=i[j]}}return h},clone:function(g){var f,j,i,h={};for(f in g){for(j in h[f]={},g[f]){i=g[f][j],h[f][j]=i instanceof THREE.Color||i instanceof THREE.Vector2||i instanceof THREE.Vector3||i instanceof THREE.Vector4||i instanceof THREE.Matrix4||i instanceof THREE.Texture?i.clone():i instanceof Array?i.slice():i}}return h}};THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:0.00025},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2000},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:0.00025},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2000},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2000},opacity:{type:"f",value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:0.98},uReflectivity:{type:"f",value:0.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float uRefractionRatio;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += uDiffuseColor * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, uRefractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};THREE.WebGLRenderer=function(aV){function aT(d){if(d.__webglCustomAttributesList){for(var c in d.__webglCustomAttributesList){aG.deleteBuffer(d.__webglCustomAttributesList[c].buffer)}}}function aS(i,g){var n=i.vertices.length,m=g.material;if(m.attributes){void 0===i.__webglCustomAttributesList&&(i.__webglCustomAttributesList=[]);for(var l in m.attributes){var k=m.attributes[l];if(!k.__webglInitialized||k.createUniqueBuffers){k.__webglInitialized=!0;var j=1;"v2"===k.type?j=2:"v3"===k.type?j=3:"v4"===k.type?j=4:"c"===k.type&&(j=3);k.size=j;k.array=new Float32Array(n*j);k.buffer=aG.createBuffer();k.buffer.belongsToAttribute=l;k.needsUpdate=!0}i.__webglCustomAttributesList.push(k)}}}function aQ(D,C){var B=C.geometry,A=D.faces3,u=D.faces4,t=3*A.length+4*u.length,s=1*A.length+2*u.length,u=3*A.length+4*u.length,A=aO(C,D),k=aL(A),r=aN(A),h=A.vertexColors?A.vertexColors:!1;D.__vertexArray=new Float32Array(3*t);r&&(D.__normalArray=new Float32Array(3*t));B.hasTangents&&(D.__tangentArray=new Float32Array(4*t));h&&(D.__colorArray=new Float32Array(3*t));if(k){if(0<B.faceUvs.length||0<B.faceVertexUvs.length){D.__uvArray=new Float32Array(2*t)}if(1<B.faceUvs.length||1<B.faceVertexUvs.length){D.__uv2Array=new Float32Array(2*t)}}C.geometry.skinWeights.length&&C.geometry.skinIndices.length&&(D.__skinIndexArray=new Float32Array(4*t),D.__skinWeightArray=new Float32Array(4*t));D.__faceArray=new Uint16Array(3*s);D.__lineArray=new Uint16Array(2*u);if(D.numMorphTargets){D.__morphTargetsArrays=[];B=0;for(k=D.numMorphTargets;B<k;B++){D.__morphTargetsArrays.push(new Float32Array(3*t))}}if(D.numMorphNormals){D.__morphNormalsArrays=[];B=0;for(k=D.numMorphNormals;B<k;B++){D.__morphNormalsArrays.push(new Float32Array(3*t))}}D.__webglFaceCount=3*s;D.__webglLineCount=2*u;if(A.attributes){void 0===D.__webglCustomAttributesList&&(D.__webglCustomAttributesList=[]);for(var f in A.attributes){var s=A.attributes[f],B={},e;for(e in s){B[e]=s[e]}if(!B.__webglInitialized||B.createUniqueBuffers){B.__webglInitialized=!0,u=1,"v2"===B.type?u=2:"v3"===B.type?u=3:"v4"===B.type?u=4:"c"===B.type&&(u=3),B.size=u,B.array=new Float32Array(t*u),B.buffer=aG.createBuffer(),B.buffer.belongsToAttribute=f,s.needsUpdate=!0,B.__original=s}D.__webglCustomAttributesList.push(B)}}D.__inittedArrays=!0}function aO(d,c){return d.material instanceof THREE.MeshFaceMaterial?d.material.materials[c.materialIndex]:d.material}function aN(b){return b instanceof THREE.MeshBasicMaterial&&!b.envMap||b instanceof THREE.MeshDepthMaterial?!1:b&&void 0!==b.shading&&b.shading===THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function aL(b){return b.map||b.lightMap||b.bumpMap||b.normalMap||b.specularMap||b instanceof THREE.ShaderMaterial?!0:!1}function aM(b){by[b]||(aG.enableVertexAttribArray(b),by[b]=!0)}function aJ(){for(var b in by){by[b]&&(aG.disableVertexAttribArray(b),by[b]=!1)}}function aI(d,c){return d.z!==c.z?c.z-d.z:d.id-c.id}function aF(d,c){return c[0]-d[0]}function aE(g,f,j){if(g.length){for(var i=0,h=g.length;i<h;i++){bw=ad=null,al=aW=a2=aj=bn=E=bo=-1,bu=!0,g[i].render(f,j,ah,aR),bw=ad=null,al=aW=a2=aj=bn=E=bo=-1,bu=!0}}}function aD(G,F,D,C,B,A,t,u){var q,s,r,n;F?(s=G.length-1,n=F=-1):(s=0,F=G.length,n=1);for(var p=s;p!==F;p+=n){if(q=G[p],q.render){s=q.object;r=q.buffer;if(u){q=u}else{q=q[D];if(!q){continue}t&&bh.setBlending(q.blending,q.blendEquation,q.blendSrc,q.blendDst);bh.setDepthTest(q.depthTest);bh.setDepthWrite(q.depthWrite);a7(q.polygonOffset,q.polygonOffsetFactor,q.polygonOffsetUnits)}bh.setMaterialFaces(q);r instanceof THREE.BufferGeometry?bh.renderBufferDirect(C,B,A,q,r,s):bh.renderBuffer(C,B,A,q,r,s)}}}function aC(D,C,B,A,u,t,r,s){for(var n,q,p=0,l=D.length;p<l;p++){if(n=D[p],q=n.object,q.visible&&(void 0==s||0!=(s&q.renderBitmask))){if(r){n=r}else{n=n[C];if(!n){continue}t&&bh.setBlending(n.blending,n.blendEquation,n.blendSrc,n.blendDst);bh.setDepthTest(n.depthTest);bh.setDepthWrite(n.depthWrite);a7(n.polygonOffset,n.polygonOffsetFactor,n.polygonOffsetUnits)}bh.renderImmediateObject(B,A,u,n,q)}}}function ay(J,I){var H,G,D,F;if(void 0===J.__webglInit&&(J.__webglInit=!0,J._modelViewMatrix=new THREE.Matrix4,J._normalMatrix=new THREE.Matrix3,void 0!==J.geometry&&void 0===J.geometry.__webglInit&&(J.geometry.__webglInit=!0,J.geometry.addEventListener("dispose",bA)),G=J.geometry,void 0!==G)){if(G instanceof THREE.BufferGeometry){var C,B;for(C in G.attributes){B="index"===C?aG.ELEMENT_ARRAY_BUFFER:aG.ARRAY_BUFFER,F=G.attributes[C],void 0===F.numItems&&(F.numItems=F.array.length),F.buffer=aG.createBuffer(),aG.bindBuffer(B,F.buffer),aG.bufferData(B,F.array,aG.STATIC_DRAW)}}else{if(J instanceof THREE.Mesh){D=J.material;if(void 0===G.geometryGroups){C=G;var q,A,k,d,c;B={};var N=C.morphTargets.length,L=C.morphNormals.length,K=D instanceof THREE.MeshFaceMaterial;C.geometryGroups={};D=0;for(q=C.faces.length;D<q;D++){A=C.faces[D],k=K?A.materialIndex:0,void 0===B[k]&&(B[k]={hash:k,counter:0}),c=B[k].hash+"_"+B[k].counter,void 0===C.geometryGroups[c]&&(C.geometryGroups[c]={faces3:[],faces4:[],materialIndex:k,vertices:0,numMorphTargets:N,numMorphNormals:L}),d=A instanceof THREE.Face3?3:4,65535<C.geometryGroups[c].vertices+d&&(B[k].counter+=1,c=B[k].hash+"_"+B[k].counter,void 0===C.geometryGroups[c]&&(C.geometryGroups[c]={faces3:[],faces4:[],materialIndex:k,vertices:0,numMorphTargets:N,numMorphNormals:L})),A instanceof THREE.Face3?C.geometryGroups[c].faces3.push(D):C.geometryGroups[c].faces4.push(D),C.geometryGroups[c].vertices+=d}C.geometryGroupsList=[];for(F in C.geometryGroups){C.geometryGroups[F].id=bt++,C.geometryGroupsList.push(C.geometryGroups[F])}}for(H in G.geometryGroups){if(F=G.geometryGroups[H],!F.__webglVertexBuffer){C=F;C.__webglVertexBuffer=aG.createBuffer();C.__webglNormalBuffer=aG.createBuffer();C.__webglTangentBuffer=aG.createBuffer();C.__webglColorBuffer=aG.createBuffer();C.__webglUVBuffer=aG.createBuffer();C.__webglUV2Buffer=aG.createBuffer();C.__webglSkinIndicesBuffer=aG.createBuffer();C.__webglSkinWeightsBuffer=aG.createBuffer();C.__webglFaceBuffer=aG.createBuffer();C.__webglLineBuffer=aG.createBuffer();N=B=void 0;if(C.numMorphTargets){C.__webglMorphTargetsBuffers=[];B=0;for(N=C.numMorphTargets;B<N;B++){C.__webglMorphTargetsBuffers.push(aG.createBuffer())}}if(C.numMorphNormals){C.__webglMorphNormalsBuffers=[];B=0;for(N=C.numMorphNormals;B<N;B++){C.__webglMorphNormalsBuffers.push(aG.createBuffer())}}bh.info.memory.geometries++;aQ(F,J);G.verticesNeedUpdate=!0;G.morphTargetsNeedUpdate=!0;G.elementsNeedUpdate=!0;G.uvsNeedUpdate=!0;G.normalsNeedUpdate=!0;G.tangentsNeedUpdate=!0;G.colorsNeedUpdate=!0}}}else{J instanceof THREE.Ribbon?G.__webglVertexBuffer||(F=G,F.__webglVertexBuffer=aG.createBuffer(),F.__webglColorBuffer=aG.createBuffer(),F.__webglNormalBuffer=aG.createBuffer(),bh.info.memory.geometries++,F=G,C=F.vertices.length,F.__vertexArray=new Float32Array(3*C),F.__colorArray=new Float32Array(3*C),F.__normalArray=new Float32Array(3*C),F.__webglVertexCount=C,aS(F,J),G.verticesNeedUpdate=!0,G.colorsNeedUpdate=!0,G.normalsNeedUpdate=!0):J instanceof THREE.Line?G.__webglVertexBuffer||(F=G,F.__webglVertexBuffer=aG.createBuffer(),F.__webglColorBuffer=aG.createBuffer(),F.__webglLineDistanceBuffer=aG.createBuffer(),bh.info.memory.geometries++,F=G,C=F.vertices.length,F.__vertexArray=new Float32Array(3*C),F.__colorArray=new Float32Array(3*C),F.__lineDistanceArray=new Float32Array(1*C),F.__webglLineCount=C,aS(F,J),G.verticesNeedUpdate=!0,G.colorsNeedUpdate=!0,G.lineDistancesNeedUpdate=!0):J instanceof THREE.ParticleSystem&&!G.__webglVertexBuffer&&(F=G,F.__webglVertexBuffer=aG.createBuffer(),F.__webglColorBuffer=aG.createBuffer(),bh.info.memory.geometries++,F=G,C=F.vertices.length,F.__vertexArray=new Float32Array(3*C),F.__colorArray=new Float32Array(3*C),F.__sortArray=[],F.__webglParticleCount=C,aS(F,J),G.verticesNeedUpdate=!0,G.colorsNeedUpdate=!0)}}}if(void 0===J.__webglActive){if(J instanceof THREE.Mesh){if(G=J.geometry,G instanceof THREE.BufferGeometry){aB(I.__webglObjects,G,J)}else{if(G instanceof THREE.Geometry){for(H in G.geometryGroups){F=G.geometryGroups[H],aB(I.__webglObjects,F,J)}}}}else{J instanceof THREE.Ribbon||J instanceof THREE.Line||J instanceof THREE.ParticleSystem?(G=J.geometry,aB(I.__webglObjects,G,J)):J instanceof THREE.ImmediateRenderObject||J.immediateRenderCallback?I.__webglObjectsImmediate.push({id:null,object:J,opaque:null,transparent:null,z:0}):J instanceof THREE.Sprite?I.__webglSprites.push(J):J instanceof THREE.LensFlare&&I.__webglFlares.push(J)}J.__webglActive=!0}}function aB(e,d,f){e.push({id:null,buffer:d,object:f,opaque:null,transparent:null,z:0})}function aA(d){for(var c in d.attributes){if(d.attributes[c].needsUpdate){return !0}}return !1}function az(d){for(var c in d.attributes){d.attributes[c].needsUpdate=!1}}function ax(d,c){d instanceof THREE.Mesh||d instanceof THREE.ParticleSystem||d instanceof THREE.Ribbon||d instanceof THREE.Line?at(c.__webglObjects,d):d instanceof THREE.Sprite?bi(c.__webglSprites,d):d instanceof THREE.LensFlare?bi(c.__webglFlares,d):(d instanceof THREE.ImmediateRenderObject||d.immediateRenderCallback)&&at(c.__webglObjectsImmediate,d);delete d.__webglActive}function at(e,d){for(var f=e.length-1;0<=f;f--){e[f].object===d&&e.splice(f,1)}}function bi(e,d){for(var f=e.length-1;0<=f;f--){e[f]===d&&e.splice(f,1)}}function be(cb,ca,b9,b8,b7){bz=0;b8.needsUpdate&&(b8.program&&ap(b8),bh.initMaterial(b8,ca,b9,b7),b8.needsUpdate=!1);b8.morphTargets&&!b7.__webglMorphTargetInfluences&&(b7.__webglMorphTargetInfluences=new Float32Array(bh.maxMorphTargets));var b6=!1,b5=b8.program,b4=b5.uniforms,b3=b8.uniforms;b5!==ad&&(aG.useProgram(b5),ad=b5,b6=!0);b8.id!==al&&(al=b8.id,b6=!0);if(b6||cb!==bw){aG.uniformMatrix4fv(b4.projectionMatrix,!1,cb.projectionMatrix.elements),cb!==bw&&(bw=cb)}if(b8.skinning){if(bq&&b7.useVertexTexture){if(null!==b4.boneTexture){var b2=bc();aG.uniform1i(b4.boneTexture,b2);bh.setTexture(b7.boneTexture,b2)}}else{null!==b4.boneGlobalMatrices&&aG.uniformMatrix4fv(b4.boneGlobalMatrices,!1,b7.boneMatrices)}}if(b6){b9&&b8.fog&&(b3.fogColor.value=b9.color,b9 instanceof THREE.Fog?(b3.fogNear.value=b9.near,b3.fogFar.value=b9.far):b9 instanceof THREE.FogExp2&&(b3.fogDensity.value=b9.density));if(b8 instanceof THREE.MeshPhongMaterial||b8 instanceof THREE.MeshLambertMaterial||b8.lights){if(bu){for(var b0,b1=b2=0,bZ=0,bY,bX,bW,bV=bf,bU=bV.directional.colors,bT=bV.directional.positions,bR=bV.point.colors,bS=bV.point.positions,bO=bV.point.distances,bN=bV.spot.colors,bK=bV.spot.positions,bM=bV.spot.distances,bL=bV.spot.directions,bJ=bV.spot.anglesCos,bH=bV.spot.exponents,G=bV.hemi.skyColors,bI=bV.hemi.groundColors,bG=bV.hemi.positions,ab=0,k=0,H=0,bP=0,bQ=0,N=0,I=0,Z=0,cc=b0=0,b9=bW=cc=0,b6=ca.length;b9<b6;b9++){b0=ca[b9],b0.onlyShadow||(bY=b0.color,bX=b0.intensity,bW=b0.distance,b0 instanceof THREE.AmbientLight?b0.visible&&(bh.gammaInput?(b2+=bY.r*bY.r,b1+=bY.g*bY.g,bZ+=bY.b*bY.b):(b2+=bY.r,b1+=bY.g,bZ+=bY.b)):b0 instanceof THREE.DirectionalLight?(bQ+=1,b0.visible&&(ba.getPositionFromMatrix(b0.matrixWorld),bE.getPositionFromMatrix(b0.target.matrixWorld),ba.sub(bE),ba.normalize(),0===ba.x&&0===ba.y&&0===ba.z||(b0=3*ab,bT[b0]=ba.x,bT[b0+1]=ba.y,bT[b0+2]=ba.z,bh.gammaInput?bb(bU,b0,bY,bX*bX):bd(bU,b0,bY,bX),ab+=1))):b0 instanceof THREE.PointLight?(N+=1,b0.visible&&(cc=3*k,bh.gammaInput?bb(bR,cc,bY,bX*bX):bd(bR,cc,bY,bX),bE.getPositionFromMatrix(b0.matrixWorld),bS[cc]=bE.x,bS[cc+1]=bE.y,bS[cc+2]=bE.z,bO[k]=bW,k+=1)):b0 instanceof THREE.SpotLight?(I+=1,b0.visible&&(cc=3*H,bh.gammaInput?bb(bN,cc,bY,bX*bX):bd(bN,cc,bY,bX),bE.getPositionFromMatrix(b0.matrixWorld),bK[cc]=bE.x,bK[cc+1]=bE.y,bK[cc+2]=bE.z,bM[H]=bW,ba.copy(bE),bE.getPositionFromMatrix(b0.target.matrixWorld),ba.sub(bE),ba.normalize(),bL[cc]=ba.x,bL[cc+1]=ba.y,bL[cc+2]=ba.z,bJ[H]=Math.cos(b0.angle),bH[H]=b0.exponent,H+=1)):b0 instanceof THREE.HemisphereLight&&(Z+=1,b0.visible&&(ba.getPositionFromMatrix(b0.matrixWorld),ba.normalize(),0===ba.x&&0===ba.y&&0===ba.z||(bW=3*bP,bG[bW]=ba.x,bG[bW+1]=ba.y,bG[bW+2]=ba.z,bY=b0.color,b0=b0.groundColor,bh.gammaInput?(bX*=bX,bb(G,bW,bY,bX),bb(bI,bW,b0,bX)):(bd(G,bW,bY,bX),bd(bI,bW,b0,bX)),bP+=1))))}b9=3*ab;for(b6=Math.max(bU.length,3*bQ);b9<b6;b9++){bU[b9]=0}b9=3*k;for(b6=Math.max(bR.length,3*N);b9<b6;b9++){bR[b9]=0}b9=3*H;for(b6=Math.max(bN.length,3*I);b9<b6;b9++){bN[b9]=0}b9=3*bP;for(b6=Math.max(G.length,3*Z);b9<b6;b9++){G[b9]=0}b9=3*bP;for(b6=Math.max(bI.length,3*Z);b9<b6;b9++){bI[b9]=0}bV.directional.length=ab;bV.point.length=k;bV.spot.length=H;bV.hemi.length=bP;bV.ambient[0]=b2;bV.ambient[1]=b1;bV.ambient[2]=bZ;bu=!1}b9=bf;b3.ambientLightColor.value=b9.ambient;b3.directionalLightColor.value=b9.directional.colors;b3.directionalLightDirection.value=b9.directional.positions;b3.pointLightColor.value=b9.point.colors;b3.pointLightPosition.value=b9.point.positions;b3.pointLightDistance.value=b9.point.distances;b3.spotLightColor.value=b9.spot.colors;b3.spotLightPosition.value=b9.spot.positions;b3.spotLightDistance.value=b9.spot.distances;b3.spotLightDirection.value=b9.spot.directions;b3.spotLightAngleCos.value=b9.spot.anglesCos;b3.spotLightExponent.value=b9.spot.exponents;b3.hemisphereLightSkyColor.value=b9.hemi.skyColors;b3.hemisphereLightGroundColor.value=b9.hemi.groundColors;b3.hemisphereLightDirection.value=b9.hemi.positions}if(b8 instanceof THREE.MeshBasicMaterial||b8 instanceof THREE.MeshLambertMaterial||b8 instanceof THREE.MeshPhongMaterial){b3.opacity.value=b8.opacity;bh.gammaInput?b3.diffuse.value.copyGammaToLinear(b8.color):b3.diffuse.value=b8.color;b3.map.value=b8.map;b3.lightMap.value=b8.lightMap;b3.specularMap.value=b8.specularMap;b8.bumpMap&&(b3.bumpMap.value=b8.bumpMap,b3.bumpScale.value=b8.bumpScale);b8.normalMap&&(b3.normalMap.value=b8.normalMap,b3.normalScale.value.copy(b8.normalScale));var D;b8.map?D=b8.map:b8.specularMap?D=b8.specularMap:b8.normalMap?D=b8.normalMap:b8.bumpMap&&(D=b8.bumpMap);void 0!==D&&(b9=D.offset,D=D.repeat,b3.offsetRepeat.value.set(b9.x,b9.y,D.x,D.y));b3.envMap.value=b8.envMap;b3.flipEnvMap.value=b8.envMap instanceof THREE.WebGLRenderTargetCube?1:-1;b3.reflectivity.value=b8.reflectivity;b3.refractionRatio.value=b8.refractionRatio;b3.combine.value=b8.combine;b3.useRefract.value=b8.envMap&&b8.envMap.mapping instanceof THREE.CubeRefractionMapping}b8 instanceof THREE.LineBasicMaterial?(b3.diffuse.value=b8.color,b3.opacity.value=b8.opacity):b8 instanceof THREE.LineDashedMaterial?(b3.diffuse.value=b8.color,b3.opacity.value=b8.opacity,b3.dashSize.value=b8.dashSize,b3.totalSize.value=b8.dashSize+b8.gapSize,b3.scale.value=b8.scale):b8 instanceof THREE.ParticleBasicMaterial?(b3.psColor.value=b8.color,b3.opacity.value=b8.opacity,b3.size.value=b8.size,b3.scale.value=aZ.height/2,b3.map.value=b8.map):b8 instanceof THREE.MeshPhongMaterial?(b3.shininess.value=b8.shininess,bh.gammaInput?(b3.ambient.value.copyGammaToLinear(b8.ambient),b3.emissive.value.copyGammaToLinear(b8.emissive),b3.specular.value.copyGammaToLinear(b8.specular)):(b3.ambient.value=b8.ambient,b3.emissive.value=b8.emissive,b3.specular.value=b8.specular),b8.wrapAround&&b3.wrapRGB.value.copy(b8.wrapRGB)):b8 instanceof THREE.MeshLambertMaterial?(bh.gammaInput?(b3.ambient.value.copyGammaToLinear(b8.ambient),b3.emissive.value.copyGammaToLinear(b8.emissive)):(b3.ambient.value=b8.ambient,b3.emissive.value=b8.emissive),b8.wrapAround&&b3.wrapRGB.value.copy(b8.wrapRGB)):b8 instanceof THREE.MeshDepthMaterial?(b3.mNear.value=cb.near,b3.mFar.value=cb.far,b3.opacity.value=b8.opacity):b8 instanceof THREE.MeshNormalMaterial&&(b3.opacity.value=b8.opacity);if(b7.receiveShadow&&!b8._shadowPass&&b3.shadowMatrix){b9=D=0;for(b6=ca.length;b9<b6;b9++){if(b2=ca[b9],b2.castShadow&&(b2 instanceof THREE.SpotLight||b2 instanceof THREE.DirectionalLight&&!b2.shadowCascade)){b3.shadowMap.value[D]=b2.shadowMap,b3.shadowMapSize.value[D]=b2.shadowMapSize,b3.shadowMatrix.value[D]=b2.shadowMatrix,b3.shadowDarkness.value[D]=b2.shadowDarkness,b3.shadowBias.value[D]=b2.shadowBias,D++}}}ca=b8.uniformsList;b3=0;for(D=ca.length;b3<D;b3++){if(b6=b5.uniforms[ca[b3][1]]){if(b9=ca[b3][0],b1=b9.type,b2=b9.value,"i"===b1){aG.uniform1i(b6,b2)}else{if("f"===b1){aG.uniform1f(b6,b2)}else{if("v2"===b1){aG.uniform2f(b6,b2.x,b2.y)}else{if("v3"===b1){aG.uniform3f(b6,b2.x,b2.y,b2.z)}else{if("v4"===b1){aG.uniform4f(b6,b2.x,b2.y,b2.z,b2.w)}else{if("c"===b1){aG.uniform3f(b6,b2.r,b2.g,b2.b)}else{if("iv1"===b1){aG.uniform1iv(b6,b2)}else{if("iv"===b1){aG.uniform3iv(b6,b2)}else{if("fv1"===b1){aG.uniform1fv(b6,b2)}else{if("fv"===b1){aG.uniform3fv(b6,b2)}else{if("v2v"===b1){void 0===b9._array&&(b9._array=new Float32Array(2*b2.length));b1=0;for(bZ=b2.length;b1<bZ;b1++){bV=2*b1,b9._array[bV]=b2[b1].x,b9._array[bV+1]=b2[b1].y}aG.uniform2fv(b6,b9._array)}else{if("v3v"===b1){void 0===b9._array&&(b9._array=new Float32Array(3*b2.length));b1=0;for(bZ=b2.length;b1<bZ;b1++){bV=3*b1,b9._array[bV]=b2[b1].x,b9._array[bV+1]=b2[b1].y,b9._array[bV+2]=b2[b1].z}aG.uniform3fv(b6,b9._array)}else{if("v4v"===b1){void 0===b9._array&&(b9._array=new Float32Array(4*b2.length));b1=0;for(bZ=b2.length;b1<bZ;b1++){bV=4*b1,b9._array[bV]=b2[b1].x,b9._array[bV+1]=b2[b1].y,b9._array[bV+2]=b2[b1].z,b9._array[bV+3]=b2[b1].w}aG.uniform4fv(b6,b9._array)}else{if("m4"===b1){void 0===b9._array&&(b9._array=new Float32Array(16)),b2.flattenToArray(b9._array),aG.uniformMatrix4fv(b6,!1,b9._array)}else{if("m4v"===b1){void 0===b9._array&&(b9._array=new Float32Array(16*b2.length));b1=0;for(bZ=b2.length;b1<bZ;b1++){b2[b1].flattenToArrayOffset(b9._array,16*b1)}aG.uniformMatrix4fv(b6,!1,b9._array)}else{if("t"===b1){if(bV=b2,b2=bc(),aG.uniform1i(b6,b2),bV){if(bV.image instanceof Array&&6===bV.image.length){if(b9=bV,b6=b2,6===b9.image.length){if(b9.needsUpdate){b9.image.__webglTextureCube||(b9.addEventListener("dispose",bp),b9.image.__webglTextureCube=aG.createTexture(),bh.info.memory.textures++);aG.activeTexture(aG.TEXTURE0+b6);aG.bindTexture(aG.TEXTURE_CUBE_MAP,b9.image.__webglTextureCube);aG.pixelStorei(aG.UNPACK_FLIP_Y_WEBGL,b9.flipY);b6=b9 instanceof THREE.CompressedTexture;b2=[];for(b1=0;6>b1;b1++){bh.autoScaleCubemaps&&!b6?(bZ=b2,bV=b1,bU=b9.image[b1],bR=bl,bU.width<=bR&&bU.height<=bR||(bS=Math.max(bU.width,bU.height),bT=Math.floor(bU.width*bR/bS),bR=Math.floor(bU.height*bR/bS),bS=document.createElement("canvas"),bS.width=bT,bS.height=bR,bS.getContext("2d").drawImage(bU,0,0,bU.width,bU.height,0,0,bT,bR),bU=bS),bZ[bV]=bU):b2[b1]=b9.image[b1]}b1=b2[0];bZ=0===(b1.width&b1.width-1)&&0===(b1.height&b1.height-1);bV=aw(b9.format);bU=aw(b9.type);a4(aG.TEXTURE_CUBE_MAP,b9,bZ);for(b1=0;6>b1;b1++){if(b6){bR=b2[b1].mipmaps;bS=0;for(bO=bR.length;bS<bO;bS++){bT=bR[bS],aG.compressedTexImage2D(aG.TEXTURE_CUBE_MAP_POSITIVE_X+b1,bS,bV,bT.width,bT.height,0,bT.data)}}else{aG.texImage2D(aG.TEXTURE_CUBE_MAP_POSITIVE_X+b1,0,bV,bV,bU,b2[b1])}}b9.generateMipmaps&&bZ&&aG.generateMipmap(aG.TEXTURE_CUBE_MAP);b9.needsUpdate=!1;if(b9.onUpdate){b9.onUpdate()}}else{aG.activeTexture(aG.TEXTURE0+b6),aG.bindTexture(aG.TEXTURE_CUBE_MAP,b9.image.__webglTextureCube)}}}else{bV instanceof THREE.WebGLRenderTargetCube?(b9=bV,aG.activeTexture(aG.TEXTURE0+b2),aG.bindTexture(aG.TEXTURE_CUBE_MAP,b9.__webglTexture)):bh.setTexture(bV,b2)}}}else{if("tv"===b1){void 0===b9._array&&(b9._array=[]);b1=0;for(bZ=b9.value.length;b1<bZ;b1++){b9._array[b1]=bc()}aG.uniform1iv(b6,b9._array);b1=0;for(bZ=b9.value.length;b1<bZ;b1++){bV=b9.value[b1],b2=b9._array[b1],bV&&bh.setTexture(bV,b2)}}else{console.warn("THREE.WebGLRenderer: Unknown uniform type: "+b1)}}}}}}}}}}}}}}}}}}}if((b8 instanceof THREE.ShaderMaterial||b8 instanceof THREE.MeshPhongMaterial||b8.envMap)&&null!==b4.cameraPosition){bE.getPositionFromMatrix(cb.matrixWorld),aG.uniform3f(b4.cameraPosition,bE.x,bE.y,bE.z)}(b8 instanceof THREE.MeshPhongMaterial||b8 instanceof THREE.MeshLambertMaterial||b8 instanceof THREE.ShaderMaterial||b8.skinning)&&null!==b4.viewMatrix&&aG.uniformMatrix4fv(b4.viewMatrix,!1,cb.matrixWorldInverse.elements)}aG.uniformMatrix4fv(b4.modelViewMatrix,!1,b7._modelViewMatrix.elements);b4.normalMatrix&&aG.uniformMatrix3fv(b4.normalMatrix,!1,b7._normalMatrix.elements);null!==b4.modelMatrix&&aG.uniformMatrix4fv(b4.modelMatrix,!1,b7.matrixWorld.elements);return b5}function bc(){var b=bz;b>=aH&&console.warn("WebGLRenderer: trying to use "+b+" texture units while this GPU supports only "+aH);bz+=1;return b}function bb(f,e,h,g){f[e]=h.r*h.r*g;f[e+1]=h.g*h.g*g;f[e+2]=h.b*h.b*g}function bd(f,e,h,g){f[e]=h.r*g;f[e+1]=h.g*g;f[e+2]=h.b*g}function bk(b){b!==ak&&(aG.lineWidth(b),ak=b)}function a7(e,d,f){bD!==e&&(e?aG.enable(aG.POLYGON_OFFSET_FILL):aG.disable(aG.POLYGON_OFFSET_FILL),bD=e);if(e&&(aK!==d||bF!==f)){aG.polygonOffset(d,f),aK=d,bF=f}}function bj(e){for(var e=e.split("\n"),d=0,f=e.length;d<f;d++){e[d]=d+1+": "+e[d]}return e.join("\n")}function a8(e,d){var f;"fragment"===e?f=aG.createShader(aG.FRAGMENT_SHADER):"vertex"===e&&(f=aG.createShader(aG.VERTEX_SHADER));aG.shaderSource(f,d);aG.compileShader(f);return !aG.getShaderParameter(f,aG.COMPILE_STATUS)?(console.error(aG.getShaderInfoLog(f)),console.error(bj(d)),null):f}function a4(e,d,f){f?(aG.texParameteri(e,aG.TEXTURE_WRAP_S,aw(d.wrapS)),aG.texParameteri(e,aG.TEXTURE_WRAP_T,aw(d.wrapT)),aG.texParameteri(e,aG.TEXTURE_MAG_FILTER,aw(d.magFilter)),aG.texParameteri(e,aG.TEXTURE_MIN_FILTER,aw(d.minFilter))):(aG.texParameteri(e,aG.TEXTURE_WRAP_S,aG.CLAMP_TO_EDGE),aG.texParameteri(e,aG.TEXTURE_WRAP_T,aG.CLAMP_TO_EDGE),aG.texParameteri(e,aG.TEXTURE_MAG_FILTER,a5(d.magFilter)),aG.texParameteri(e,aG.TEXTURE_MIN_FILTER,a5(d.minFilter)));if(bx&&d.type!==THREE.FloatType&&(1<d.anisotropy||d.__oldAnisotropy)){aG.texParameterf(e,bx.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(d.anisotropy,av)),d.__oldAnisotropy=d.anisotropy}}function au(d,c){aG.bindRenderbuffer(aG.RENDERBUFFER,d);c.depthBuffer&&!c.stencilBuffer?(aG.renderbufferStorage(aG.RENDERBUFFER,aG.DEPTH_COMPONENT16,c.width,c.height),aG.framebufferRenderbuffer(aG.FRAMEBUFFER,aG.DEPTH_ATTACHMENT,aG.RENDERBUFFER,d)):c.depthBuffer&&c.stencilBuffer?(aG.renderbufferStorage(aG.RENDERBUFFER,aG.DEPTH_STENCIL,c.width,c.height),aG.framebufferRenderbuffer(aG.FRAMEBUFFER,aG.DEPTH_STENCIL_ATTACHMENT,aG.RENDERBUFFER,d)):aG.renderbufferStorage(aG.RENDERBUFFER,aG.RGBA4,c.width,c.height)}function a5(b){return b===THREE.NearestFilter||b===THREE.NearestMipMapNearestFilter||b===THREE.NearestMipMapLinearFilter?aG.NEAREST:aG.LINEAR}function aw(b){if(b===THREE.RepeatWrapping){return aG.REPEAT}if(b===THREE.ClampToEdgeWrapping){return aG.CLAMP_TO_EDGE}if(b===THREE.MirroredRepeatWrapping){return aG.MIRRORED_REPEAT}if(b===THREE.NearestFilter){return aG.NEAREST}if(b===THREE.NearestMipMapNearestFilter){return aG.NEAREST_MIPMAP_NEAREST}if(b===THREE.NearestMipMapLinearFilter){return aG.NEAREST_MIPMAP_LINEAR}if(b===THREE.LinearFilter){return aG.LINEAR}if(b===THREE.LinearMipMapNearestFilter){return aG.LINEAR_MIPMAP_NEAREST}if(b===THREE.LinearMipMapLinearFilter){return aG.LINEAR_MIPMAP_LINEAR}if(b===THREE.UnsignedByteType){return aG.UNSIGNED_BYTE}if(b===THREE.UnsignedShort4444Type){return aG.UNSIGNED_SHORT_4_4_4_4}if(b===THREE.UnsignedShort5551Type){return aG.UNSIGNED_SHORT_5_5_5_1}if(b===THREE.UnsignedShort565Type){return aG.UNSIGNED_SHORT_5_6_5}if(b===THREE.ByteType){return aG.BYTE}if(b===THREE.ShortType){return aG.SHORT}if(b===THREE.UnsignedShortType){return aG.UNSIGNED_SHORT}if(b===THREE.IntType){return aG.INT}if(b===THREE.UnsignedIntType){return aG.UNSIGNED_INT}if(b===THREE.FloatType){return aG.FLOAT}if(b===THREE.AlphaFormat){return aG.ALPHA}if(b===THREE.RGBFormat){return aG.RGB}if(b===THREE.RGBAFormat){return aG.RGBA}if(b===THREE.LuminanceFormat){return aG.LUMINANCE}if(b===THREE.LuminanceAlphaFormat){return aG.LUMINANCE_ALPHA}if(b===THREE.AddEquation){return aG.FUNC_ADD}if(b===THREE.SubtractEquation){return aG.FUNC_SUBTRACT}if(b===THREE.ReverseSubtractEquation){return aG.FUNC_REVERSE_SUBTRACT}if(b===THREE.ZeroFactor){return aG.ZERO}if(b===THREE.OneFactor){return aG.ONE}if(b===THREE.SrcColorFactor){return aG.SRC_COLOR}if(b===THREE.OneMinusSrcColorFactor){return aG.ONE_MINUS_SRC_COLOR}if(b===THREE.SrcAlphaFactor){return aG.SRC_ALPHA}if(b===THREE.OneMinusSrcAlphaFactor){return aG.ONE_MINUS_SRC_ALPHA}if(b===THREE.DstAlphaFactor){return aG.DST_ALPHA}if(b===THREE.OneMinusDstAlphaFactor){return aG.ONE_MINUS_DST_ALPHA}if(b===THREE.DstColorFactor){return aG.DST_COLOR}if(b===THREE.OneMinusDstColorFactor){return aG.ONE_MINUS_DST_COLOR}if(b===THREE.SrcAlphaSaturateFactor){return aG.SRC_ALPHA_SATURATE}if(void 0!==aP){if(b===THREE.RGB_S3TC_DXT1_Format){return aP.COMPRESSED_RGB_S3TC_DXT1_EXT}if(b===THREE.RGBA_S3TC_DXT1_Format){return aP.COMPRESSED_RGBA_S3TC_DXT1_EXT}if(b===THREE.RGBA_S3TC_DXT3_Format){return aP.COMPRESSED_RGBA_S3TC_DXT3_EXT}if(b===THREE.RGBA_S3TC_DXT5_Format){return aP.COMPRESSED_RGBA_S3TC_DXT5_EXT}}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);var aV=aV||{},aZ=void 0!==aV.canvas?aV.canvas:document.createElement("canvas"),a6=void 0!==aV.precision?aV.precision:"highp",an=void 0!==aV.alpha?aV.alpha:!0,aY=void 0!==aV.premultipliedAlpha?aV.premultipliedAlpha:!0,bm=void 0!==aV.antialias?aV.antialias:!1,a3=void 0!==aV.stencil?aV.stencil:!0,W=void 0!==aV.preserveDrawingBuffer?aV.preserveDrawingBuffer:!1,Y=new THREE.Color(0),af=0;void 0!==aV.clearColor&&(console.warn("DEPRECATED: clearColor in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),Y.setHex(aV.clearColor));void 0!==aV.clearAlpha&&(console.warn("DEPRECATED: clearAlpha in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),af=aV.clearAlpha);this.domElement=aZ;this.context=null;this.devicePixelRatio=void 0!==aV.devicePixelRatio?aV.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.physicallyBasedShading=this.gammaOutput=this.gammaInput=!1;this.shadowMapAutoUpdate=!0;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapCascade=this.shadowMapDebug=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.renderPluginsPre=[];this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var bh=this,a1=[],S=0,ad=null,R=null,al=-1,aW=null,bw=null,bt=0,bz=0,aj=-1,a2=-1,bo=-1,bg=-1,a9=-1,a0=-1,E=-1,bn=-1,bD=null,aK=null,bF=null,ak=null,aX=0,ag=0,ar=0,ai=0,ah=0,aR=0,by={},P=new THREE.Frustum,o=new THREE.Matrix4,bB=new THREE.Matrix4,bE=new THREE.Vector3,ba=new THREE.Vector3,bu=!0,bf={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},aG,ae,Q,bx,aP;try{if(!(aG=aZ.getContext("experimental-webgl",{alpha:an,premultipliedAlpha:aY,antialias:bm,stencil:a3,preserveDrawingBuffer:W}))){throw"Error creating WebGL context."}}catch(aq){console.error(aq)}ae=aG.getExtension("OES_texture_float");aG.getExtension("OES_texture_float_linear");Q=aG.getExtension("OES_standard_derivatives");bx=aG.getExtension("EXT_texture_filter_anisotropic")||aG.getExtension("MOZ_EXT_texture_filter_anisotropic")||aG.getExtension("WEBKIT_EXT_texture_filter_anisotropic");aP=aG.getExtension("WEBGL_compressed_texture_s3tc")||aG.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||aG.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");ae||console.log("THREE.WebGLRenderer: Float textures not supported.");Q||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");bx||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");aP||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");void 0===aG.getShaderPrecisionFormat&&(aG.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});aG.clearColor(0,0,0,1);aG.clearDepth(1);aG.clearStencil(0);aG.enable(aG.DEPTH_TEST);aG.depthFunc(aG.LEQUAL);aG.frontFace(aG.CCW);aG.cullFace(aG.BACK);aG.enable(aG.CULL_FACE);aG.enable(aG.BLEND);aG.blendEquation(aG.FUNC_ADD);aG.blendFunc(aG.SRC_ALPHA,aG.ONE_MINUS_SRC_ALPHA);aG.clearColor(Y.r,Y.g,Y.b,af);this.context=aG;var aH=aG.getParameter(aG.MAX_TEXTURE_IMAGE_UNITS),bv=aG.getParameter(aG.MAX_VERTEX_TEXTURE_IMAGE_UNITS);aG.getParameter(aG.MAX_TEXTURE_SIZE);var bl=aG.getParameter(aG.MAX_CUBE_MAP_TEXTURE_SIZE),av=bx?aG.getParameter(bx.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,bC=0<bv,bq=bC&&ae;aP&&aG.getParameter(aG.COMPRESSED_TEXTURE_FORMATS);var am=aG.getShaderPrecisionFormat(aG.VERTEX_SHADER,aG.HIGH_FLOAT),ao=aG.getShaderPrecisionFormat(aG.VERTEX_SHADER,aG.MEDIUM_FLOAT);aG.getShaderPrecisionFormat(aG.VERTEX_SHADER,aG.LOW_FLOAT);var v=aG.getShaderPrecisionFormat(aG.FRAGMENT_SHADER,aG.HIGH_FLOAT),ac=aG.getShaderPrecisionFormat(aG.FRAGMENT_SHADER,aG.MEDIUM_FLOAT);aG.getShaderPrecisionFormat(aG.FRAGMENT_SHADER,aG.LOW_FLOAT);aG.getShaderPrecisionFormat(aG.VERTEX_SHADER,aG.HIGH_INT);aG.getShaderPrecisionFormat(aG.VERTEX_SHADER,aG.MEDIUM_INT);aG.getShaderPrecisionFormat(aG.VERTEX_SHADER,aG.LOW_INT);aG.getShaderPrecisionFormat(aG.FRAGMENT_SHADER,aG.HIGH_INT);aG.getShaderPrecisionFormat(aG.FRAGMENT_SHADER,aG.MEDIUM_INT);aG.getShaderPrecisionFormat(aG.FRAGMENT_SHADER,aG.LOW_INT);var bs=0<am.precision&&0<v.precision,U=0<ao.precision&&0<ac.precision;"highp"===a6&&!bs&&(U?(a6="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(a6="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"===a6&&!U&&(a6="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return aG};this.supportsVertexTextures=function(){return bC};this.supportsFloatTextures=function(){return ae};this.supportsStandardDerivatives=function(){return Q};this.supportsCompressedTextureS3TC=function(){return aP};this.getMaxAnisotropy=function(){return av};this.getPrecision=function(){return a6};this.setSize=function(e,d,f){aZ.width=e*this.devicePixelRatio;aZ.height=d*this.devicePixelRatio;1!==this.devicePixelRatio&&!1!==f&&(aZ.style.width=e+"px",aZ.style.height=d+"px");this.setViewport(0,0,aZ.width,aZ.height)};this.setViewport=function(f,e,h,g){aX=void 0!==f?f:0;ag=void 0!==e?e:0;ar=void 0!==h?h:aZ.width;ai=void 0!==g?g:aZ.height;aG.viewport(aX,ag,ar,ai)};this.setScissor=function(f,e,h,g){aG.scissor(f,e,h,g)};this.enableScissorTest=function(b){b?aG.enable(aG.SCISSOR_TEST):aG.disable(aG.SCISSOR_TEST)};this.setClearColor=function(d,c){Y.set(d);af=void 0!==c?c:1;aG.clearColor(Y.r,Y.g,Y.b,af)};this.setClearColorHex=function(d,c){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(d,c)};this.getClearColor=function(){return Y};this.getClearAlpha=function(){return af};this.clear=function(f,e,h){var g=0;if(void 0===f||f){g|=aG.COLOR_BUFFER_BIT}if(void 0===e||e){g|=aG.DEPTH_BUFFER_BIT}if(void 0===h||h){g|=aG.STENCIL_BUFFER_BIT}aG.clear(g)};this.clearTarget=function(f,e,h,g){this.setRenderTarget(f);this.clear(e,h,g)};this.addPostPlugin=function(b){b.init(this);this.renderPluginsPost.push(b)};this.addPrePlugin=function(b){b.init(this);this.renderPluginsPre.push(b)};this.updateShadowMap=function(d,c){ad=null;al=aW=bn=E=bo=-1;bu=!0;a2=aj=-1;this.shadowMapPlugin.update(d,c)};var bA=function(b){b=b.target;b.removeEventListener("dispose",bA);b.__webglInit=void 0;void 0!==b.__webglVertexBuffer&&aG.deleteBuffer(b.__webglVertexBuffer);void 0!==b.__webglNormalBuffer&&aG.deleteBuffer(b.__webglNormalBuffer);void 0!==b.__webglTangentBuffer&&aG.deleteBuffer(b.__webglTangentBuffer);void 0!==b.__webglColorBuffer&&aG.deleteBuffer(b.__webglColorBuffer);void 0!==b.__webglUVBuffer&&aG.deleteBuffer(b.__webglUVBuffer);void 0!==b.__webglUV2Buffer&&aG.deleteBuffer(b.__webglUV2Buffer);void 0!==b.__webglSkinIndicesBuffer&&aG.deleteBuffer(b.__webglSkinIndicesBuffer);void 0!==b.__webglSkinWeightsBuffer&&aG.deleteBuffer(b.__webglSkinWeightsBuffer);void 0!==b.__webglFaceBuffer&&aG.deleteBuffer(b.__webglFaceBuffer);void 0!==b.__webglLineBuffer&&aG.deleteBuffer(b.__webglLineBuffer);void 0!==b.__webglLineDistanceBuffer&&aG.deleteBuffer(b.__webglLineDistanceBuffer);if(void 0!==b.geometryGroups){for(var j in b.geometryGroups){var i=b.geometryGroups[j];if(void 0!==i.numMorphTargets){for(var h=0,g=i.numMorphTargets;h<g;h++){aG.deleteBuffer(i.__webglMorphTargetsBuffers[h])}}if(void 0!==i.numMorphNormals){h=0;for(g=i.numMorphNormals;h<g;h++){aG.deleteBuffer(i.__webglMorphNormalsBuffers[h])}}aT(i)}}aT(b);bh.info.memory.geometries--},bp=function(b){b=b.target;b.removeEventListener("dispose",bp);b.image&&b.image.__webglTextureCube?aG.deleteTexture(b.image.__webglTextureCube):b.__webglInit&&(b.__webglInit=!1,aG.deleteTexture(b.__webglTexture));bh.info.memory.textures--},br=function(d){d=d.target;d.removeEventListener("dispose",br);if(d&&d.__webglTexture){if(aG.deleteTexture(d.__webglTexture),d instanceof THREE.WebGLRenderTargetCube){for(var c=0;6>c;c++){aG.deleteFramebuffer(d.__webglFramebuffer[c]),aG.deleteRenderbuffer(d.__webglRenderbuffer[c])}}else{aG.deleteFramebuffer(d.__webglFramebuffer),aG.deleteRenderbuffer(d.__webglRenderbuffer)}}bh.info.memory.textures--},aU=function(b){b=b.target;b.removeEventListener("dispose",aU);ap(b)},ap=function(g){var f=g.program;if(void 0!==f){g.program=void 0;var j,i,h=!1,g=0;for(j=a1.length;g<j;g++){if(i=a1[g],i.program===f){i.usedTimes--;0===i.usedTimes&&(h=!0);break}}if(!0===h){h=[];g=0;for(j=a1.length;g<j;g++){i=a1[g],i.program!==f&&h.push(i)}a1=h;aG.deleteProgram(f);bh.info.memory.programs--}}};this.renderBufferImmediate=function(K,J,I){K.hasPositions&&!K.__webglVertexBuffer&&(K.__webglVertexBuffer=aG.createBuffer());K.hasNormals&&!K.__webglNormalBuffer&&(K.__webglNormalBuffer=aG.createBuffer());K.hasUvs&&!K.__webglUvBuffer&&(K.__webglUvBuffer=aG.createBuffer());K.hasColors&&!K.__webglColorBuffer&&(K.__webglColorBuffer=aG.createBuffer());K.hasPositions&&(aG.bindBuffer(aG.ARRAY_BUFFER,K.__webglVertexBuffer),aG.bufferData(aG.ARRAY_BUFFER,K.positionArray,aG.DYNAMIC_DRAW),aG.enableVertexAttribArray(J.attributes.position),aG.vertexAttribPointer(J.attributes.position,3,aG.FLOAT,!1,0,0));if(K.hasNormals){aG.bindBuffer(aG.ARRAY_BUFFER,K.__webglNormalBuffer);if(I.shading===THREE.FlatShading){var H,G,F,D,C,B,A,u,t,s,r,k=3*K.count;for(r=0;r<k;r+=9){s=K.normalArray,H=s[r],G=s[r+1],F=s[r+2],D=s[r+3],B=s[r+4],u=s[r+5],C=s[r+6],A=s[r+7],t=s[r+8],H=(H+D+C)/3,G=(G+B+A)/3,F=(F+u+t)/3,s[r]=H,s[r+1]=G,s[r+2]=F,s[r+3]=H,s[r+4]=G,s[r+5]=F,s[r+6]=H,s[r+7]=G,s[r+8]=F}}aG.bufferData(aG.ARRAY_BUFFER,K.normalArray,aG.DYNAMIC_DRAW);aG.enableVertexAttribArray(J.attributes.normal);aG.vertexAttribPointer(J.attributes.normal,3,aG.FLOAT,!1,0,0)}K.hasUvs&&I.map&&(aG.bindBuffer(aG.ARRAY_BUFFER,K.__webglUvBuffer),aG.bufferData(aG.ARRAY_BUFFER,K.uvArray,aG.DYNAMIC_DRAW),aG.enableVertexAttribArray(J.attributes.uv),aG.vertexAttribPointer(J.attributes.uv,2,aG.FLOAT,!1,0,0));K.hasColors&&I.vertexColors!==THREE.NoColors&&(aG.bindBuffer(aG.ARRAY_BUFFER,K.__webglColorBuffer),aG.bufferData(aG.ARRAY_BUFFER,K.colorArray,aG.DYNAMIC_DRAW),aG.enableVertexAttribArray(J.attributes.color),aG.vertexAttribPointer(J.attributes.color,3,aG.FLOAT,!1,0,0));aG.drawArrays(aG.TRIANGLES,0,K.count);K.count=0};this.renderBufferDirect=function(D,C,B,A,u,t){if(!1!==A.visible){var s,r,q,k;s=be(D,C,B,A,t);C=s.attributes;D=u.attributes;B=!1;s=16777215*u.id+2*s.id+(A.wireframe?1:0);s!==aW&&(aW=s,B=!0);B&&aJ();if(t instanceof THREE.Mesh){if(A=D.index){u=u.offsets;1<u.length&&(B=!0);for(var t=0,i=u.length;t<i;t++){var g=u[t].index;if(B){for(r in D){"index"!==r&&(q=C[r],s=D[r],k=s.itemSize,0<=q&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.buffer),aM(q),aG.vertexAttribPointer(q,k,aG.FLOAT,!1,0,4*g*k)))}aG.bindBuffer(aG.ELEMENT_ARRAY_BUFFER,A.buffer)}aG.drawElements(aG.TRIANGLES,u[t].count,aG.UNSIGNED_SHORT,2*u[t].start);bh.info.render.calls++;bh.info.render.vertices+=u[t].count;bh.info.render.faces+=u[t].count/3}}else{if(B){for(r in D){"index"!==r&&(q=C[r],s=D[r],k=s.itemSize,0<=q&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.buffer),aM(q),aG.vertexAttribPointer(q,k,aG.FLOAT,!1,0,0)))}}D=u.attributes.position;aG.drawArrays(aG.TRIANGLES,0,D.numItems/3);bh.info.render.calls++;bh.info.render.vertices+=D.numItems/3;bh.info.render.faces+=D.numItems/3/3}}else{if(t instanceof THREE.ParticleSystem){if(B){for(r in D){q=C[r],s=D[r],k=s.itemSize,0<=q&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.buffer),aM(q),aG.vertexAttribPointer(q,k,aG.FLOAT,!1,0,0))}D=D.position;aG.drawArrays(aG.POINTS,0,D.numItems/3);bh.info.render.calls++;bh.info.render.points+=D.numItems/3}}else{if(t instanceof THREE.Line&&B){for(r in D){q=C[r],s=D[r],k=s.itemSize,0<=q&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.buffer),aM(q),aG.vertexAttribPointer(q,k,aG.FLOAT,!1,0,0))}r=t.type===THREE.LineStrip?aG.LINE_STRIP:aG.LINES;bk(A.linewidth);D=D.position;aG.drawArrays(r,0,D.numItems/3);bh.info.render.calls++;bh.info.render.points+=D.numItems}}}}};this.renderBuffer=function(B,A,u,t,s,r){if(!1!==t.visible){var q,l,u=be(B,A,u,t,r),B=u.attributes,A=!1,u=16777215*s.id+2*u.id+(t.wireframe?1:0);u!==aW&&(aW=u,A=!0);A&&aJ();if(!t.morphTargets&&0<=B.position){A&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglVertexBuffer),aM(B.position),aG.vertexAttribPointer(B.position,3,aG.FLOAT,!1,0,0))}else{if(r.morphTargetBase){u=t.program.attributes;-1!==r.morphTargetBase&&0<=u.position?(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglMorphTargetsBuffers[r.morphTargetBase]),aM(u.position),aG.vertexAttribPointer(u.position,3,aG.FLOAT,!1,0,0)):0<=u.position&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglVertexBuffer),aM(u.position),aG.vertexAttribPointer(u.position,3,aG.FLOAT,!1,0,0));if(r.morphTargetForcedOrder.length){var k=0;l=r.morphTargetForcedOrder;for(q=r.morphTargetInfluences;k<t.numSupportedMorphTargets&&k<l.length;){0<=u["morphTarget"+k]&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglMorphTargetsBuffers[l[k]]),aM(u["morphTarget"+k]),aG.vertexAttribPointer(u["morphTarget"+k],3,aG.FLOAT,!1,0,0)),0<=u["morphNormal"+k]&&t.morphNormals&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglMorphNormalsBuffers[l[k]]),aM(u["morphNormal"+k]),aG.vertexAttribPointer(u["morphNormal"+k],3,aG.FLOAT,!1,0,0)),r.__webglMorphTargetInfluences[k]=q[l[k]],k++}}else{l=[];q=r.morphTargetInfluences;var i,g=q.length;for(i=0;i<g;i++){k=q[i],0<k&&l.push([k,i])}l.length>t.numSupportedMorphTargets?(l.sort(aF),l.length=t.numSupportedMorphTargets):l.length>t.numSupportedMorphNormals?l.sort(aF):0===l.length&&l.push([0,0]);for(k=0;k<t.numSupportedMorphTargets;){l[k]?(i=l[k][1],0<=u["morphTarget"+k]&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglMorphTargetsBuffers[i]),aM(u["morphTarget"+k]),aG.vertexAttribPointer(u["morphTarget"+k],3,aG.FLOAT,!1,0,0)),0<=u["morphNormal"+k]&&t.morphNormals&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglMorphNormalsBuffers[i]),aM(u["morphNormal"+k]),aG.vertexAttribPointer(u["morphNormal"+k],3,aG.FLOAT,!1,0,0)),r.__webglMorphTargetInfluences[k]=q[i]):r.__webglMorphTargetInfluences[k]=0,k++}}null!==t.program.uniforms.morphTargetInfluences&&aG.uniform1fv(t.program.uniforms.morphTargetInfluences,r.__webglMorphTargetInfluences)}}if(A){if(s.__webglCustomAttributesList){q=0;for(l=s.__webglCustomAttributesList.length;q<l;q++){u=s.__webglCustomAttributesList[q],0<=B[u.buffer.belongsToAttribute]&&(aG.bindBuffer(aG.ARRAY_BUFFER,u.buffer),aM(B[u.buffer.belongsToAttribute]),aG.vertexAttribPointer(B[u.buffer.belongsToAttribute],u.size,aG.FLOAT,!1,0,0))}}0<=B.color&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglColorBuffer),aM(B.color),aG.vertexAttribPointer(B.color,3,aG.FLOAT,!1,0,0));0<=B.normal&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglNormalBuffer),aM(B.normal),aG.vertexAttribPointer(B.normal,3,aG.FLOAT,!1,0,0));0<=B.tangent&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglTangentBuffer),aM(B.tangent),aG.vertexAttribPointer(B.tangent,4,aG.FLOAT,!1,0,0));0<=B.uv&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglUVBuffer),aM(B.uv),aG.vertexAttribPointer(B.uv,2,aG.FLOAT,!1,0,0));0<=B.uv2&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglUV2Buffer),aM(B.uv2),aG.vertexAttribPointer(B.uv2,2,aG.FLOAT,!1,0,0));t.skinning&&(0<=B.skinIndex&&0<=B.skinWeight)&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglSkinIndicesBuffer),aM(B.skinIndex),aG.vertexAttribPointer(B.skinIndex,4,aG.FLOAT,!1,0,0),aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglSkinWeightsBuffer),aM(B.skinWeight),aG.vertexAttribPointer(B.skinWeight,4,aG.FLOAT,!1,0,0));0<=B.lineDistance&&(aG.bindBuffer(aG.ARRAY_BUFFER,s.__webglLineDistanceBuffer),aM(B.lineDistance),aG.vertexAttribPointer(B.lineDistance,1,aG.FLOAT,!1,0,0))}r instanceof THREE.Mesh?(t.wireframe?(bk(t.wireframeLinewidth),A&&aG.bindBuffer(aG.ELEMENT_ARRAY_BUFFER,s.__webglLineBuffer),aG.drawElements(aG.LINES,s.__webglLineCount,aG.UNSIGNED_SHORT,0)):(A&&aG.bindBuffer(aG.ELEMENT_ARRAY_BUFFER,s.__webglFaceBuffer),aG.drawElements(aG.TRIANGLES,s.__webglFaceCount,aG.UNSIGNED_SHORT,0)),bh.info.render.calls++,bh.info.render.vertices+=s.__webglFaceCount,bh.info.render.faces+=s.__webglFaceCount/3):r instanceof THREE.Line?(r=r.type===THREE.LineStrip?aG.LINE_STRIP:aG.LINES,bk(t.linewidth),aG.drawArrays(r,0,s.__webglLineCount),bh.info.render.calls++):r instanceof THREE.ParticleSystem?(aG.drawArrays(aG.POINTS,0,s.__webglParticleCount),bh.info.render.calls++,bh.info.render.points+=s.__webglParticleCount):r instanceof THREE.Ribbon&&(aG.drawArrays(aG.TRIANGLE_STRIP,0,s.__webglVertexCount),bh.info.render.calls++)}};this.render=function(H,G,F,D,C){if(!1===G instanceof THREE.Camera){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")}else{var B,p,A,n,m=H.__lights,k=H.fog;al=-1;bu=!0;!0===H.autoUpdate&&H.updateMatrixWorld();void 0===G.parent&&G.updateMatrixWorld();G.matrixWorldInverse.getInverse(G.matrixWorld);o.multiplyMatrices(G.projectionMatrix,G.matrixWorldInverse);P.setFromMatrix(o);this.autoUpdateObjects&&this.initWebGLObjects(H);aE(this.renderPluginsPre,H,G);bh.info.render.calls=0;bh.info.render.vertices=0;bh.info.render.faces=0;bh.info.render.points=0;this.setRenderTarget(F);(this.autoClear||D)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);n=H.__webglObjects;D=0;for(B=n.length;D<B;D++){if(p=n[D],A=p.object,p.id=D,p.render=!1,A.visible&&(!(A instanceof THREE.Mesh||A instanceof THREE.ParticleSystem)||!A.frustumCulled||P.intersectsObject(A))){var j=A;j._modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,j.matrixWorld);j._normalMatrix.getNormalMatrix(j._modelViewMatrix);var j=p,K=j.buffer,J=void 0,I=J=void 0,I=j.object.material;if(I instanceof THREE.MeshFaceMaterial){J=K.materialIndex,J=I.materials[J],J.transparent?(j.transparent=J,j.opaque=null):(j.opaque=J,j.transparent=null)}else{if(J=I){J.transparent?(j.transparent=J,j.opaque=null):(j.opaque=J,j.transparent=null)}}p.render=!0;!0===this.sortObjects&&(null!==A.renderDepth?p.z=A.renderDepth:(bE.getPositionFromMatrix(A.matrixWorld),bE.applyProjection(o),p.z=bE.z))}}this.sortObjects&&n.sort(aI);n=H.__webglObjectsImmediate;D=0;for(B=n.length;D<B;D++){p=n[D],A=p.object,A.visible&&(A._modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,A.matrixWorld),A._normalMatrix.getNormalMatrix(A._modelViewMatrix),A=p.object.material,A.transparent?(p.transparent=A,p.opaque=null):(p.opaque=A,p.transparent=null))}H.overrideMaterial?(D=H.overrideMaterial,this.setBlending(D.blending,D.blendEquation,D.blendSrc,D.blendDst),this.setDepthTest(D.depthTest),this.setDepthWrite(D.depthWrite),a7(D.polygonOffset,D.polygonOffsetFactor,D.polygonOffsetUnits),aD(H.__webglObjects,!1,"",G,m,k,!0,D),aC(H.__webglObjectsImmediate,"",G,m,k,!1,D,C)):(D=null,this.setBlending(THREE.NoBlending),aD(H.__webglObjects,!0,"opaque",G,m,k,!1,D),aC(H.__webglObjectsImmediate,"opaque",G,m,k,!1,D,C),aD(H.__webglObjects,!1,"transparent",G,m,k,!0,D),aC(H.__webglObjectsImmediate,"transparent",G,m,k,!0,D,C));aE(this.renderPluginsPost,H,G);F&&(F.generateMipmaps&&F.minFilter!==THREE.NearestFilter&&F.minFilter!==THREE.LinearFilter)&&(F instanceof THREE.WebGLRenderTargetCube?(aG.bindTexture(aG.TEXTURE_CUBE_MAP,F.__webglTexture),aG.generateMipmap(aG.TEXTURE_CUBE_MAP),aG.bindTexture(aG.TEXTURE_CUBE_MAP,null)):(aG.bindTexture(aG.TEXTURE_2D,F.__webglTexture),aG.generateMipmap(aG.TEXTURE_2D),aG.bindTexture(aG.TEXTURE_2D,null)));this.setDepthTest(!0);this.setDepthWrite(!0)}};this.renderImmediateObject=function(h,g,l,k,j){var i=be(h,g,l,k,j);aW=-1;bh.setMaterialFaces(k);j.immediateRenderCallback?j.immediateRenderCallback(i,aG,P):j.render(function(b){bh.renderBufferImmediate(b,i,k)})};this.initWebGLObjects=function(dF){dF.__webglObjects||(dF.__webglObjects=[],dF.__webglObjectsImmediate=[],dF.__webglSprites=[],dF.__webglFlares=[]);for(;dF.__objectsAdded.length;){ay(dF.__objectsAdded[0],dF),dF.__objectsAdded.splice(0,1)}for(;dF.__objectsRemoved.length;){ax(dF.__objectsRemoved[0],dF),dF.__objectsRemoved.splice(0,1)}for(var dE=0,dD=dF.__webglObjects.length;dE<dD;dE++){var dA=dF.__webglObjects[dE].object;void 0===dA.__webglInit&&(void 0!==dA.__webglActive&&ax(dA,dF),ay(dA,dF));var dy=dA,dw=dy.geometry,dv=void 0,du=void 0,dt=void 0;if(dw instanceof THREE.BufferGeometry){var dr=aG.DYNAMIC_DRAW,di=!dw.dynamic,dm=dw.attributes,dk=void 0,em=void 0;for(dk in dm){em=dm[dk],em.needsUpdate&&("index"===dk?(aG.bindBuffer(aG.ELEMENT_ARRAY_BUFFER,em.buffer),aG.bufferData(aG.ELEMENT_ARRAY_BUFFER,em.array,dr)):(aG.bindBuffer(aG.ARRAY_BUFFER,em.buffer),aG.bufferData(aG.ARRAY_BUFFER,em.array,dr)),em.needsUpdate=!1),di&&!em.dynamic&&(em.array=null)}}else{if(dy instanceof THREE.Mesh){for(var ek=0,eg=dw.geometryGroupsList.length;ek<eg;ek++){if(dv=dw.geometryGroupsList[ek],dt=aO(dy,dv),dw.buffersNeedUpdate&&aQ(dv,dy),du=dt.attributes&&aA(dt),dw.verticesNeedUpdate||dw.morphTargetsNeedUpdate||dw.elementsNeedUpdate||dw.uvsNeedUpdate||dw.normalsNeedUpdate||dw.colorsNeedUpdate||dw.tangentsNeedUpdate||du){var ej=dv,ee=dy,d8=aG.DYNAMIC_DRAW,d7=!dw.dynamic,d5=dt;if(ej.__inittedArrays){var dP=aN(d5),d2=d5.vertexColors?d5.vertexColors:!1,d1=aL(d5),d0=dP===THREE.SmoothShading,eh=void 0,ei=void 0,dZ=void 0,dW=void 0,dY=void 0,cW=void 0,dR=void 0,dN=void 0,c2=void 0,cJ=void 0,eC=void 0,dU=void 0,dT=void 0,dX=void 0,ef=void 0,dL=void 0,c9=void 0,eO=void 0,bS=void 0,cj=void 0,eG=void 0,b3=void 0,cV=void 0,bH=void 0,et=void 0,d=void 0,b9=void 0,dK=void 0,dj=void 0,cP=void 0,cg=void 0,bX=void 0,bM=void 0,l=void 0,dh=void 0,ey=void 0,b8=void 0,t=void 0,b6=void 0,bK=void 0,d9=void 0,eB=void 0,cD=void 0,ep=void 0,ew=void 0,bV=void 0,eL=0,cS=0,ds=0,c5=0,df=0,bR=0,b1=0,dJ=0,dV=0,dM=0,cv=0,dl=0,cH=void 0,dB=ej.__vertexArray,cI=ej.__uvArray,b2=ej.__uv2Array,h=ej.__normalArray,c0=ej.__tangentArray,c8=ej.__colorArray,cN=ej.__skinIndexArray,cz=ej.__skinWeightArray,eN=ej.__morphTargetsArrays,cF=ej.__morphNormalsArrays,cr=ej.__webglCustomAttributesList,dn=void 0,cL=ej.__faceArray,bL=ej.__lineArray,c1=ee.geometry,eQ=c1.elementsNeedUpdate,eF=c1.uvsNeedUpdate,bJ=c1.normalsNeedUpdate,f=c1.tangentsNeedUpdate,c4=c1.colorsNeedUpdate,cR=c1.morphTargetsNeedUpdate,dz=c1.vertices,cB=ej.faces3,cp=ej.faces4,bG=c1.faces,dG=c1.faceVertexUvs[0],cY=c1.faceVertexUvs[1],c7=c1.skinIndices,en=c1.skinWeights,eA=c1.morphTargets,eq=c1.morphNormals;if(c1.verticesNeedUpdate){eh=0;for(ei=cB.length;eh<ei;eh++){dW=bG[cB[eh]],dU=dz[dW.a],dT=dz[dW.b],dX=dz[dW.c],dB[cS]=dU.x,dB[cS+1]=dU.y,dB[cS+2]=dU.z,dB[cS+3]=dT.x,dB[cS+4]=dT.y,dB[cS+5]=dT.z,dB[cS+6]=dX.x,dB[cS+7]=dX.y,dB[cS+8]=dX.z,cS+=9}eh=0;for(ei=cp.length;eh<ei;eh++){dW=bG[cp[eh]],dU=dz[dW.a],dT=dz[dW.b],dX=dz[dW.c],ef=dz[dW.d],dB[cS]=dU.x,dB[cS+1]=dU.y,dB[cS+2]=dU.z,dB[cS+3]=dT.x,dB[cS+4]=dT.y,dB[cS+5]=dT.z,dB[cS+6]=dX.x,dB[cS+7]=dX.y,dB[cS+8]=dX.z,dB[cS+9]=ef.x,dB[cS+10]=ef.y,dB[cS+11]=ef.z,cS+=12}aG.bindBuffer(aG.ARRAY_BUFFER,ej.__webglVertexBuffer);aG.bufferData(aG.ARRAY_BUFFER,dB,d8)}if(cR){d9=0;for(eB=eA.length;d9<eB;d9++){eh=cv=0;for(ei=cB.length;eh<ei;eh++){ew=cB[eh],dW=bG[ew],dU=eA[d9].vertices[dW.a],dT=eA[d9].vertices[dW.b],dX=eA[d9].vertices[dW.c],cD=eN[d9],cD[cv]=dU.x,cD[cv+1]=dU.y,cD[cv+2]=dU.z,cD[cv+3]=dT.x,cD[cv+4]=dT.y,cD[cv+5]=dT.z,cD[cv+6]=dX.x,cD[cv+7]=dX.y,cD[cv+8]=dX.z,d5.morphNormals&&(d0?(bV=eq[d9].vertexNormals[ew],cj=bV.a,eG=bV.b,b3=bV.c):b3=eG=cj=eq[d9].faceNormals[ew],ep=cF[d9],ep[cv]=cj.x,ep[cv+1]=cj.y,ep[cv+2]=cj.z,ep[cv+3]=eG.x,ep[cv+4]=eG.y,ep[cv+5]=eG.z,ep[cv+6]=b3.x,ep[cv+7]=b3.y,ep[cv+8]=b3.z),cv+=9}eh=0;for(ei=cp.length;eh<ei;eh++){ew=cp[eh],dW=bG[ew],dU=eA[d9].vertices[dW.a],dT=eA[d9].vertices[dW.b],dX=eA[d9].vertices[dW.c],ef=eA[d9].vertices[dW.d],cD=eN[d9],cD[cv]=dU.x,cD[cv+1]=dU.y,cD[cv+2]=dU.z,cD[cv+3]=dT.x,cD[cv+4]=dT.y,cD[cv+5]=dT.z,cD[cv+6]=dX.x,cD[cv+7]=dX.y,cD[cv+8]=dX.z,cD[cv+9]=ef.x,cD[cv+10]=ef.y,cD[cv+11]=ef.z,d5.morphNormals&&(d0?(bV=eq[d9].vertexNormals[ew],cj=bV.a,eG=bV.b,b3=bV.c,cV=bV.d):cV=b3=eG=cj=eq[d9].faceNormals[ew],ep=cF[d9],ep[cv]=cj.x,ep[cv+1]=cj.y,ep[cv+2]=cj.z,ep[cv+3]=eG.x,ep[cv+4]=eG.y,ep[cv+5]=eG.z,ep[cv+6]=b3.x,ep[cv+7]=b3.y,ep[cv+8]=b3.z,ep[cv+9]=cV.x,ep[cv+10]=cV.y,ep[cv+11]=cV.z),cv+=12}aG.bindBuffer(aG.ARRAY_BUFFER,ej.__webglMorphTargetsBuffers[d9]);aG.bufferData(aG.ARRAY_BUFFER,eN[d9],d8);d5.morphNormals&&(aG.bindBuffer(aG.ARRAY_BUFFER,ej.__webglMorphNormalsBuffers[d9]),aG.bufferData(aG.ARRAY_BUFFER,cF[d9],d8))}}if(en.length){eh=0;for(ei=cB.length;eh<ei;eh++){dW=bG[cB[eh]],dK=en[dW.a],dj=en[dW.b],cP=en[dW.c],cz[dM]=dK.x,cz[dM+1]=dK.y,cz[dM+2]=dK.z,cz[dM+3]=dK.w,cz[dM+4]=dj.x,cz[dM+5]=dj.y,cz[dM+6]=dj.z,cz[dM+7]=dj.w,cz[dM+8]=cP.x,cz[dM+9]=cP.y,cz[dM+10]=cP.z,cz[dM+11]=cP.w,bX=c7[dW.a],bM=c7[dW.b],l=c7[dW.c],cN[dM]=bX.x,cN[dM+1]=bX.y,cN[dM+2]=bX.z,cN[dM+3]=bX.w,cN[dM+4]=bM.x,cN[dM+5]=bM.y,cN[dM+6]=bM.z,cN[dM+7]=bM.w,cN[dM+8]=l.x,cN[dM+9]=l.y,cN[dM+10]=l.z,cN[dM+11]=l.w,dM+=12}eh=0;for(ei=cp.length;eh<ei;eh++){dW=bG[cp[eh]],dK=en[dW.a],dj=en[dW.b],cP=en[dW.c],cg=en[dW.d],cz[dM]=dK.x,cz[dM+1]=dK.y,cz[dM+2]=dK.z,cz[dM+3]=dK.w,cz[dM+4]=dj.x,cz[dM+5]=dj.y,cz[dM+6]=dj.z,cz[dM+7]=dj.w,cz[dM+8]=cP.x,cz[dM+9]=cP.y,cz[dM+10]=cP.z,cz[dM+11]=cP.w,cz[dM+12]=cg.x,cz[dM+13]=cg.y,cz[dM+14]=cg.z,cz[dM+15]=cg.w,bX=c7[dW.a],bM=c7[dW.b],l=c7[dW.c],dh=c7[dW.d],cN[dM]=bX.x,cN[dM+1]=bX.y,cN[dM+2]=bX.z,cN[dM+3]=bX.w,cN[dM+4]=bM.x,cN[dM+5]=bM.y,cN[dM+6]=bM.z,cN[dM+7]=bM.w,cN[dM+8]=l.x,cN[dM+9]=l.y,cN[dM+10]=l.z,cN[dM+11]=l.w,cN[dM+12]=dh.x,cN[dM+13]=dh.y,cN[dM+14]=dh.z,cN[dM+15]=dh.w,dM+=16}0<dM&&(aG.bindBuffer(aG.ARRAY_BUFFER,ej.__webglSkinIndicesBuffer),aG.bufferData(aG.ARRAY_BUFFER,cN,d8),aG.bindBuffer(aG.ARRAY_BUFFER,ej.__webglSkinWeightsBuffer),aG.bufferData(aG.ARRAY_BUFFER,cz,d8))}if(c4&&d2){eh=0;for(ei=cB.length;eh<ei;eh++){dW=bG[cB[eh]],dR=dW.vertexColors,dN=dW.color,3===dR.length&&d2===THREE.VertexColors?(bH=dR[0],et=dR[1],d=dR[2]):d=et=bH=dN,c8[dV]=bH.r,c8[dV+1]=bH.g,c8[dV+2]=bH.b,c8[dV+3]=et.r,c8[dV+4]=et.g,c8[dV+5]=et.b,c8[dV+6]=d.r,c8[dV+7]=d.g,c8[dV+8]=d.b,dV+=9}eh=0;for(ei=cp.length;eh<ei;eh++){dW=bG[cp[eh]],dR=dW.vertexColors,dN=dW.color,4===dR.length&&d2===THREE.VertexColors?(bH=dR[0],et=dR[1],d=dR[2],b9=dR[3]):b9=d=et=bH=dN,c8[dV]=bH.r,c8[dV+1]=bH.g,c8[dV+2]=bH.b,c8[dV+3]=et.r,c8[dV+4]=et.g,c8[dV+5]=et.b,c8[dV+6]=d.r,c8[dV+7]=d.g,c8[dV+8]=d.b,c8[dV+9]=b9.r,c8[dV+10]=b9.g,c8[dV+11]=b9.b,dV+=12}0<dV&&(aG.bindBuffer(aG.ARRAY_BUFFER,ej.__webglColorBuffer),aG.bufferData(aG.ARRAY_BUFFER,c8,d8))}if(f&&c1.hasTangents){eh=0;for(ei=cB.length;eh<ei;eh++){dW=bG[cB[eh]],c2=dW.vertexTangents,dL=c2[0],c9=c2[1],eO=c2[2],c0[b1]=dL.x,c0[b1+1]=dL.y,c0[b1+2]=dL.z,c0[b1+3]=dL.w,c0[b1+4]=c9.x,c0[b1+5]=c9.y,c0[b1+6]=c9.z,c0[b1+7]=c9.w,c0[b1+8]=eO.x,c0[b1+9]=eO.y,c0[b1+10]=eO.z,c0[b1+11]=eO.w,b1+=12}eh=0;for(ei=cp.length;eh<ei;eh++){dW=bG[cp[eh]],c2=dW.vertexTangents,dL=c2[0],c9=c2[1],eO=c2[2],bS=c2[3],c0[b1]=dL.x,c0[b1+1]=dL.y,c0[b1+2]=dL.z,c0[b1+3]=dL.w,c0[b1+4]=c9.x,c0[b1+5]=c9.y,c0[b1+6]=c9.z,c0[b1+7]=c9.w,c0[b1+8]=eO.x,c0[b1+9]=eO.y,c0[b1+10]=eO.z,c0[b1+11]=eO.w,c0[b1+12]=bS.x,c0[b1+13]=bS.y,c0[b1+14]=bS.z,c0[b1+15]=bS.w,b1+=16}aG.bindBuffer(aG.ARRAY_BUFFER,ej.__webglTangentBuffer);aG.bufferData(aG.ARRAY_BUFFER,c0,d8)}if(bJ&&dP){eh=0;for(ei=cB.length;eh<ei;eh++){if(dW=bG[cB[eh]],dY=dW.vertexNormals,cW=dW.normal,3===dY.length&&d0){for(ey=0;3>ey;ey++){t=dY[ey],h[bR]=t.x,h[bR+1]=t.y,h[bR+2]=t.z,bR+=3}}else{for(ey=0;3>ey;ey++){h[bR]=cW.x,h[bR+1]=cW.y,h[bR+2]=cW.z,bR+=3}}}eh=0;for(ei=cp.length;eh<ei;eh++){if(dW=bG[cp[eh]],dY=dW.vertexNormals,cW=dW.normal,4===dY.length&&d0){for(ey=0;4>ey;ey++){t=dY[ey],h[bR]=t.x,h[bR+1]=t.y,h[bR+2]=t.z,bR+=3}}else{for(ey=0;4>ey;ey++){h[bR]=cW.x,h[bR+1]=cW.y,h[bR+2]=cW.z,bR+=3}}}aG.bindBuffer(aG.ARRAY_BUFFER,ej.__webglNormalBuffer);aG.bufferData(aG.ARRAY_BUFFER,h,d8)}if(eF&&dG&&d1){eh=0;for(ei=cB.length;eh<ei;eh++){if(dZ=cB[eh],cJ=dG[dZ],void 0!==cJ){for(ey=0;3>ey;ey++){b6=cJ[ey],cI[ds]=b6.x,cI[ds+1]=b6.y,ds+=2}}}eh=0;for(ei=cp.length;eh<ei;eh++){if(dZ=cp[eh],cJ=dG[dZ],void 0!==cJ){for(ey=0;4>ey;ey++){b6=cJ[ey],cI[ds]=b6.x,cI[ds+1]=b6.y,ds+=2}}}0<ds&&(aG.bindBuffer(aG.ARRAY_BUFFER,ej.__webglUVBuffer),aG.bufferData(aG.ARRAY_BUFFER,cI,d8))}if(eF&&cY&&d1){eh=0;for(ei=cB.length;eh<ei;eh++){if(dZ=cB[eh],eC=cY[dZ],void 0!==eC){for(ey=0;3>ey;ey++){bK=eC[ey],b2[c5]=bK.x,b2[c5+1]=bK.y,c5+=2}}}eh=0;for(ei=cp.length;eh<ei;eh++){if(dZ=cp[eh],eC=cY[dZ],void 0!==eC){for(ey=0;4>ey;ey++){bK=eC[ey],b2[c5]=bK.x,b2[c5+1]=bK.y,c5+=2}}}0<c5&&(aG.bindBuffer(aG.ARRAY_BUFFER,ej.__webglUV2Buffer),aG.bufferData(aG.ARRAY_BUFFER,b2,d8))}if(eQ){eh=0;for(ei=cB.length;eh<ei;eh++){cL[df]=eL,cL[df+1]=eL+1,cL[df+2]=eL+2,df+=3,bL[dJ]=eL,bL[dJ+1]=eL+1,bL[dJ+2]=eL,bL[dJ+3]=eL+2,bL[dJ+4]=eL+1,bL[dJ+5]=eL+2,dJ+=6,eL+=3}eh=0;for(ei=cp.length;eh<ei;eh++){cL[df]=eL,cL[df+1]=eL+1,cL[df+2]=eL+3,cL[df+3]=eL+1,cL[df+4]=eL+2,cL[df+5]=eL+3,df+=6,bL[dJ]=eL,bL[dJ+1]=eL+1,bL[dJ+2]=eL,bL[dJ+3]=eL+3,bL[dJ+4]=eL+1,bL[dJ+5]=eL+2,bL[dJ+6]=eL+2,bL[dJ+7]=eL+3,dJ+=8,eL+=4}aG.bindBuffer(aG.ELEMENT_ARRAY_BUFFER,ej.__webglFaceBuffer);aG.bufferData(aG.ELEMENT_ARRAY_BUFFER,cL,d8);aG.bindBuffer(aG.ELEMENT_ARRAY_BUFFER,ej.__webglLineBuffer);aG.bufferData(aG.ELEMENT_ARRAY_BUFFER,bL,d8)}if(cr){ey=0;for(b8=cr.length;ey<b8;ey++){if(dn=cr[ey],dn.__original.needsUpdate){dl=0;if(1===dn.size){if(void 0===dn.boundTo||"vertices"===dn.boundTo){eh=0;for(ei=cB.length;eh<ei;eh++){dW=bG[cB[eh]],dn.array[dl]=dn.value[dW.a],dn.array[dl+1]=dn.value[dW.b],dn.array[dl+2]=dn.value[dW.c],dl+=3}eh=0;for(ei=cp.length;eh<ei;eh++){dW=bG[cp[eh]],dn.array[dl]=dn.value[dW.a],dn.array[dl+1]=dn.value[dW.b],dn.array[dl+2]=dn.value[dW.c],dn.array[dl+3]=dn.value[dW.d],dl+=4}}else{if("faces"===dn.boundTo){eh=0;for(ei=cB.length;eh<ei;eh++){cH=dn.value[cB[eh]],dn.array[dl]=cH,dn.array[dl+1]=cH,dn.array[dl+2]=cH,dl+=3}eh=0;for(ei=cp.length;eh<ei;eh++){cH=dn.value[cp[eh]],dn.array[dl]=cH,dn.array[dl+1]=cH,dn.array[dl+2]=cH,dn.array[dl+3]=cH,dl+=4}}}}else{if(2===dn.size){if(void 0===dn.boundTo||"vertices"===dn.boundTo){eh=0;for(ei=cB.length;eh<ei;eh++){dW=bG[cB[eh]],dU=dn.value[dW.a],dT=dn.value[dW.b],dX=dn.value[dW.c],dn.array[dl]=dU.x,dn.array[dl+1]=dU.y,dn.array[dl+2]=dT.x,dn.array[dl+3]=dT.y,dn.array[dl+4]=dX.x,dn.array[dl+5]=dX.y,dl+=6}eh=0;for(ei=cp.length;eh<ei;eh++){dW=bG[cp[eh]],dU=dn.value[dW.a],dT=dn.value[dW.b],dX=dn.value[dW.c],ef=dn.value[dW.d],dn.array[dl]=dU.x,dn.array[dl+1]=dU.y,dn.array[dl+2]=dT.x,dn.array[dl+3]=dT.y,dn.array[dl+4]=dX.x,dn.array[dl+5]=dX.y,dn.array[dl+6]=ef.x,dn.array[dl+7]=ef.y,dl+=8}}else{if("faces"===dn.boundTo){eh=0;for(ei=cB.length;eh<ei;eh++){dX=dT=dU=cH=dn.value[cB[eh]],dn.array[dl]=dU.x,dn.array[dl+1]=dU.y,dn.array[dl+2]=dT.x,dn.array[dl+3]=dT.y,dn.array[dl+4]=dX.x,dn.array[dl+5]=dX.y,dl+=6}eh=0;for(ei=cp.length;eh<ei;eh++){ef=dX=dT=dU=cH=dn.value[cp[eh]],dn.array[dl]=dU.x,dn.array[dl+1]=dU.y,dn.array[dl+2]=dT.x,dn.array[dl+3]=dT.y,dn.array[dl+4]=dX.x,dn.array[dl+5]=dX.y,dn.array[dl+6]=ef.x,dn.array[dl+7]=ef.y,dl+=8}}}}else{if(3===dn.size){var dO;dO="c"===dn.type?["r","g","b"]:["x","y","z"];if(void 0===dn.boundTo||"vertices"===dn.boundTo){eh=0;for(ei=cB.length;eh<ei;eh++){dW=bG[cB[eh]],dU=dn.value[dW.a],dT=dn.value[dW.b],dX=dn.value[dW.c],dn.array[dl]=dU[dO[0]],dn.array[dl+1]=dU[dO[1]],dn.array[dl+2]=dU[dO[2]],dn.array[dl+3]=dT[dO[0]],dn.array[dl+4]=dT[dO[1]],dn.array[dl+5]=dT[dO[2]],dn.array[dl+6]=dX[dO[0]],dn.array[dl+7]=dX[dO[1]],dn.array[dl+8]=dX[dO[2]],dl+=9}eh=0;for(ei=cp.length;eh<ei;eh++){dW=bG[cp[eh]],dU=dn.value[dW.a],dT=dn.value[dW.b],dX=dn.value[dW.c],ef=dn.value[dW.d],dn.array[dl]=dU[dO[0]],dn.array[dl+1]=dU[dO[1]],dn.array[dl+2]=dU[dO[2]],dn.array[dl+3]=dT[dO[0]],dn.array[dl+4]=dT[dO[1]],dn.array[dl+5]=dT[dO[2]],dn.array[dl+6]=dX[dO[0]],dn.array[dl+7]=dX[dO[1]],dn.array[dl+8]=dX[dO[2]],dn.array[dl+9]=ef[dO[0]],dn.array[dl+10]=ef[dO[1]],dn.array[dl+11]=ef[dO[2]],dl+=12}}else{if("faces"===dn.boundTo){eh=0;for(ei=cB.length;eh<ei;eh++){dX=dT=dU=cH=dn.value[cB[eh]],dn.array[dl]=dU[dO[0]],dn.array[dl+1]=dU[dO[1]],dn.array[dl+2]=dU[dO[2]],dn.array[dl+3]=dT[dO[0]],dn.array[dl+4]=dT[dO[1]],dn.array[dl+5]=dT[dO[2]],dn.array[dl+6]=dX[dO[0]],dn.array[dl+7]=dX[dO[1]],dn.array[dl+8]=dX[dO[2]],dl+=9}eh=0;for(ei=cp.length;eh<ei;eh++){ef=dX=dT=dU=cH=dn.value[cp[eh]],dn.array[dl]=dU[dO[0]],dn.array[dl+1]=dU[dO[1]],dn.array[dl+2]=dU[dO[2]],dn.array[dl+3]=dT[dO[0]],dn.array[dl+4]=dT[dO[1]],dn.array[dl+5]=dT[dO[2]],dn.array[dl+6]=dX[dO[0]],dn.array[dl+7]=dX[dO[1]],dn.array[dl+8]=dX[dO[2]],dn.array[dl+9]=ef[dO[0]],dn.array[dl+10]=ef[dO[1]],dn.array[dl+11]=ef[dO[2]],dl+=12}}else{if("faceVertices"===dn.boundTo){eh=0;for(ei=cB.length;eh<ei;eh++){cH=dn.value[cB[eh]],dU=cH[0],dT=cH[1],dX=cH[2],dn.array[dl]=dU[dO[0]],dn.array[dl+1]=dU[dO[1]],dn.array[dl+2]=dU[dO[2]],dn.array[dl+3]=dT[dO[0]],dn.array[dl+4]=dT[dO[1]],dn.array[dl+5]=dT[dO[2]],dn.array[dl+6]=dX[dO[0]],dn.array[dl+7]=dX[dO[1]],dn.array[dl+8]=dX[dO[2]],dl+=9}eh=0;for(ei=cp.length;eh<ei;eh++){cH=dn.value[cp[eh]],dU=cH[0],dT=cH[1],dX=cH[2],ef=cH[3],dn.array[dl]=dU[dO[0]],dn.array[dl+1]=dU[dO[1]],dn.array[dl+2]=dU[dO[2]],dn.array[dl+3]=dT[dO[0]],dn.array[dl+4]=dT[dO[1]],dn.array[dl+5]=dT[dO[2]],dn.array[dl+6]=dX[dO[0]],dn.array[dl+7]=dX[dO[1]],dn.array[dl+8]=dX[dO[2]],dn.array[dl+9]=ef[dO[0]],dn.array[dl+10]=ef[dO[1]],dn.array[dl+11]=ef[dO[2]],dl+=12}}}}}else{if(4===dn.size){if(void 0===dn.boundTo||"vertices"===dn.boundTo){eh=0;for(ei=cB.length;eh<ei;eh++){dW=bG[cB[eh]],dU=dn.value[dW.a],dT=dn.value[dW.b],dX=dn.value[dW.c],dn.array[dl]=dU.x,dn.array[dl+1]=dU.y,dn.array[dl+2]=dU.z,dn.array[dl+3]=dU.w,dn.array[dl+4]=dT.x,dn.array[dl+5]=dT.y,dn.array[dl+6]=dT.z,dn.array[dl+7]=dT.w,dn.array[dl+8]=dX.x,dn.array[dl+9]=dX.y,dn.array[dl+10]=dX.z,dn.array[dl+11]=dX.w,dl+=12}eh=0;for(ei=cp.length;eh<ei;eh++){dW=bG[cp[eh]],dU=dn.value[dW.a],dT=dn.value[dW.b],dX=dn.value[dW.c],ef=dn.value[dW.d],dn.array[dl]=dU.x,dn.array[dl+1]=dU.y,dn.array[dl+2]=dU.z,dn.array[dl+3]=dU.w,dn.array[dl+4]=dT.x,dn.array[dl+5]=dT.y,dn.array[dl+6]=dT.z,dn.array[dl+7]=dT.w,dn.array[dl+8]=dX.x,dn.array[dl+9]=dX.y,dn.array[dl+10]=dX.z,dn.array[dl+11]=dX.w,dn.array[dl+12]=ef.x,dn.array[dl+13]=ef.y,dn.array[dl+14]=ef.z,dn.array[dl+15]=ef.w,dl+=16}}else{if("faces"===dn.boundTo){eh=0;for(ei=cB.length;eh<ei;eh++){dX=dT=dU=cH=dn.value[cB[eh]],dn.array[dl]=dU.x,dn.array[dl+1]=dU.y,dn.array[dl+2]=dU.z,dn.array[dl+3]=dU.w,dn.array[dl+4]=dT.x,dn.array[dl+5]=dT.y,dn.array[dl+6]=dT.z,dn.array[dl+7]=dT.w,dn.array[dl+8]=dX.x,dn.array[dl+9]=dX.y,dn.array[dl+10]=dX.z,dn.array[dl+11]=dX.w,dl+=12}eh=0;for(ei=cp.length;eh<ei;eh++){ef=dX=dT=dU=cH=dn.value[cp[eh]],dn.array[dl]=dU.x,dn.array[dl+1]=dU.y,dn.array[dl+2]=dU.z,dn.array[dl+3]=dU.w,dn.array[dl+4]=dT.x,dn.array[dl+5]=dT.y,dn.array[dl+6]=dT.z,dn.array[dl+7]=dT.w,dn.array[dl+8]=dX.x,dn.array[dl+9]=dX.y,dn.array[dl+10]=dX.z,dn.array[dl+11]=dX.w,dn.array[dl+12]=ef.x,dn.array[dl+13]=ef.y,dn.array[dl+14]=ef.z,dn.array[dl+15]=ef.w,dl+=16}}else{if("faceVertices"===dn.boundTo){eh=0;for(ei=cB.length;eh<ei;eh++){cH=dn.value[cB[eh]],dU=cH[0],dT=cH[1],dX=cH[2],dn.array[dl]=dU.x,dn.array[dl+1]=dU.y,dn.array[dl+2]=dU.z,dn.array[dl+3]=dU.w,dn.array[dl+4]=dT.x,dn.array[dl+5]=dT.y,dn.array[dl+6]=dT.z,dn.array[dl+7]=dT.w,dn.array[dl+8]=dX.x,dn.array[dl+9]=dX.y,dn.array[dl+10]=dX.z,dn.array[dl+11]=dX.w,dl+=12}eh=0;for(ei=cp.length;eh<ei;eh++){cH=dn.value[cp[eh]],dU=cH[0],dT=cH[1],dX=cH[2],ef=cH[3],dn.array[dl]=dU.x,dn.array[dl+1]=dU.y,dn.array[dl+2]=dU.z,dn.array[dl+3]=dU.w,dn.array[dl+4]=dT.x,dn.array[dl+5]=dT.y,dn.array[dl+6]=dT.z,dn.array[dl+7]=dT.w,dn.array[dl+8]=dX.x,dn.array[dl+9]=dX.y,dn.array[dl+10]=dX.z,dn.array[dl+11]=dX.w,dn.array[dl+12]=ef.x,dn.array[dl+13]=ef.y,dn.array[dl+14]=ef.z,dn.array[dl+15]=ef.w,dl+=16}}}}}}}}aG.bindBuffer(aG.ARRAY_BUFFER,dn.buffer);aG.bufferData(aG.ARRAY_BUFFER,dn.array,d8)}}}d7&&(delete ej.__inittedArrays,delete ej.__colorArray,delete ej.__normalArray,delete ej.__tangentArray,delete ej.__uvArray,delete ej.__uv2Array,delete ej.__faceArray,delete ej.__vertexArray,delete ej.__lineArray,delete ej.__skinIndexArray,delete ej.__skinWeightArray)}}}dw.verticesNeedUpdate=!1;dw.morphTargetsNeedUpdate=!1;dw.elementsNeedUpdate=!1;dw.uvsNeedUpdate=!1;dw.normalsNeedUpdate=!1;dw.colorsNeedUpdate=!1;dw.tangentsNeedUpdate=!1;dw.buffersNeedUpdate=!1;dt.attributes&&az(dt)}else{if(dy instanceof THREE.Ribbon){dt=aO(dy,dw);du=dt.attributes&&aA(dt);if(dw.verticesNeedUpdate||dw.colorsNeedUpdate||dw.normalsNeedUpdate||du){var cf=dw,de=aG.DYNAMIC_DRAW,es=void 0,dI=void 0,dg=void 0,eK=void 0,cs=void 0,ev=void 0,k=void 0,eM=void 0,ct=void 0,cu=void 0,ch=void 0,er=void 0,cO=void 0,u=cf.vertices,eR=cf.colors,eH=cf.normals,b7=u.length,bW=eR.length,cQ=eH.length,ex=cf.__vertexArray,cE=cf.__colorArray,cq=cf.__normalArray,cC=cf.colorsNeedUpdate,el=cf.normalsNeedUpdate,cX=cf.__webglCustomAttributesList;if(cf.verticesNeedUpdate){for(es=0;es<b7;es++){eK=u[es],cs=3*es,ex[cs]=eK.x,ex[cs+1]=eK.y,ex[cs+2]=eK.z}aG.bindBuffer(aG.ARRAY_BUFFER,cf.__webglVertexBuffer);aG.bufferData(aG.ARRAY_BUFFER,ex,de)}if(cC){for(dI=0;dI<bW;dI++){ev=eR[dI],cs=3*dI,cE[cs]=ev.r,cE[cs+1]=ev.g,cE[cs+2]=ev.b}aG.bindBuffer(aG.ARRAY_BUFFER,cf.__webglColorBuffer);aG.bufferData(aG.ARRAY_BUFFER,cE,de)}if(el){for(dg=0;dg<cQ;dg++){k=eH[dg],cs=3*dg,cq[cs]=k.x,cq[cs+1]=k.y,cq[cs+2]=k.z}aG.bindBuffer(aG.ARRAY_BUFFER,cf.__webglNormalBuffer);aG.bufferData(aG.ARRAY_BUFFER,cq,de)}if(cX){eM=0;for(ct=cX.length;eM<ct;eM++){if(er=cX[eM],er.needsUpdate&&(void 0===er.boundTo||"vertices"===er.boundTo)){cs=0;ch=er.value.length;if(1===er.size){for(cu=0;cu<ch;cu++){er.array[cu]=er.value[cu]}}else{if(2===er.size){for(cu=0;cu<ch;cu++){cO=er.value[cu],er.array[cs]=cO.x,er.array[cs+1]=cO.y,cs+=2}}else{if(3===er.size){if("c"===er.type){for(cu=0;cu<ch;cu++){cO=er.value[cu],er.array[cs]=cO.r,er.array[cs+1]=cO.g,er.array[cs+2]=cO.b,cs+=3}}else{for(cu=0;cu<ch;cu++){cO=er.value[cu],er.array[cs]=cO.x,er.array[cs+1]=cO.y,er.array[cs+2]=cO.z,cs+=3}}}else{if(4===er.size){for(cu=0;cu<ch;cu++){cO=er.value[cu],er.array[cs]=cO.x,er.array[cs+1]=cO.y,er.array[cs+2]=cO.z,er.array[cs+3]=cO.w,cs+=4}}}}}aG.bindBuffer(aG.ARRAY_BUFFER,er.buffer);aG.bufferData(aG.ARRAY_BUFFER,er.array,de)}}}}dw.verticesNeedUpdate=!1;dw.colorsNeedUpdate=!1;dw.normalsNeedUpdate=!1;dt.attributes&&az(dt)}else{if(dy instanceof THREE.Line){dt=aO(dy,dw);du=dt.attributes&&aA(dt);if(dw.verticesNeedUpdate||dw.colorsNeedUpdate||dw.lineDistancesNeedUpdate||du){var bZ=dw,ce=aG.DYNAMIC_DRAW,cZ=void 0,cM=void 0,cy=void 0,bY=void 0,cn=void 0,bN=void 0,bT=bZ.vertices,bI=bZ.colors,e=bZ.lineDistances,ez=bT.length,d4=bI.length,dx=e.length,r=bZ.__vertexArray,eP=bZ.__colorArray,eJ=bZ.__lineDistanceArray,c6=bZ.colorsNeedUpdate,cT=bZ.lineDistancesNeedUpdate,cK=bZ.__webglCustomAttributesList,eE=void 0,eu=void 0,ci=void 0,b0=void 0,cA=void 0,dH=void 0;if(bZ.verticesNeedUpdate){for(cZ=0;cZ<ez;cZ++){bY=bT[cZ],cn=3*cZ,r[cn]=bY.x,r[cn+1]=bY.y,r[cn+2]=bY.z}aG.bindBuffer(aG.ARRAY_BUFFER,bZ.__webglVertexBuffer);aG.bufferData(aG.ARRAY_BUFFER,r,ce)}if(c6){for(cM=0;cM<d4;cM++){bN=bI[cM],cn=3*cM,eP[cn]=bN.r,eP[cn+1]=bN.g,eP[cn+2]=bN.b}aG.bindBuffer(aG.ARRAY_BUFFER,bZ.__webglColorBuffer);aG.bufferData(aG.ARRAY_BUFFER,eP,ce)}if(cT){for(cy=0;cy<dx;cy++){eJ[cy]=e[cy]}aG.bindBuffer(aG.ARRAY_BUFFER,bZ.__webglLineDistanceBuffer);aG.bufferData(aG.ARRAY_BUFFER,eJ,ce)}if(cK){eE=0;for(eu=cK.length;eE<eu;eE++){if(dH=cK[eE],dH.needsUpdate&&(void 0===dH.boundTo||"vertices"===dH.boundTo)){cn=0;b0=dH.value.length;if(1===dH.size){for(ci=0;ci<b0;ci++){dH.array[ci]=dH.value[ci]}}else{if(2===dH.size){for(ci=0;ci<b0;ci++){cA=dH.value[ci],dH.array[cn]=cA.x,dH.array[cn+1]=cA.y,cn+=2}}else{if(3===dH.size){if("c"===dH.type){for(ci=0;ci<b0;ci++){cA=dH.value[ci],dH.array[cn]=cA.r,dH.array[cn+1]=cA.g,dH.array[cn+2]=cA.b,cn+=3}}else{for(ci=0;ci<b0;ci++){cA=dH.value[ci],dH.array[cn]=cA.x,dH.array[cn+1]=cA.y,dH.array[cn+2]=cA.z,cn+=3}}}else{if(4===dH.size){for(ci=0;ci<b0;ci++){cA=dH.value[ci],dH.array[cn]=cA.x,dH.array[cn+1]=cA.y,dH.array[cn+2]=cA.z,dH.array[cn+3]=cA.w,cn+=4}}}}}aG.bindBuffer(aG.ARRAY_BUFFER,dH.buffer);aG.bufferData(aG.ARRAY_BUFFER,dH.array,ce)}}}}dw.verticesNeedUpdate=!1;dw.colorsNeedUpdate=!1;dw.lineDistancesNeedUpdate=!1;dt.attributes&&az(dt)}else{if(dy instanceof THREE.ParticleSystem){dt=aO(dy,dw);du=dt.attributes&&aA(dt);if(dw.verticesNeedUpdate||dw.colorsNeedUpdate||dy.sortParticles||du){var cx=dw,cw=aG.DYNAMIC_DRAW,cm=dy,co=void 0,cl=void 0,b5=void 0,dC=void 0,bU=void 0,d6=void 0,eo=cx.vertices,ck=eo.length,b4=cx.colors,dQ=b4.length,cU=cx.__vertexArray,cG=cx.__colorArray,dS=cx.__sortArray,dp=cx.verticesNeedUpdate,c3=cx.colorsNeedUpdate,dq=cx.__webglCustomAttributesList,bO=void 0,bQ=void 0,eI=void 0,s=void 0,bP=void 0,eD=void 0;if(cm.sortParticles){bB.copy(o);bB.multiply(cm.matrixWorld);for(co=0;co<ck;co++){b5=eo[co],bE.copy(b5),bE.applyProjection(bB),dS[co]=[bE.z,co]}dS.sort(aF);for(co=0;co<ck;co++){b5=eo[dS[co][1]],dC=3*co,cU[dC]=b5.x,cU[dC+1]=b5.y,cU[dC+2]=b5.z}for(cl=0;cl<dQ;cl++){dC=3*cl,d6=b4[dS[cl][1]],cG[dC]=d6.r,cG[dC+1]=d6.g,cG[dC+2]=d6.b}if(dq){bO=0;for(bQ=dq.length;bO<bQ;bO++){if(eD=dq[bO],void 0===eD.boundTo||"vertices"===eD.boundTo){if(dC=0,s=eD.value.length,1===eD.size){for(eI=0;eI<s;eI++){bU=dS[eI][1],eD.array[eI]=eD.value[bU]}}else{if(2===eD.size){for(eI=0;eI<s;eI++){bU=dS[eI][1],bP=eD.value[bU],eD.array[dC]=bP.x,eD.array[dC+1]=bP.y,dC+=2}}else{if(3===eD.size){if("c"===eD.type){for(eI=0;eI<s;eI++){bU=dS[eI][1],bP=eD.value[bU],eD.array[dC]=bP.r,eD.array[dC+1]=bP.g,eD.array[dC+2]=bP.b,dC+=3}}else{for(eI=0;eI<s;eI++){bU=dS[eI][1],bP=eD.value[bU],eD.array[dC]=bP.x,eD.array[dC+1]=bP.y,eD.array[dC+2]=bP.z,dC+=3}}}else{if(4===eD.size){for(eI=0;eI<s;eI++){bU=dS[eI][1],bP=eD.value[bU],eD.array[dC]=bP.x,eD.array[dC+1]=bP.y,eD.array[dC+2]=bP.z,eD.array[dC+3]=bP.w,dC+=4}}}}}}}}}else{if(dp){for(co=0;co<ck;co++){b5=eo[co],dC=3*co,cU[dC]=b5.x,cU[dC+1]=b5.y,cU[dC+2]=b5.z}}if(c3){for(cl=0;cl<dQ;cl++){d6=b4[cl],dC=3*cl,cG[dC]=d6.r,cG[dC+1]=d6.g,cG[dC+2]=d6.b}}if(dq){bO=0;for(bQ=dq.length;bO<bQ;bO++){if(eD=dq[bO],eD.needsUpdate&&(void 0===eD.boundTo||"vertices"===eD.boundTo)){if(s=eD.value.length,dC=0,1===eD.size){for(eI=0;eI<s;eI++){eD.array[eI]=eD.value[eI]}}else{if(2===eD.size){for(eI=0;eI<s;eI++){bP=eD.value[eI],eD.array[dC]=bP.x,eD.array[dC+1]=bP.y,dC+=2}}else{if(3===eD.size){if("c"===eD.type){for(eI=0;eI<s;eI++){bP=eD.value[eI],eD.array[dC]=bP.r,eD.array[dC+1]=bP.g,eD.array[dC+2]=bP.b,dC+=3}}else{for(eI=0;eI<s;eI++){bP=eD.value[eI],eD.array[dC]=bP.x,eD.array[dC+1]=bP.y,eD.array[dC+2]=bP.z,dC+=3}}}else{if(4===eD.size){for(eI=0;eI<s;eI++){bP=eD.value[eI],eD.array[dC]=bP.x,eD.array[dC+1]=bP.y,eD.array[dC+2]=bP.z,eD.array[dC+3]=bP.w,dC+=4}}}}}}}}}if(dp||cm.sortParticles){aG.bindBuffer(aG.ARRAY_BUFFER,cx.__webglVertexBuffer),aG.bufferData(aG.ARRAY_BUFFER,cU,cw)}if(c3||cm.sortParticles){aG.bindBuffer(aG.ARRAY_BUFFER,cx.__webglColorBuffer),aG.bufferData(aG.ARRAY_BUFFER,cG,cw)}if(dq){bO=0;for(bQ=dq.length;bO<bQ;bO++){if(eD=dq[bO],eD.needsUpdate||cm.sortParticles){aG.bindBuffer(aG.ARRAY_BUFFER,eD.buffer),aG.bufferData(aG.ARRAY_BUFFER,eD.array,cw)}}}}dw.verticesNeedUpdate=!1;dw.colorsNeedUpdate=!1;dt.attributes&&az(dt)}}}}}}};this.initMaterial=function(bG,ab,aa,Z){var X,V,O,T;bG.addEventListener("dispose",aU);var N,L,K,J,I;bG instanceof THREE.MeshDepthMaterial?I="depth":bG instanceof THREE.MeshNormalMaterial?I="normal":bG instanceof THREE.MeshBasicMaterial?I="basic":bG instanceof THREE.MeshLambertMaterial?I="lambert":bG instanceof THREE.MeshPhongMaterial?I="phong":bG instanceof THREE.LineBasicMaterial?I="basic":bG instanceof THREE.LineDashedMaterial?I="dashed":bG instanceof THREE.ParticleBasicMaterial&&(I="particle_basic");if(I){var H=THREE.ShaderLib[I];bG.uniforms=THREE.UniformsUtils.clone(H.uniforms);bG.vertexShader=H.vertexShader;bG.fragmentShader=H.fragmentShader}var G=X=0,F=0;V=H=0;for(var D=ab.length;V<D;V++){O=ab[V],O.onlyShadow||(O instanceof THREE.DirectionalLight&&X++,O instanceof THREE.PointLight&&G++,O instanceof THREE.SpotLight&&F++,O instanceof THREE.HemisphereLight&&H++)}V=G;O=F;T=H;F=H=0;for(G=ab.length;F<G;F++){D=ab[F],D.castShadow&&(D instanceof THREE.SpotLight&&H++,D instanceof THREE.DirectionalLight&&!D.shadowCascade&&H++)}J=H;bq&&Z&&Z.useVertexTexture?K=1024:(ab=aG.getParameter(aG.MAX_VERTEX_UNIFORM_VECTORS),ab=Math.floor((ab-20)/4),void 0!==Z&&Z instanceof THREE.SkinnedMesh&&(ab=Math.min(Z.bones.length,ab),ab<Z.bones.length&&console.warn("WebGLRenderer: too many bones - "+Z.bones.length+", this GPU supports just "+ab+" (try OpenGL instead of ANGLE)")),K=ab);bG:{var F=bG.fragmentShader,G=bG.vertexShader,H=bG.uniforms,ab=bG.attributes,D=bG.defines,aa={map:!!bG.map,envMap:!!bG.envMap,lightMap:!!bG.lightMap,bumpMap:!!bG.bumpMap,normalMap:!!bG.normalMap,specularMap:!!bG.specularMap,vertexColors:bG.vertexColors,fog:aa,useFog:bG.fog,fogExp:aa instanceof THREE.FogExp2,sizeAttenuation:bG.sizeAttenuation,skinning:bG.skinning,maxBones:K,useVertexTexture:bq&&Z&&Z.useVertexTexture,boneTextureWidth:Z&&Z.boneTextureWidth,boneTextureHeight:Z&&Z.boneTextureHeight,morphTargets:bG.morphTargets,morphNormals:bG.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:X,maxPointLights:V,maxSpotLights:O,maxHemiLights:T,maxShadows:J,shadowMapEnabled:this.shadowMapEnabled&&Z.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:bG.alphaTest,metal:bG.metal,perPixel:bG.perPixel,wrapAround:bG.wrapAround,doubleSided:bG.side===THREE.DoubleSide,flipSided:bG.side===THREE.BackSide},C,B,A,Z=[];I?Z.push(I):(Z.push(F),Z.push(G));for(B in D){Z.push(B),Z.push(D[B])}for(C in aa){Z.push(C),Z.push(aa[C])}I=Z.join();C=0;for(B=a1.length;C<B;C++){if(Z=a1[C],Z.code===I){Z.usedTimes++;L=Z.program;break bG}}C="SHADOWMAP_TYPE_BASIC";aa.shadowMapType===THREE.PCFShadowMap?C="SHADOWMAP_TYPE_PCF":aa.shadowMapType===THREE.PCFSoftShadowMap&&(C="SHADOWMAP_TYPE_PCF_SOFT");B=[];for(A in D){Z=D[A],!1!==Z&&(Z="#define "+A+" "+Z,B.push(Z))}Z=B.join("\n");A=aG.createProgram();B=["precision "+a6+" float;",Z,bC?"#define VERTEX_TEXTURES":"",bh.gammaInput?"#define GAMMA_INPUT":"",bh.gammaOutput?"#define GAMMA_OUTPUT":"",bh.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+aa.maxDirLights,"#define MAX_POINT_LIGHTS "+aa.maxPointLights,"#define MAX_SPOT_LIGHTS "+aa.maxSpotLights,"#define MAX_HEMI_LIGHTS "+aa.maxHemiLights,"#define MAX_SHADOWS "+aa.maxShadows,"#define MAX_BONES "+aa.maxBones,aa.map?"#define USE_MAP":"",aa.envMap?"#define USE_ENVMAP":"",aa.lightMap?"#define USE_LIGHTMAP":"",aa.bumpMap?"#define USE_BUMPMAP":"",aa.normalMap?"#define USE_NORMALMAP":"",aa.specularMap?"#define USE_SPECULARMAP":"",aa.vertexColors?"#define USE_COLOR":"",aa.skinning?"#define USE_SKINNING":"",aa.useVertexTexture?"#define BONE_TEXTURE":"",aa.boneTextureWidth?"#define N_BONE_PIXEL_X "+aa.boneTextureWidth.toFixed(1):"",aa.boneTextureHeight?"#define N_BONE_PIXEL_Y "+aa.boneTextureHeight.toFixed(1):"",aa.morphTargets?"#define USE_MORPHTARGETS":"",aa.morphNormals?"#define USE_MORPHNORMALS":"",aa.perPixel?"#define PHONG_PER_PIXEL":"",aa.wrapAround?"#define WRAP_AROUND":"",aa.doubleSided?"#define DOUBLE_SIDED":"",aa.flipSided?"#define FLIP_SIDED":"",aa.shadowMapEnabled?"#define USE_SHADOWMAP":"",aa.shadowMapEnabled?"#define "+C:"",aa.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",aa.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",aa.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n");C=["precision "+a6+" float;",aa.bumpMap||aa.normalMap?"#extension GL_OES_standard_derivatives : enable":"",Z,"#define MAX_DIR_LIGHTS "+aa.maxDirLights,"#define MAX_POINT_LIGHTS "+aa.maxPointLights,"#define MAX_SPOT_LIGHTS "+aa.maxSpotLights,"#define MAX_HEMI_LIGHTS "+aa.maxHemiLights,"#define MAX_SHADOWS "+aa.maxShadows,aa.alphaTest?"#define ALPHATEST "+aa.alphaTest:"",bh.gammaInput?"#define GAMMA_INPUT":"",bh.gammaOutput?"#define GAMMA_OUTPUT":"",bh.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",aa.useFog&&aa.fog?"#define USE_FOG":"",aa.useFog&&aa.fogExp?"#define FOG_EXP2":"",aa.map?"#define USE_MAP":"",aa.envMap?"#define USE_ENVMAP":"",aa.lightMap?"#define USE_LIGHTMAP":"",aa.bumpMap?"#define USE_BUMPMAP":"",aa.normalMap?"#define USE_NORMALMAP":"",aa.specularMap?"#define USE_SPECULARMAP":"",aa.vertexColors?"#define USE_COLOR":"",aa.metal?"#define METAL":"",aa.perPixel?"#define PHONG_PER_PIXEL":"",aa.wrapAround?"#define WRAP_AROUND":"",aa.doubleSided?"#define DOUBLE_SIDED":"",aa.flipSided?"#define FLIP_SIDED":"",aa.shadowMapEnabled?"#define USE_SHADOWMAP":"",aa.shadowMapEnabled?"#define "+C:"",aa.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",aa.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n");B=a8("vertex",B+G);C=a8("fragment",C+F);aG.attachShader(A,B);aG.attachShader(A,C);aG.linkProgram(A);aG.getProgramParameter(A,aG.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+aG.getProgramParameter(A,aG.VALIDATE_STATUS)+", gl error ["+aG.getError()+"]");aG.deleteShader(C);aG.deleteShader(B);A.uniforms={};A.attributes={};var k;C="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences".split(" ");aa.useVertexTexture?C.push("boneTexture"):C.push("boneGlobalMatrices");for(k in H){C.push(k)}k=C;C=0;for(B=k.length;C<B;C++){H=k[C],A.uniforms[H]=aG.getUniformLocation(A,H)}C="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(k=0;k<aa.maxMorphTargets;k++){C.push("morphTarget"+k)}for(k=0;k<aa.maxMorphNormals;k++){C.push("morphNormal"+k)}for(L in ab){C.push(L)}L=C;k=0;for(ab=L.length;k<ab;k++){C=L[k],A.attributes[C]=aG.getAttribLocation(A,C)}A.id=S++;a1.push({program:A,code:I,usedTimes:1});bh.info.memory.programs=a1.length;L=A}bG.program=L;k=bG.program.attributes;if(bG.morphTargets){bG.numSupportedMorphTargets=0;ab="morphTarget";for(L=0;L<this.maxMorphTargets;L++){A=ab+L,0<=k[A]&&bG.numSupportedMorphTargets++}}if(bG.morphNormals){bG.numSupportedMorphNormals=0;ab="morphNormal";for(L=0;L<this.maxMorphNormals;L++){A=ab+L,0<=k[A]&&bG.numSupportedMorphNormals++}}bG.uniformsList=[];for(N in bG.uniforms){bG.uniformsList.push([bG.uniforms[N],N])}};this.setFaceCulling=function(d,c){d===THREE.CullFaceNone?aG.disable(aG.CULL_FACE):(c===THREE.FrontFaceDirectionCW?aG.frontFace(aG.CW):aG.frontFace(aG.CCW),d===THREE.CullFaceBack?aG.cullFace(aG.BACK):d===THREE.CullFaceFront?aG.cullFace(aG.FRONT):aG.cullFace(aG.FRONT_AND_BACK),aG.enable(aG.CULL_FACE))};this.setMaterialFaces=function(d){var c=d.side===THREE.DoubleSide,d=d.side===THREE.BackSide;aj!==c&&(c?aG.disable(aG.CULL_FACE):aG.enable(aG.CULL_FACE),aj=c);a2!==d&&(d?aG.frontFace(aG.CW):aG.frontFace(aG.CCW),a2=d)};this.setDepthTest=function(b){E!==b&&(b?aG.enable(aG.DEPTH_TEST):aG.disable(aG.DEPTH_TEST),E=b)};this.setDepthWrite=function(b){bn!==b&&(aG.depthMask(b),bn=b)};this.setBlending=function(f,e,h,g){f!==bo&&(f===THREE.NoBlending?aG.disable(aG.BLEND):f===THREE.AdditiveBlending?(aG.enable(aG.BLEND),aG.blendEquation(aG.FUNC_ADD),aG.blendFunc(aG.SRC_ALPHA,aG.ONE)):f===THREE.SubtractiveBlending?(aG.enable(aG.BLEND),aG.blendEquation(aG.FUNC_ADD),aG.blendFunc(aG.ZERO,aG.ONE_MINUS_SRC_COLOR)):f===THREE.MultiplyBlending?(aG.enable(aG.BLEND),aG.blendEquation(aG.FUNC_ADD),aG.blendFunc(aG.ZERO,aG.SRC_COLOR)):f===THREE.CustomBlending?aG.enable(aG.BLEND):(aG.enable(aG.BLEND),aG.blendEquationSeparate(aG.FUNC_ADD,aG.FUNC_ADD),aG.blendFuncSeparate(aG.SRC_ALPHA,aG.ONE_MINUS_SRC_ALPHA,aG.ONE,aG.ONE_MINUS_SRC_ALPHA)),bo=f);if(f===THREE.CustomBlending){if(e!==bg&&(aG.blendEquation(aw(e)),bg=e),h!==a9||g!==a0){aG.blendFunc(aw(h),aw(g)),a9=h,a0=g}}else{a0=a9=bg=null}};this.setTexture=function(s,r){if(s.needsUpdate){s.__webglInit||(s.__webglInit=!0,s.addEventListener("dispose",bp),s.__webglTexture=aG.createTexture(),bh.info.memory.textures++);aG.activeTexture(aG.TEXTURE0+r);aG.bindTexture(aG.TEXTURE_2D,s.__webglTexture);aG.pixelStorei(aG.UNPACK_FLIP_Y_WEBGL,s.flipY);aG.pixelStorei(aG.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha);aG.pixelStorei(aG.UNPACK_ALIGNMENT,s.unpackAlignment);var q=s.image,p=0===(q.width&q.width-1)&&0===(q.height&q.height-1),n=aw(s.format),m=aw(s.type);a4(aG.TEXTURE_2D,s,p);var k=s.mipmaps;if(s instanceof THREE.DataTexture){if(0<k.length&&p){for(var l=0,j=k.length;l<j;l++){q=k[l],aG.texImage2D(aG.TEXTURE_2D,l,n,q.width,q.height,0,n,m,q.data)}s.generateMipmaps=!1}else{aG.texImage2D(aG.TEXTURE_2D,0,n,q.width,q.height,0,n,m,q.data)}}else{if(s instanceof THREE.CompressedTexture){l=0;for(j=k.length;l<j;l++){q=k[l],aG.compressedTexImage2D(aG.TEXTURE_2D,l,n,q.width,q.height,0,q.data)}}else{if(0<k.length&&p){l=0;for(j=k.length;l<j;l++){q=k[l],aG.texImage2D(aG.TEXTURE_2D,l,n,n,m,q)}s.generateMipmaps=!1}else{aG.texImage2D(aG.TEXTURE_2D,0,n,n,m,s.image)}}}s.generateMipmaps&&p&&aG.generateMipmap(aG.TEXTURE_2D);s.needsUpdate=!1;if(s.onUpdate){s.onUpdate()}}else{aG.activeTexture(aG.TEXTURE0+r),aG.bindTexture(aG.TEXTURE_2D,s.__webglTexture)}};this.setRenderTarget=function(j){var i=j instanceof THREE.WebGLRenderTargetCube;if(j&&!j.__webglFramebuffer){void 0===j.depthBuffer&&(j.depthBuffer=!0);void 0===j.stencilBuffer&&(j.stencilBuffer=!0);j.addEventListener("dispose",br);j.__webglTexture=aG.createTexture();bh.info.memory.textures++;var q=0===(j.width&j.width-1)&&0===(j.height&j.height-1),p=aw(j.format),n=aw(j.type);if(i){j.__webglFramebuffer=[];j.__webglRenderbuffer=[];aG.bindTexture(aG.TEXTURE_CUBE_MAP,j.__webglTexture);a4(aG.TEXTURE_CUBE_MAP,j,q);for(var m=0;6>m;m++){j.__webglFramebuffer[m]=aG.createFramebuffer();j.__webglRenderbuffer[m]=aG.createRenderbuffer();aG.texImage2D(aG.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,p,j.width,j.height,0,p,n,null);var k=j,l=aG.TEXTURE_CUBE_MAP_POSITIVE_X+m;aG.bindFramebuffer(aG.FRAMEBUFFER,j.__webglFramebuffer[m]);aG.framebufferTexture2D(aG.FRAMEBUFFER,aG.COLOR_ATTACHMENT0,l,k.__webglTexture,0);au(j.__webglRenderbuffer[m],j)}q&&aG.generateMipmap(aG.TEXTURE_CUBE_MAP)}else{j.__webglFramebuffer=aG.createFramebuffer(),j.__webglRenderbuffer=j.shareDepthFrom?j.shareDepthFrom.__webglRenderbuffer:aG.createRenderbuffer(),aG.bindTexture(aG.TEXTURE_2D,j.__webglTexture),a4(aG.TEXTURE_2D,j,q),aG.texImage2D(aG.TEXTURE_2D,0,p,j.width,j.height,0,p,n,null),p=aG.TEXTURE_2D,aG.bindFramebuffer(aG.FRAMEBUFFER,j.__webglFramebuffer),aG.framebufferTexture2D(aG.FRAMEBUFFER,aG.COLOR_ATTACHMENT0,p,j.__webglTexture,0),j.shareDepthFrom?j.depthBuffer&&!j.stencilBuffer?aG.framebufferRenderbuffer(aG.FRAMEBUFFER,aG.DEPTH_ATTACHMENT,aG.RENDERBUFFER,j.__webglRenderbuffer):j.depthBuffer&&j.stencilBuffer&&aG.framebufferRenderbuffer(aG.FRAMEBUFFER,aG.DEPTH_STENCIL_ATTACHMENT,aG.RENDERBUFFER,j.__webglRenderbuffer):au(j.__webglRenderbuffer,j),q&&aG.generateMipmap(aG.TEXTURE_2D)}i?aG.bindTexture(aG.TEXTURE_CUBE_MAP,null):aG.bindTexture(aG.TEXTURE_2D,null);aG.bindRenderbuffer(aG.RENDERBUFFER,null);aG.bindFramebuffer(aG.FRAMEBUFFER,null)}j?(i=i?j.__webglFramebuffer[j.activeCubeFace]:j.__webglFramebuffer,q=j.width,j=j.height,n=p=0):(i=null,q=ar,j=ai,p=aX,n=ag);i!==R&&(aG.bindFramebuffer(aG.FRAMEBUFFER,i),aG.viewport(p,n,q,j),R=i);ah=q;aR=j};this.shadowMapPlugin=new THREE.ShadowMapPlugin;this.addPrePlugin(this.shadowMapPlugin);this.addPostPlugin(new THREE.SpritePlugin);this.addPostPlugin(new THREE.LensFlarePlugin)};THREE.WebGLRenderTarget=function(e,d,f){this.width=e;this.height=d;f=f||{};this.wrapS=void 0!==f.wrapS?f.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==f.wrapT?f.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==f.magFilter?f.magFilter:THREE.LinearFilter;this.minFilter=void 0!==f.minFilter?f.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==f.anisotropy?f.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==f.format?f.format:THREE.RGBAFormat;this.type=void 0!==f.type?f.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==f.depthBuffer?f.depthBuffer:!0;this.stencilBuffer=void 0!==f.stencilBuffer?f.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=null};THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,clone:function(){var b=new THREE.WebGLRenderTarget(this.width,this.height);b.wrapS=this.wrapS;b.wrapT=this.wrapT;b.magFilter=this.magFilter;b.minFilter=this.minFilter;b.anisotropy=this.anisotropy;b.offset.copy(this.offset);b.repeat.copy(this.repeat);b.format=this.format;b.type=this.type;b.depthBuffer=this.depthBuffer;b.stencilBuffer=this.stencilBuffer;b.generateMipmaps=this.generateMipmaps;b.shareDepthFrom=this.shareDepthFrom;return b},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube=function(e,d,f){THREE.WebGLRenderTarget.call(this,e,d,f);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(b){this.positionWorld.copy(b.positionWorld);this.positionScreen.copy(b.positionScreen)};THREE.RenderableFace3=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.material=this.color=null;this.uvs=[[]];this.z=0};THREE.RenderableFace4=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.v4=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.material=this.color=null;this.uvs=[[]];this.z=0};THREE.RenderableObject=function(){this.id=0;this.object=null;this.z=0};THREE.RenderableParticle=function(){this.id=0;this.object=null;this.z=this.y=this.x=0;this.rotation=null;this.scale=new THREE.Vector2;this.material=null};THREE.RenderableLine=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.vertexColors=[new THREE.Color,new THREE.Color];this.material=null;this.z=0};THREE.GeometryUtils={merge:function(K,J,I){var H,G,F=K.vertices.length,D=J instanceof THREE.Mesh?J.geometry:J,E=K.vertices,C=D.vertices,B=K.faces,A=D.faces,K=K.faceVertexUvs[0],D=D.faceVertexUvs[0];void 0===I&&(I=0);J instanceof THREE.Mesh&&(J.matrixAutoUpdate&&J.updateMatrix(),H=J.matrix,G=(new THREE.Matrix3).getNormalMatrix(H));for(var J=0,v=C.length;J<v;J++){var u=C[J].clone();H&&u.applyMatrix4(H);E.push(u)}J=0;for(v=A.length;J<v;J++){var u=A[J],s,L,o=u.vertexNormals,k=u.vertexColors;u instanceof THREE.Face3?s=new THREE.Face3(u.a+F,u.b+F,u.c+F):u instanceof THREE.Face4&&(s=new THREE.Face4(u.a+F,u.b+F,u.c+F,u.d+F));s.normal.copy(u.normal);G&&s.normal.applyMatrix3(G).normalize();E=0;for(C=o.length;E<C;E++){L=o[E].clone(),G&&L.applyMatrix3(G).normalize(),s.vertexNormals.push(L)}s.color.copy(u.color);E=0;for(C=k.length;E<C;E++){L=k[E],s.vertexColors.push(L.clone())}s.materialIndex=u.materialIndex+I;s.centroid.copy(u.centroid);H&&s.centroid.applyMatrix4(H);B.push(s)}J=0;for(v=D.length;J<v;J++){I=D[J];H=[];E=0;for(C=I.length;E<C;E++){H.push(new THREE.Vector2(I[E].x,I[E].y))}K.push(H)}},removeMaterials:function(i,g){for(var n={},m=0,l=g.length;m<l;m++){n[g[m]]=!0}for(var k,j=[],m=0,l=i.faces.length;m<l;m++){k=i.faces[m],k.materialIndex in n||j.push(k)}i.faces=j},randomPointInTriangle:function(){var b=new THREE.Vector3;return function(a,n,m){var l=new THREE.Vector3,k=THREE.Math.random16(),i=THREE.Math.random16();1<k+i&&(k=1-k,i=1-i);var j=1-k-i;l.copy(a);l.multiplyScalar(k);b.copy(n);b.multiplyScalar(i);l.add(b);b.copy(m);b.multiplyScalar(j);l.add(b);return l}}(),randomPointInFace:function(i,g,n){var m,l,k;if(i instanceof THREE.Face3){return m=g.vertices[i.a],l=g.vertices[i.b],k=g.vertices[i.c],THREE.GeometryUtils.randomPointInTriangle(m,l,k)}if(i instanceof THREE.Face4){m=g.vertices[i.a];l=g.vertices[i.b];k=g.vertices[i.c];var g=g.vertices[i.d],j;n?i._area1&&i._area2?(n=i._area1,j=i._area2):(n=THREE.GeometryUtils.triangleArea(m,l,g),j=THREE.GeometryUtils.triangleArea(l,k,g),i._area1=n,i._area2=j):(n=THREE.GeometryUtils.triangleArea(m,l,g),j=THREE.GeometryUtils.triangleArea(l,k,g));return THREE.Math.random16()*(n+j)<n?THREE.GeometryUtils.randomPointInTriangle(m,l,g):THREE.GeometryUtils.randomPointInTriangle(l,k,g)}},randomPointsInGeometry:function(F,E){function D(d){function c(f,b){if(b<f){return f}var a=f+Math.floor((b-f)/2);return s[a]>d?c(f,a-1):s[a]<d?c(a+1,b):a}return c(0,s.length-1)}var C,B,A=F.faces,u=F.vertices,v=A.length,t=0,s=[],r,q,o,k;for(B=0;B<v;B++){C=A[B],C instanceof THREE.Face3?(r=u[C.a],q=u[C.b],o=u[C.c],C._area=THREE.GeometryUtils.triangleArea(r,q,o)):C instanceof THREE.Face4&&(r=u[C.a],q=u[C.b],o=u[C.c],k=u[C.d],C._area1=THREE.GeometryUtils.triangleArea(r,q,k),C._area2=THREE.GeometryUtils.triangleArea(q,o,k),C._area=C._area1+C._area2),t+=C._area,s[B]=t}C=[];for(B=0;B<E;B++){u=THREE.Math.random16()*t,u=D(u),C[B]=THREE.GeometryUtils.randomPointInFace(A[u],F,!0)}return C},triangleArea:function(){var d=new THREE.Vector3,c=new THREE.Vector3;return function(f,b,a){d.subVectors(b,f);c.subVectors(a,f);d.cross(c);return 0.5*d.length()}}(),center:function(e){e.computeBoundingBox();var d=e.boundingBox,f=new THREE.Vector3;f.addVectors(d.min,d.max);f.multiplyScalar(-0.5);e.applyMatrix((new THREE.Matrix4).makeTranslation(f.x,f.y,f.z));e.computeBoundingBox();return f},triangulateQuads:function(D){var C,B,A,v,u=[],s=[],t=[];C=0;for(B=D.faceUvs.length;C<B;C++){s[C]=[]}C=0;for(B=D.faceVertexUvs.length;C<B;C++){t[C]=[]}C=0;for(B=D.faces.length;C<B;C++){if(A=D.faces[C],A instanceof THREE.Face4){v=A.a;var r=A.b,q=A.c,p=A.d,o=new THREE.Face3,k=new THREE.Face3;o.color.copy(A.color);k.color.copy(A.color);o.materialIndex=A.materialIndex;k.materialIndex=A.materialIndex;o.a=v;o.b=r;o.c=p;k.a=r;k.b=q;k.c=p;4===A.vertexColors.length&&(o.vertexColors[0]=A.vertexColors[0].clone(),o.vertexColors[1]=A.vertexColors[1].clone(),o.vertexColors[2]=A.vertexColors[3].clone(),k.vertexColors[0]=A.vertexColors[1].clone(),k.vertexColors[1]=A.vertexColors[2].clone(),k.vertexColors[2]=A.vertexColors[3].clone());u.push(o,k);A=0;for(v=D.faceVertexUvs.length;A<v;A++){D.faceVertexUvs[A].length&&(o=D.faceVertexUvs[A][C],r=o[1],q=o[2],p=o[3],o=[o[0].clone(),r.clone(),p.clone()],r=[r.clone(),q.clone(),p.clone()],t[A].push(o,r))}A=0;for(v=D.faceUvs.length;A<v;A++){D.faceUvs[A].length&&(r=D.faceUvs[A][C],s[A].push(r,r))}}else{u.push(A);A=0;for(v=D.faceUvs.length;A<v;A++){s[A].push(D.faceUvs[A][C])}A=0;for(v=D.faceVertexUvs.length;A<v;A++){t[A].push(D.faceVertexUvs[A][C])}}}D.faces=u;D.faceUvs=s;D.faceVertexUvs=t;D.computeCentroids();D.computeFaceNormals();D.computeVertexNormals();D.hasTangents&&D.computeTangents()},setMaterialIndex:function(f,e,h,g){f=f.faces;g=g||f.length-1;for(h=h||0;h<=g;h++){f[h].materialIndex=e}}};THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(g,f,j){var i=new Image,h=new THREE.Texture(i,f),f=new THREE.ImageLoader;f.crossOrigin=this.crossOrigin;f.load(g,function(b){h.image=b;h.needsUpdate=!0;j&&j(h)});h.sourceFile=g;return h},loadCompressedTexture:function(h,g,l,k){var j=new THREE.CompressedTexture;j.mapping=g;var i=new XMLHttpRequest;i.onload=function(){var b=THREE.ImageUtils.parseDDS(i.response,!0);j.format=b.format;j.mipmaps=b.mipmaps;j.image.width=b.width;j.image.height=b.height;j.generateMipmaps=!1;j.needsUpdate=!0;l&&l(j)};i.onerror=k;i.open("GET",h,!0);i.responseType="arraybuffer";i.send(null);return j},loadTextureCube:function(j,i,p,o){var n=[];n.loadCount=0;var m=new THREE.Texture;m.image=n;void 0!==i&&(m.mapping=i);m.flipY=!1;for(var i=0,k=j.length;i<k;++i){var l=new Image;n[i]=l;l.onload=function(){n.loadCount+=1;6===n.loadCount&&(m.needsUpdate=!0,p&&p(m))};l.onerror=o;l.crossOrigin=this.crossOrigin;l.src=j[i]}return m},loadCompressedTextureCube:function(t,s,r,q){var p=[];p.loadCount=0;var o=new THREE.CompressedTexture;o.image=p;void 0!==s&&(o.mapping=s);o.flipY=!1;o.generateMipmaps=!1;s=function(d,c){return function(){var a=THREE.ImageUtils.parseDDS(d.response,!0);c.format=a.format;c.mipmaps=a.mipmaps;c.width=a.width;c.height=a.height;p.loadCount+=1;6===p.loadCount&&(o.format=a.format,o.needsUpdate=!0,r&&r(o))}};if(t instanceof Array){for(var m=0,n=t.length;m<n;++m){var l={};p[m]=l;var k=new XMLHttpRequest;k.onload=s(k,l);k.onerror=q;l=t[m];k.open("GET",l,!0);k.responseType="arraybuffer";k.send(null)}}else{k=new XMLHttpRequest,k.onload=function(){var e=THREE.ImageUtils.parseDDS(k.response,!0);if(e.isCubemap){for(var c=e.mipmaps.length/e.mipmapCount,g=0;g<c;g++){p[g]={mipmaps:[]};for(var f=0;f<e.mipmapCount;f++){p[g].mipmaps.push(e.mipmaps[g*e.mipmapCount+f]),p[g].format=e.format,p[g].width=e.width,p[g].height=e.height}}o.format=e.format;o.needsUpdate=!0;r&&r(o)}},k.onerror=q,k.open("GET",t,!0),k.responseType="arraybuffer",k.send(null)}return o},parseDDS:function(D,C){function B(b){return b.charCodeAt(0)+(b.charCodeAt(1)<<8)+(b.charCodeAt(2)<<16)+(b.charCodeAt(3)<<24)}var A={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},v=B("DXT1"),u=B("DXT3"),s=B("DXT5"),t=new Int32Array(D,0,31);if(542327876!==t[0]){return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),A}if(!t[20]&4){return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),A}var r=t[21];switch(r){case v:v=8;A.format=THREE.RGB_S3TC_DXT1_Format;break;case u:v=16;A.format=THREE.RGBA_S3TC_DXT3_Format;break;case s:v=16;A.format=THREE.RGBA_S3TC_DXT5_Format;break;default:return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(r&255,r>>8&255,r>>16&255,r>>24&255)),A}A.mipmapCount=1;t[2]&131072&&!1!==C&&(A.mipmapCount=Math.max(1,t[7]));A.isCubemap=t[28]&512?!0:!1;A.width=t[4];A.height=t[3];for(var t=t[1]+4,u=A.width,s=A.height,r=A.isCubemap?6:1,q=0;q<r;q++){for(var p=0;p<A.mipmapCount;p++){var o=Math.max(4,u)/4*Math.max(4,s)/4*v,k={data:new Uint8Array(D,t,o),width:u,height:s};A.mipmaps.push(k);t+=o;u=Math.max(0.5*u,1);s=Math.max(0.5*s,1)}u=A.width;s=A.height}return A},getNormalMap:function(Q,P){var O=function(d){var c=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);return[d[0]/c,d[1]/c,d[2]/c]},P=P|1,N=Q.width,L=Q.height,K=document.createElement("canvas");K.width=N;K.height=L;var I=K.getContext("2d");I.drawImage(Q,0,0);for(var J=I.getImageData(0,0,N,L).data,H=I.createImageData(N,L),G=H.data,F=0;F<N;F++){for(var E=0;E<L;E++){var D=0>E-1?0:E-1,C=E+1>L-1?L-1:E+1,o=0>F-1?0:F-1,B=F+1>N-1?N-1:F+1,A=[],v=[0,0,J[4*(E*N+F)]/255*P];A.push([-1,0,J[4*(E*N+o)]/255*P]);A.push([-1,-1,J[4*(D*N+o)]/255*P]);A.push([0,-1,J[4*(D*N+F)]/255*P]);A.push([1,-1,J[4*(D*N+B)]/255*P]);A.push([1,0,J[4*(E*N+B)]/255*P]);A.push([1,1,J[4*(C*N+B)]/255*P]);A.push([0,1,J[4*(C*N+F)]/255*P]);A.push([-1,1,J[4*(C*N+o)]/255*P]);D=[];o=A.length;for(C=0;C<o;C++){var B=A[C],k=A[(C+1)%o],B=[B[0]-v[0],B[1]-v[1],B[2]-v[2]],k=[k[0]-v[0],k[1]-v[1],k[2]-v[2]];D.push(O([B[1]*k[2]-B[2]*k[1],B[2]*k[0]-B[0]*k[2],B[0]*k[1]-B[1]*k[0]]))}A=[0,0,0];for(C=0;C<D.length;C++){A[0]+=D[C][0],A[1]+=D[C][1],A[2]+=D[C][2]}A[0]/=D.length;A[1]/=D.length;A[2]/=D.length;v=4*(E*N+F);G[v]=255*((A[0]+1)/2)|0;G[v+1]=255*((A[1]+1)/2)|0;G[v+2]=255*A[2]|0;G[v+3]=255}}I.putImageData(H,0,0);return K},generateDataTexture:function(j,i,p){for(var o=j*i,n=new Uint8Array(3*o),m=Math.floor(255*p.r),k=Math.floor(255*p.g),p=Math.floor(255*p.b),l=0;l<o;l++){n[3*l]=m,n[3*l+1]=k,n[3*l+2]=p}j=new THREE.DataTexture(n,j,i,THREE.RGBFormat);j.needsUpdate=!0;return j}};THREE.SceneUtils={createMultiMaterialObject:function(g,f){for(var j=new THREE.Object3D,i=0,h=f.length;i<h;i++){j.add(new THREE.Mesh(g,f[i]))}return j},detach:function(e,d,f){e.applyMatrix(d.matrixWorld);d.remove(e);f.add(e)},attach:function(f,e,h){var g=new THREE.Matrix4;g.getInverse(h.matrixWorld);f.applyMatrix(g);e.remove(f);h.add(f)}};THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(d){var c=d.familyName.toLowerCase();this.faces[c]=this.faces[c]||{};this.faces[c][d.cssFontWeight]=this.faces[c][d.cssFontWeight]||{};this.faces[c][d.cssFontWeight][d.cssFontStyle]=d;return this.faces[c][d.cssFontWeight][d.cssFontStyle]=d},drawText:function(j){for(var i=this.getFace(),p=this.size/i.resolution,o=0,n=String(j).split(""),m=n.length,k=[],j=0;j<m;j++){var l=new THREE.Path,l=this.extractGlyphPoints(n[j],i,p,o,l),o=o+l.offset;k.push(l.path)}return{paths:k,offset:o/2}},extractGlyphPoints:function(Q,P,O,N,L){var K=[],I,J,H,G,F,E,D,C,o,B,A,v=P.glyphs[Q]||P.glyphs["?"];if(v){if(v.o){P=v._cachedOutline||(v._cachedOutline=v.o.split(" "));G=P.length;for(Q=0;Q<G;){switch(H=P[Q++],H){case"m":H=P[Q++]*O+N;F=P[Q++]*O;L.moveTo(H,F);break;case"l":H=P[Q++]*O+N;F=P[Q++]*O;L.lineTo(H,F);break;case"q":H=P[Q++]*O+N;F=P[Q++]*O;C=P[Q++]*O+N;o=P[Q++]*O;L.quadraticCurveTo(C,o,H,F);if(I=K[K.length-1]){E=I.x;D=I.y;I=1;for(J=this.divisions;I<=J;I++){var k=I/J;THREE.Shape.Utils.b2(k,E,C,H);THREE.Shape.Utils.b2(k,D,o,F)}}break;case"b":if(H=P[Q++]*O+N,F=P[Q++]*O,C=P[Q++]*O+N,o=P[Q++]*-O,B=P[Q++]*O+N,A=P[Q++]*-O,L.bezierCurveTo(H,F,C,o,B,A),I=K[K.length-1]){E=I.x;D=I.y;I=1;for(J=this.divisions;I<=J;I++){k=I/J,THREE.Shape.Utils.b3(k,E,C,B,H),THREE.Shape.Utils.b3(k,D,o,A,F)}}}}}return{offset:v.ha*O,path:L}}}};THREE.FontUtils.generateShapes=function(h,g){var g=g||{},l=void 0!==g.curveSegments?g.curveSegments:4,k=void 0!==g.font?g.font:"helvetiker",j=void 0!==g.weight?g.weight:"normal",i=void 0!==g.style?g.style:"normal";THREE.FontUtils.size=void 0!==g.size?g.size:100;THREE.FontUtils.divisions=l;THREE.FontUtils.face=k;THREE.FontUtils.weight=j;THREE.FontUtils.style=i;l=THREE.FontUtils.drawText(h).paths;k=[];j=0;for(i=l.length;j<i;j++){Array.prototype.push.apply(k,l[j].toShapes())}return k};(function(d){var c=function(i){for(var g=i.length,l=0,k=g-1,j=0;j<g;k=j++){l+=i[k].x*i[j].y-i[j].x*i[k].y}return 0.5*l};d.Triangulate=function(aj,ai){var ah=aj.length;if(3>ah){return null}var ag=[],ae=[],af=[],ad,ac,ab;if(0<c(aj)){for(ac=0;ac<ah;ac++){ae[ac]=ac}}else{for(ac=0;ac<ah;ac++){ae[ac]=ah-1-ac}}var aa=2*ah;for(ac=ah-1;2<ah;){if(0>=aa--){console.log("Warning, unable to triangulate polygon!");break}ad=ac;ah<=ad&&(ad=0);ac=ad+1;ah<=ac&&(ac=0);ab=ac+1;ah<=ab&&(ab=0);var Z;aj:{var Y=Z=void 0,R=void 0,W=void 0,U=void 0,S=void 0,Q=void 0,o=void 0,T=void 0,Y=aj[ae[ad]].x,R=aj[ae[ad]].y,W=aj[ae[ac]].x,U=aj[ae[ac]].y,S=aj[ae[ab]].x,Q=aj[ae[ab]].y;if(1e-10>(W-Y)*(Q-R)-(U-R)*(S-Y)){Z=!1}else{var P=void 0,L=void 0,E=void 0,O=void 0,X=void 0,k=void 0,V=void 0,D=void 0,b=void 0,v=void 0,b=D=V=T=o=void 0,P=S-W,L=Q-U,E=Y-S,O=R-Q,X=W-Y,k=U-R;for(Z=0;Z<ah;Z++){if(!(Z===ad||Z===ac||Z===ab)){if(o=aj[ae[Z]].x,T=aj[ae[Z]].y,V=o-Y,D=T-R,b=o-W,v=T-U,o-=S,T-=Q,b=P*v-L*b,V=X*D-k*V,D=E*T-O*o,0<=b&&0<=D&&0<=V){Z=!1;break aj}}}Z=!0}}if(Z){ag.push([aj[ae[ad]],aj[ae[ac]],aj[ae[ab]]]);af.push([ae[ad],ae[ac],ae[ab]]);ad=ac;for(ab=ac+1;ab<ah;ad++,ab++){ae[ad]=ae[ab]}ah--;aa=2*ah}}return ai?af:ag};d.Triangulate.area=c;return d})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(b){b=this.getUtoTmapping(b);return this.getPoint(b)};THREE.Curve.prototype.getPoints=function(e){e||(e=5);var d,f=[];for(d=0;d<=e;d++){f.push(this.getPoint(d/e))}return f};THREE.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var d,f=[];for(d=0;d<=e;d++){f.push(this.getPointAt(d/e))}return f};THREE.Curve.prototype.getLength=function(){var b=this.getLengths();return b[b.length-1]};THREE.Curve.prototype.getLengths=function(h){h||(h=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==h+1&&!this.needsUpdate){return this.cacheArcLengths}this.needsUpdate=!1;var g=[],l,k=this.getPoint(0),j,i=0;g.push(0);for(j=1;j<=h;j++){l=this.getPoint(j/h),i+=l.distanceTo(k),g.push(i),k=l}return this.cacheArcLengths=g};THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};THREE.Curve.prototype.getUtoTmapping=function(r,q){var p=this.getLengths(),o=0,n=p.length,m;m=q?q:r*p[n-1];for(var k=0,l=n-1,j;k<=l;){if(o=Math.floor(k+(l-k)/2),j=p[o]-m,0>j){k=o+1}else{if(0<j){l=o-1}else{l=o;break}}}o=l;if(p[o]==m){return o/(n-1)}k=p[o];return p=(o+(m-k)/(p[o+1]-k))/(n-1)};THREE.Curve.prototype.getTangent=function(d){var c=d-0.0001,d=d+0.0001;0>c&&(c=0);1<d&&(d=1);c=this.getPoint(c);return this.getPoint(d).clone().sub(c).normalize()};THREE.Curve.prototype.getTangentAt=function(b){b=this.getUtoTmapping(b);return this.getTangent(b)};THREE.Curve.Utils={tangentQuadraticBezier:function(f,e,h,g){return 2*(1-f)*(h-e)+2*f*(g-h)},tangentCubicBezier:function(g,f,j,i,h){return -3*f*(1-g)*(1-g)+3*j*(1-g)*(1-g)-6*g*j*(1-g)+6*g*i*(1-g)-3*g*g*i+3*g*g*h},tangentSpline:function(b){return 6*b*b-6*b+(3*b*b-4*b+1)+(-6*b*b+6*b)+(3*b*b-2*b)},interpolate:function(h,g,l,k,j){var h=0.5*(l-h),k=0.5*(k-g),i=j*j;return(2*g-2*l+h+k)*j*i+(-3*g+3*l-2*h-k)*i+h*j+g}};THREE.Curve.create=function(d,c){d.prototype=Object.create(THREE.Curve.prototype);d.prototype.getPoint=c;return d};THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.add=function(b){this.curves.push(b)};THREE.CurvePath.prototype.checkConnection=function(){};THREE.CurvePath.prototype.closePath=function(){var d=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);d.equals(c)||this.curves.push(new THREE.LineCurve(c,d))};THREE.CurvePath.prototype.getPoint=function(e){for(var d=e*this.getLength(),f=this.getCurveLengths(),e=0;e<f.length;){if(f[e]>=d){return d=f[e]-d,e=this.curves[e],d=1-d/e.getLength(),e.getPointAt(d)}e++}return null};THREE.CurvePath.prototype.getLength=function(){var b=this.getCurveLengths();return b[b.length-1]};THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length){return this.cacheLengths}var f=[],e=0,h,g=this.curves.length;for(h=0;h<g;h++){e+=this.curves[h].getLength(),f.push(e)}return this.cacheLengths=f};THREE.CurvePath.prototype.getBoundingBox=function(){var B=this.getPoints(),A,v,u,t,s,q;A=v=Number.NEGATIVE_INFINITY;t=s=Number.POSITIVE_INFINITY;var r,p,o,n,k=B[0] instanceof THREE.Vector3;n=k?new THREE.Vector3:new THREE.Vector2;p=0;for(o=B.length;p<o;p++){r=B[p],r.x>A?A=r.x:r.x<t&&(t=r.x),r.y>v?v=r.y:r.y<s&&(s=r.y),k&&(r.z>u?u=r.z:r.z<q&&(q=r.z)),n.add(r)}B={minX:t,minY:s,maxX:A,maxY:v,centroid:n.divideScalar(o)};k&&(B.maxZ=u,B.minZ=q);return B};THREE.CurvePath.prototype.createPointsGeometry=function(b){b=this.getPoints(b,!0);return this.createGeometry(b)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(b){b=this.getSpacedPoints(b,!0);return this.createGeometry(b)};THREE.CurvePath.prototype.createGeometry=function(e){for(var d=new THREE.Geometry,f=0;f<e.length;f++){d.vertices.push(new THREE.Vector3(e[f].x,e[f].y,e[f].z||0))}return d};THREE.CurvePath.prototype.addWrapPath=function(b){this.bends.push(b)};THREE.CurvePath.prototype.getTransformedPoints=function(g,f){var j=this.getPoints(g),i,h;f||(f=this.bends);i=0;for(h=f.length;i<h;i++){j=this.getWrapPoints(j,f[i])}return j};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(g,f){var j=this.getSpacedPoints(g),i,h;f||(f=this.bends);i=0;for(h=f.length;i<h;i++){j=this.getWrapPoints(j,f[i])}return j};THREE.CurvePath.prototype.getWrapPoints=function(r,q){var p=this.getBoundingBox(),o,n,m,k,l,j;o=0;for(n=r.length;o<n;o++){m=r[o],k=m.x,l=m.y,j=k/p.maxX,j=q.getUtoTmapping(j,k),k=q.getPoint(j),l=q.getNormalVector(j).multiplyScalar(l),m.x=k.x+l.x,m.y=k.y+l.y}return r};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);THREE.Gyroscope.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||e){this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0}for(var d=0,f=this.children.length;d<f;d++){this.children[d].updateMatrixWorld(e)}};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;THREE.Path=function(b){THREE.CurvePath.call(this);this.actions=[];b&&this.fromPoints(b)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};THREE.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var d=1,f=e.length;d<f;d++){this.lineTo(e[d].x,e[d].y)}};THREE.Path.prototype.moveTo=function(e,d){var f=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:f})};THREE.Path.prototype.lineTo=function(f,e){var h=Array.prototype.slice.call(arguments),g=this.actions[this.actions.length-1].args,g=new THREE.LineCurve(new THREE.Vector2(g[g.length-2],g[g.length-1]),new THREE.Vector2(f,e));this.curves.push(g);this.actions.push({action:THREE.PathActions.LINE_TO,args:h})};THREE.Path.prototype.quadraticCurveTo=function(h,g,l,k){var j=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,i=new THREE.QuadraticBezierCurve(new THREE.Vector2(i[i.length-2],i[i.length-1]),new THREE.Vector2(h,g),new THREE.Vector2(l,k));this.curves.push(i);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:j})};THREE.Path.prototype.bezierCurveTo=function(j,i,p,o,n,m){var k=Array.prototype.slice.call(arguments),l=this.actions[this.actions.length-1].args,l=new THREE.CubicBezierCurve(new THREE.Vector2(l[l.length-2],l[l.length-1]),new THREE.Vector2(j,i),new THREE.Vector2(p,o),new THREE.Vector2(n,m));this.curves.push(l);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:k})};THREE.Path.prototype.splineThru=function(e){var d=Array.prototype.slice.call(arguments),f=this.actions[this.actions.length-1].args,f=[new THREE.Vector2(f[f.length-2],f[f.length-1])];Array.prototype.push.apply(f,e);f=new THREE.SplineCurve(f);this.curves.push(f);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:d})};THREE.Path.prototype.arc=function(i,g,n,m,l,k){var j=this.actions[this.actions.length-1].args;this.absarc(i+j[j.length-2],g+j[j.length-1],n,m,l,k)};THREE.Path.prototype.absarc=function(h,g,l,k,j,i){this.absellipse(h,g,l,l,k,j,i)};THREE.Path.prototype.ellipse=function(j,i,p,o,n,m,k){var l=this.actions[this.actions.length-1].args;this.absellipse(j+l[l.length-2],i+l[l.length-1],p,o,n,m,k)};THREE.Path.prototype.absellipse=function(r,q,p,o,n,m,k){var l=Array.prototype.slice.call(arguments),j=new THREE.EllipseCurve(r,q,p,o,n,m,k);this.curves.push(j);j=j.getPoint(k?1:0);l.push(j.x);l.push(j.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:l})};THREE.Path.prototype.getSpacedPoints=function(e){e||(e=40);for(var d=[],f=0;f<e;f++){d.push(this.getPoint(f/e))}return d};THREE.Path.prototype.getPoints=function(I,H){if(this.useSpacedPoints){return console.log("tata"),this.getSpacedPoints(I,H)}var I=I||12,G=[],F,E,D,B,C,A,v,u,s,r,o,J,k;F=0;for(E=this.actions.length;F<E;F++){switch(D=this.actions[F],B=D.action,D=D.args,B){case THREE.PathActions.MOVE_TO:G.push(new THREE.Vector2(D[0],D[1]));break;case THREE.PathActions.LINE_TO:G.push(new THREE.Vector2(D[0],D[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:C=D[2];A=D[3];s=D[0];r=D[1];0<G.length?(B=G[G.length-1],o=B.x,J=B.y):(B=this.actions[F-1].args,o=B[B.length-2],J=B[B.length-1]);for(D=1;D<=I;D++){k=D/I,B=THREE.Shape.Utils.b2(k,o,s,C),k=THREE.Shape.Utils.b2(k,J,r,A),G.push(new THREE.Vector2(B,k))}break;case THREE.PathActions.BEZIER_CURVE_TO:C=D[4];A=D[5];s=D[0];r=D[1];v=D[2];u=D[3];0<G.length?(B=G[G.length-1],o=B.x,J=B.y):(B=this.actions[F-1].args,o=B[B.length-2],J=B[B.length-1]);for(D=1;D<=I;D++){k=D/I,B=THREE.Shape.Utils.b3(k,o,s,v,C),k=THREE.Shape.Utils.b3(k,J,r,u,A),G.push(new THREE.Vector2(B,k))}break;case THREE.PathActions.CSPLINE_THRU:B=this.actions[F-1].args;k=[new THREE.Vector2(B[B.length-2],B[B.length-1])];B=I*D[0].length;k=k.concat(D[0]);k=new THREE.SplineCurve(k);for(D=1;D<=B;D++){G.push(k.getPointAt(D/B))}break;case THREE.PathActions.ARC:C=D[0];A=D[1];r=D[2];v=D[3];B=D[4];s=!!D[5];o=B-v;J=2*I;for(D=1;D<=J;D++){k=D/J,s||(k=1-k),k=v+k*o,B=C+r*Math.cos(k),k=A+r*Math.sin(k),G.push(new THREE.Vector2(B,k))}break;case THREE.PathActions.ELLIPSE:C=D[0];A=D[1];r=D[2];u=D[3];v=D[4];B=D[5];s=!!D[6];o=B-v;J=2*I;for(D=1;D<=J;D++){k=D/J,s||(k=1-k),k=v+k*o,B=C+r*Math.cos(k),k=A+u*Math.sin(k),G.push(new THREE.Vector2(B,k))}}}F=G[G.length-1];1e-10>Math.abs(F.x-G[0].x)&&1e-10>Math.abs(F.y-G[0].y)&&G.splice(G.length-1,1);H&&G.push(G[0]);return G};THREE.Path.prototype.toShapes=function(j){var i,p,o,n,m=[],k=new THREE.Path;i=0;for(p=this.actions.length;i<p;i++){o=this.actions[i],n=o.args,o=o.action,o==THREE.PathActions.MOVE_TO&&0!=k.actions.length&&(m.push(k),k=new THREE.Path),k[o].apply(k,n)}0!=k.actions.length&&m.push(k);if(0==m.length){return[]}var l;n=[];if(1==m.length){return o=m[0],l=new THREE.Shape,l.actions=o.actions,l.curves=o.curves,n.push(l),n}i=!THREE.Shape.Utils.isClockWise(m[0].getPoints());if(j?!i:i){l=new THREE.Shape;i=0;for(p=m.length;i<p;i++){o=m[i],k=THREE.Shape.Utils.isClockWise(o.getPoints()),(k=j?!k:k)?(l.actions=o.actions,l.curves=o.curves,n.push(l),l=new THREE.Shape):l.holes.push(o)}}else{l=void 0;i=0;for(p=m.length;i<p;i++){o=m[i],k=THREE.Shape.Utils.isClockWise(o.getPoints()),(k=j?!k:k)?(l&&n.push(l),l=new THREE.Shape,l.actions=o.actions,l.curves=o.curves):l.holes.push(o)}n.push(l)}return n};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);THREE.Shape.prototype.extrude=function(b){return new THREE.ExtrudeGeometry(this,b)};THREE.Shape.prototype.makeGeometry=function(b){return new THREE.ShapeGeometry(this,b)};THREE.Shape.prototype.getPointsHoles=function(f){var e,h=this.holes.length,g=[];for(e=0;e<h;e++){g[e]=this.holes[e].getTransformedPoints(f,this.bends)}return g};THREE.Shape.prototype.getSpacedPointsHoles=function(f){var e,h=this.holes.length,g=[];for(e=0;e<h;e++){g[e]=this.holes[e].getTransformedSpacedPoints(f,this.bends)}return g};THREE.Shape.prototype.extractAllPoints=function(b){return{shape:this.getTransformedPoints(b),holes:this.getPointsHoles(b)}};THREE.Shape.prototype.extractPoints=function(b){return this.useSpacedPoints?this.extractAllSpacedPoints(b):this.extractAllPoints(b)};THREE.Shape.prototype.extractAllSpacedPoints=function(b){return{shape:this.getTransformedSpacedPoints(b),holes:this.getSpacedPointsHoles(b)}};THREE.Shape.Utils={removeHoles:function(K,J){var I=K.concat(),H=I.concat(),G,F,D,E,C,B,A,v,u,s,L=[];for(C=0;C<J.length;C++){B=J[C];Array.prototype.push.apply(H,B);F=Number.POSITIVE_INFINITY;for(G=0;G<B.length;G++){u=B[G];s=[];for(v=0;v<I.length;v++){A=I[v],A=u.distanceToSquared(A),s.push(A),A<F&&(F=A,D=G,E=v)}}G=0<=E-1?E-1:I.length-1;F=0<=D-1?D-1:B.length-1;var o=[B[D],I[E],I[G]];v=THREE.FontUtils.Triangulate.area(o);var k=[B[D],B[F],I[E]];u=THREE.FontUtils.Triangulate.area(k);s=E;A=D;E+=1;D+=-1;0>E&&(E+=I.length);E%=I.length;0>D&&(D+=B.length);D%=B.length;G=0<=E-1?E-1:I.length-1;F=0<=D-1?D-1:B.length-1;o=[B[D],I[E],I[G]];o=THREE.FontUtils.Triangulate.area(o);k=[B[D],B[F],I[E]];k=THREE.FontUtils.Triangulate.area(k);v+u>o+k&&(E=s,D=A,0>E&&(E+=I.length),E%=I.length,0>D&&(D+=B.length),D%=B.length,G=0<=E-1?E-1:I.length-1,F=0<=D-1?D-1:B.length-1);v=I.slice(0,E);u=I.slice(E);s=B.slice(D);A=B.slice(0,D);F=[B[D],B[F],I[E]];L.push([B[D],I[E],I[G]]);L.push(F);I=v.concat(s).concat(A).concat(u)}return{shape:I,isolatedPts:L,allpoints:H}},triangulateShape:function(t,s){var r=THREE.Shape.Utils.removeHoles(t,s),q=r.allpoints,p=r.isolatedPts,r=THREE.FontUtils.Triangulate(r.shape,!1),o,m,n,l,k={};o=0;for(m=q.length;o<m;o++){l=q[o].x+":"+q[o].y,void 0!==k[l]&&console.log("Duplicate point",l),k[l]=o}o=0;for(m=r.length;o<m;o++){n=r[o];for(q=0;3>q;q++){l=n[q].x+":"+n[q].y,l=k[l],void 0!==l&&(n[q]=l)}}o=0;for(m=p.length;o<m;o++){n=p[o];for(q=0;3>q;q++){l=n[q].x+":"+n[q].y,l=k[l],void 0!==l&&(n[q]=l)}}return r.concat(p)},isClockWise:function(b){return 0>THREE.FontUtils.Triangulate.area(b)},b2p0:function(e,d){var f=1-e;return f*f*d},b2p1:function(d,c){return 2*(1-d)*d*c},b2p2:function(d,c){return d*d*c},b2:function(f,e,h,g){return this.b2p0(f,e)+this.b2p1(f,h)+this.b2p2(f,g)},b3p0:function(e,d){var f=1-e;return f*f*f*d},b3p1:function(e,d){var f=1-e;return 3*f*f*e*d},b3p2:function(d,c){return 3*(1-d)*d*d*c},b3p3:function(d,c){return d*d*d*c},b3:function(g,f,j,i,h){return this.b3p0(g,f)+this.b3p1(g,j)+this.b3p2(g,i)+this.b3p3(g,h)}};THREE.LineCurve=function(d,c){this.v1=d;this.v2=c};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.getPoint=function(d){var c=this.v2.clone().sub(this.v1);c.multiplyScalar(d).add(this.v1);return c};THREE.LineCurve.prototype.getPointAt=function(b){return this.getPoint(b)};THREE.LineCurve.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()};THREE.QuadraticBezierCurve=function(e,d,f){this.v0=e;this.v1=d;this.v2=f};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.getPoint=function(d){var c;c=THREE.Shape.Utils.b2(d,this.v0.x,this.v1.x,this.v2.x);d=THREE.Shape.Utils.b2(d,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(c,d)};THREE.QuadraticBezierCurve.prototype.getTangent=function(d){var c;c=THREE.Curve.Utils.tangentQuadraticBezier(d,this.v0.x,this.v1.x,this.v2.x);d=THREE.Curve.Utils.tangentQuadraticBezier(d,this.v0.y,this.v1.y,this.v2.y);c=new THREE.Vector2(c,d);c.normalize();return c};THREE.CubicBezierCurve=function(f,e,h,g){this.v0=f;this.v1=e;this.v2=h;this.v3=g};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.CubicBezierCurve.prototype.getPoint=function(d){var c;c=THREE.Shape.Utils.b3(d,this.v0.x,this.v1.x,this.v2.x,this.v3.x);d=THREE.Shape.Utils.b3(d,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(c,d)};THREE.CubicBezierCurve.prototype.getTangent=function(d){var c;c=THREE.Curve.Utils.tangentCubicBezier(d,this.v0.x,this.v1.x,this.v2.x,this.v3.x);d=THREE.Curve.Utils.tangentCubicBezier(d,this.v0.y,this.v1.y,this.v2.y,this.v3.y);c=new THREE.Vector2(c,d);c.normalize();return c};THREE.SplineCurve=function(b){this.points=void 0==b?[]:b};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.getPoint=function(g){var f=new THREE.Vector2,j=[],i=this.points,h;h=(i.length-1)*g;g=Math.floor(h);h-=g;j[0]=0==g?g:g-1;j[1]=g;j[2]=g>i.length-2?i.length-1:g+1;j[3]=g>i.length-3?i.length-1:g+2;f.x=THREE.Curve.Utils.interpolate(i[j[0]].x,i[j[1]].x,i[j[2]].x,i[j[3]].x,h);f.y=THREE.Curve.Utils.interpolate(i[j[0]].y,i[j[1]].y,i[j[2]].y,i[j[3]].y,h);return f};THREE.EllipseCurve=function(i,g,n,m,l,k,j){this.aX=i;this.aY=g;this.xRadius=n;this.yRadius=m;this.aStartAngle=l;this.aEndAngle=k;this.aClockwise=j};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.getPoint=function(d){var c=this.aEndAngle-this.aStartAngle;this.aClockwise||(d=1-d);c=this.aStartAngle+d*c;d=this.aX+this.xRadius*Math.cos(c);c=this.aY+this.yRadius*Math.sin(c);return new THREE.Vector2(d,c)};THREE.ArcCurve=function(h,g,l,k,j,i){THREE.EllipseCurve.call(this,h,g,l,l,k,j,i)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);THREE.LineCurve3=THREE.Curve.create(function(d,c){this.v1=d;this.v2=c},function(d){var c=new THREE.Vector3;c.subVectors(this.v2,this.v1);c.multiplyScalar(d);c.add(this.v1);return c});THREE.QuadraticBezierCurve3=THREE.Curve.create(function(e,d,f){this.v0=e;this.v1=d;this.v2=f},function(e){var d,f;d=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x);f=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y);e=THREE.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(d,f,e)});THREE.CubicBezierCurve3=THREE.Curve.create(function(f,e,h,g){this.v0=f;this.v1=e;this.v2=h;this.v3=g},function(e){var d,f;d=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x);f=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);e=THREE.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(d,f,e)});THREE.SplineCurve3=THREE.Curve.create(function(b){this.points=void 0==b?[]:b},function(i){var g=new THREE.Vector3,n=[],m=this.points,l,i=(m.length-1)*i;l=Math.floor(i);i-=l;n[0]=0==l?l:l-1;n[1]=l;n[2]=l>m.length-2?m.length-1:l+1;n[3]=l>m.length-3?m.length-1:l+2;l=m[n[0]];var k=m[n[1]],j=m[n[2]],n=m[n[3]];g.x=THREE.Curve.Utils.interpolate(l.x,k.x,j.x,n.x,i);g.y=THREE.Curve.Utils.interpolate(l.y,k.y,j.y,n.y,i);g.z=THREE.Curve.Utils.interpolate(l.z,k.z,j.z,n.z,i);return g});THREE.ClosedSplineCurve3=THREE.Curve.create(function(b){this.points=void 0==b?[]:b},function(g){var f=new THREE.Vector3,j=[],i=this.points,h;h=(i.length-0)*g;g=Math.floor(h);h-=g;g+=0<g?0:(Math.floor(Math.abs(g)/i.length)+1)*i.length;j[0]=(g-1)%i.length;j[1]=g%i.length;j[2]=(g+1)%i.length;j[3]=(g+2)%i.length;f.x=THREE.Curve.Utils.interpolate(i[j[0]].x,i[j[1]].x,i[j[2]].x,i[j[3]].x,h);f.y=THREE.Curve.Utils.interpolate(i[j[0]].y,i[j[1]].y,i[j[2]].y,i[j[3]].y,h);f.z=THREE.Curve.Utils.interpolate(i[j[0]].z,i[j[1]].z,i[j[2]].z,i[j[3]].z,h);return f});THREE.AnimationHandler=function(){var f=[],e={},h={update:function(a){for(var d=0;d<f.length;d++){f[d].update(a)}},addToUpdate:function(a){-1===f.indexOf(a)&&f.push(a)},removeFromUpdate:function(a){a=f.indexOf(a);-1!==a&&f.splice(a,1)},add:function(k){void 0!==e[k.name]&&console.log("THREE.AnimationHandler.add: Warning! "+k.name+" already exists in library. Overwriting.");e[k.name]=k;if(!0!==k.initialized){for(var q=0;q<k.hierarchy.length;q++){for(var p=0;p<k.hierarchy[q].keys.length;p++){if(0>k.hierarchy[q].keys[p].time&&(k.hierarchy[q].keys[p].time=0),void 0!==k.hierarchy[q].keys[p].rot&&!(k.hierarchy[q].keys[p].rot instanceof THREE.Quaternion)){var o=k.hierarchy[q].keys[p].rot;k.hierarchy[q].keys[p].rot=new THREE.Quaternion(o[0],o[1],o[2],o[3])}}if(k.hierarchy[q].keys.length&&void 0!==k.hierarchy[q].keys[0].morphTargets){o={};for(p=0;p<k.hierarchy[q].keys.length;p++){for(var n=0;n<k.hierarchy[q].keys[p].morphTargets.length;n++){var m=k.hierarchy[q].keys[p].morphTargets[n];o[m]=-1}}k.hierarchy[q].usedMorphTargets=o;for(p=0;p<k.hierarchy[q].keys.length;p++){var b={};for(m in o){for(n=0;n<k.hierarchy[q].keys[p].morphTargets.length;n++){if(k.hierarchy[q].keys[p].morphTargets[n]===m){b[m]=k.hierarchy[q].keys[p].morphTargetsInfluences[n];break}}n===k.hierarchy[q].keys[p].morphTargets.length&&(b[m]=0)}k.hierarchy[q].keys[p].morphTargetsInfluences=b}}for(p=1;p<k.hierarchy[q].keys.length;p++){k.hierarchy[q].keys[p].time===k.hierarchy[q].keys[p-1].time&&(k.hierarchy[q].keys.splice(p,1),p--)}for(p=0;p<k.hierarchy[q].keys.length;p++){k.hierarchy[q].keys[p].index=p}}p=parseInt(k.length*k.fps,10);k.JIT={};k.JIT.hierarchy=[];for(q=0;q<k.hierarchy.length;q++){k.JIT.hierarchy.push(Array(p))}k.initialized=!0}},get:function(b){if("string"===typeof b){if(e[b]){return e[b]}console.log("THREE.AnimationHandler.get: Couldn't find animation "+b);return null}},parse:function(i){var d=[];if(i instanceof THREE.SkinnedMesh){for(var j=0;j<i.bones.length;j++){d.push(i.bones[j])}}else{g(i,d)}return d}},g=function(i,d){d.push(i);for(var j=0;j<i.children.length;j++){g(i.children[j],d)}};h.LINEAR=0;h.CATMULLROM=1;h.CATMULLROM_FORWARD=2;return h}();THREE.Animation=function(e,d,f){this.root=e;this.data=THREE.AnimationHandler.get(d);this.hierarchy=THREE.AnimationHandler.parse(e);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=this.isPaused=!0;this.interpolationType=void 0!==f?f:THREE.AnimationHandler.LINEAR;this.points=[];this.target=new THREE.Vector3};THREE.Animation.prototype.play=function(h,g){if(!1===this.isPlaying){this.isPlaying=!0;this.loop=void 0!==h?h:!0;this.currentTime=void 0!==g?g:0;var l,k=this.hierarchy.length,j;for(l=0;l<k;l++){j=this.hierarchy[l];j.matrixAutoUpdate=!0;void 0===j.animationCache&&(j.animationCache={},j.animationCache.prevKey={pos:0,rot:0,scl:0},j.animationCache.nextKey={pos:0,rot:0,scl:0},j.animationCache.originalMatrix=j instanceof THREE.Bone?j.skinMatrix:j.matrix);var i=j.animationCache.prevKey;j=j.animationCache.nextKey;i.pos=this.data.hierarchy[l].keys[0];i.rot=this.data.hierarchy[l].keys[0];i.scl=this.data.hierarchy[l].keys[0];j.pos=this.getNextKeyWith("pos",l,1);j.rot=this.getNextKeyWith("rot",l,1);j.scl=this.getNextKeyWith("scl",l,1)}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.Animation.prototype.pause=function(){!0===this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this)};THREE.Animation.prototype.update=function(F){if(!1!==this.isPlaying){var E=["pos","rot","scl"],D,C,B,A,u,v,t,s,r;r=this.currentTime+=F*this.timeScale;s=this.currentTime%=this.data.length;parseInt(Math.min(s*this.data.fps,this.data.length*this.data.fps),10);for(var q=0,o=this.hierarchy.length;q<o;q++){F=this.hierarchy[q];t=F.animationCache;for(var k=0;3>k;k++){D=E[k];u=t.prevKey[D];v=t.nextKey[D];if(v.time<=r){if(s<r){if(this.loop){u=this.data.hierarchy[q].keys[0];for(v=this.getNextKeyWith(D,q,1);v.time<s;){u=v,v=this.getNextKeyWith(D,q,v.index+1)}}else{this.stop();return}}else{do{u=v,v=this.getNextKeyWith(D,q,v.index+1)}while(v.time<s)}t.prevKey[D]=u;t.nextKey[D]=v}F.matrixAutoUpdate=!0;F.matrixWorldNeedsUpdate=!0;C=(s-u.time)/(v.time-u.time);B=u[D];A=v[D];if(0>C||1<C){console.log("THREE.Animation.update: Warning! Scale out of bounds:"+C+" on bone "+q),C=0>C?0:1}if("pos"===D){if(D=F.position,this.interpolationType===THREE.AnimationHandler.LINEAR){D.x=B[0]+(A[0]-B[0])*C,D.y=B[1]+(A[1]-B[1])*C,D.z=B[2]+(A[2]-B[2])*C}else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){this.points[0]=this.getPrevKeyWith("pos",q,u.index-1).pos,this.points[1]=B,this.points[2]=A,this.points[3]=this.getNextKeyWith("pos",q,v.index+1).pos,C=0.33*C+0.33,B=this.interpolateCatmullRom(this.points,C),D.x=B[0],D.y=B[1],D.z=B[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(C=this.interpolateCatmullRom(this.points,1.01*C),this.target.set(C[0],C[1],C[2]),this.target.sub(D),this.target.y=0,this.target.normalize(),C=Math.atan2(this.target.x,this.target.z),F.rotation.set(0,C,0))}}}else{"rot"===D?THREE.Quaternion.slerp(B,A,F.quaternion,C):"scl"===D&&(D=F.scale,D.x=B[0]+(A[0]-B[0])*C,D.y=B[1]+(A[1]-B[1])*C,D.z=B[2]+(A[2]-B[2])*C)}}}}};THREE.Animation.prototype.interpolateCatmullRom=function(t,s){var r=[],q=[],p,o,m,n,l,k;p=(t.length-1)*s;o=Math.floor(p);p-=o;r[0]=0===o?o:o-1;r[1]=o;r[2]=o>t.length-2?o:o+1;r[3]=o>t.length-3?o:o+2;o=t[r[0]];n=t[r[1]];l=t[r[2]];k=t[r[3]];r=p*p;m=p*r;q[0]=this.interpolate(o[0],n[0],l[0],k[0],p,r,m);q[1]=this.interpolate(o[1],n[1],l[1],k[1],p,r,m);q[2]=this.interpolate(o[2],n[2],l[2],k[2],p,r,m);return q};THREE.Animation.prototype.interpolate=function(i,g,n,m,l,k,j){i=0.5*(n-i);m=0.5*(m-g);return(2*(g-n)+i+m)*j+(-3*(g-n)-2*i-m)*k+i*l+g};THREE.Animation.prototype.getNextKeyWith=function(f,e,h){for(var g=this.data.hierarchy[e].keys,h=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?h<g.length-1?h:g.length-1:h%g.length;h<g.length;h++){if(void 0!==g[h][f]){return g[h]}}return this.data.hierarchy[e].keys[0]};THREE.Animation.prototype.getPrevKeyWith=function(f,e,h){for(var g=this.data.hierarchy[e].keys,h=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<h?h:0:0<=h?h:h+g.length;0<=h;h--){if(void 0!==g[h][f]){return g[h]}}return this.data.hierarchy[e].keys[g.length-1]};THREE.KeyFrameAnimation=function(i,g,n){this.root=i;this.data=THREE.AnimationHandler.get(g);this.hierarchy=THREE.AnimationHandler.parse(i);this.currentTime=0;this.timeScale=0.001;this.isPlaying=!1;this.loop=this.isPaused=!0;this.JITCompile=void 0!==n?n:!0;i=0;for(g=this.hierarchy.length;i<g;i++){var n=this.data.hierarchy[i].sids,m=this.hierarchy[i];if(this.data.hierarchy[i].keys.length&&n){for(var l=0;l<n.length;l++){var k=n[l],j=this.getNextKeyWith(k,i,0);j&&j.apply(k)}m.matrixAutoUpdate=!1;this.data.hierarchy[i].node.updateMatrix();m.matrixWorldNeedsUpdate=!0}}};THREE.KeyFrameAnimation.prototype.play=function(h,g){if(!this.isPlaying){this.isPlaying=!0;this.loop=void 0!==h?h:!0;this.currentTime=void 0!==g?g:0;this.startTimeMs=g;this.startTime=10000000;this.endTime=-this.startTime;var l,k=this.hierarchy.length,j,i;for(l=0;l<k;l++){j=this.hierarchy[l],i=this.data.hierarchy[l],void 0===i.animationCache&&(i.animationCache={},i.animationCache.prevKey=null,i.animationCache.nextKey=null,i.animationCache.originalMatrix=j instanceof THREE.Bone?j.skinMatrix:j.matrix),j=this.data.hierarchy[l].keys,j.length&&(i.animationCache.prevKey=j[0],i.animationCache.nextKey=j[1],this.startTime=Math.min(j[0].time,this.startTime),this.endTime=Math.max(j[j.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var f=0;f<this.data.hierarchy.length;f++){var e=this.hierarchy[f],h=this.data.hierarchy[f];if(void 0!==h.animationCache){var g=h.animationCache.originalMatrix;e instanceof THREE.Bone?(g.copy(e.skinMatrix),e.skinMatrix=g):(g.copy(e.matrix),e.matrix=g);delete h.animationCache}}};THREE.KeyFrameAnimation.prototype.update=function(D){if(this.isPlaying){var C,B,A,v,u=this.data.JIT.hierarchy,s,t,r;t=this.currentTime+=D*this.timeScale;s=this.currentTime%=this.data.length;s<this.startTimeMs&&(s=this.currentTime=this.startTimeMs+s);v=parseInt(Math.min(s*this.data.fps,this.data.length*this.data.fps),10);if((r=s<t)&&!this.loop){for(var D=0,q=this.hierarchy.length;D<q;D++){var p=this.data.hierarchy[D].keys,u=this.data.hierarchy[D].sids;A=p.length-1;v=this.hierarchy[D];if(p.length){for(p=0;p<u.length;p++){s=u[p],(t=this.getPrevKeyWith(s,D,A))&&t.apply(s)}this.data.hierarchy[D].node.updateMatrix();v.matrixWorldNeedsUpdate=!0}}this.stop()}else{if(!(s<this.startTime)){D=0;for(q=this.hierarchy.length;D<q;D++){A=this.hierarchy[D];C=this.data.hierarchy[D];var p=C.keys,o=C.animationCache;if(this.JITCompile&&void 0!==u[D][v]){A instanceof THREE.Bone?(A.skinMatrix=u[D][v],A.matrixWorldNeedsUpdate=!1):(A.matrix=u[D][v],A.matrixWorldNeedsUpdate=!0)}else{if(p.length){this.JITCompile&&o&&(A instanceof THREE.Bone?A.skinMatrix=o.originalMatrix:A.matrix=o.originalMatrix);C=o.prevKey;B=o.nextKey;if(C&&B){if(B.time<=t){if(r&&this.loop){C=p[0];for(B=p[1];B.time<s;){C=B,B=p[C.index+1]}}else{if(!r){for(var k=p.length-1;B.time<s&&B.index!==k;){C=B,B=p[C.index+1]}}}o.prevKey=C;o.nextKey=B}B.time>=s?C.interpolate(B,s):C.interpolate(B,B.time)}this.data.hierarchy[D].node.updateMatrix();A.matrixWorldNeedsUpdate=!0}}}if(this.JITCompile&&void 0===u[0][v]){this.hierarchy[0].updateMatrixWorld(!0);for(D=0;D<this.hierarchy.length;D++){u[D][v]=this.hierarchy[D] instanceof THREE.Bone?this.hierarchy[D].skinMatrix.clone():this.hierarchy[D].matrix.clone()}}}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(e,d,f){d=this.data.hierarchy[d].keys;for(f%=d.length;f<d.length;f++){if(d[f].hasTarget(e)){return d[f]}}return d[0]};THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(e,d,f){d=this.data.hierarchy[d].keys;for(f=0<=f?f:f+d.length;0<=f;f--){if(d[f].hasTarget(e)){return d[f]}}return d[d.length-1]};THREE.CubeCamera=function(r,q,p){THREE.Object3D.call(this);var o=new THREE.PerspectiveCamera(90,1,r,q);o.up.set(0,-1,0);o.lookAt(new THREE.Vector3(1,0,0));this.add(o);var n=new THREE.PerspectiveCamera(90,1,r,q);n.up.set(0,-1,0);n.lookAt(new THREE.Vector3(-1,0,0));this.add(n);var m=new THREE.PerspectiveCamera(90,1,r,q);m.up.set(0,0,1);m.lookAt(new THREE.Vector3(0,1,0));this.add(m);var k=new THREE.PerspectiveCamera(90,1,r,q);k.up.set(0,0,-1);k.lookAt(new THREE.Vector3(0,-1,0));this.add(k);var l=new THREE.PerspectiveCamera(90,1,r,q);l.up.set(0,-1,0);l.lookAt(new THREE.Vector3(0,0,1));this.add(l);var j=new THREE.PerspectiveCamera(90,1,r,q);j.up.set(0,-1,0);j.lookAt(new THREE.Vector3(0,0,-1));this.add(j);this.renderTarget=new THREE.WebGLRenderTargetCube(p,p,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(e,d){var g=this.renderTarget,f=g.generateMipmaps;g.generateMipmaps=!1;g.activeCubeFace=0;e.render(d,o,g);g.activeCubeFace=1;e.render(d,n,g);g.activeCubeFace=2;e.render(d,m,g);g.activeCubeFace=3;e.render(d,k,g);g.activeCubeFace=4;e.render(d,l,g);g.generateMipmaps=f;g.activeCubeFace=5;e.render(d,j,g)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CombinedCamera=function(i,g,n,m,l,k,j){THREE.Camera.call(this);this.fov=n;this.left=-i/2;this.right=i/2;this.top=g/2;this.bottom=-g/2;this.cameraO=new THREE.OrthographicCamera(i/-2,i/2,g/2,g/-2,k,j);this.cameraP=new THREE.PerspectiveCamera(n,i/g,m,l);this.zoom=1;this.toPerspective()};THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype);THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPerspectiveMode=!0;this.inOrthographicMode=!1};THREE.CombinedCamera.prototype.toOrthographic=function(){var d=this.cameraP.aspect,c=(this.cameraP.near+this.cameraP.far)/2,c=Math.tan(this.fov/2)*c,d=2*c*d/2,c=c/this.zoom,d=d/this.zoom;this.cameraO.left=-d;this.cameraO.right=d;this.cameraO.top=c;this.cameraO.bottom=-c;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPerspectiveMode=!1;this.inOrthographicMode=!0};THREE.CombinedCamera.prototype.setSize=function(d,c){this.cameraP.aspect=d/c;this.left=-d/2;this.right=d/2;this.top=c/2;this.bottom=-c/2};THREE.CombinedCamera.prototype.setFov=function(b){this.fov=b;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())};THREE.CombinedCamera.prototype.setLens=function(e,d){void 0===d&&(d=24);var f=2*THREE.Math.radToDeg(Math.atan(d/(2*e)));this.setFov(f);return f};THREE.CombinedCamera.prototype.setZoom=function(b){this.zoom=b;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CircleGeometry=function(r,q,p,o){THREE.Geometry.call(this);var r=r||50,p=void 0!==p?p:0,o=void 0!==o?o:2*Math.PI,q=void 0!==q?Math.max(3,q):8,n,m=[];n=new THREE.Vector3;var k=new THREE.Vector2(0.5,0.5);this.vertices.push(n);m.push(k);for(n=0;n<=q;n++){var l=new THREE.Vector3,j=p+n/q*o;l.x=r*Math.cos(j);l.y=r*Math.sin(j);this.vertices.push(l);m.push(new THREE.Vector2((l.x/r+1)/2,(l.y/r+1)/2))}p=new THREE.Vector3(0,0,1);for(n=1;n<=q;n++){this.faces.push(new THREE.Face3(n,n+1,0,[p,p,p])),this.faceVertexUvs[0].push([m[n],m[n+1],k])}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,r)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CubeGeometry=function(j,i,p,o,n,m){function k(Z,Y,X,W,V,U,T,R){var P,N=l.widthSegments,L=l.heightSegments,t=V/2,O=U/2,J=l.vertices.length;if("x"===Z&&"y"===Y||"y"===Z&&"x"===Y){P="z"}else{if("x"===Z&&"z"===Y||"z"===Z&&"x"===Y){P="y",L=l.depthSegments}else{if("z"===Z&&"y"===Y||"y"===Z&&"z"===Y){P="x",N=l.depthSegments}}}var D=N+1,v=L+1,E=V/N,S=U/L,g=new THREE.Vector3;g[P]=0<T?1:-1;for(V=0;V<v;V++){for(U=0;U<D;U++){var Q=new THREE.Vector3;Q[Z]=(U*E-t)*X;Q[Y]=(V*S-O)*W;Q[P]=T;l.vertices.push(Q)}}for(V=0;V<L;V++){for(U=0;U<N;U++){Z=new THREE.Face4(U+D*V+J,U+D*(V+1)+J,U+1+D*(V+1)+J,U+1+D*V+J),Z.normal.copy(g),Z.vertexNormals.push(g.clone(),g.clone(),g.clone(),g.clone()),Z.materialIndex=R,l.faces.push(Z),l.faceVertexUvs[0].push([new THREE.Vector2(U/N,1-V/L),new THREE.Vector2(U/N,1-(V+1)/L),new THREE.Vector2((U+1)/N,1-(V+1)/L),new THREE.Vector2((U+1)/N,1-V/L)])}}}THREE.Geometry.call(this);var l=this;this.width=j;this.height=i;this.depth=p;this.widthSegments=o||1;this.heightSegments=n||1;this.depthSegments=m||1;j=this.width/2;i=this.height/2;p=this.depth/2;k("z","y",-1,-1,this.depth,this.height,j,0);k("z","y",1,-1,this.depth,this.height,-j,1);k("x","z",1,1,this.width,this.depth,i,2);k("x","z",1,-1,this.width,this.depth,-i,3);k("x","y",1,-1,this.width,this.height,p,4);k("x","y",-1,-1,this.width,this.height,-p,5);this.computeCentroids();this.mergeVertices()};THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CylinderGeometry=function(ab,aa,Z,Y,X,W){THREE.Geometry.call(this);this.radiusTop=ab=void 0!==ab?ab:20;this.radiusBottom=aa=void 0!==aa?aa:20;this.height=Z=void 0!==Z?Z:100;this.radialSegments=Y=Y||8;this.heightSegments=X=X||1;this.openEnded=W=void 0!==W?W:!1;var U=Z/2,V,T,S=[],R=[];for(T=0;T<=X;T++){var Q=[],P=[],O=T/X,E=O*(aa-ab)+ab;for(V=0;V<=Y;V++){var N=V/Y,L=new THREE.Vector3;L.x=E*Math.sin(2*N*Math.PI);L.y=-O*Z+U;L.z=E*Math.cos(2*N*Math.PI);this.vertices.push(L);Q.push(this.vertices.length-1);P.push(new THREE.Vector2(N,1-O))}S.push(Q);R.push(P)}Z=(aa-ab)/Z;for(V=0;V<Y;V++){0!==ab?(Q=this.vertices[S[0][V]].clone(),P=this.vertices[S[0][V+1]].clone()):(Q=this.vertices[S[1][V]].clone(),P=this.vertices[S[1][V+1]].clone());Q.setY(Math.sqrt(Q.x*Q.x+Q.z*Q.z)*Z).normalize();P.setY(Math.sqrt(P.x*P.x+P.z*P.z)*Z).normalize();for(T=0;T<X;T++){var O=S[T][V],E=S[T+1][V],N=S[T+1][V+1],L=S[T][V+1],J=Q.clone(),D=Q.clone(),k=P.clone(),K=P.clone(),B=R[T][V].clone(),v=R[T+1][V].clone(),o=R[T+1][V+1].clone(),A=R[T][V+1].clone();this.faces.push(new THREE.Face4(O,E,N,L,[J,D,k,K]));this.faceVertexUvs[0].push([B,v,o,A])}}if(!1===W&&0<ab){this.vertices.push(new THREE.Vector3(0,U,0));for(V=0;V<Y;V++){O=S[0][V],E=S[0][V+1],N=this.vertices.length-1,J=new THREE.Vector3(0,1,0),D=new THREE.Vector3(0,1,0),k=new THREE.Vector3(0,1,0),B=R[0][V].clone(),v=R[0][V+1].clone(),o=new THREE.Vector2(v.u,0),this.faces.push(new THREE.Face3(O,E,N,[J,D,k])),this.faceVertexUvs[0].push([B,v,o])}}if(!1===W&&0<aa){this.vertices.push(new THREE.Vector3(0,-U,0));for(V=0;V<Y;V++){O=S[T][V+1],E=S[T][V],N=this.vertices.length-1,J=new THREE.Vector3(0,-1,0),D=new THREE.Vector3(0,-1,0),k=new THREE.Vector3(0,-1,0),B=R[T][V+1].clone(),v=R[T][V].clone(),o=new THREE.Vector2(v.u,1),this.faces.push(new THREE.Face3(O,E,N,[J,D,k])),this.faceVertexUvs[0].push([B,v,o])}}this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry=function(d,c){"undefined"!==typeof d&&(THREE.Geometry.call(this),d=d instanceof Array?d:[d],this.shapebb=d[d.length-1].getBoundingBox(),this.addShapeList(d,c),this.computeCentroids(),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(f,e){for(var h=f.length,g=0;g<h;g++){this.addShape(f[g],e)}};THREE.ExtrudeGeometry.prototype.addShape=function(aD,aC){function aB(e,d,f){d||console.log("die");return d.clone().multiplyScalar(f).add(e)}function aA(t,s,r){var q=THREE.ExtrudeGeometry.__v1,p=THREE.ExtrudeGeometry.__v2,n=THREE.ExtrudeGeometry.__v3,m=THREE.ExtrudeGeometry.__v4,l=THREE.ExtrudeGeometry.__v5,j=THREE.ExtrudeGeometry.__v6;q.set(t.x-s.x,t.y-s.y);p.set(t.x-r.x,t.y-r.y);q=q.normalize();p=p.normalize();n.set(-q.y,q.x);m.set(p.y,-p.x);l.copy(t).add(n);j.copy(t).add(m);if(l.equals(j)){return m.clone()}l.copy(s).add(n);j.copy(r).add(m);n=q.dot(m);m=j.sub(l).dot(m);0===n&&(console.log("Either infinite or no solutions!"),0===m?console.log("Its finite solutions."):console.log("Too bad, no solutions."));m/=n;return 0>m?(s=Math.atan2(s.y-t.y,s.x-t.x),t=Math.atan2(r.y-t.y,r.x-t.x),s>t&&(t+=2*Math.PI),r=(s+t)/2,t=-Math.cos(r),r=-Math.sin(r),new THREE.Vector2(t,r)):q.multiplyScalar(m).add(l).sub(t).clone()}function az(H,G){var F,D;for(P=H.length;0<=--P;){F=P;D=P-1;0>D&&(D=H.length-1);for(var C=0,B=ao+2*ar,C=0;C<B;C++){var A=af*C,u=af*(C+1),p=G+F+A,A=G+D+A,l=G+D+u,u=G+F+u,b=H,a=C,K=B,J=F,I=D,p=p+U,A=A+U,l=l+U,u=u+U;ad.faces.push(new THREE.Face4(p,A,l,u,null,null,aj));p=ag.generateSideWallUV(ad,aD,b,aC,p,A,l,u,a,K,J,I);ad.faceVertexUvs[0].push(p)}}}function ay(e,d,f){ad.vertices.push(new THREE.Vector3(e,d,f))}function aw(h,g,b,a){h+=U;g+=U;b+=U;ad.faces.push(new THREE.Face3(h,g,b,null,null,al));h=a?ag.generateBottomUV(ad,aD,aC,h,g,b):ag.generateTopUV(ad,aD,aC,h,g,b);ad.faceVertexUvs[0].push(h)}var ax=void 0!==aC.amount?aC.amount:100,av=void 0!==aC.bevelThickness?aC.bevelThickness:6,au=void 0!==aC.bevelSize?aC.bevelSize:av-2,ar=void 0!==aC.bevelSegments?aC.bevelSegments:3,aq=void 0!==aC.bevelEnabled?aC.bevelEnabled:!0,ap=void 0!==aC.curveSegments?aC.curveSegments:12,ao=void 0!==aC.steps?aC.steps:1,ak=aC.extrudePath,an,am=!1,al=aC.material,aj=aC.extrudeMaterial,ag=void 0!==aC.UVGenerator?aC.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,ac,aa,X,V;ak&&(an=ak.getSpacedPoints(ao),am=!0,aq=!1,ac=void 0!==aC.frames?aC.frames:new THREE.TubeGeometry.FrenetFrames(ak,ao,!1),aa=new THREE.Vector3,X=new THREE.Vector3,V=new THREE.Vector3);aq||(au=av=ar=0);var Y,ae,T,ad=this,U=this.vertices.length,ap=aD.extractPoints(ap),Q=ap.shape,ap=ap.holes;if(ak=!THREE.Shape.Utils.isClockWise(Q)){Q=Q.reverse();ae=0;for(T=ap.length;ae<T;ae++){Y=ap[ae],THREE.Shape.Utils.isClockWise(Y)&&(ap[ae]=Y.reverse())}ak=!1}var ah=THREE.Shape.Utils.triangulateShape(Q,ap),ak=Q;ae=0;for(T=ap.length;ae<T;ae++){Y=ap[ae],Q=Q.concat(Y)}var R,ai,k,S,af=Q.length,at=ah.length,W=[],P=0,o=ak.length;R=o-1;for(ai=P+1;P<o;P++,R++,ai++){R===o&&(R=0),ai===o&&(ai=0),W[P]=aA(ak[P],ak[R],ak[ai])}var v=[],E,ab=W.concat();ae=0;for(T=ap.length;ae<T;ae++){Y=ap[ae];E=[];P=0;o=Y.length;R=o-1;for(ai=P+1;P<o;P++,R++,ai++){R===o&&(R=0),ai===o&&(ai=0),E[P]=aA(Y[P],Y[R],Y[ai])}v.push(E);ab=ab.concat(E)}for(R=0;R<ar;R++){Y=R/ar;k=av*(1-Y);ai=au*Math.sin(Y*Math.PI/2);P=0;for(o=ak.length;P<o;P++){S=aB(ak[P],W[P],ai),ay(S.x,S.y,-k)}ae=0;for(T=ap.length;ae<T;ae++){Y=ap[ae];E=v[ae];P=0;for(o=Y.length;P<o;P++){S=aB(Y[P],E[P],ai),ay(S.x,S.y,-k)}}}ai=au;for(P=0;P<af;P++){S=aq?aB(Q[P],ab[P],ai):Q[P],am?(X.copy(ac.normals[0]).multiplyScalar(S.x),aa.copy(ac.binormals[0]).multiplyScalar(S.y),V.copy(an[0]).add(X).add(aa),ay(V.x,V.y,V.z)):ay(S.x,S.y,0)}for(Y=1;Y<=ao;Y++){for(P=0;P<af;P++){S=aq?aB(Q[P],ab[P],ai):Q[P],am?(X.copy(ac.normals[Y]).multiplyScalar(S.x),aa.copy(ac.binormals[Y]).multiplyScalar(S.y),V.copy(an[Y]).add(X).add(aa),ay(V.x,V.y,V.z)):ay(S.x,S.y,ax/ao*Y)}}for(R=ar-1;0<=R;R--){Y=R/ar;k=av*(1-Y);ai=au*Math.sin(Y*Math.PI/2);P=0;for(o=ak.length;P<o;P++){S=aB(ak[P],W[P],ai),ay(S.x,S.y,ax+k)}ae=0;for(T=ap.length;ae<T;ae++){Y=ap[ae];E=v[ae];P=0;for(o=Y.length;P<o;P++){S=aB(Y[P],E[P],ai),am?ay(S.x,S.y+an[ao-1].y,an[ao-1].x+k):ay(S.x,S.y,ax+k)}}}if(aq){av=0*af;for(P=0;P<at;P++){ax=ah[P],aw(ax[2]+av,ax[1]+av,ax[0]+av,!0)}av=af*(ao+2*ar);for(P=0;P<at;P++){ax=ah[P],aw(ax[0]+av,ax[1]+av,ax[2]+av,!1)}}else{for(P=0;P<at;P++){ax=ah[P],aw(ax[2],ax[1],ax[0],!0)}for(P=0;P<at;P++){ax=ah[P],aw(ax[0]+af*ao,ax[1]+af*ao,ax[2]+af*ao,!1)}}ax=0;az(ak,ax);ax+=ak.length;ae=0;for(T=ap.length;ae<T;ae++){Y=ap[ae],az(Y,ax),ax+=Y.length}};THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(h,g,l,k,j,i){g=h.vertices[j].x;j=h.vertices[j].y;l=h.vertices[i].x;i=h.vertices[i].y;return[new THREE.Vector2(h.vertices[k].x,h.vertices[k].y),new THREE.Vector2(g,j),new THREE.Vector2(l,i)]},generateBottomUV:function(h,g,l,k,j,i){return this.generateTopUV(h,g,l,k,j,i)},generateSideWallUV:function(D,C,B,A,v,u,s,t){var C=D.vertices[v].x,B=D.vertices[v].y,v=D.vertices[v].z,A=D.vertices[u].x,r=D.vertices[u].y,u=D.vertices[u].z,q=D.vertices[s].x,p=D.vertices[s].y,s=D.vertices[s].z,o=D.vertices[t].x,k=D.vertices[t].y,D=D.vertices[t].z;return 0.01>Math.abs(B-r)?[new THREE.Vector2(C,1-v),new THREE.Vector2(A,1-u),new THREE.Vector2(q,1-s),new THREE.Vector2(o,1-D)]:[new THREE.Vector2(B,1-v),new THREE.Vector2(r,1-u),new THREE.Vector2(p,1-s),new THREE.Vector2(k,1-D)]}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.ShapeGeometry=function(d,c){THREE.Geometry.call(this);!1===d instanceof Array&&(d=[d]);this.shapebb=d[d.length-1].getBoundingBox();this.addShapeList(d,c);this.computeCentroids();this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(f,e){for(var h=0,g=f.length;h<g;h++){this.addShape(f[h],e)}return this};THREE.ShapeGeometry.prototype.addShape=function(v,u){void 0===u&&(u={});var t=u.material,s=void 0===u.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:u.UVGenerator,r,q,o,p=this.vertices.length;r=v.extractPoints(void 0!==u.curveSegments?u.curveSegments:12);var n=r.shape,m=r.holes;if(!THREE.Shape.Utils.isClockWise(n)){n=n.reverse();r=0;for(q=m.length;r<q;r++){o=m[r],THREE.Shape.Utils.isClockWise(o)&&(m[r]=o.reverse())}}var k=THREE.Shape.Utils.triangulateShape(n,m);r=0;for(q=m.length;r<q;r++){o=m[r],n=n.concat(o)}m=n.length;q=k.length;for(r=0;r<m;r++){o=n[r],this.vertices.push(new THREE.Vector3(o.x,o.y,0))}for(r=0;r<q;r++){m=k[r],n=m[0]+p,o=m[1]+p,m=m[2]+p,this.faces.push(new THREE.Face3(n,o,m,null,null,t)),this.faceVertexUvs[0].push(s.generateBottomUV(this,v,u,n,o,m))}};THREE.LatheGeometry=function(F,E,D,C){THREE.Geometry.call(this);for(var E=E||12,D=D||0,C=C||2*Math.PI,B=1/(F.length-1),A=1/E,u=0,v=E;u<=v;u++){for(var t=D+u*A*C,s=Math.cos(t),r=Math.sin(t),t=0,q=F.length;t<q;t++){var o=F[t],k=new THREE.Vector3;k.x=s*o.x-r*o.y;k.y=r*o.x+s*o.y;k.z=o.z;this.vertices.push(k)}}D=F.length;u=0;for(v=E;u<v;u++){t=0;for(q=F.length-1;t<q;t++){C=E=t+D*u,r=E+D,s=E+1+D,this.faces.push(new THREE.Face4(C,r,s,E+1)),s=u*A,E=t*B,C=s+A,r=E+B,this.faceVertexUvs[0].push([new THREE.Vector2(s,E),new THREE.Vector2(C,E),new THREE.Vector2(C,r),new THREE.Vector2(s,r)])}}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PlaneGeometry=function(v,u,t,s){THREE.Geometry.call(this);this.width=v;this.height=u;this.widthSegments=t||1;this.heightSegments=s||1;for(var t=v/2,r=u/2,s=this.widthSegments,q=this.heightSegments,o=s+1,p=q+1,n=this.width/s,m=this.height/q,k=new THREE.Vector3(0,0,1),v=0;v<p;v++){for(u=0;u<o;u++){this.vertices.push(new THREE.Vector3(u*n-t,-(v*m-r),0))}}for(v=0;v<q;v++){for(u=0;u<s;u++){t=new THREE.Face4(u+o*v,u+o*(v+1),u+1+o*(v+1),u+1+o*v),t.normal.copy(k),t.vertexNormals.push(k.clone(),k.clone(),k.clone(),k.clone()),this.faces.push(t),this.faceVertexUvs[0].push([new THREE.Vector2(u/s,1-v/q),new THREE.Vector2(u/s,1-(v+1)/q),new THREE.Vector2((u+1)/s,1-(v+1)/q),new THREE.Vector2((u+1)/s,1-v/q)])}}this.computeCentroids()};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.RingGeometry=function(B,A,v,u,t,s){THREE.Geometry.call(this);for(var B=B||0,A=A||50,t=void 0!==t?t:0,s=void 0!==s?s:2*Math.PI,v=void 0!==v?Math.max(3,v):8,u=void 0!==u?Math.max(3,u):8,q=[],r=B,p=(A-B)/u,B=0;B<=u;B++){for(A=0;A<=v;A++){var o=new THREE.Vector3,n=t+A/v*s;o.x=r*Math.cos(n);o.y=r*Math.sin(n);this.vertices.push(o);q.push(new THREE.Vector2((o.x/r+1)/2,-(o.y/r+1)/2+1))}r+=p}t=new THREE.Vector3(0,0,1);for(B=0;B<u;B++){s=B*v;for(A=0;A<=v;A++){var n=A+s,p=n+B,o=n+v+B,k=n+v+1+B;this.faces.push(new THREE.Face3(p,o,k,[t,t,t]));this.faceVertexUvs[0].push([q[p],q[o],q[k]]);p=n+B;o=n+v+1+B;k=n+1+B;this.faces.push(new THREE.Face3(p,o,k,[t,t,t]));this.faceVertexUvs[0].push([q[p],q[o],q[k]])}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,r)};THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.SphereGeometry=function(K,J,I,H,G,F,D){THREE.Geometry.call(this);this.radius=K=K||50;this.widthSegments=J=Math.max(3,Math.floor(J)||8);this.heightSegments=I=Math.max(2,Math.floor(I)||6);this.phiStart=H=void 0!==H?H:0;this.phiLength=G=void 0!==G?G:2*Math.PI;this.thetaStart=F=void 0!==F?F:0;this.thetaLength=D=void 0!==D?D:Math.PI;var E,C,B=[],A=[];for(C=0;C<=I;C++){var v=[],u=[];for(E=0;E<=J;E++){var s=E/J,L=C/I,o=new THREE.Vector3;o.x=-K*Math.cos(H+s*G)*Math.sin(F+L*D);o.y=K*Math.cos(F+L*D);o.z=K*Math.sin(H+s*G)*Math.sin(F+L*D);this.vertices.push(o);v.push(this.vertices.length-1);u.push(new THREE.Vector2(s,1-L))}B.push(v);A.push(u)}for(C=0;C<this.heightSegments;C++){for(E=0;E<this.widthSegments;E++){var J=B[C][E+1],I=B[C][E],H=B[C+1][E],G=B[C+1][E+1],F=this.vertices[J].clone().normalize(),D=this.vertices[I].clone().normalize(),v=this.vertices[H].clone().normalize(),u=this.vertices[G].clone().normalize(),s=A[C][E+1].clone(),L=A[C][E].clone(),o=A[C+1][E].clone(),k=A[C+1][E+1].clone();Math.abs(this.vertices[J].y)===this.radius?(this.faces.push(new THREE.Face3(J,H,G,[F,v,u])),this.faceVertexUvs[0].push([s,o,k])):Math.abs(this.vertices[H].y)===this.radius?(this.faces.push(new THREE.Face3(J,I,H,[F,D,v])),this.faceVertexUvs[0].push([s,L,o])):(this.faces.push(new THREE.Face4(J,I,H,G,[F,D,v,u])),this.faceVertexUvs[0].push([s,L,o,k]))}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,K)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TextGeometry=function(e,d){var d=d||{},f=THREE.FontUtils.generateShapes(e,d);d.amount=void 0!==d.height?d.height:50;void 0===d.bevelThickness&&(d.bevelThickness=10);void 0===d.bevelSize&&(d.bevelSize=8);void 0===d.bevelEnabled&&(d.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,f,d)};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);THREE.TorusGeometry=function(r,q,p,o,n){THREE.Geometry.call(this);this.radius=r||100;this.tube=q||40;this.radialSegments=p||8;this.tubularSegments=o||6;this.arc=n||2*Math.PI;n=new THREE.Vector3;r=[];q=[];for(p=0;p<=this.radialSegments;p++){for(o=0;o<=this.tubularSegments;o++){var m=o/this.tubularSegments*this.arc,k=2*p/this.radialSegments*Math.PI;n.x=this.radius*Math.cos(m);n.y=this.radius*Math.sin(m);var l=new THREE.Vector3;l.x=(this.radius+this.tube*Math.cos(k))*Math.cos(m);l.y=(this.radius+this.tube*Math.cos(k))*Math.sin(m);l.z=this.tube*Math.sin(k);this.vertices.push(l);r.push(new THREE.Vector2(o/this.tubularSegments,p/this.radialSegments));q.push(l.clone().sub(n).normalize())}}for(p=1;p<=this.radialSegments;p++){for(o=1;o<=this.tubularSegments;o++){var n=(this.tubularSegments+1)*p+o-1,m=(this.tubularSegments+1)*(p-1)+o-1,k=(this.tubularSegments+1)*(p-1)+o,l=(this.tubularSegments+1)*p+o,j=new THREE.Face4(n,m,k,l,[q[n],q[m],q[k],q[l]]);j.normal.add(q[n]);j.normal.add(q[m]);j.normal.add(q[k]);j.normal.add(q[l]);j.normal.normalize();this.faces.push(j);this.faceVertexUvs[0].push([r[n].clone(),r[m].clone(),r[k].clone(),r[l].clone()])}}this.computeCentroids()};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusKnotGeometry=function(v,u,t,s,r,q,o){function p(i,h,C,B,A){var l=Math.cos(i),j=Math.sin(i),i=h/C*i,h=Math.cos(i),l=0.5*(B*(2+h))*l,j=0.5*B*(2+h)*j,B=0.5*A*B*Math.sin(i);return new THREE.Vector3(l,j,B)}THREE.Geometry.call(this);this.radius=v||100;this.tube=u||40;this.radialSegments=t||64;this.tubularSegments=s||8;this.p=r||2;this.q=q||3;this.heightScale=o||1;this.grid=Array(this.radialSegments);t=new THREE.Vector3;s=new THREE.Vector3;r=new THREE.Vector3;for(v=0;v<this.radialSegments;++v){this.grid[v]=Array(this.tubularSegments);u=2*(v/this.radialSegments)*this.p*Math.PI;q=p(u,this.q,this.p,this.radius,this.heightScale);u=p(u+0.01,this.q,this.p,this.radius,this.heightScale);t.subVectors(u,q);s.addVectors(u,q);r.crossVectors(t,s);s.crossVectors(r,t);r.normalize();s.normalize();for(u=0;u<this.tubularSegments;++u){var n=2*(u/this.tubularSegments)*Math.PI,o=-this.tube*Math.cos(n),n=this.tube*Math.sin(n),m=new THREE.Vector3;m.x=q.x+o*s.x+n*r.x;m.y=q.y+o*s.y+n*r.y;m.z=q.z+o*s.z+n*r.z;this.grid[v][u]=this.vertices.push(m)-1}}for(v=0;v<this.radialSegments;++v){for(u=0;u<this.tubularSegments;++u){var r=(v+1)%this.radialSegments,q=(u+1)%this.tubularSegments,t=this.grid[v][u],s=this.grid[r][u],r=this.grid[r][q],q=this.grid[v][q],o=new THREE.Vector2(v/this.radialSegments,u/this.tubularSegments),n=new THREE.Vector2((v+1)/this.radialSegments,u/this.tubularSegments),m=new THREE.Vector2((v+1)/this.radialSegments,(u+1)/this.tubularSegments),k=new THREE.Vector2(v/this.radialSegments,(u+1)/this.tubularSegments);this.faces.push(new THREE.Face4(t,s,r,q));this.faceVertexUvs[0].push([o,n,m,k])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry=function(B,A,v,u,t){THREE.Geometry.call(this);this.path=B;this.segments=A||64;this.radius=v||1;this.radialSegments=u||8;this.closed=t||!1;this.grid=[];var s,q,u=this.segments+1,r,p,o,t=new THREE.Vector3,n,k,A=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed);n=A.normals;k=A.binormals;this.tangents=A.tangents;this.normals=n;this.binormals=k;for(A=0;A<u;A++){this.grid[A]=[];v=A/(u-1);o=B.getPointAt(v);s=n[A];q=k[A];for(v=0;v<this.radialSegments;v++){r=2*(v/this.radialSegments)*Math.PI,p=-this.radius*Math.cos(r),r=this.radius*Math.sin(r),t.copy(o),t.x+=p*s.x+r*q.x,t.y+=p*s.y+r*q.y,t.z+=p*s.z+r*q.z,this.grid[A][v]=this.vertices.push(new THREE.Vector3(t.x,t.y,t.z))-1}}for(A=0;A<this.segments;A++){for(v=0;v<this.radialSegments;v++){t=this.closed?(A+1)%this.segments:A+1,n=(v+1)%this.radialSegments,B=this.grid[A][v],u=this.grid[t][v],t=this.grid[t][n],n=this.grid[A][n],k=new THREE.Vector2(A/this.segments,v/this.radialSegments),s=new THREE.Vector2((A+1)/this.segments,v/this.radialSegments),q=new THREE.Vector2((A+1)/this.segments,(v+1)/this.radialSegments),p=new THREE.Vector2(A/this.segments,(v+1)/this.radialSegments),this.faces.push(new THREE.Face4(B,u,t,n)),this.faceVertexUvs[0].push([k,s,q,p])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry.FrenetFrames=function(B,A,v){new THREE.Vector3;var u=new THREE.Vector3;new THREE.Vector3;var t=[],s=[],q=[],r=new THREE.Vector3,p=new THREE.Matrix4,A=A+1,o,n,k;this.tangents=t;this.normals=s;this.binormals=q;for(o=0;o<A;o++){n=o/(A-1),t[o]=B.getTangentAt(n),t[o].normalize()}s[0]=new THREE.Vector3;q[0]=new THREE.Vector3;B=Number.MAX_VALUE;o=Math.abs(t[0].x);n=Math.abs(t[0].y);k=Math.abs(t[0].z);o<=B&&(B=o,u.set(1,0,0));n<=B&&(B=n,u.set(0,1,0));k<=B&&u.set(0,0,1);r.crossVectors(t[0],u).normalize();s[0].crossVectors(t[0],r);q[0].crossVectors(t[0],s[0]);for(o=1;o<A;o++){s[o]=s[o-1].clone(),q[o]=q[o-1].clone(),r.crossVectors(t[o-1],t[o]),0.0001<r.length()&&(r.normalize(),u=Math.acos(THREE.Math.clamp(t[o-1].dot(t[o]),-1,1)),s[o].applyMatrix4(p.makeRotationAxis(r,u))),q[o].crossVectors(t[o],s[o])}if(v){u=Math.acos(THREE.Math.clamp(s[0].dot(s[A-1]),-1,1));u/=A-1;0<t[0].dot(r.crossVectors(s[0],s[A-1]))&&(u=-u);for(o=1;o<A;o++){s[o].applyMatrix4(p.makeRotationAxis(t[o],u*o)),q[o].crossVectors(t[o],s[o])}}};THREE.PolyhedronGeometry=function(Q,P,O,N){function L(e){var d=e.normalize().clone();d.index=J.vertices.push(d)-1;var f=Math.atan2(e.z,-e.x)/2/Math.PI+0.5,e=Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+0.5;d.uv=new THREE.Vector2(f,1-e);return d}function K(f,e,h){var g=new THREE.Face3(f.index,e.index,h.index,[f.clone(),e.clone(),h.clone()]);g.centroid.add(f).add(e).add(h).divideScalar(3);J.faces.push(g);g=Math.atan2(g.centroid.z,-g.centroid.x);J.faceVertexUvs[0].push([I(f.uv,f,g),I(e.uv,e,g),I(h.uv,h,g)])}function I(e,d,f){0>f&&1===e.x&&(e=new THREE.Vector2(e.x-1,e.y));0===d.x&&0===d.z&&(e=new THREE.Vector2(f/2/Math.PI+0.5,e.y));return e.clone()}THREE.Geometry.call(this);for(var O=O||1,N=N||0,J=this,H=0,G=Q.length;H<G;H++){L(new THREE.Vector3(Q[H][0],Q[H][1],Q[H][2]))}for(var F=this.vertices,Q=[],H=0,G=P.length;H<G;H++){var E=F[P[H][0]],D=F[P[H][1]],C=F[P[H][2]];Q[H]=new THREE.Face3(E.index,D.index,C.index,[E.clone(),D.clone(),C.clone()])}H=0;for(G=Q.length;H<G;H++){D=Q[H];F=N;P=Math.pow(2,F);Math.pow(4,F);for(var F=L(J.vertices[D.a]),E=L(J.vertices[D.b]),o=L(J.vertices[D.c]),D=[],C=0;C<=P;C++){D[C]=[];for(var B=L(F.clone().lerp(o,C/P)),A=L(E.clone().lerp(o,C/P)),v=P-C,k=0;k<=v;k++){D[C][k]=0==k&&C==P?B:L(B.clone().lerp(A,k/v))}}for(C=0;C<P;C++){for(k=0;k<2*(P-C)-1;k++){F=Math.floor(k/2),0==k%2?K(D[C][F+1],D[C+1][F],D[C][F]):K(D[C][F+1],D[C+1][F+1],D[C+1][F])}}}H=0;for(G=this.faceVertexUvs[0].length;H<G;H++){N=this.faceVertexUvs[0][H],Q=N[0].x,P=N[1].x,F=N[2].x,E=Math.max(Q,Math.max(P,F)),D=Math.min(Q,Math.min(P,F)),0.9<E&&0.1>D&&(0.2>Q&&(N[0].x+=1),0.2>P&&(N[1].x+=1),0.2>F&&(N[2].x+=1))}H=0;for(G=this.vertices.length;H<G;H++){this.vertices[H].multiplyScalar(O)}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,O)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.IcosahedronGeometry=function(e,d){this.radius=e;this.detail=d;var f=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,f,0],[1,f,0],[-1,-f,0],[1,-f,0],[0,-1,f],[0,1,f],[0,-1,-f],[0,1,-f],[f,0,-1],[f,0,1],[-f,0,-1],[-f,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],e,d)};THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.OctahedronGeometry=function(d,c){THREE.PolyhedronGeometry.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],d,c)};THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TetrahedronGeometry=function(d,c){THREE.PolyhedronGeometry.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],d,c)};THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ParametricGeometry=function(I,H,G,F){THREE.Geometry.call(this);var E=this.vertices,D=this.faces,B=this.faceVertexUvs[0],F=void 0===F?!1:F,C,A,v,u,s=H+1;for(C=0;C<=G;C++){u=C/G;for(A=0;A<=H;A++){v=A/H,v=I(v,u),E.push(v)}}var r,o,J,k;for(C=0;C<G;C++){for(A=0;A<H;A++){I=C*s+A,E=C*s+A+1,u=(C+1)*s+A,v=(C+1)*s+A+1,r=new THREE.Vector2(A/H,C/G),o=new THREE.Vector2((A+1)/H,C/G),J=new THREE.Vector2(A/H,(C+1)/G),k=new THREE.Vector2((A+1)/H,(C+1)/G),F?(D.push(new THREE.Face3(I,E,u)),D.push(new THREE.Face3(E,v,u)),B.push([r,o,J]),B.push([o,k,J])):(D.push(new THREE.Face4(I,E,v,u)),B.push([r,o,k,J]))}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.AxisHelper=function(d){var d=d||1,c=new THREE.Geometry;c.vertices.push(new THREE.Vector3,new THREE.Vector3(d,0,0),new THREE.Vector3,new THREE.Vector3(0,d,0),new THREE.Vector3,new THREE.Vector3(0,0,d));c.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,c,d,THREE.LinePieces)};THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);THREE.ArrowHelper=function(f,e,h,g){THREE.Object3D.call(this);void 0===g&&(g=16776960);void 0===h&&(h=1);this.position=e;e=new THREE.Geometry;e.vertices.push(new THREE.Vector3(0,0,0));e.vertices.push(new THREE.Vector3(0,1,0));this.line=new THREE.Line(e,new THREE.LineBasicMaterial({color:g}));this.line.matrixAutoUpdate=!1;this.add(this.line);e=new THREE.CylinderGeometry(0,0.05,0.25,5,1);e.applyMatrix((new THREE.Matrix4).makeTranslation(0,0.875,0));this.cone=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:g}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(f);this.setLength(h)};THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var d=new THREE.Vector3,c;return function(a){0.99999<a.y?this.quaternion.set(0,0,0,1):-0.99999>a.y?this.quaternion.set(1,0,0,0):(d.set(a.z,0,-a.x).normalize(),c=Math.acos(a.y),this.quaternion.setFromAxisAngle(d,c))}}();THREE.ArrowHelper.prototype.setLength=function(b){this.scale.set(b,b,b)};THREE.ArrowHelper.prototype.setColor=function(b){this.line.material.color.setHex(b);this.cone.material.color.setHex(b)};THREE.BoxHelper=function(e){var d=[new THREE.Vector3(1,1,1),new THREE.Vector3(-1,1,1),new THREE.Vector3(-1,-1,1),new THREE.Vector3(1,-1,1),new THREE.Vector3(1,1,-1),new THREE.Vector3(-1,1,-1),new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,-1,-1)];this.vertices=d;var f=new THREE.Geometry;f.vertices.push(d[0],d[1],d[1],d[2],d[2],d[3],d[3],d[0],d[4],d[5],d[5],d[6],d[6],d[7],d[7],d[4],d[0],d[4],d[1],d[5],d[2],d[6],d[3],d[7]);THREE.Line.call(this,f,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces);void 0!==e&&this.update(e)};THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);THREE.BoxHelper.prototype.update=function(f){var e=f.geometry;null===e.boundingBox&&e.computeBoundingBox();var h=e.boundingBox.min,e=e.boundingBox.max,g=this.vertices;g[0].set(e.x,e.y,e.z);g[1].set(h.x,e.y,e.z);g[2].set(h.x,h.y,e.z);g[3].set(e.x,h.y,e.z);g[4].set(e.x,e.y,h.z);g[5].set(h.x,e.y,h.z);g[6].set(h.x,h.y,h.z);g[7].set(e.x,h.y,h.z);this.geometry.computeBoundingSphere();this.geometry.verticesNeedUpdate=!0;this.matrixAutoUpdate=!1;this.matrixWorld=f.matrixWorld};THREE.BoundingBoxHelper=function(e,d){var f=d||8947848;this.object=e;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.CubeGeometry(1,1,1),new THREE.MeshBasicMaterial({color:f,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};THREE.CameraHelper=function(h){function g(e,c,f){l(e,f);l(c,f)}function l(d,c){k.vertices.push(new THREE.Vector3);k.colors.push(new THREE.Color(c));void 0===i[d]&&(i[d]=[]);i[d].push(k.vertices.length-1)}var k=new THREE.Geometry,j=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),i={};g("n1","n2",16755200);g("n2","n4",16755200);g("n4","n3",16755200);g("n3","n1",16755200);g("f1","f2",16755200);g("f2","f4",16755200);g("f4","f3",16755200);g("f3","f1",16755200);g("n1","f1",16755200);g("n2","f2",16755200);g("n3","f3",16755200);g("n4","f4",16755200);g("p","n1",16711680);g("p","n2",16711680);g("p","n3",16711680);g("p","n4",16711680);g("u1","u2",43775);g("u2","u3",43775);g("u3","u1",43775);g("c","t",16777215);g("p","c",3355443);g("cn1","cn2",3355443);g("cn3","cn4",3355443);g("cf1","cf2",3355443);g("cf3","cf4",3355443);THREE.Line.call(this,k,j,THREE.LinePieces);this.camera=h;this.matrixWorld=h.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=i;this.update()};THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);THREE.CameraHelper.prototype.update=function(){var e=new THREE.Vector3,d=new THREE.Camera,f=new THREE.Projector;return function(){function b(l,j,k,c){e.set(j,k,c);f.unprojectVector(e,d);l=a.pointMap[l];if(void 0!==l){j=0;for(k=l.length;j<k;j++){a.geometry.vertices[l[j]].copy(e)}}}var a=this;d.projectionMatrix.copy(this.camera.projectionMatrix);b("c",0,0,-1);b("t",0,0,1);b("n1",-1,-1,-1);b("n2",1,-1,-1);b("n3",-1,1,-1);b("n4",1,1,-1);b("f1",-1,-1,1);b("f2",1,-1,1);b("f3",-1,1,1);b("f4",1,1,1);b("u1",0.7,1.1,-1);b("u2",-0.7,1.1,-1);b("u3",0,2,-1);b("cf1",-1,0,1);b("cf2",1,0,1);b("cf3",0,-1,1);b("cf4",0,1,1);b("cn1",-1,0,-1);b("cn2",1,0,-1);b("cn3",0,-1,-1);b("cn4",0,1,-1);this.geometry.verticesNeedUpdate=!0}}();THREE.DirectionalLightHelper=function(f,e){THREE.Object3D.call(this);this.light=f;this.light.updateMatrixWorld();this.matrixWorld=f.matrixWorld;this.matrixAutoUpdate=!1;var h=new THREE.PlaneGeometry(e,e),g=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});g.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Mesh(h,g);this.add(this.lightPlane);h=new THREE.Geometry;h.vertices.push(new THREE.Vector3);h.vertices.push(new THREE.Vector3);h.computeLineDistances();g=new THREE.LineBasicMaterial({fog:!1});g.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(h,g);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){b.getPositionFromMatrix(this.light.matrixWorld).negate();this.lightPlane.lookAt(b);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(b);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();THREE.FaceNormalsHelper=function(g,f,j,i){this.object=g;this.size=f||1;for(var g=j||16776960,i=i||1,f=new THREE.Geometry,j=0,h=this.object.geometry.faces.length;j<h;j++){f.vertices.push(new THREE.Vector3),f.vertices.push(new THREE.Vector3)}THREE.Line.call(this,f,new THREE.LineBasicMaterial({color:g,linewidth:i}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype);THREE.FaceNormalsHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var a=this.geometry.vertices,n=this.object.geometry.faces,m=this.object.matrixWorld,l=0,k=n.length;l<k;l++){var i=n[l];b.copy(i.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);var j=2*l;a[j].copy(i.centroid).applyMatrix4(m);a[j+1].addVectors(a[j],b)}this.geometry.verticesNeedUpdate=!0;return this}}();THREE.GridHelper=function(h,g){var l=new THREE.Geometry,k=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var j=-h;j<=h;j+=g){l.vertices.push(new THREE.Vector3(-h,0,j),new THREE.Vector3(h,0,j),new THREE.Vector3(j,0,-h),new THREE.Vector3(j,0,h));var i=0===j?this.color1:this.color2;l.colors.push(i,i,i,i)}THREE.Line.call(this,l,k,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);THREE.GridHelper.prototype.setColors=function(d,c){this.color1.set(d);this.color2.set(c);this.geometry.colorsNeedUpdate=!0};THREE.HemisphereLightHelper=function(f,e){THREE.Object3D.call(this);this.light=f;this.light.updateMatrixWorld();this.matrixWorld=f.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];var h=new THREE.SphereGeometry(e,4,2);h.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var g=0;8>g;g++){h.faces[g].color=this.colors[4>g?0:1]}g=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(h,g);this.add(this.lightSphere);this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(b.getPositionFromMatrix(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();THREE.PointLightHelper=function(f,e){this.light=f;this.light.updateMatrixWorld();var h=new THREE.SphereGeometry(e,4,2),g=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});g.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,h,g);this.matrixWorld=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};THREE.SpotLightHelper=function(d){THREE.Object3D.call(this);this.light=d;this.light.updateMatrixWorld();this.matrixWorld=d.matrixWorld;this.matrixAutoUpdate=!1;d=new THREE.CylinderGeometry(0,1,1,8,1,!0);d.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0));d.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var c=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(d,c);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.SpotLightHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){var a=this.light.distance?this.light.distance:10000,d=a*Math.tan(this.light.angle);this.cone.scale.set(d,d,a);this.cone.lookAt(b.getPositionFromMatrix(this.light.matrixWorld).negate());this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();THREE.VertexNormalsHelper=function(j,i,p,o){this.object=j;this.size=i||1;for(var i=p||16711680,o=o||1,p=new THREE.Geometry,j=j.geometry.faces,n=0,m=j.length;n<m;n++){for(var k=0,l=j[n].vertexNormals.length;k<l;k++){p.vertices.push(new THREE.Vector3),p.vertices.push(new THREE.Vector3)}}THREE.Line.call(this,p,new THREE.LineBasicMaterial({color:i,linewidth:o}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype);THREE.VertexNormalsHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){var B=["a","b","c","d"];this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var A=this.geometry.vertices,v=this.object.geometry.vertices,u=this.object.geometry.faces,t=this.object.matrixWorld,r=0,s=0,q=u.length;s<q;s++){for(var p=u[s],o=0,k=p.vertexNormals.length;o<k;o++){var a=p.vertexNormals[o];A[r].copy(v[p[B[o]]]).applyMatrix4(t);b.copy(a).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);b.add(A[r]);r+=1;A[r].copy(b);r+=1}}this.geometry.verticesNeedUpdate=!0;return this}}();THREE.VertexTangentsHelper=function(j,i,p,o){this.object=j;this.size=i||1;for(var i=p||255,o=o||1,p=new THREE.Geometry,j=j.geometry.faces,n=0,m=j.length;n<m;n++){for(var k=0,l=j[n].vertexTangents.length;k<l;k++){p.vertices.push(new THREE.Vector3),p.vertices.push(new THREE.Vector3)}}THREE.Line.call(this,p,new THREE.LineBasicMaterial({color:i,linewidth:o}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.update()};THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype);THREE.VertexTangentsHelper.prototype.update=function(){var b=new THREE.Vector3;return function(){var B=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var A=this.geometry.vertices,v=this.object.geometry.vertices,u=this.object.geometry.faces,t=this.object.matrixWorld,r=0,s=0,q=u.length;s<q;s++){for(var p=u[s],o=0,k=p.vertexTangents.length;o<k;o++){var a=p.vertexTangents[o];A[r].copy(v[p[B[o]]]).applyMatrix4(t);b.copy(a).transformDirection(t).multiplyScalar(this.size);b.add(A[r]);r+=1;A[r].copy(b);r+=1}}this.geometry.verticesNeedUpdate=!0;return this}}();THREE.WireframeHelper=function(F){for(var E=[0,0],D={},C=function(d,c){return d-c},B=["a","b","c","d"],A=new THREE.Geometry,u=F.geometry.vertices,v=F.geometry.faces,t=0,s=v.length;t<s;t++){for(var r=v[t],q=r instanceof THREE.Face4?4:3,o=0;o<q;o++){E[0]=r[B[o]];E[1]=r[B[(o+1)%q]];E.sort(C);var k=E.toString();void 0===D[k]&&(A.vertices.push(u[E[0]]),A.vertices.push(u[E[1]]),D[k]=!0)}}THREE.Line.call(this,A,new THREE.LineBasicMaterial({color:16777215}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.matrixWorld=F.matrixWorld};THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype);THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare=function(g,f,j,i,h){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==g&&this.add(g,f,j,i,h)};THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare.prototype.add=function(h,g,l,k,j,i){void 0===g&&(g=-1);void 0===l&&(l=0);void 0===i&&(i=1);void 0===j&&(j=new THREE.Color(16777215));void 0===k&&(k=THREE.NormalBlending);l=Math.min(l,Math.max(0,l));this.lensFlares.push({texture:h,size:g,distance:l,x:0,y:0,z:0,scale:1,rotation:1,opacity:i,color:j,blending:k})};THREE.LensFlare.prototype.updateLensFlares=function(){var g,f=this.lensFlares.length,j,i=2*-this.positionScreen.x,h=2*-this.positionScreen.y;for(g=0;g<f;g++){j=this.lensFlares[g],j.x=this.positionScreen.x+i*j.distance,j.y=this.positionScreen.y+h*j.distance,j.wantedRotation=0.25*j.x*Math.PI,j.rotation+=0.25*(j.wantedRotation-j.rotation)}};THREE.MorphBlendMesh=function(e,d){THREE.Mesh.call(this,e,d);this.animationsMap={};this.animationsList=[];var f=this.geometry.morphTargets.length;this.createAnimation("__default",0,f-1,f/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphBlendMesh.prototype.createAnimation=function(f,e,h,g){e={startFrame:e,endFrame:h,length:h-e+1,fps:g,duration:(h-e)/g,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[f]=e;this.animationsList.push(e)};THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(r){for(var q=/([a-z]+)(\d+)/,p,o={},n=this.geometry,m=0,k=n.morphTargets.length;m<k;m++){var l=n.morphTargets[m].name.match(q);if(l&&1<l.length){var j=l[1];o[j]||(o[j]={start:Infinity,end:-Infinity});l=o[j];m<l.start&&(l.start=m);m>l.end&&(l.end=m);p||(p=j)}}for(j in o){l=o[j],this.createAnimation(j,l.start,l.end,r)}this.firstAnimation=p};THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(b){if(b=this.animationsMap[b]){b.direction=1,b.directionBackwards=!1}};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(b){if(b=this.animationsMap[b]){b.direction=-1,b.directionBackwards=!0}};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(e,d){var f=this.animationsMap[e];f&&(f.fps=d,f.duration=(f.end-f.start)/f.fps)};THREE.MorphBlendMesh.prototype.setAnimationDuration=function(e,d){var f=this.animationsMap[e];f&&(f.duration=d,f.fps=(f.end-f.start)/f.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(e,d){var f=this.animationsMap[e];f&&(f.weight=d)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(e,d){var f=this.animationsMap[e];f&&(f.time=d)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(d){var c=0;if(d=this.animationsMap[d]){c=d.time}return c};THREE.MorphBlendMesh.prototype.getAnimationDuration=function(d){var c=-1;if(d=this.animationsMap[d]){c=d.duration}return c};THREE.MorphBlendMesh.prototype.playAnimation=function(d){var c=this.animationsMap[d];c?(c.time=0,c.active=!0):console.warn("animation["+d+"] undefined")};THREE.MorphBlendMesh.prototype.stopAnimation=function(b){if(b=this.animationsMap[b]){b.active=!1}};THREE.MorphBlendMesh.prototype.update=function(i){for(var g=0,n=this.animationsList.length;g<n;g++){var m=this.animationsList[g];if(m.active){var l=m.duration/m.length;m.time+=m.direction*i;if(m.mirroredLoop){if(m.time>m.duration||0>m.time){m.direction*=-1,m.time>m.duration&&(m.time=m.duration,m.directionBackwards=!0),0>m.time&&(m.time=0,m.directionBackwards=!1)}}else{m.time%=m.duration,0>m.time&&(m.time+=m.duration)}var k=m.startFrame+THREE.Math.clamp(Math.floor(m.time/l),0,m.length-1),j=m.weight;k!==m.currentFrame&&(this.morphTargetInfluences[m.lastFrame]=0,this.morphTargetInfluences[m.currentFrame]=1*j,this.morphTargetInfluences[k]=0,m.lastFrame=m.currentFrame,m.currentFrame=k);l=m.time%l/l;m.directionBackwards&&(l=1-l);this.morphTargetInfluences[m.currentFrame]=l*j;this.morphTargetInfluences[m.lastFrame]=(1-l)*j}}};THREE.LensFlarePlugin=function(){function F(b,m){var l=E.createProgram(),j=E.createShader(E.FRAGMENT_SHADER),i=E.createShader(E.VERTEX_SHADER),h="precision "+m+" float;\n";E.shaderSource(j,h+b.fragmentShader);E.shaderSource(i,h+b.vertexShader);E.compileShader(j);E.compileShader(i);E.attachShader(l,j);E.attachShader(l,i);E.linkProgram(l);return l}var E,D,C,B,A,u,v,t,s,r,q,o,k;this.init=function(a){E=a.context;D=a;C=a.getPrecision();B=new Float32Array(16);A=new Uint16Array(6);a=0;B[a++]=-1;B[a++]=-1;B[a++]=0;B[a++]=0;B[a++]=1;B[a++]=-1;B[a++]=1;B[a++]=0;B[a++]=1;B[a++]=1;B[a++]=1;B[a++]=1;B[a++]=-1;B[a++]=1;B[a++]=0;B[a++]=1;a=0;A[a++]=0;A[a++]=1;A[a++]=2;A[a++]=0;A[a++]=2;A[a++]=3;u=E.createBuffer();v=E.createBuffer();E.bindBuffer(E.ARRAY_BUFFER,u);E.bufferData(E.ARRAY_BUFFER,B,E.STATIC_DRAW);E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,v);E.bufferData(E.ELEMENT_ARRAY_BUFFER,A,E.STATIC_DRAW);t=E.createTexture();s=E.createTexture();E.bindTexture(E.TEXTURE_2D,t);E.texImage2D(E.TEXTURE_2D,0,E.RGB,16,16,0,E.RGB,E.UNSIGNED_BYTE,null);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.NEAREST);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.NEAREST);E.bindTexture(E.TEXTURE_2D,s);E.texImage2D(E.TEXTURE_2D,0,E.RGBA,16,16,0,E.RGBA,E.UNSIGNED_BYTE,null);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.NEAREST);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.NEAREST);0>=E.getParameter(E.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(r=!1,q=F(THREE.ShaderFlares.lensFlare,C)):(r=!0,q=F(THREE.ShaderFlares.lensFlareVertexTexture,C));o={};k={};o.vertex=E.getAttribLocation(q,"position");o.uv=E.getAttribLocation(q,"uv");k.renderType=E.getUniformLocation(q,"renderType");k.map=E.getUniformLocation(q,"map");k.occlusionMap=E.getUniformLocation(q,"occlusionMap");k.opacity=E.getUniformLocation(q,"opacity");k.color=E.getUniformLocation(q,"color");k.scale=E.getUniformLocation(q,"scale");k.rotation=E.getUniformLocation(q,"rotation");k.screenPosition=E.getUniformLocation(q,"screenPosition")};this.render=function(V,U,T,S){var V=V.__webglFlares,O=V.length;if(O){var h=new THREE.Vector3,P=S/T,L=0.5*T,n=0.5*S,l=16/S,p=new THREE.Vector2(l*P,l),R=new THREE.Vector3(1,1,0),g=new THREE.Vector2(1,1),Q=k,l=o;E.useProgram(q);E.enableVertexAttribArray(o.vertex);E.enableVertexAttribArray(o.uv);E.uniform1i(Q.occlusionMap,0);E.uniform1i(Q.map,1);E.bindBuffer(E.ARRAY_BUFFER,u);E.vertexAttribPointer(l.vertex,2,E.FLOAT,!1,16,0);E.vertexAttribPointer(l.uv,2,E.FLOAT,!1,16,8);E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,v);E.disable(E.CULL_FACE);E.depthMask(!1);var i,b,j,c,m;for(i=0;i<O;i++){if(l=16/S,p.set(l*P,l),c=V[i],h.set(c.matrixWorld.elements[12],c.matrixWorld.elements[13],c.matrixWorld.elements[14]),h.applyMatrix4(U.matrixWorldInverse),h.applyProjection(U.projectionMatrix),R.copy(h),g.x=R.x*L+L,g.y=R.y*n+n,r||0<g.x&&g.x<T&&0<g.y&&g.y<S){E.activeTexture(E.TEXTURE1);E.bindTexture(E.TEXTURE_2D,t);E.copyTexImage2D(E.TEXTURE_2D,0,E.RGB,g.x-8,g.y-8,16,16,0);E.uniform1i(Q.renderType,0);E.uniform2f(Q.scale,p.x,p.y);E.uniform3f(Q.screenPosition,R.x,R.y,R.z);E.disable(E.BLEND);E.enable(E.DEPTH_TEST);E.drawElements(E.TRIANGLES,6,E.UNSIGNED_SHORT,0);E.activeTexture(E.TEXTURE0);E.bindTexture(E.TEXTURE_2D,s);E.copyTexImage2D(E.TEXTURE_2D,0,E.RGBA,g.x-8,g.y-8,16,16,0);E.uniform1i(Q.renderType,1);E.disable(E.DEPTH_TEST);E.activeTexture(E.TEXTURE1);E.bindTexture(E.TEXTURE_2D,t);E.drawElements(E.TRIANGLES,6,E.UNSIGNED_SHORT,0);c.positionScreen.copy(R);c.customUpdateCallback?c.customUpdateCallback(c):c.updateLensFlares();E.uniform1i(Q.renderType,2);E.enable(E.BLEND);b=0;for(j=c.lensFlares.length;b<j;b++){m=c.lensFlares[b],0.001<m.opacity&&0.001<m.scale&&(R.x=m.x,R.y=m.y,R.z=m.z,l=m.size*m.scale/S,p.x=l*P,p.y=l,E.uniform3f(Q.screenPosition,R.x,R.y,R.z),E.uniform2f(Q.scale,p.x,p.y),E.uniform1f(Q.rotation,m.rotation),E.uniform1f(Q.opacity,m.opacity),E.uniform3f(Q.color,m.color.r,m.color.g,m.color.b),D.setBlending(m.blending,m.blendEquation,m.blendSrc,m.blendDst),D.setTexture(m.texture,1),E.drawElements(E.TRIANGLES,6,E.UNSIGNED_SHORT,0))}}}E.enable(E.CULL_FACE);E.enable(E.DEPTH_TEST);E.depthMask(!0)}}};THREE.ShadowMapPlugin=function(){var v,u,t,s,r,q,o=new THREE.Frustum,p=new THREE.Matrix4,n=new THREE.Vector3,m=new THREE.Vector3,k=new THREE.Vector3;this.init=function(b){v=b.context;u=b;var b=THREE.ShaderLib.depthRGBA,a=THREE.UniformsUtils.clone(b.uniforms);t=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a});s=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,morphTargets:!0});r=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,skinning:!0});q=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,morphTargets:!0,skinning:!0});t._shadowPass=!0;s._shadowPass=!0;r._shadowPass=!0;q._shadowPass=!0};this.render=function(b,d){u.shadowMapEnabled&&u.shadowMapAutoUpdate&&this.update(b,d)};this.update=function(f,e){var d,B,c,a,D,l,g,b,A,i=[];a=0;v.clearColor(1,1,1,1);v.disable(v.BLEND);v.enable(v.CULL_FACE);v.frontFace(v.CCW);u.shadowMapCullFace===THREE.CullFaceFront?v.cullFace(v.FRONT):v.cullFace(v.BACK);u.setDepthTest(!0);d=0;for(B=f.__lights.length;d<B;d++){if(c=f.__lights[d],c.castShadow){if(c instanceof THREE.DirectionalLight&&c.shadowCascade){for(D=0;D<c.shadowCascadeCount;D++){var h;if(c.shadowCascadeArray[D]){h=c.shadowCascadeArray[D]}else{A=c;g=D;h=new THREE.DirectionalLight;h.isVirtual=!0;h.onlyShadow=!0;h.castShadow=!0;h.shadowCameraNear=A.shadowCameraNear;h.shadowCameraFar=A.shadowCameraFar;h.shadowCameraLeft=A.shadowCameraLeft;h.shadowCameraRight=A.shadowCameraRight;h.shadowCameraBottom=A.shadowCameraBottom;h.shadowCameraTop=A.shadowCameraTop;h.shadowCameraVisible=A.shadowCameraVisible;h.shadowDarkness=A.shadowDarkness;h.shadowBias=A.shadowCascadeBias[g];h.shadowMapWidth=A.shadowCascadeWidth[g];h.shadowMapHeight=A.shadowCascadeHeight[g];h.pointsWorld=[];h.pointsFrustum=[];b=h.pointsWorld;l=h.pointsFrustum;for(var j=0;8>j;j++){b[j]=new THREE.Vector3,l[j]=new THREE.Vector3}b=A.shadowCascadeNearZ[g];A=A.shadowCascadeFarZ[g];l[0].set(-1,-1,b);l[1].set(1,-1,b);l[2].set(-1,1,b);l[3].set(1,1,b);l[4].set(-1,-1,A);l[5].set(1,-1,A);l[6].set(-1,1,A);l[7].set(1,1,A);h.originalCamera=e;l=new THREE.Gyroscope;l.position=c.shadowCascadeOffset;l.add(h);l.add(h.target);e.add(l);c.shadowCascadeArray[D]=h;console.log("Created virtualLight",h)}g=c;b=D;A=g.shadowCascadeArray[b];A.position.copy(g.position);A.target.position.copy(g.target.position);A.lookAt(A.target);A.shadowCameraVisible=g.shadowCameraVisible;A.shadowDarkness=g.shadowDarkness;A.shadowBias=g.shadowCascadeBias[b];l=g.shadowCascadeNearZ[b];g=g.shadowCascadeFarZ[b];A=A.pointsFrustum;A[0].z=l;A[1].z=l;A[2].z=l;A[3].z=l;A[4].z=g;A[5].z=g;A[6].z=g;A[7].z=g;i[a]=h;a++}}else{i[a]=c,a++}}}d=0;for(B=i.length;d<B;d++){c=i[d];c.shadowMap||(D=THREE.LinearFilter,u.shadowMapType===THREE.PCFSoftShadowMap&&(D=THREE.NearestFilter),c.shadowMap=new THREE.WebGLRenderTarget(c.shadowMapWidth,c.shadowMapHeight,{minFilter:D,magFilter:D,format:THREE.RGBAFormat}),c.shadowMapSize=new THREE.Vector2(c.shadowMapWidth,c.shadowMapHeight),c.shadowMatrix=new THREE.Matrix4);if(!c.shadowCamera){if(c instanceof THREE.SpotLight){c.shadowCamera=new THREE.PerspectiveCamera(c.shadowCameraFov,c.shadowMapWidth/c.shadowMapHeight,c.shadowCameraNear,c.shadowCameraFar)}else{if(c instanceof THREE.DirectionalLight){c.shadowCamera=new THREE.OrthographicCamera(c.shadowCameraLeft,c.shadowCameraRight,c.shadowCameraTop,c.shadowCameraBottom,c.shadowCameraNear,c.shadowCameraFar)}else{console.error("Unsupported light type for shadow");continue}}f.add(c.shadowCamera);!0===f.autoUpdate&&f.updateMatrixWorld()}c.shadowCameraVisible&&!c.cameraHelper&&(c.cameraHelper=new THREE.CameraHelper(c.shadowCamera),c.shadowCamera.add(c.cameraHelper));if(c.isVirtual&&h.originalCamera==e){D=e;a=c.shadowCamera;l=c.pointsFrustum;A=c.pointsWorld;n.set(Infinity,Infinity,Infinity);m.set(-Infinity,-Infinity,-Infinity);for(g=0;8>g;g++){b=A[g],b.copy(l[g]),THREE.ShadowMapPlugin.__projector.unprojectVector(b,D),b.applyMatrix4(a.matrixWorldInverse),b.x<n.x&&(n.x=b.x),b.x>m.x&&(m.x=b.x),b.y<n.y&&(n.y=b.y),b.y>m.y&&(m.y=b.y),b.z<n.z&&(n.z=b.z),b.z>m.z&&(m.z=b.z)}a.left=n.x;a.right=m.x;a.top=m.y;a.bottom=n.y;a.updateProjectionMatrix()}a=c.shadowMap;l=c.shadowMatrix;D=c.shadowCamera;D.position.getPositionFromMatrix(c.matrixWorld);k.getPositionFromMatrix(c.target.matrixWorld);D.lookAt(k);D.updateMatrixWorld();D.matrixWorldInverse.getInverse(D.matrixWorld);c.cameraHelper&&(c.cameraHelper.visible=c.shadowCameraVisible);c.shadowCameraVisible&&c.cameraHelper.update();l.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);l.multiply(D.projectionMatrix);l.multiply(D.matrixWorldInverse);p.multiplyMatrices(D.projectionMatrix,D.matrixWorldInverse);o.setFromMatrix(p);u.setRenderTarget(a);u.clear();A=f.__webglObjects;c=0;for(a=A.length;c<a;c++){if(g=A[c],l=g.object,g.render=!1,l.visible&&l.castShadow&&(!(l instanceof THREE.Mesh||l instanceof THREE.ParticleSystem)||!l.frustumCulled||o.intersectsObject(l))){l._modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,l.matrixWorld),g.render=!0}}c=0;for(a=A.length;c<a;c++){g=A[c],g.render&&(l=g.object,g=g.buffer,j=l.material instanceof THREE.MeshFaceMaterial?l.material.materials[0]:l.material,b=0<l.geometry.morphTargets.length&&j.morphTargets,j=l instanceof THREE.SkinnedMesh&&j.skinning,b=l.customDepthMaterial?l.customDepthMaterial:j?b?q:r:b?s:t,g instanceof THREE.BufferGeometry?u.renderBufferDirect(D,f.__lights,null,b,g,l):u.renderBuffer(D,f.__lights,null,b,g,l))}A=f.__webglObjectsImmediate;c=0;for(a=A.length;c<a;c++){g=A[c],l=g.object,l.visible&&l.castShadow&&(l._modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,l.matrixWorld),u.renderImmediateObject(D,f.__lights,null,t,l))}}d=u.getClearColor();B=u.getClearAlpha();v.clearColor(d.r,d.g,d.b,B);v.enable(v.BLEND);u.shadowMapCullFace===THREE.CullFaceFront&&v.cullFace(v.BACK)}};THREE.ShadowMapPlugin.__projector=new THREE.Projector;THREE.SpritePlugin=function(){function v(d,c){return d.z!==c.z?c.z-d.z:c.id-d.id}var u,t,s,r,q,o,p,n,m,k;this.init=function(b){u=b.context;t=b;s=b.getPrecision();r=new Float32Array(16);q=new Uint16Array(6);b=0;r[b++]=-1;r[b++]=-1;r[b++]=0;r[b++]=0;r[b++]=1;r[b++]=-1;r[b++]=1;r[b++]=0;r[b++]=1;r[b++]=1;r[b++]=1;r[b++]=1;r[b++]=-1;r[b++]=1;r[b++]=0;r[b++]=1;b=0;q[b++]=0;q[b++]=1;q[b++]=2;q[b++]=0;q[b++]=2;q[b++]=3;o=u.createBuffer();p=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,o);u.bufferData(u.ARRAY_BUFFER,r,u.STATIC_DRAW);u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,p);u.bufferData(u.ELEMENT_ARRAY_BUFFER,q,u.STATIC_DRAW);var b=THREE.ShaderSprite.sprite,f=u.createProgram(),e=u.createShader(u.FRAGMENT_SHADER),c=u.createShader(u.VERTEX_SHADER),d="precision "+s+" float;\n";u.shaderSource(e,d+b.fragmentShader);u.shaderSource(c,d+b.vertexShader);u.compileShader(e);u.compileShader(c);u.attachShader(f,e);u.attachShader(f,c);u.linkProgram(f);n=f;m={};k={};m.position=u.getAttribLocation(n,"position");m.uv=u.getAttribLocation(n,"uv");k.uvOffset=u.getUniformLocation(n,"uvOffset");k.uvScale=u.getUniformLocation(n,"uvScale");k.rotation=u.getUniformLocation(n,"rotation");k.scale=u.getUniformLocation(n,"scale");k.alignment=u.getUniformLocation(n,"alignment");k.color=u.getUniformLocation(n,"color");k.map=u.getUniformLocation(n,"map");k.opacity=u.getUniformLocation(n,"opacity");k.useScreenCoordinates=u.getUniformLocation(n,"useScreenCoordinates");k.sizeAttenuation=u.getUniformLocation(n,"sizeAttenuation");k.screenPosition=u.getUniformLocation(n,"screenPosition");k.modelViewMatrix=u.getUniformLocation(n,"modelViewMatrix");k.projectionMatrix=u.getUniformLocation(n,"projectionMatrix");k.fogType=u.getUniformLocation(n,"fogType");k.fogDensity=u.getUniformLocation(n,"fogDensity");k.fogNear=u.getUniformLocation(n,"fogNear");k.fogFar=u.getUniformLocation(n,"fogFar");k.fogColor=u.getUniformLocation(n,"fogColor");k.alphaTest=u.getUniformLocation(n,"alphaTest")};this.render=function(j,i,h,L){var c=j.__webglSprites,a=c.length;if(a){var N=m,J=k,l=L/h,h=0.5*h,b=0.5*L;u.useProgram(n);u.enableVertexAttribArray(N.position);u.enableVertexAttribArray(N.uv);u.disable(u.CULL_FACE);u.enable(u.BLEND);u.bindBuffer(u.ARRAY_BUFFER,o);u.vertexAttribPointer(N.position,2,u.FLOAT,!1,16,0);u.vertexAttribPointer(N.uv,2,u.FLOAT,!1,16,8);u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,p);u.uniformMatrix4fv(J.projectionMatrix,!1,i.projectionMatrix.elements);u.activeTexture(u.TEXTURE0);u.uniform1i(J.map,0);var K=N=0,D=j.fog;D?(u.uniform3f(J.fogColor,D.color.r,D.color.g,D.color.b),D instanceof THREE.Fog?(u.uniform1f(J.fogNear,D.near),u.uniform1f(J.fogFar,D.far),u.uniform1i(J.fogType,1),K=N=1):D instanceof THREE.FogExp2&&(u.uniform1f(J.fogDensity,D.density),u.uniform1i(J.fogType,2),K=N=2)):(u.uniform1i(J.fogType,0),K=N=0);for(var B,E,g=[],D=0;D<a;D++){B=c[D],E=B.material,B.visible&&0!==E.opacity&&(E.useScreenCoordinates?B.z=-B.position.z:(B._modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,B.matrixWorld),B.z=-B._modelViewMatrix.elements[14]))}c.sort(v);for(D=0;D<a;D++){B=c[D],E=B.material,B.visible&&0!==E.opacity&&(E.map&&E.map.image&&E.map.image.width)&&(u.uniform1f(J.alphaTest,E.alphaTest),!0===E.useScreenCoordinates?(u.uniform1i(J.useScreenCoordinates,1),u.uniform3f(J.screenPosition,(B.position.x*t.devicePixelRatio-h)/h,(b-B.position.y*t.devicePixelRatio)/b,Math.max(0,Math.min(1,B.position.z))),g[0]=t.devicePixelRatio,g[1]=t.devicePixelRatio):(u.uniform1i(J.useScreenCoordinates,0),u.uniform1i(J.sizeAttenuation,E.sizeAttenuation?1:0),u.uniformMatrix4fv(J.modelViewMatrix,!1,B._modelViewMatrix.elements),g[0]=1,g[1]=1),i=j.fog&&E.fog?K:0,N!==i&&(u.uniform1i(J.fogType,i),N=i),i=1/(E.scaleByViewport?L:1),g[0]*=i*l*B.scale.x,g[1]*=i*B.scale.y,u.uniform2f(J.uvScale,E.uvScale.x,E.uvScale.y),u.uniform2f(J.uvOffset,E.uvOffset.x,E.uvOffset.y),u.uniform2f(J.alignment,E.alignment.x,E.alignment.y),u.uniform1f(J.opacity,E.opacity),u.uniform3f(J.color,E.color.r,E.color.g,E.color.b),u.uniform1f(J.rotation,B.rotation),u.uniform2fv(J.scale,g),t.setBlending(E.blending,E.blendEquation,E.blendSrc,E.blendDst),t.setDepthTest(E.depthTest),t.setDepthWrite(E.depthWrite),t.setTexture(E.map,0),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0))}u.enable(u.CULL_FACE)}}};THREE.DepthPassPlugin=function(){this.enabled=!1;this.renderTarget=null;var j,i,p,o,n,m,k=new THREE.Frustum,l=new THREE.Matrix4;this.init=function(b){j=b.context;i=b;var b=THREE.ShaderLib.depthRGBA,a=THREE.UniformsUtils.clone(b.uniforms);p=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a});o=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,morphTargets:!0});n=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,skinning:!0});m=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:a,morphTargets:!0,skinning:!0});p._shadowPass=!0;o._shadowPass=!0;n._shadowPass=!0;m._shadowPass=!0};this.render=function(d,c){this.enabled&&this.update(d,c)};this.update=function(h,g){var f,e,d,c,s,b;j.clearColor(1,1,1,1);j.disable(j.BLEND);i.setDepthTest(!0);!0===h.autoUpdate&&h.updateMatrixWorld();g.matrixWorldInverse.getInverse(g.matrixWorld);l.multiplyMatrices(g.projectionMatrix,g.matrixWorldInverse);k.setFromMatrix(l);i.setRenderTarget(this.renderTarget);i.clear();b=h.__webglObjects;f=0;for(e=b.length;f<e;f++){if(d=b[f],s=d.object,d.render=!1,s.visible&&(!(s instanceof THREE.Mesh||s instanceof THREE.ParticleSystem)||!s.frustumCulled||k.intersectsObject(s))){s._modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,s.matrixWorld),d.render=!0}}var a;f=0;for(e=b.length;f<e;f++){if(d=b[f],d.render&&(s=d.object,d=d.buffer,!(s instanceof THREE.ParticleSystem)||s.customDepthMaterial)){(a=s.material instanceof THREE.MeshFaceMaterial?s.material.materials[0]:s.material)&&i.setMaterialFaces(s.material),c=0<s.geometry.morphTargets.length&&a.morphTargets,a=s instanceof THREE.SkinnedMesh&&a.skinning,c=s.customDepthMaterial?s.customDepthMaterial:a?c?m:n:c?o:p,d instanceof THREE.BufferGeometry?i.renderBufferDirect(g,h.__lights,null,c,d,s):i.renderBuffer(g,h.__lights,null,c,d,s)}}b=h.__webglObjectsImmediate;f=0;for(e=b.length;f<e;f++){d=b[f],s=d.object,s.visible&&(s._modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,s.matrixWorld),i.renderImmediateObject(g,h.__lights,null,p,s))}f=i.getClearColor();e=i.getClearAlpha();j.clearColor(f.r,f.g,f.b,e);j.enable(j.BLEND)}};THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},lensFlare:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};THREE.ShaderSprite={sprite:{vertexShader:"uniform int useScreenCoordinates;\nuniform int sizeAttenuation;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}",fragmentShader:"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"}};var Stats=function(){var F=Date.now(),E=F,K=0,D=Infinity,C=0,J=0,B=Infinity,A=0,v=0,u=0,L=document.createElement("div");L.id="stats";L.addEventListener("mousedown",function(a){a.preventDefault();b(++u%2)},!1);L.style.cssText="width:80px;opacity:0.9;cursor:pointer";var Q=document.createElement("div");Q.id="fps";Q.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002";L.appendChild(Q);var I=document.createElement("div");I.id="fpsText";I.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";I.innerHTML="FPS";Q.appendChild(I);var P=document.createElement("div");P.id="fpsGraph";P.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff";for(Q.appendChild(P);74>P.children.length;){var H=document.createElement("span");H.style.cssText="width:1px;height:30px;float:left;background-color:#113";P.appendChild(H)}var O=document.createElement("div");O.id="ms";O.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none";L.appendChild(O);var G=document.createElement("div");G.id="msText";G.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";G.innerHTML="MS";O.appendChild(G);var N=document.createElement("div");N.id="msGraph";N.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0";for(O.appendChild(N);74>N.children.length;){H=document.createElement("span"),H.style.cssText="width:1px;height:30px;float:left;background-color:#131",N.appendChild(H)}var b=function(a){u=a;switch(u){case 0:Q.style.display="block";O.style.display="none";break;case 1:Q.style.display="none",O.style.display="block"}};return{REVISION:11,domElement:L,setMode:b,begin:function(){F=Date.now()},end:function(){var c=Date.now();K=c-F;D=Math.min(D,K);C=Math.max(C,K);G.textContent=K+" MS ("+D+"-"+C+")";var d=Math.min(30,30-30*(K/200));N.appendChild(N.firstChild).style.height=d+"px";v++;c>E+1000&&(J=Math.round(1000*v/(c-E)),B=Math.min(B,J),A=Math.max(A,J),I.textContent=J+" FPS ("+B+"-"+A+")",d=Math.min(30,30-30*(J/100)),P.appendChild(P.firstChild).style.height=d+"px",E=c,v=0);return c},update:function(){F=this.end()}}};THREE.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")};THREE.DotScreenShader={uniforms:{tDiffuse:{type:"t",value:null},tSize:{type:"v2",value:new THREE.Vector2(256,256)},center:{type:"v2",value:new THREE.Vector2(0.5,0.5)},angle:{type:"f",value:1.57},scale:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","float s = sin( angle ), c = cos( angle );","vec2 tex = vUv * tSize - center;","vec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","return ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","vec4 color = texture2D( tDiffuse, vUv );","float average = ( color.r + color.g + color.b ) / 3.0;","gl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")};THREE.RGBShiftShader={uniforms:{tDiffuse:{type:"t",value:null},amount:{type:"f",value:0.005},angle:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float amount;","uniform float angle;","varying vec2 vUv;","void main() {","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, vUv + offset);","vec4 cga = texture2D(tDiffuse, vUv);","vec4 cb = texture2D(tDiffuse, vUv - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","}"].join("\n")};THREE.FXAAShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","#define FXAA_REDUCE_MIN   (1.0/128.0)","#define FXAA_REDUCE_MUL   (1.0/8.0)","#define FXAA_SPAN_MAX     8.0","void main() {","vec3 rgbNW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ).xyz;","vec3 rgbNE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ).xyz;","vec3 rgbSW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ).xyz;","vec3 rgbSE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ).xyz;","vec4 rgbaM  = texture2D( tDiffuse,  gl_FragCoord.xy  * resolution );","vec3 rgbM  = rgbaM.xyz;","float opacity  = rgbaM.w;","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float lumaNW = dot( rgbNW, luma );","float lumaNE = dot( rgbNE, luma );","float lumaSW = dot( rgbSW, luma );","float lumaSE = dot( rgbSE, luma );","float lumaM  = dot( rgbM,  luma );","float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );","float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );","vec2 dir;","dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));","dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));","float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );","float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );","dir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),","max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),","dir * rcpDirMin)) * resolution;","vec3 rgbA = texture2D( tDiffuse, gl_FragCoord.xy  * resolution + dir * ( 1.0 / 3.0 - 0.5 ) ).xyz;","rgbA += texture2D( tDiffuse, gl_FragCoord.xy  * resolution + dir * ( 2.0 / 3.0 - 0.5 ) ).xyz;","rgbA *= 0.5;","vec3 rgbB = texture2D( tDiffuse, gl_FragCoord.xy  * resolution + dir * -0.5 ).xyz;","rgbB += texture2D( tDiffuse, gl_FragCoord.xy  * resolution + dir * 0.5 ).xyz;","rgbB *= 0.25;","rgbB += rgbA * 0.5;","float lumaB = dot( rgbB, luma );","if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) ) {","gl_FragColor = vec4( rgbA, opacity );","} else {","gl_FragColor = vec4( rgbB, opacity );","}","}"].join("\n")};THREE.TriangleBlurShader={uniforms:{texture:{type:"t",value:null},delta:{type:"v2",value:new THREE.Vector2(1,1)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define ITERATIONS 10.0","uniform sampler2D texture;","uniform vec2 delta;","varying vec2 vUv;","float random( vec3 scale, float seed ) {","return fract( sin( dot( gl_FragCoord.xyz + seed, scale ) ) * 43758.5453 + seed );","}","void main() {","vec4 color = vec4( 0.0 );","float total = 0.0;","float offset = random( vec3( 12.9898, 78.233, 151.7182 ), 0.0 );","for ( float t = -ITERATIONS; t <= ITERATIONS; t ++ ) {","float percent = ( t + offset - 0.5 ) / ITERATIONS;","float weight = 1.0 - abs( percent );","color += texture2D( texture, vUv + delta * percent ) * weight;","total += weight;","}","gl_FragColor = color / total;","}"].join("\n")};THREE.HorizontalBlurShader={uniforms:{tDiffuse:{type:"t",value:null},h:{type:"f",value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")};THREE.VerticalBlurShader={uniforms:{tDiffuse:{type:"t",value:null},v:{type:"f",value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")};THREE.AdditiveBlendShader={uniforms:{tDiffuse1:{type:"t",value:null},tDiffuse2:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","varying vec2 vUv;","void main() {","vec4 texel1 = texture2D( tDiffuse1, vUv );","vec4 texel2 = texture2D( tDiffuse2, vUv );","gl_FragColor = texel1 + texel2;","}"].join("\n")};THREE.EffectComposer=function(e,d){this.renderer=e;if(d===undefined){var b=window.innerWidth||1;var a=window.innerHeight||1;var c={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:false};d=new THREE.WebGLRenderTarget(b,a,c)}this.renderTarget1=d;this.renderTarget2=d.clone();this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2;this.autoRenderScreen=true;this.passes=[];if(THREE.CopyShader===undefined){console.error("THREE.EffectComposer relies on THREE.CopyShader")}this.copyPass=new THREE.ShaderPass(THREE.CopyShader)};THREE.EffectComposer.prototype={swapBuffers:function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer;this.writeBuffer=a},addPass:function(a){this.passes.push(a)},insertPass:function(b,a){this.passes.splice(a,0,b)},render:function(g){this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2;var f=false;var a=false;var e,d,b=this.passes.length;for(d=0;d<b;d++){e=this.passes[d];if(!e.enabled){continue}if((d==b-1)&&(this.autoRenderScreen)){f=e.renderToScreen;e.renderToScreen=true}e.render(this.renderer,this.writeBuffer,this.readBuffer,g,a);if(e.needsSwap){if(a){var c=this.renderer.context;c.stencilFunc(c.NOTEQUAL,1,4294967295);this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,g);c.stencilFunc(c.EQUAL,1,4294967295)}this.swapBuffers()}if((d==b-1)&&(this.autoRenderScreen)){e.renderToScreen=f}if(e instanceof THREE.MaskPass){a=true}else{if(e instanceof THREE.ClearMaskPass){a=false}}}},reset:function(a){if(a===undefined){a=this.renderTarget1.clone();a.width=window.innerWidth;a.height=window.innerHeight}this.renderTarget1=a;this.renderTarget2=a.clone();this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2},setSize:function(c,a){var d=this.renderTarget1.clone();d.width=c;d.height=a;for(var b=0;b<this.passes.length;b++){if(this.passes[b] instanceof THREE.ComposerPass){this.passes[b].setSize(c,a)}}this.reset(d)}};THREE.EffectComposer.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1);THREE.EffectComposer.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),null);THREE.EffectComposer.scene=new THREE.Scene();THREE.EffectComposer.scene.add(THREE.EffectComposer.quad);THREE.RenderPass=function(e,c,a,d,b){this.scene=e;this.camera=c;this.overrideMaterial=a;this.clearColor=d;this.clearAlpha=(b!==undefined)?b:1;this.oldClearColor=new THREE.Color();this.oldClearAlpha=1;this.enabled=true;this.clear=true;this.needsSwap=false};THREE.RenderPass.prototype={render:function(b,c,a,d){this.scene.overrideMaterial=this.overrideMaterial;if(this.clearColor){this.oldClearColor.copy(b.getClearColor());this.oldClearAlpha=b.getClearAlpha();b.setClearColor(this.clearColor,this.clearAlpha)}b.render(this.scene,this.camera,a,this.clear);if(this.clearColor){b.setClearColor(this.oldClearColor,this.oldClearAlpha)}this.scene.overrideMaterial=null}};THREE.MaskPass=function(b,a){this.scene=b;this.camera=a;this.enabled=true;this.clear=true;this.needsSwap=false;this.inverse=false};THREE.MaskPass.prototype={render:function(e,f,d,g){var c=e.context;c.colorMask(false,false,false,false);c.depthMask(false);var b,a;if(this.inverse){b=0;a=1}else{b=1;a=0}c.enable(c.STENCIL_TEST);c.stencilOp(c.REPLACE,c.REPLACE,c.REPLACE);c.stencilFunc(c.ALWAYS,b,4294967295);c.clearStencil(a);e.render(this.scene,this.camera,d,this.clear);e.render(this.scene,this.camera,f,this.clear);c.colorMask(true,true,true,true);c.depthMask(true);c.stencilFunc(c.EQUAL,1,4294967295);c.stencilOp(c.KEEP,c.KEEP,c.KEEP)}};THREE.ClearMaskPass=function(){this.enabled=true};THREE.ClearMaskPass.prototype={render:function(c,d,b,e){var a=c.context;a.disable(a.STENCIL_TEST)}};THREE.ShaderPass=function(a,b){this.textureID=(b!==undefined)?b:"tDiffuse";this.uniforms=THREE.UniformsUtils.clone(a.uniforms);this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader});this.renderToScreen=false;this.enabled=true;this.needsSwap=true;this.clear=false};THREE.ShaderPass.prototype={render:function(b,c,a,d){if(this.uniforms[this.textureID]){this.uniforms[this.textureID].value=a}THREE.EffectComposer.quad.material=this.material;if(this.renderToScreen){b.render(THREE.EffectComposer.scene,THREE.EffectComposer.camera)}else{b.render(THREE.EffectComposer.scene,THREE.EffectComposer.camera,c,this.clear)}}};THREE.ComposerPass=function(d,c,a,e){this.width=c;this.height=a;this.mixShader=e||THREE.AdditiveBlendShader;var b={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:false};this.renderTarget=new THREE.WebGLRenderTarget(this.width,this.height,b);this.composer=new THREE.EffectComposer(d);this.composer.autoRenderScreen=false;this.blendPass=new THREE.ShaderPass(this.mixShader,"tDiffuse2");this.enabled=true;this.clear=true;this.needsSwap=false};THREE.ComposerPass.prototype={render:function(b,c,a,d){this.composer.render(d);this.composer.swapBuffers();this.blendPass.uniforms.tDiffuse1.value=this.composer.renderTarget2;this.blendPass.renderToScreen=this.renderToScreen;return this.blendPass.render(b,c,a,d)},setSize:function(b,a){this.composer.setSize(b,a);this.renderTarget.width=b;this.renderTarget.height=a},addPass:function(a){this.composer.addPass(a)}};var M={version:"1.0"};(function(b){function a(c){return(c==undefined)}b.SmartObject=function(c){this.config=c||{};var d=c.parameters||{};this.varValues={};this.varConfig={};$.each(d,function(f,e){if(e["default"]==undefined){e["default"]=0}this.varValues[f]=e["default"];this.varConfig[f]=e});this.geometryConstructor=function(e){return THREE.CubeGeometry(1,1,1)};this.materialConstructor=function(e){return THREE.MeshBasicMaterial({color:16711680})};this.meshConstructor=function(e,g,f){return THREE.Mesh(g,f)};this.geometryBinder=function(e,f){};this.materialBinder=function(e,f){};this.meshBinder=function(e,f){}};b.SmartObject.prototype.regenerate=function(){var d=this.geometryConstructor(this.varValues);this.geometryBinder(d);var c=this.materialConstructor(this.varValues);this.materialBinder(c);var e=this.meshConstructor(this.varValues,d,c);this.meshBinder(e)};b.Viewport=function(e){var i=e||{};if(!i.container){this.container=document.createElement("div");document.body.appendChild(this.container)}else{this.container=$(i.container)}this.fullscreen=i.fullscreen||false;this.bg=i.bg||0;this.stats=i.stats==undefined?true:i.stats;this.autostop=i.autostop==undefined?true:i.autostop;this.autohover=i.autohover==undefined?true:i.autohover;this.animating=(i.animating==undefined)?true:i.animating;this.updateListeners=[];var d=this;this.lastFrameTime=Date.now();var c=$(this.container).width(),f=$(this.container).height();if(this.fullscreen){c=$(window).width();f=$(window).height()}console.log(c,f);this.renderer=new THREE.WebGLRenderer({antialias:true,clearColor:this.bg,clearAlpha:1});$(this.container).append(this.renderer.domElement);this.scene=new THREE.Scene();this.camera=new THREE.PerspectiveCamera(40,c/f,0.1,10000);this.camera.position.set(10,0,0);this.camera.lookAt(new THREE.Vector3(0,0,0));if(this.stats){this.stats=new Stats();$(this.container).append(this.stats.domElement);$(this.stats.domElement).css({position:"absolute",top:0,left:0})}this.composer=new THREE.EffectComposer(this.renderer);var g=new THREE.RenderPass(this.scene,this.camera);this.composer.addPass(g);this.renderPasses=[];this.resize();$(window).resize(function(){d.resize()});this.mouse=new THREE.Vector2(0,0);$(this.renderer.domElement).mousemove(function(j){var h=$(d.renderer.domElement).offset();d.mouse.x=((j.pageX-h.left)/d.width)*2-1;d.mouse.y=-((j.pageY-h.top)/d.height)*2+1});this.projector=new THREE.Projector();this.raycaster=new THREE.Raycaster();this.currentHover=false;if(this.animating){this.animate()}$(window).blur(function(){if(d.autostop){d.animating=false}});$(window).focus(function(){if(d.autostop){d.animating=true;d.animate()}})};b.Viewport.prototype.addUpdateHandler=function(c){this.updateListeners.push(c)};b.Viewport.prototype.removeUpdateHandler=function(d){var c=this.updateListeners.indexOf(d);if(c<0){return}this.updateListeners.splice(c,1)};b.Viewport.prototype.insertPass=function(d,c){this.renderPasses.splice(c,0,d);this.composer.insertPass(d,c)};b.Viewport.prototype.addPass=function(c){this.renderPasses.push(c);this.composer.addPass(c)};b.Viewport.prototype.getHoverObject=function(){var c=new THREE.Vector3(this.mouse.x,this.mouse.y,1);this.projector.unprojectVector(c,this.camera);this.raycaster.set(this.camera.position,c.sub(this.camera.position).normalize());var e=this.raycaster.intersectObjects(this.scene.children,true);if(e.length==0){return false}for(var d=0;d<e.length;d++){if(e[d].object.hoverTarget!==undefined){return e[d].object.hoverTarget}}return e[0].object};b.Viewport.prototype.resize=function(){var c=$(this.container).width(),d=$(this.container).height();if(this.fullscreen){c=$(window).width();d=$(window).height()}console.log(c,d);this.width=c;this.height=d;this.renderer.setSize(c,d);this.composer.setSize(c,d);this.camera.aspect=c/d;this.camera.updateProjectionMatrix()};b.Viewport.prototype.render=function(e){for(var d=0;d<this.updateListeners.length;d++){try{this.updateListeners[d](e)}catch(c){console.warn("Update exception: "+c.toString())}}if(this.renderPasses.length==0){this.renderer.render(this.scene,this.camera)}else{this.composer.render(e)}};b.Viewport.prototype.animate=function(){var c=this,e=Date.now();if(!this.animating){return}requestAnimationFrame(function(){c.animate()});if(this.autohover){var d=this.getHoverObject();if(this.currentHover!==d){if(this.currentHover){$(this).trigger("hoverexit",this.currentHover)}$(this).trigger("hoverenter",d);this.currentHover=d}}this.render(e-this.lastFrameTime);this.lastFrameTime=e;if(this.stats){this.stats.update()}};b.ObjectPicker=function(c){this.projector=new THREE.Projector();this.raycaster=new THREE.Raycaster();this.mouse=new THREE.Vector2();this.viewport=c;this.intersects=[]};b.ObjectPicker.prototype.updateIntersectionsFromEvent=function(d){var c=$(this.viewport.renderer.domElement).offset();return this.updateIntersectionsFromPoint(d.pageX-c.left,d.clientY-c.top)};b.ObjectPicker.prototype.updateIntersectionsFromPoint=function(c,e){this.mouse.x=(c/this.viewport.width)*2-1;this.mouse.y=-(e/this.viewport.height)*2+1;if(this.mouse.x<-1){this.mouse.x=-1}if(this.mouse.x>1){this.mouse.x=1}if(this.mouse.y<-1){this.mouse.y=-1}if(this.mouse.y>1){this.mouse.y=1}var d=new THREE.Vector3(this.mouse.x,this.mouse.y,1);this.projector.unprojectVector(d,this.viewport.camera);this.raycaster.set(this.viewport.camera.position,d.sub(this.viewport.camera.position).normalize());this.intersects=this.raycaster.intersectObjects(this.viewport.scene.children,true)};b.ObjectPicker.prototype.getIntersection=function(){if(this.intersects.length>0){for(var c=0;c<this.intersects.length;c++){if(this.intersects[c].object.pickTarget!==undefined){return this.intersects[c].object.pickTarget}}return false}else{return false}};b.SmasherFrame=function(e){var d=this;var g=e||{};b.Viewport.call(this,g);var c=new THREE.DirectionalLight(16777215);c.position.set(400,-400,400);c.lookAt(new THREE.Vector3(0,0,0));this.scene.add(c);var f=new THREE.AmbientLight(1118481);this.scene.add(f);this.camera.position.set(0,-200,100);this.camera.lookAt(new THREE.Vector3(0,-60,0));this.lhc=new b.LHCRing();this.scene.add(this.lhc);if(g.env!==undefined){this.setEnvironment(g.env)}$(this).on("hoverenter",function(h){console.log(h);if(h instanceof b.LHCDipole){console.log("DA!");h.position.z=5}});$(this).on("hoverexit",function(h){if(h instanceof b.LHCDipole){console.log("Done!");h.position.z=0}});this.blurScene=new THREE.Scene();this.blurComposer=new THREE.ComposerPass(this.renderer,this.width,this.height);this.blurHShaderPass=new THREE.ShaderPass(THREE.HorizontalBlurShader);this.blurVShaderPass=new THREE.ShaderPass(THREE.VerticalBlurShader);this.blurComposer.addPass(new THREE.RenderPass(this.blurScene,this.camera,undefined,new THREE.Color(0)));this.blurComposer.addPass(this.blurHShaderPass);this.blurComposer.addPass(this.blurVShaderPass);this.addPass(this.blurComposer);this.resize();this.animate()};b.SmasherFrame.prototype=Object.create(b.Viewport.prototype);b.SmasherFrame.prototype.updateEnvmap=function(){if((this.model!=null)&&(this.envMap!=null)){for(var c=0;c<this.model.materials.length;c++){this.model.materials[c].envMap=this.envMap;this.model.materials[c].needsUpdate=true}}};b.SmasherFrame.prototype.resize=function(c,d){b.Viewport.prototype.resize.call(this,c,d);if(this.blurVShaderPass!==undefined){this.blurVShaderPass.uniforms.v.value=2/this.height;this.blurHShaderPass.uniforms.h.value=2/this.width}};b.SmasherFrame.prototype.setEnvironment=function(f,c){var e=c||".png";var d=[f+"px"+e,f+"nx"+e,f+"py"+e,f+"ny"+e,f+"pz"+e,f+"nz"+e];this.envMap=THREE.ImageUtils.loadTextureCube(d);this.envMap.format=THREE.RGBFormat;this.updateEnvmap()};b.SmasherFrame.prototype.render=function(c){if(this.controller){this.controller.update()}if(this.o){this.o.rotation.z+=0.01}if(this.cmsh){this.cmsh.rotation.z+=0.01}if(this.lhc){this.lhc.rotation.z+=c/5000}b.Viewport.prototype.render.call(this,c)};b.LHCWindow=function(f){var e=this;var h=f||{};b.Viewport.call(this,h);var d=new THREE.DirectionalLight(16777215);d.position.set(400,-400,400);d.lookAt(new THREE.Vector3(0,0,0));this.scene.add(d);var g=new THREE.AmbientLight(1118481);this.scene.add(g);this.camera.position.set(0,-200,100);this.camera.lookAt(new THREE.Vector3(0,-60,0));this.lhc=new b.LHCRing();this.scene.add(this.lhc);this.lhc_mirror=new b.LHCRing();this.lhc_mirror.position.z=-15;this.scene.add(this.lhc_mirror);var c=new THREE.Mesh(new THREE.PlaneGeometry(10000,10000),new THREE.MeshBasicMaterial({color:0,opacity:0.5,transparent:true}));c.position.z=-10;this.scene.add(c);this.renderer.autoClear=false;if(h.env!==undefined){this.setEnvironment(h.env)}this.glowScene=new THREE.Scene();this.glowScene.add(this.lhc.glowObject);this.glowComposer=new THREE.ComposerPass(this.renderer,this.width,this.height);this.glowHShaderPass=new THREE.ShaderPass(THREE.HorizontalBlurShader);this.glowVShaderPass=new THREE.ShaderPass(THREE.VerticalBlurShader);this.glowComposer.addPass(new THREE.RenderPass(this.glowScene,this.camera,undefined,new THREE.Color(0)));this.glowComposer.addPass(this.glowHShaderPass);this.glowComposer.addPass(this.glowVShaderPass);this.addPass(this.glowComposer);this.resize();this.animate()};b.LHCWindow.prototype=Object.create(b.Viewport.prototype);b.LHCWindow.prototype.updateEnvmap=function(){if((this.model!=null)&&(this.envMap!=null)){for(var c=0;c<this.model.materials.length;c++){this.model.materials[c].envMap=this.envMap;this.model.materials[c].needsUpdate=true}}};b.LHCWindow.prototype.resize=function(c,d){b.Viewport.prototype.resize.call(this,c,d);if(this.glowVShaderPass!==undefined){this.glowVShaderPass.uniforms.v.value=2/this.height;this.glowHShaderPass.uniforms.h.value=2/this.width}};b.LHCWindow.prototype.setEnvironment=function(f,c){var e=c||".png";var d=[f+"px"+e,f+"nx"+e,f+"py"+e,f+"ny"+e,f+"pz"+e,f+"nz"+e];this.envMap=THREE.ImageUtils.loadTextureCube(d);this.envMap.format=THREE.RGBFormat;this.updateEnvmap()};b.LHCWindow.prototype.render=function(c){if(this.controller){this.controller.update()}if(this.o){this.o.rotation.z+=0.01}if(this.cmsh){this.cmsh.rotation.z+=0.01}if(this.lhc){this.lhc.rotation.z+=c/5000;this.lhc_mirror.rotation.z+=c/5000;this.lhc.update(c);this.lhc_mirror.update(c)}b.Viewport.prototype.render.call(this,c)};THREE.ParticleTextureShader={uniforms:{uScale:{type:"f",value:1},uTime:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define M_PI 3.1415926535897932384626433832795","uniform float uTime;","uniform float uScale;","float uValue;","varying vec2 vUv;","void main() {","uValue = abs(sin( vUv.x * M_PI * uScale + uTime * 5.0 ));","gl_FragColor = vec4( uValue, uValue, uValue, 0.0 );","}"].join("\n")};b.AcceleratorRing=function(v){THREE.Object3D.call(this);this.cTime=0;this.animations=[];this.fxTimer=0;this.fxEasing=jQuery.easing.easeOutQuad;this.fxDelay=1000;this.fxCompleteCb=null;this.ringRotationSpeed=0;this.collisionOpacity=0;this.camera=v;this.camera.rotation.z=Math.PI/2;this.camera.position.x=100;this.camera.position.z=50;this.camera.rotation.y=Math.PI/2-0.5;this.camera.position.x=-5;this.camera.position.z=0;this.camera.rotation.y=Math.PI/2;this.camera.position.x=100;this.camera.position.z=0;this.camera.rotation.y=Math.PI/2;var P=new THREE.PointLight(16777215);P.position.set(0,0,0);this.add(P);var o=this.lightM=new THREE.PointLight(32896,0,20);o.position.set(0,-15,0);this.add(o);var m=this.lightR=new THREE.PointLight(3670015,0,20);m.position.set(-13,7.5,0);this.add(m);var k=this.lightL=new THREE.PointLight(16755200,0,20);k.position.set(-13,-7.5,0);this.add(k);var s=THREE.ImageUtils.loadTexture("theme/img/beam-1b.png");s.wrapS=THREE.RepeatWrapping;s.wrapT=THREE.RepeatWrapping;var q=THREE.ImageUtils.loadTexture("theme/img/beam-2b.png");q.wrapS=THREE.RepeatWrapping;q.wrapT=THREE.RepeatWrapping;var J=BeamShader;var t=this.beamShaderUniformsLf=THREE.UniformsUtils.clone(J.uniforms);var I=this.beamShaderUniformsRf=THREE.UniformsUtils.clone(J.uniforms);var u=this.beamShaderUniformsLb=THREE.UniformsUtils.clone(J.uniforms);var K=this.beamShaderUniformsRb=THREE.UniformsUtils.clone(J.uniforms);t.tTexture1.value=s;t.tTexture2.value=q;I.tTexture1.value=s;I.tTexture2.value=q;u.tTexture1.value=s;u.tTexture2.value=q;K.tTexture1.value=s;K.tTexture2.value=q;t.uColor.value=new THREE.Color(16755200);I.uColor.value=new THREE.Color(3670015);u.uColor.value=new THREE.Color(16755200);K.uColor.value=new THREE.Color(3670015);var L=new THREE.ShaderMaterial({uniforms:t,vertexShader:J.vertexShader,fragmentShader:J.fragmentShader,transparent:true,side:THREE.FrontSide});var N=new THREE.ShaderMaterial({uniforms:u,vertexShader:J.vertexShader,fragmentShader:J.fragmentShader,transparent:true,side:THREE.BackSide});var h=new THREE.ShaderMaterial({uniforms:I,vertexShader:J.vertexShader,fragmentShader:J.fragmentShader,transparent:true,side:THREE.FrontSide});var j=new THREE.ShaderMaterial({uniforms:K,vertexShader:J.vertexShader,fragmentShader:J.fragmentShader,transparent:true,side:THREE.BackSide});var n=new THREE.TorusGeometry(20,1.2,20,20,Math.PI);var C=this.beamMeshLb=new THREE.Mesh(n,j);C.rotation.z=0;C.rotation.y=Math.PI;this.add(C);var A=this.beamMeshLf=new THREE.Mesh(n,h);A.rotation.z=0;A.rotation.y=Math.PI;this.add(A);var i=this.beamMeshRb=new THREE.Mesh(n,N);i.rotation.z=-Math.PI;this.add(i);var g=this.beamMeshRf=new THREE.Mesh(n,L);g.rotation.z=-Math.PI;this.add(g);var e=this.backgroundMat=new THREE.MeshPhongMaterial({side:THREE.FrontSide,transparent:true,color:6316128,opacity:0.4});var O=this.wireframeMat=new THREE.MeshPhongMaterial({wireframe:true,side:THREE.BackSide,color:0});var d=new THREE.TorusGeometry(20,3,10,20,Math.PI);var p=this.ringBackgroundMesh=new THREE.Mesh(d,e);p.rotation.z=Math.PI/2;this.add(p);var f=new THREE.TorusGeometry(20,3.1,18,25,Math.PI*2);var r=this.ringOutlineMesh=new THREE.Mesh(f,O);this.add(r);var D=THREE.ImageUtils.loadTexture("theme/img/collision-1.png");var B=THREE.ImageUtils.loadTexture("theme/img/collision-2.png");var E=13761774;var H=this.collisionMaterial1=new THREE.SpriteMaterial({map:D,useScreenCoordinates:false,color:E,fog:true});var G=this.collisionMaterial2=new THREE.SpriteMaterial({map:D,useScreenCoordinates:false,color:E,fog:true});var F=this.collisionMaterial3=new THREE.SpriteMaterial({map:D,useScreenCoordinates:false,color:E,fog:true});var c=this.collisionSprite1=new THREE.Sprite(H);c.position.set(-15,0,0);c.scale.set(100,100,100);this.add(c);var R=this.collisionSprite2=new THREE.Sprite(G);R.position=c.position.clone();R.scale=c.scale.clone();this.add(R);var Q=this.collisionSprite3=new THREE.Sprite(F);Q.position=c.position.clone();Q.scale=c.scale.clone();this.add(Q);this.animationTargets=[{o:this.camera.position,t:this.camera.position.clone(),s:this.camera.position.clone(),v:["x","y","z"]},{o:this.camera.rotation,t:this.camera.rotation.clone(),s:this.camera.rotation.clone(),v:["x","y","z"]},{o:this,t:{ringRotationSpeed:0,collisionOpacity:0},s:{ringRotationSpeed:0,collisionOpacity:0},v:["ringRotationSpeed","collisionOpacity"]},{o:this.lightL,t:{intensity:0},s:{intensity:0},v:["intensity"]},{o:this.lightR,t:{intensity:0},s:{intensity:0},v:["intensity"]},{o:this.lightM,t:{intensity:0},s:{intensity:0},v:["intensity"]},{o:I.uOpacity,t:{value:0},s:{value:0},v:["value"]},{o:K.uOpacity,t:{value:0},s:{value:0},v:["value"]},{o:t.uOpacity,t:{value:0},s:{value:0},v:["value"]},{o:u.uOpacity,t:{value:0},s:{value:0},v:["value"]},{o:this.backgroundMat,t:{opacity:0},s:{opacity:0},v:["opacity"]},{o:this.wireframeMat.color,t:new THREE.Color(0,0,0),s:new THREE.Color(0,0,0),v:["r","g","b"]},{o:this.wireframeMat.emissive,t:new THREE.Color(0,0,0),s:new THREE.Color(0,0,0),v:["r","g","b"]}];this.setAnimationTarget=function(l,S){$.each(S,(function(U,T){this.animationTargets[l].s[U]=this.animationTargets[l].o[U];this.animationTargets[l].t[U]=T}).bind(this))};this.fxCycle=function(l,T,S){if(T==undefined){T=1}if(S==undefined){S=1}if(l<0.2){l=l/0.2;return{s:(l*0.2)*T,o:l*S}}else{if(l<0.8){l=(l-0.2)/0.6;return{s:(0.2+l*0.8)*T,o:1*S}}else{l=(l-0.8)/0.2;return{s:(1+l*0.2)*T,o:(1-l)*S}}}}};b.AcceleratorRing.prototype=Object.create(THREE.Object3D.prototype);b.AcceleratorRing.prototype.onAnimationCompleted=function(c){this.fxCompleteCb=c};b.AcceleratorRing.prototype.setBeamColors=function(d,c,e){this.lightL.color.setHex(d);this.beamShaderUniformsLf.uColor.value.setHex(d);this.beamShaderUniformsLb.uColor.value.setHex(d);this.lightR.color.setHex(c);this.beamShaderUniformsRf.uColor.value.setHex(c);this.beamShaderUniformsRb.uColor.value.setHex(c);if(e==undefined){e=d|c}this.collisionMaterial1.color.setHex(e);this.collisionMaterial2.color.setHex(e);this.collisionMaterial3.color.setHex(e)};b.AcceleratorRing.prototype.update=function(l){this.cTime+=l/3000;this.beamShaderUniformsLf.uTime.value+=l/1000;this.beamShaderUniformsRf.uTime.value+=l/1000;this.beamShaderUniformsLb.uTime.value+=l/1000;this.beamShaderUniformsRb.uTime.value+=l/1000;this.collisionSprite1.rotation+=l/7000;this.collisionSprite2.rotation-=l/8000;this.collisionSprite3.rotation-=l/5000;var h=this.fxCycle(this.cTime%1,10,this.collisionOpacity);this.collisionSprite1.scale.set(h.s,h.s,h.s);this.collisionMaterial1.opacity=h.o;h=this.fxCycle((this.cTime+0.33333)%1,10,this.collisionOpacity);this.collisionSprite2.scale.set(h.s,h.s,h.s);this.collisionMaterial2.opacity=h.o;h=this.fxCycle((this.cTime+0.66666)%1,10,this.collisionOpacity);this.collisionSprite3.scale.set(h.s,h.s,h.s);this.collisionMaterial3.opacity=h.o;if(this.ringRotationSpeed!=0){this.ringOutlineMesh.rotation.z+=l*this.ringRotationSpeed/1000}if(this.fxTimer<this.fxDelay){this.fxTimer+=l;if(this.fxTimer>this.fxDelay){this.fxTimer=this.fxDelay}for(var f=0;f<this.animationTargets.length;f++){var k=this.animationTargets[f].o,g=this.animationTargets[f].s,e=this.animationTargets[f].t,c=this.animationTargets[f].v;for(var d=0;d<c.length;d++){if(typeof(g)=="number"){k[c[d]]=this.fxEasing(null,this.fxTimer,g,e-g,this.fxDelay)}else{k[c[d]]=this.fxEasing(null,this.fxTimer,g[c[d]],e[c[d]]-g[c[d]],this.fxDelay)}}}if((this.fxTimer==this.fxDelay)&&(this.fxCompleteCb!=undefined)){this.fxCompleteCb()}}};b.AcceleratorRing.prototype.setView=function(c){this.fxTimer=0;this.view=c;if(c==0){this.setAnimationTarget(0,{x:100,z:0});this.setAnimationTarget(1,{y:Math.PI/2,x:0});this.setAnimationTarget(2,{ringRotationSpeed:0,collisionOpacity:0});this.setAnimationTarget(3,{intensity:0});this.setAnimationTarget(4,{intensity:0});this.setAnimationTarget(5,{intensity:0});this.setAnimationTarget(6,{value:0});this.setAnimationTarget(7,{value:0});this.setAnimationTarget(8,{value:0});this.setAnimationTarget(9,{value:0});this.setAnimationTarget(10,{opacity:0});this.setAnimationTarget(11,{r:0.5,g:0.5,b:0.5});this.setAnimationTarget(12,{r:0.4,g:0.4,b:0.4})}else{if(c==1){this.setAnimationTarget(0,{x:100,z:40});this.setAnimationTarget(1,{y:Math.PI/2-0.45,x:0});this.setAnimationTarget(2,{ringRotationSpeed:1,collisionOpacity:0});this.setAnimationTarget(3,{intensity:0});this.setAnimationTarget(4,{intensity:0});this.setAnimationTarget(5,{intensity:0});this.setAnimationTarget(6,{value:0});this.setAnimationTarget(7,{value:0});this.setAnimationTarget(8,{value:0});this.setAnimationTarget(9,{value:0});this.setAnimationTarget(10,{opacity:0});this.setAnimationTarget(11,{r:0.8,g:0.8,b:0.8});this.setAnimationTarget(12,{r:0.1,g:0.1,b:0.1})}else{if(c==2){this.setAnimationTarget(0,{x:-5,z:0});this.setAnimationTarget(1,{y:Math.PI/2,x:0});this.setAnimationTarget(2,{ringRotationSpeed:0,collisionOpacity:1});this.setAnimationTarget(3,{intensity:1});this.setAnimationTarget(4,{intensity:1});this.setAnimationTarget(5,{intensity:1});this.setAnimationTarget(6,{value:1});this.setAnimationTarget(7,{value:0.5});this.setAnimationTarget(8,{value:1});this.setAnimationTarget(9,{value:0.5});this.setAnimationTarget(10,{opacity:0.4});this.setAnimationTarget(11,{r:0.2,g:0.2,b:0.2});this.setAnimationTarget(12,{r:0.2,g:0.2,b:0.2})}else{if(c==3){this.setAnimationTarget(0,{x:100,z:20});this.setAnimationTarget(1,{y:Math.PI/2-0.2,x:0.2});this.setAnimationTarget(2,{ringRotationSpeed:0,collisionOpacity:0});this.setAnimationTarget(3,{intensity:0});this.setAnimationTarget(4,{intensity:0});this.setAnimationTarget(5,{intensity:0});this.setAnimationTarget(6,{value:0});this.setAnimationTarget(7,{value:0});this.setAnimationTarget(8,{value:0});this.setAnimationTarget(9,{value:0});this.setAnimationTarget(10,{opacity:0});this.setAnimationTarget(11,{r:1,g:0,b:0});this.setAnimationTarget(12,{r:0.4,g:0.4,b:0.4})}}}}};b.LHCDipole=function(c,f,e,g,d){THREE.Object3D.call(this);this.radius=c||10;this.length=f||1;this.segments=e||8;this.materialInner=g||new THREE.MeshBasicMaterial({color:16711680});this.materialOuter=d||this.materialInner;this.overdraw=1;this.insetRadius=1;this.openEnds=true;this.geomOuterRing=new THREE.CylinderGeometry(this.radius,this.radius,this.length+this.overdraw,this.segments,1,this.openEnds);this.geomInnerRing=new THREE.CylinderGeometry(this.radius-this.insetRadius,this.radius-this.insetRadius,this.length+this.overdraw,this.segments,1,this.openEnds);this.meshOuterRing=new THREE.Mesh(this.geomOuterRing,this.materialOuter);this.meshInnerRing=new THREE.Mesh(this.geomInnerRing,this.materialInner);this.meshOuterRing.position.set(0,0,this.length/2-this.overdraw/2);this.meshInnerRing.position.set(0,0,this.length/2-this.overdraw/2);this.meshOuterRing.rotation.set(Math.PI/2,0,0);this.meshInnerRing.rotation.set(Math.PI/2,0,0);this.meshOuterRing.hoverTarget=this;this.meshInnerRing.hoverTarget=this;this.add(this.meshOuterRing);this.add(this.meshInnerRing)};b.LHCDipole.prototype=Object.create(THREE.Object3D.prototype);b.LHCDipole.prototype.setMaterial=function(d,c){this.materialInner=d||new THREE.MeshBasicMaterial({color:16711680});this.materialOuter=this.materialInner;this.meshInnerRing.material=this.materialInner;this.meshOuterRing.material=this.materialOuter};b.LHCRing=function(c){THREE.Object3D.call(this);var j=c||{};this.radius=j.radius||100;this.thickness=j.thickness||5;this.segments=j.segments||40;this.innerMaterial=j.material||new THREE.MeshPhongMaterial({color:3355443,side:THREE.BackSide,transparent:true,opacity:0.5});this.outerMaterial=j.material||new THREE.MeshPhongMaterial({color:6711039,side:THREE.FrontSide,transparent:true,opacity:0.5});var o=2*Math.PI*this.radius,q=o/this.segments;this.dipoles=[];var r=0,n=Math.PI*2/this.segments,k=Math.sin(r-n)*this.radius,h=Math.cos(r-n)*this.radius,f=0;for(var e=0;e<this.segments;e++,r+=n){var p=Math.sin(r)*this.radius,m=Math.cos(r)*this.radius,l=0;var d=new b.LHCDipole(this.thickness,q,8,this.innerMaterial,this.outerMaterial);d.position.set(p,m,l);d.lookAt(new THREE.Vector3(k,h,f));this.add(d);k=p;h=m;f=l;this.dipoles.push(d)}this.glowObject=new THREE.Object3D();this.glowObject.position=this.position;this.glowObject.rotation=this.rotation;this.shadowGeometry=new THREE.RingGeometry(this.radius-this.thickness/2,this.radius+this.thickness/2,this.segments);this.shadowMaterial=new THREE.MeshBasicMaterial({color:10027008,side:THREE.DoubleSide});this.shadow=new THREE.Mesh(this.shadowGeometry,this.shadowMaterial);this.shadow.position.set(0,0,-20);var g=THREE.ParticleTextureShader;this.ringMatUniforms=THREE.UniformsUtils.clone(g.uniforms);this.ringMaterial=new THREE.ShaderMaterial({uniforms:this.ringMatUniforms,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader});this.ringMatUniforms.uScale.value=10;this.ringGeometry=new THREE.TorusGeometry(this.radius,1,10,this.segments);this.ringMesh=new THREE.Mesh(this.ringGeometry,this.ringMaterial);this.glowObject.add(this.ringMesh)};b.LHCRing.prototype=Object.create(THREE.Object3D.prototype);b.LHCRing.prototype.setProgress=function(c){};b.LHCRing.prototype.update=function(c){this.ringMatUniforms.uTime.value+=c/1000};$(function(){})})(M);var BeamShader={uniforms:{tTexture1:{type:"t",value:null},tTexture2:{type:"t",value:null},uColor:{type:"c",value:new THREE.Color(16755200)},uTime:{type:"f",value:0},uOpacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define M_PI 3.1415926535897932384626433832795","uniform sampler2D tTexture1;","uniform sampler2D tTexture2;","uniform vec3 uColor;","uniform float uTime;","uniform float uOpacity;","varying vec2 vUv;","float ease(float v) {","return 1.0 - pow( 1.0 - v, 2.0 );","}","void main() {","float uValue = abs(sin( vUv.x * M_PI + uTime ));","float tx1fw = mod( vUv.x * 20.0 + uTime, 1.0 );","vec3 texel1 = texture2D( tTexture1, vec2( tx1fw , vUv.y ) ).xyz;","float  tx1a = ease((texel1.x + texel1.y + texel1.z) / 3.0) * 0.2;","float tx2fw = mod( vUv.x * 8.0 + uTime, 1.0 );","vec3 texel2 = texture2D( tTexture1, vec2( tx2fw , 1.0 - vUv.y ) ).xyz;","float  tx2a = ease((texel2.x + texel2.y + texel2.z) / 3.0) * 0.5;","float tx3fw = mod( vUv.x * 4.0 + uTime * 10.0, 1.0 );","vec3 texel3 = texture2D( tTexture2, vec2( tx3fw , 1.0 - vUv.y ) ).xyz;","float  tx3a = ease((texel3.x + texel3.y + texel3.z) / 3.0);","gl_FragColor  = clamp( vec4(texel1, tx1a) + vec4(texel2, tx2a) + vec4(texel3.xyz, tx3a), 0.0, 1.0);","gl_FragColor *= vec4( uColor, uOpacity );","}"].join("\n")};var CollisionShader={uniforms:{tTexture1:{type:"t",value:null},tTexture2:{type:"t",value:null},uColor:{type:"c",value:new THREE.Color(16755200)},uTime:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define M_PI 3.1415926535897932384626433832795","uniform sampler2D tTexture1;","uniform sampler2D tTexture2;","uniform vec3 uColor;","uniform float uTime;","varying vec2 vUv;","void main() {","float uValue = abs(sin( vUv.x * M_PI + uTime ));","vec4 texel1 = texture2D( tTexture1, vec2( vUv.x * 20.0 + mod( uTime, 1.0 ) , vUv.y ) );","vec4 texel2 = texture2D( tTexture1, vec2( vUv.x * 8.0 + mod( uTime, 1.0 ) , 1.0 - vUv.y ) ) / vec4( 1.0, 1.0, 1.0, 2.0);","vec4 texel3 = texture2D( tTexture2, vec2( vUv.x * 4.0 - mod( uTime * 10.0 , 1.0 ) , 1.0 - vUv.y ) );","vec4 color = clamp( texel1 + texel2 + texel3, 0.0, 1.0 );","gl_FragColor = uColor;","}"].join("\n")};jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,f,a,h,g){return jQuery.easing[jQuery.easing.def](e,f,a,h,g)},easeInQuad:function(e,f,a,h,g){return h*(f/=g)*f+a},easeOutQuad:function(e,f,a,h,g){return -h*(f/=g)*(f-2)+a},easeInOutQuad:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f+a}return -h/2*((--f)*(f-2)-1)+a},easeInCubic:function(e,f,a,h,g){return h*(f/=g)*f*f+a},easeOutCubic:function(e,f,a,h,g){return h*((f=f/g-1)*f*f+1)+a},easeInOutCubic:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f+a}return h/2*((f-=2)*f*f+2)+a},easeInQuart:function(e,f,a,h,g){return h*(f/=g)*f*f*f+a},easeOutQuart:function(e,f,a,h,g){return -h*((f=f/g-1)*f*f*f-1)+a},easeInOutQuart:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f+a}return -h/2*((f-=2)*f*f*f-2)+a},easeInQuint:function(e,f,a,h,g){return h*(f/=g)*f*f*f*f+a},easeOutQuint:function(e,f,a,h,g){return h*((f=f/g-1)*f*f*f*f+1)+a},easeInOutQuint:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f*f+a}return h/2*((f-=2)*f*f*f*f+2)+a},easeInSine:function(e,f,a,h,g){return -h*Math.cos(f/g*(Math.PI/2))+h+a},easeOutSine:function(e,f,a,h,g){return h*Math.sin(f/g*(Math.PI/2))+a},easeInOutSine:function(e,f,a,h,g){return -h/2*(Math.cos(Math.PI*f/g)-1)+a},easeInExpo:function(e,f,a,h,g){return(f==0)?a:h*Math.pow(2,10*(f/g-1))+a},easeOutExpo:function(e,f,a,h,g){return(f==g)?a+h:h*(-Math.pow(2,-10*f/g)+1)+a},easeInOutExpo:function(e,f,a,h,g){if(f==0){return a}if(f==g){return a+h}if((f/=g/2)<1){return h/2*Math.pow(2,10*(f-1))+a}return h/2*(-Math.pow(2,-10*--f)+2)+a},easeInCirc:function(e,f,a,h,g){return -h*(Math.sqrt(1-(f/=g)*f)-1)+a},easeOutCirc:function(e,f,a,h,g){return h*Math.sqrt(1-(f=f/g-1)*f)+a},easeInOutCirc:function(e,f,a,h,g){if((f/=g/2)<1){return -h/2*(Math.sqrt(1-f*f)-1)+a}return h/2*(Math.sqrt(1-(f-=2)*f)+1)+a},easeInElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return -(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e},easeOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return g*Math.pow(2,-10*h)*Math.sin((h*k-i)*(2*Math.PI)/j)+l+e},easeInOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k/2)==2){return e+l}if(!j){j=k*(0.3*1.5)}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}if(h<1){return -0.5*(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e}return g*Math.pow(2,-10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j)*0.5+l+e},easeInBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*(f/=h)*f*((g+1)*f-g)+a},easeOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*((f=f/h-1)*f*((g+1)*f+g)+1)+a},easeInOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}if((f/=h/2)<1){return i/2*(f*f*(((g*=(1.525))+1)*f-g))+a}return i/2*((f-=2)*f*(((g*=(1.525))+1)*f+g)+2)+a},easeInBounce:function(e,f,a,h,g){return h-jQuery.easing.easeOutBounce(e,g-f,0,h,g)+a},easeOutBounce:function(e,f,a,h,g){if((f/=g)<(1/2.75)){return h*(7.5625*f*f)+a}else{if(f<(2/2.75)){return h*(7.5625*(f-=(1.5/2.75))*f+0.75)+a}else{if(f<(2.5/2.75)){return h*(7.5625*(f-=(2.25/2.75))*f+0.9375)+a}else{return h*(7.5625*(f-=(2.625/2.75))*f+0.984375)+a}}}},easeInOutBounce:function(e,f,a,h,g){if(f<g/2){return jQuery.easing.easeInBounce(e,f*2,0,h,g)*0.5+a}return jQuery.easing.easeOutBounce(e,f*2-g,0,h,g)*0.5+h*0.5+a}});function md5cycle(f,h){var g=f[0],e=f[1],j=f[2],i=f[3];g=ff(g,e,j,i,h[0],7,-680876936);i=ff(i,g,e,j,h[1],12,-389564586);j=ff(j,i,g,e,h[2],17,606105819);e=ff(e,j,i,g,h[3],22,-1044525330);g=ff(g,e,j,i,h[4],7,-176418897);i=ff(i,g,e,j,h[5],12,1200080426);j=ff(j,i,g,e,h[6],17,-1473231341);e=ff(e,j,i,g,h[7],22,-45705983);g=ff(g,e,j,i,h[8],7,1770035416);i=ff(i,g,e,j,h[9],12,-1958414417);j=ff(j,i,g,e,h[10],17,-42063);e=ff(e,j,i,g,h[11],22,-1990404162);g=ff(g,e,j,i,h[12],7,1804603682);i=ff(i,g,e,j,h[13],12,-40341101);j=ff(j,i,g,e,h[14],17,-1502002290);e=ff(e,j,i,g,h[15],22,1236535329);g=gg(g,e,j,i,h[1],5,-165796510);i=gg(i,g,e,j,h[6],9,-1069501632);j=gg(j,i,g,e,h[11],14,643717713);e=gg(e,j,i,g,h[0],20,-373897302);g=gg(g,e,j,i,h[5],5,-701558691);i=gg(i,g,e,j,h[10],9,38016083);j=gg(j,i,g,e,h[15],14,-660478335);e=gg(e,j,i,g,h[4],20,-405537848);g=gg(g,e,j,i,h[9],5,568446438);i=gg(i,g,e,j,h[14],9,-1019803690);j=gg(j,i,g,e,h[3],14,-187363961);e=gg(e,j,i,g,h[8],20,1163531501);g=gg(g,e,j,i,h[13],5,-1444681467);i=gg(i,g,e,j,h[2],9,-51403784);j=gg(j,i,g,e,h[7],14,1735328473);e=gg(e,j,i,g,h[12],20,-1926607734);g=hh(g,e,j,i,h[5],4,-378558);i=hh(i,g,e,j,h[8],11,-2022574463);j=hh(j,i,g,e,h[11],16,1839030562);e=hh(e,j,i,g,h[14],23,-35309556);g=hh(g,e,j,i,h[1],4,-1530992060);i=hh(i,g,e,j,h[4],11,1272893353);j=hh(j,i,g,e,h[7],16,-155497632);e=hh(e,j,i,g,h[10],23,-1094730640);g=hh(g,e,j,i,h[13],4,681279174);i=hh(i,g,e,j,h[0],11,-358537222);j=hh(j,i,g,e,h[3],16,-722521979);e=hh(e,j,i,g,h[6],23,76029189);g=hh(g,e,j,i,h[9],4,-640364487);i=hh(i,g,e,j,h[12],11,-421815835);j=hh(j,i,g,e,h[15],16,530742520);e=hh(e,j,i,g,h[2],23,-995338651);g=ii(g,e,j,i,h[0],6,-198630844);i=ii(i,g,e,j,h[7],10,1126891415);j=ii(j,i,g,e,h[14],15,-1416354905);e=ii(e,j,i,g,h[5],21,-57434055);g=ii(g,e,j,i,h[12],6,1700485571);i=ii(i,g,e,j,h[3],10,-1894986606);j=ii(j,i,g,e,h[10],15,-1051523);e=ii(e,j,i,g,h[1],21,-2054922799);g=ii(g,e,j,i,h[8],6,1873313359);i=ii(i,g,e,j,h[15],10,-30611744);j=ii(j,i,g,e,h[6],15,-1560198380);e=ii(e,j,i,g,h[13],21,1309151649);g=ii(g,e,j,i,h[4],6,-145523070);i=ii(i,g,e,j,h[11],10,-1120210379);j=ii(j,i,g,e,h[2],15,718787259);e=ii(e,j,i,g,h[9],21,-343485551);f[0]=add32(g,f[0]);f[1]=add32(e,f[1]);f[2]=add32(j,f[2]);f[3]=add32(i,f[3])}function cmn(h,e,d,c,g,f){e=add32(add32(e,h),add32(c,f));return add32((e<<g)|(e>>>(32-g)),d)}function ff(g,f,k,j,e,i,h){return cmn((f&k)|((~f)&j),g,f,e,i,h)}function gg(g,f,k,j,e,i,h){return cmn((f&j)|(k&(~j)),g,f,e,i,h)}function hh(g,f,k,j,e,i,h){return cmn(f^k^j,g,f,e,i,h)}function ii(g,f,k,j,e,i,h){return cmn(k^(f|(~j)),g,f,e,i,h)}function md51(c){txt="";var e=c.length,d=[1732584193,-271733879,-1732584194,271733878],b;for(b=64;b<=c.length;b+=64){md5cycle(d,md5blk(c.substring(b-64,b)))}c=c.substring(b-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;b<c.length;b++){a[b>>2]|=c.charCodeAt(b)<<((b%4)<<3)}a[b>>2]|=128<<((b%4)<<3);if(b>55){md5cycle(d,a);for(b=0;b<16;b++){a[b]=0}}a[14]=e*8;md5cycle(d,a);return d}function md5blk(b){var c=[],a;for(a=0;a<64;a+=4){c[a>>2]=b.charCodeAt(a)+(b.charCodeAt(a+1)<<8)+(b.charCodeAt(a+2)<<16)+(b.charCodeAt(a+3)<<24)}return c}var hex_chr="0123456789abcdef".split("");function rhex(c){var b="",a=0;for(;a<4;a++){b+=hex_chr[(c>>(a*8+4))&15]+hex_chr[(c>>(a*8))&15]}return b}function hex(a){for(var b=0;b<a.length;b++){a[b]=rhex(a[b])}return a.join("")}function md5(a){return hex(md51(a))}function add32(d,c){return(d+c)&4294967295}if(md5("hello")!="5d41402abc4b2a76b9719d911017c592"){function add32(a,d){var c=(a&65535)+(d&65535),b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}}d3=function(){function hP(a){return null!=a&&!isNaN(a)}function hH(a){return a.length}function h5(b){for(var a=1;b*a%1;){a*=10}return a}function hK(d,a){try{for(var c in a){Object.defineProperty(d.prototype,c,{value:a[c],enumerable:!1})}}catch(b){d.prototype=a}}function hF(){}function hZ(){}function hO(c,a,b){return function(){var d=b.apply(a,arguments);return d===a?c:d}}function ig(f,b){if(b in f){return b}b=b.charAt(0).toUpperCase()+b.substring(1);for(var d=0,c=bE.length;c>d;++d){var a=bE[d]+b;if(a in f){return a}}}function h8(){}function hU(){}function hI(d){function a(){for(var g,h=c,e=-1,f=h.length;++e<f;){(g=h[e].on)&&g.apply(this,arguments)}return d}var c=[],b=new hF;return a.on=function(g,e){var f,h=b.get(g);return arguments.length<2?h&&h.on:(h&&(h.on=null,c=c.slice(0,f=c.indexOf(h)).concat(c.slice(f+1)),b.remove(g)),e&&c.push(b.set(g,{on:e})),d)},a}function h3(){a5.event.preventDefault()}function h1(){for(var b,a=a5.event;b=a.sourceEvent;){a=b}return a}function h2(d){for(var a=new hU,c=0,b=arguments.length;++c<b;){a[arguments[c]]=hI(a)}return a.of=function(g,f){return function(e){try{var h=e.sourceEvent=a5.event;e.target=d,a5.event=e,a[e.type].apply(g,f)}finally{a5.event=h}}},a}function hN(a){return fj(a,f1),a}function h7(a){return"function"==typeof a?a:function(){return g1(a,this)}}function hD(a){return"function"==typeof a?a:function(){return jz(a,this)}}function hS(k,f){function h(){this.removeAttribute(k)}function g(){this.removeAttributeNS(k.space,k.local)}function c(){this.setAttribute(k,f)}function d(){this.setAttributeNS(k.space,k.local,f)}function j(){var a=f.apply(this,arguments);null==a?this.removeAttribute(k):this.setAttribute(k,a)}function b(){var a=f.apply(this,arguments);null==a?this.removeAttributeNS(k.space,k.local):this.setAttributeNS(k.space,k.local,a)}return k=a5.ns.qualify(k),null==f?k.local?g:h:"function"==typeof f?k.local?b:j:k.local?d:c}function hA(a){return a.trim().replace(/\s+/g," ")}function iN(a){return new RegExp("(?:^|\\s+)"+a5.requote(a)+"(?:\\s+|$)","g")}function hB(f,b){function d(){for(var g=-1;++g<a;){f[g](this,b)}}function c(){for(var h=-1,g=b.apply(this,arguments);++h<a;){f[h](this,g)}}f=f.trim().split(/\s+/).map(id);var a=f.length;return"function"==typeof b?c:d}function id(b){var a=iN(b);return function(f,d){if(c=f.classList){return d?c.add(b):c.remove(b)}var c=f.getAttribute("class")||"";d?(a.lastIndex=0,a.test(c)||f.setAttribute("class",hA(c+" "+b))):f.setAttribute("class",hA(c.replace(a," ")))}}function ih(g,c,f){function d(){this.style.removeProperty(g)}function a(){this.style.setProperty(g,c,f)}function b(){var e=c.apply(this,arguments);null==e?this.style.removeProperty(g):this.style.setProperty(g,e,f)}return null==c?d:"function"==typeof c?b:a}function hC(f,b){function d(){delete this[f]}function c(){this[f]=b}function a(){var g=b.apply(this,arguments);null==g?delete this[f]:this[f]=g}return null==b?d:"function"==typeof b?a:c}function iD(a){return"function"==typeof a?a:(a=a5.ns.qualify(a)).local?function(){return gJ.createElementNS(a.space,a.local)}:function(){return gJ.createElementNS(this.namespaceURI,a)}}function i0(a){return{__data__:a}}function hV(a){return function(){return fK(this,a)}}function i6(a){return arguments.length||(a=a5.ascending),function(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}}function iL(k,f){for(var h=0,g=k.length;g>h;h++){for(var c,d=k[h],j=0,b=d.length;b>j;j++){(c=d[j])&&f(c,j,h)}}return k}function hL(a){return fj(a,cH),a}function iB(c){var a,b;return function(g,e,f){var h,d=c[f].update,j=d.length;for(f!=b&&(b=f,a=0),e>=a&&(a=e+1);!(h=d[a])&&++a<j;){}return h}}function hy(){var a=this.__transition__;a&&++a.active}function i4(d,m,h){function b(){var a=this[c];a&&(this.removeEventListener(d,a,a.$),delete this[c])}function k(){var a=f(m,jL(arguments));b.call(this),this.addEventListener(d,this[c]=a,a.$=h),a._=m}function g(){var i,n=new RegExp("^__on([^.]+)"+a5.requote(d)+"$");for(var l in this){if(i=l.match(n)){var a=this[l];this.removeEventListener(i[1],a,a.$),delete this[l]}}}var c="__on"+d,j=d.indexOf("."),f=i1;j>0&&(d=d.substring(0,j));var p=d4.get(d);return p&&(d=p,f=hX),j?m?k:b:m?h8:g}function i1(b,a){return function(d){var c=a5.event;a5.event=d,a[0]=this.__data__;try{b.apply(this,a)}finally{a5.event=c}}}function hX(c,a){var b=i1(c,a);return function(f){var d=this,e=f.relatedTarget;e&&(e===d||8&e.compareDocumentPosition(d))||b.call(d,f)}}function iO(){var k=".dragsuppress-"+ ++b9,f="touchmove"+k,h="selectstart"+k,g="dragstart"+k,c="click"+k,d=a5.select(iF).on(f,h3).on(h,h3).on(g,h3),j=ag.style,b=j[dE];return j[dE]="none",function(a){function i(){d.on(c,null)}d.on(k,null),j[dE]=b,a&&(d.on(c,function(){h3(),i()},!0),setTimeout(i,0))}}function iV(g,c){var f=g.ownerSVGElement||g;if(f.createSVGPoint){var d=f.createSVGPoint();if(0>cX&&(iF.scrollX||iF.scrollY)){f=a5.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var a=f[0][0].getScreenCTM();cX=!(a.f||a.e),f.remove()}return cX?(d.x=c.pageX,d.y=c.pageY):(d.x=c.clientX,d.y=c.clientY),d=d.matrixTransform(g.getScreenCTM().inverse()),[d.x,d.y]}var b=g.getBoundingClientRect();return[c.clientX-b.left-g.clientLeft,c.clientY-b.top-g.clientTop]}function iY(a){return a>0?1:0>a?-1:0}function iH(a){return a>1?0:-1>a?bV:Math.acos(a)}function iI(a){return a>1?bV/2:-1>a?-bV/2:Math.asin(a)}function iE(a){return(Math.exp(a)-Math.exp(-a))/2}function iq(a){return(Math.exp(a)+Math.exp(-a))/2}function iU(a){return iE(a)/iq(a)}function iA(a){return(a=Math.sin(a/2))*a}function iy(){}function ip(c,a,b){return new iv(c,a,b)}function iv(c,a,b){this.h=c,this.s=a,this.l=b}function i5(h,c,f){function d(e){return e>360?e-=360:0>e&&(e+=360),60>e?b+(g-b)*e/60:180>e?g:240>e?b+(g-b)*(240-e)/60:b}function a(e){return Math.round(255*d(e))}var b,g;return h=isNaN(h)?0:(h%=360)<0?h+360:h,c=isNaN(c)?0:0>c?0:c>1?1:c,f=0>f?0:f>1?1:f,g=0.5>=f?f*(1+c):f+c-f*c,b=2*f-g,dw(a(h+120),a(h),a(h-120))}function jE(c,a,b){return new iw(c,a,b)}function iw(c,a,b){this.h=c,this.c=a,this.l=b}function iS(c,a,b){return isNaN(c)&&(c=0),isNaN(a)&&(a=0),iW(b,Math.cos(c*=h0)*a,Math.sin(c)*a)}function iW(c,a,b){return new iR(c,a,b)}function iR(c,a,b){this.l=c,this.a=a,this.b=b}function iG(g,c,f){var d=(g+16)/116,a=d+c/500,b=d-f/200;return a=bI(a)*jC,d=bI(d)*h9,b=bI(b)*eP,dw(cx(3.2404542*a-1.5371385*d-0.4985314*b),cx(-0.969266*a+1.8760108*d+0.041556*b),cx(0.0556434*a-0.2040259*d+1.0572252*b))}function dR(c,a,b){return c>0?jE(Math.atan2(b,a)*jU,Math.sqrt(a*a+b*b),c):jE(0/0,0/0,c)}function bI(a){return a>0.206893034?a*a*a:(a-4/29)/7.787037}function gT(a){return a>0.008856?Math.pow(a,1/3):7.787037*a+4/29}function cx(a){return Math.round(255*(0.00304>=a?12.92*a:1.055*Math.pow(a,1/2.4)-0.055))}function bn(a){return dw(a>>16,255&a>>8,255&a)}function fC(a){return bn(a)+""}function dw(c,a,b){return new jj(c,a,b)}function jj(c,a,b){this.r=c,this.g=a,this.b=b}function hG(a){return 16>a?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function eD(f,m,h){var b,l,g,d=0,k=0,j=0;if(b=/([a-z]+)\((.*)\)/i.exec(f)){switch(l=b[2].split(","),b[1]){case"hsl":return h(parseFloat(l[0]),parseFloat(l[1])/100,parseFloat(l[2])/100);case"rgb":return m(gb(l[0]),gb(l[1]),gb(l[2]))}}return(g=f4.get(f))?m(g.r,g.g,g.b):(null!=f&&"#"===f.charAt(0)&&(4===f.length?(d=f.charAt(1),d+=d,k=f.charAt(2),k+=k,j=f.charAt(3),j+=j):7===f.length&&(d=f.substring(1,3),k=f.substring(3,5),j=f.substring(5,7)),d=parseInt(d,16),k=parseInt(k,16),j=parseInt(j,16)),m(d,k,j))}function bZ(f,m,h){var b,l,g=Math.min(f/=255,m/=255,h/=255),d=Math.max(f,m,h),k=d-g,j=(d+g)/2;return k?(l=0.5>j?k/(d+g):k/(2-d-g),b=f==d?(m-h)/k+(h>m?6:0):m==d?(h-f)/k+2:(f-m)/k+4,b*=60):(b=0/0,l=j>0&&1>j?0:b),ip(b,l,j)}function gB(g,c,f){g=fT(g),c=fT(c),f=fT(f);var d=gT((0.4124564*g+0.3575761*c+0.1804375*f)/jC),a=gT((0.2126729*g+0.7151522*c+0.072175*f)/h9),b=gT((0.0193339*g+0.119192*c+0.9503041*f)/eP);return iW(116*a-16,500*(d-a),200*(a-b))}function fT(a){return(a/=255)<=0.04045?a/12.92:Math.pow((a+0.055)/1.055,2.4)}function gb(b){var a=parseFloat(b);return"%"===b.charAt(b.length-1)?Math.round(2.55*a):a}function c6(a){return"function"==typeof a?a:function(){return a}}function hb(a){return a}function a1(a){return function(b,d,c){return 2===arguments.length&&"function"==typeof d&&(c=d,d=null),eg(b,d,a,c)}}function eg(f,q,j,b){function p(){var e,a=k.status;if(!a&&k.responseText||a>=200&&300>a||304===a){try{e=j.call(h,k)}catch(c){return d.error.call(h,c),void 0}d.load.call(h,e)}else{d.error.call(h,k)}}var h={},d=a5.dispatch("beforesend","progress","load","error"),m={},k=new XMLHttpRequest,g=null;return !iF.XDomainRequest||"withCredentials" in k||!/^(http(s)?:)?\/\//.test(f)||(k=new XDomainRequest),"onload" in k?k.onload=k.onerror=p:k.onreadystatechange=function(){k.readyState>3&&p()},k.onprogress=function(c){var a=a5.event;a5.event=c;try{d.progress.call(h,k)}finally{a5.event=a}},h.header=function(c,a){return c=(c+"").toLowerCase(),arguments.length<2?m[c]:(null==a?delete m[c]:m[c]=a+"",h)},h.mimeType=function(a){return arguments.length?(q=null==a?null:a+"",h):q},h.responseType=function(a){return arguments.length?(g=a,h):g},h.response=function(a){return j=a,h},["get","post"].forEach(function(a){h[a]=function(){return h.send.apply(h,[a].concat(jL(arguments)))}}),h.send=function(l,i,a){if(2===arguments.length&&"function"==typeof i&&(a=i,i=null),k.open(l,f,!0),null==q||"accept" in m||(m.accept=q+",*/*"),k.setRequestHeader){for(var c in m){k.setRequestHeader(c,m[c])}}return null!=q&&k.overrideMimeType&&k.overrideMimeType(q),null!=g&&(k.responseType=g),null!=a&&h.on("error",a).on("load",function(e){a(null,e)}),d.beforesend.call(h,k),k.send(null==i?null:i),h},h.abort=function(){return k.abort(),h},a5.rebind(h,d,"on"),null==b?h:h.get(jH(b))}function jH(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function gG(){var b=iz(),a=ak()-b;a>24?(isFinite(a)&&(clearTimeout(bg),bg=setTimeout(gG,a)),hs=0):(hs=1,jT(gG))}function jY(d,a,c){var b=arguments.length;2>b&&(a=0),3>b&&(c=Date.now()),ex.callback=d,ex.time=c+a}function iz(){var a=Date.now();for(ex=gv;ex;){a>=ex.time&&(ex.flush=ex.callback(a-ex.time)),ex=ex.next}return a}function ak(){for(var c,a=gv,b=1/0;a;){a.flush?a=c?c.next=a.next:gv=a.next:(a.time<b&&(b=a.time),a=(c=a).next)}return dm=c,b}function aJ(c,a){var b=Math.pow(10,3*Math.abs(8-a));return{scale:a>8?function(d){return d/b}:function(d){return d*b},symbol:c}}function eI(b,a){return a-(b?Math.ceil(Math.log(b)/Math.LN10):1)}function aS(a){return a+""}function eV(){}function cf(g,c,f){var d=f.s=g+c,a=d-g,b=d-a;f.t=g-b+(c-a)}function gk(b,a){b&&eB.hasOwnProperty(b.type)&&eB[b.type](b,a)}function cQ(g,c,f){var d,a=-1,b=g.length-f;for(c.lineStart();++a<b;){d=g[a],c.point(d[0],d[1],d[2])}c.lineEnd()}function en(d,a){var c=-1,b=d.length;for(a.polygonStart();++c<b;){cQ(d[c],a,1)}a.polygonEnd()}function i9(){function g(r,j){r*=h0,j=j*h0/2+bV/4;var m=r-d,p=Math.cos(j),i=Math.sin(j),q=b*i,h=a*p+q*Math.cos(m),k=q*Math.sin(m);bL.add(Math.atan2(k,h)),d=r,a=p,b=i}var c,f,d,a,b;bs.point=function(h,e){bs.point=g,d=(c=h)*h0,a=Math.cos(e=(f=e)*h0/2+bV/4),b=Math.sin(e)},bs.lineEnd=function(){g(c,f)}}function bA(d){var a=d[0],c=d[1],b=Math.cos(c);return[b*Math.cos(a),b*Math.sin(a),Math.sin(c)]}function bb(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]}function fg(b,a){return[b[1]*a[2]-b[2]*a[1],b[2]*a[0]-b[0]*a[2],b[0]*a[1]-b[1]*a[0]]}function gY(b,a){b[0]+=a[0],b[1]+=a[1],b[2]+=a[2]}function js(b,a){return[b[0]*a,b[1]*a,b[2]*a]}function ax(b){var a=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=a,b[1]/=a,b[2]/=a}function fH(a){return[Math.atan2(a[1],a[0]),iI(a[2])]}function fY(b,a){return Math.abs(b[0]-a[0])<dP&&Math.abs(b[1]-a[1])<dP}function e0(c,a){c*=h0;var b=Math.cos(a*=h0);cE(b*Math.cos(c),b*Math.sin(c),Math.sin(a))}function cE(c,a,b){++fw,jK+=(c-jK)/fw,aM+=(a-aM)/fw,fR+=(b-fR)/fw}function iM(){function d(m,g){m*=h0;var h=Math.cos(g*=h0),j=h*Math.cos(m),f=h*Math.sin(m),k=Math.sin(g),e=Math.atan2(Math.sqrt((e=c*k-b*f)*e+(e=b*j-a*k)*e+(e=a*f-c*j)*e),a*j+c*f+b*k);g8+=e,f8+=e*(a+(a=j)),fb+=e*(c+(c=f)),cO+=e*(b+(b=k)),cE(a,c,b)}var a,c,b;cq.point=function(e,f){e*=h0;var g=Math.cos(f*=h0);a=g*Math.cos(e),c=g*Math.sin(e),b=Math.sin(f),cq.point=d,cE(a,c,b)}}function dY(){cq.point=e0}function dB(){function g(k,D){k*=h0;var v=Math.cos(D*=h0),j=v*Math.cos(k),C=v*Math.sin(k),B=Math.sin(D),m=a*B-b*C,E=b*j-d*B,u=d*C-a*j,q=Math.sqrt(m*m+E*E+u*u),r=d*j+a*C+b*B,i=q&&-iH(r)/q,A=Math.atan2(q,r);jf+=i*m,ed+=i*E,dO+=i*u,g8+=A,f8+=A*(d+(d=j)),fb+=A*(a+(a=C)),cO+=A*(b+(b=B)),cE(d,a,b)}var c,f,d,a,b;cq.point=function(h,e){c=h,f=e,cq.point=g,h*=h0;var i=Math.cos(e*=h0);d=i*Math.cos(h),a=i*Math.sin(h),b=Math.sin(e),cE(d,a,b)},cq.lineEnd=function(){g(c,f),cq.lineEnd=dY,cq.point=e0}}function b6(){return !0}function cU(j,E,A,b,D){var m=[],d=[];if(j.forEach(function(u){if(!((h=u.length-1)<=0)){var h,o=u[0],i=u[h];if(fY(o,i)){D.lineStart();for(var g=0;h>g;++g){D.point((o=u[g])[0],o[1])}return D.lineEnd(),void 0}var s={point:o,points:u,other:null,visited:!1,entry:!0,subject:!0},f={point:o,points:[o],other:s,visited:!1,entry:!1,subject:!1};s.other=f,m.push(s),d.push(f),s={point:i,points:[i],other:null,visited:!1,entry:!1,subject:!0},f={point:i,points:[i],other:s,visited:!1,entry:!0,subject:!1},s.other=f,m.push(s),d.push(f)}}),d.sort(E),bR(m),bR(d),m.length){if(A){for(var C=1,B=!A(d[0].point),k=d.length;k>C;++C){d[C].entry=B=!B}}for(var F,v,p,q=m[0];;){for(F=q;F.visited;){if((F=F.next)===q){return}}v=F.points,D.lineStart();do{if(F.visited=F.other.visited=!0,F.entry){if(F.subject){for(var C=0;C<v.length;C++){D.point((p=v[C])[0],p[1])}}else{b(F.point,F.next.point,1,D)}F=F.next}else{if(F.subject){v=F.prev.points;for(var C=v.length;--C>=0;){D.point((p=v[C])[0],p[1])}}else{b(F.point,F.prev.point,-1,D)}F=F.prev}F=F.other,v=F.points}while(!F.visited);D.lineEnd()}}}function bR(f){if(b=f.length){for(var b,d,c=0,a=f[0];++c<b;){a.next=d=f[c],d.prev=a,a=d}a.next=d=f[0],d.prev=a}}function dL(d,a,c,b){return function(G){function q(f,g){d(f,g)&&G.point(f,g)}function j(g,f){B.point(g,f)}function E(){F.point=j,B.lineStart()}function C(){F.point=q,B.lineEnd()}function n(g,f){D.point(g,f),e.push([g,f])}function H(){D.lineStart(),e=[]}function A(){n(e[0][0],e[0][1]),D.lineEnd();var p,g=D.clean(),l=k.buffer(),h=l.length;if(e.pop(),t.push(e),e=null,h){if(1&g){p=l[0];var f,h=p.length-1,m=-1;for(G.lineStart();++m<h;){G.point((f=p[m])[0],f[1])}return G.lineEnd(),void 0}h>1&&2&g&&l.push(l.pop().concat(l.shift())),r.push(l.filter(dd))}}var r,t,e,B=a(G),F={point:q,lineStart:E,lineEnd:C,polygonStart:function(){F.point=n,F.lineStart=H,F.lineEnd=A,r=[],t=[],G.polygonStart()},polygonEnd:function(){F.point=q,F.lineStart=E,F.lineEnd=C,r=a5.merge(r),r.length?cU(r,jQ,null,c,G):b(t)&&(G.lineStart(),c(null,null,1,G),G.lineEnd()),G.polygonEnd(),r=t=null},sphere:function(){G.polygonStart(),G.lineStart(),c(null,null,1,G),G.lineEnd(),G.polygonEnd()}},k=hT(),D=a(k);return F}}function dd(a){return a.length>1}function hT(){var b,a=[];return{lineStart:function(){a.push(b=[])},point:function(c,d){b.push([c,d])},lineEnd:h8,buffer:function(){var c=a;return a=[],b=null,c},rejoin:function(){a.length>1&&a.push(a.pop().concat(a.shift()))}}}function jQ(b,a){return((b=b.point)[0]<0?b[1]-bV/2-dP:bV/2-b[1])-((a=a.point)[0]<0?a[1]-bV/2-dP:bV/2-a[1])}function hj(R,J){var aa=R[0],L=R[1],H=[Math.sin(aa),-Math.cos(aa),0],W=0,Q=!1,al=!1,ae=0;bL.reset();for(var U=0,K=J.length;K>U;++U){var Z=J[U],X=Z.length;if(X){for(var Y=Z[0],P=Y[0],ac=Y[1]/2+bV/4,G=Math.sin(ac),T=Math.cos(ac),C=1;;){C===X&&(C=0),R=Z[C];var B=R[0],D=R[1]/2+bV/4,ai=Math.sin(D),ao=Math.cos(D),F=B-P,j=Math.abs(F)>bV,I=G*ai;if(bL.add(Math.atan2(I*Math.sin(F),T*ao+I*Math.cos(F))),Math.abs(D)<dP&&(al=!0),W+=j?F+(F>=0?2:-2)*bV:F,j^P>=aa^B>=aa){var V=fg(bA(Y),bA(R));ax(V);var O=fg(H,V);ax(O);var q=(j^F>=0?-1:1)*iI(O[2]);L>q&&(ae+=j^F>=0?1:-1)}if(!C++){break}P=B,G=ai,T=ao,Y=R}Math.abs(W)>dP&&(Q=!0)}}return(!al&&!Q&&0>bL||-dP>W)^1&ae}function fm(f){var b,d=0/0,c=0/0,a=0/0;return{lineStart:function(){f.lineStart(),b=1},point:function(g,h){var e=g>0?bV:-bV,j=Math.abs(g-d);Math.abs(j-bV)<dP?(f.point(d,c=(c+h)/2>0?bV/2:-bV/2),f.point(a,c),f.lineEnd(),f.lineStart(),f.point(e,c),f.point(g,c),b=0):a!==e&&j>=bV&&(Math.abs(d-a)<dP&&(d-=a*dP),Math.abs(g-e)<dP&&(g-=e*dP),c=d5(d,c,g,h),f.point(a,c),f.lineEnd(),f.lineStart(),f.point(e,c),b=0),f.point(d=g,c=h),a=e},lineEnd:function(){f.lineEnd(),d=c=0/0},clean:function(){return 2-b}}}function d5(h,c,f,d){var a,b,g=Math.sin(h-f);return Math.abs(g)>dP?Math.atan((Math.sin(c)*(b=Math.cos(d))*Math.sin(f)-Math.sin(d)*(a=Math.cos(c))*Math.sin(h))/(a*b*g)):(c+d)/2}function bQ(g,c,f,d){var a;if(null==g){a=f*bV/2,d.point(-bV,a),d.point(0,a),d.point(bV,a),d.point(bV,0),d.point(bV,-a),d.point(0,-a),d.point(-bV,-a),d.point(-bV,0),d.point(-bV,a)}else{if(Math.abs(g[0]-c[0])>dP){var b=(g[0]<c[0]?1:-1)*bV;a=f*b/2,d.point(-b,a),d.point(0,a),d.point(b,a)}else{d.point(c[0],c[1])}}}function g2(a){return hj(b2,a)}function cI(f){function q(c,a){return Math.cos(c)*Math.cos(a)>d}function j(A){var r,a,t,u,l;return{lineStart:function(){u=t=!1,l=1},point:function(o,i){var n,s=[o,i],B=q(o,i),e=m?B?0:p(o,i):B?p(o+(0>o?bV:-bV),i):0;if(!r&&(u=t=B)&&A.lineStart(),B!==t&&(n=b(r,s),(fY(r,n)||fY(s,n))&&(s[0]+=dP,s[1]+=dP,B=q(s[0],s[1]))),B!==t){l=0,B?(A.lineStart(),n=b(s,r),A.point(n[0],n[1])):(n=b(r,s),A.point(n[0],n[1]),A.lineEnd()),r=n}else{if(g&&r&&m^B){var c;e&a||!(c=b(s,r,!0))||(l=0,m?(A.lineStart(),A.point(c[0][0],c[0][1]),A.point(c[1][0],c[1][1]),A.lineEnd()):(A.point(c[1][0],c[1][1]),A.lineEnd(),A.lineStart(),A.point(c[0][0],c[0][1])))}}!B||r&&fY(r,s)||A.point(s[0],s[1]),r=s,t=B,a=e},lineEnd:function(){t&&A.lineEnd(),r=null},clean:function(){return l|(u&&t)<<1}}}function b(V,L,ai){var P=bA(V),J=bA(L),Z=[1,0,0],at=fg(P,J),ao=bb(at,at),X=at[0],O=ao-X*X;if(!O){return !ai&&V}var ae=d*ao/O,aa=-d*X/O,ac=fg(Z,at),U=js(Z,ae),al=js(at,aa);gY(U,al);var I=ac,W=bb(U,I),F=bb(I,I),D=W*W-F*(bb(U,U)-1);if(!(0>D)){var G=Math.sqrt(D),ar=js(I,(-W-G)/F);if(gY(ar,U),ar=fH(ar),!ai){return ar}var au,H=V[0],B=L[0],K=V[1],Y=L[1];H>B&&(au=H,H=B,B=au);var R=B-H,C=Math.abs(R-bV)<dP,Q=C||dP>R;if(!C&&K>Y&&(au=K,K=Y,Y=au),Q?C?K+Y>0^ar[1]<(Math.abs(ar[0]-H)<dP?K:Y):K<=ar[1]&&ar[1]<=Y:R>bV^(H<=ar[0]&&ar[0]<=B)){var o=js(I,(-W+G)/F);return gY(o,U),[ar,fH(o)]}}}function p(c,l){var i=m?f:bV-f,a=0;return -i>c?a|=1:c>i&&(a|=2),-i>l?a|=4:l>i&&(a|=8),a}function h(a){return hj(k,a)}var d=Math.cos(f),m=d>0,k=[f,0],g=Math.abs(d)>dP,v=cY(f,6*h0);return dL(q,j,v,h)}function bz(k,f,h,g){function c(e,a){return Math.abs(e[0]-k)<dP?a>0?0:3:Math.abs(e[0]-h)<dP?a>0?2:1:Math.abs(e[1]-f)<dP?a>0?1:0:a>0?3:2}function d(e,a){return j(e.point,a.point)}function j(m,a){var l=c(m,1),i=c(a,1);return l!==i?l-i:0===l?a[1]-m[1]:1===l?m[0]-a[0]:2===l?m[1]-a[1]:a[0]-m[0]}function b(l,m){var n=m[0]-l[0],e=m[1]-l[1],p=[0,1];return Math.abs(n)<dP&&Math.abs(e)<dP?k<=l[0]&&l[0]<=h&&f<=l[1]&&l[1]<=g:fL(k-l[0],n,p)&&fL(l[0]-h,-n,p)&&fL(f-l[1],e,p)&&fL(l[1]-g,-e,p)?(p[1]<1&&(m[0]=l[0]+p[1]*n,m[1]=l[1]+p[1]*e),p[0]>0&&(l[0]+=p[0]*n,l[1]+=p[0]*e),!0):!1}return function(Q){function I(m){var p=c(m,-1),l=C([0===p||3===p?k:h,p>1?g:f]);return l}function C(q){for(var T=0,A=n.length,m=q[1],S=0;A>S;++S){for(var v,p=1,N=n[S],E=N.length,s=N[0];E>p;++p){v=N[p],s[1]<=m?v[1]>m&&O(s,v,q)>0&&++T:v[1]<=m&&O(s,v,q)<0&&--T,s=v}}return 0!==T}function O(p,l,m){return(l[0]-p[0])*(m[1]-p[1])-(m[0]-p[0])*(l[1]-p[1])}function K(q,p,E,m){var v=0,A=0;if(null==q||(v=c(q,E))!==(A=c(p,E))||j(q,p)<0^E>0){do{m.point(0===v||3===v?k:h,v>1?g:f)}while((v=(v+E+4)%4)!==A)}else{m.point(p[0],p[1])}}function L(l,m){return l>=k&&h>=l&&m>=f&&g>=m}function G(m,l){L(m,l)&&Q.point(m,l)}function P(){a.point=H,n&&n.push(r=[]),F=!0,J=!1,e=B=0/0}function u(){o&&(H(R,U),t&&J&&D.rejoin(),o.push(D.buffer())),a.point=G,J&&Q.lineEnd()}function H(s,m){s=Math.max(-d2,Math.min(d2,s)),m=Math.max(-d2,Math.min(d2,m));var q=L(s,m);if(n&&r.push([s,m]),F){R=s,U=m,t=q,F=!1,q&&(Q.lineStart(),Q.point(s,m))}else{if(q&&J){Q.point(s,m)}else{var p=[e,B],l=[s,m];b(p,l)?(J||(Q.lineStart(),Q.point(p[0],p[1])),Q.point(l[0],l[1]),q||Q.lineEnd()):q&&(Q.lineStart(),Q.point(s,m))}}e=s,B=m,J=q}var o,n,r,R,U,t,e,B,J,F,i=Q,D=hT(),a={point:G,lineStart:P,lineEnd:u,polygonStart:function(){Q=D,o=[],n=[]},polygonEnd:function(){Q=i,(o=a5.merge(o)).length?(Q.polygonStart(),cU(o,d,I,K,Q),Q.polygonEnd()):C([k,f])&&(Q.polygonStart(),Q.lineStart(),K(null,null,1,Q),Q.lineEnd(),Q.polygonEnd()),o=n=r=null}};return a}}function fL(d,a,c){if(Math.abs(a)<dP){return 0>=d}var b=d/a;if(a>0){if(b>c[1]){return !1}b>c[0]&&(c[0]=b)}else{if(b<c[0]){return !1}b<c[1]&&(c[1]=b)}return !0}function dF(c,a){function b(f,d){return f=c(f,d),a(f[0],f[1])}return c.invert&&a.invert&&(b.invert=function(f,d){return f=a.invert(f,d),f&&c.invert(f[0],f[1])}),b}function jA(f){var b=0,d=bV/3,c=aD(f),a=c(b,d);return a.parallels=function(e){return arguments.length?c(b=e[0]*bV/180,d=e[1]*bV/180):[180*(b/bV),180*(d/bV)]},a}function h4(h,c){function f(k,i){var j=Math.sqrt(b-2*a*Math.sin(i))/a;return[j*Math.sin(k*=a),g-j*Math.cos(k)]}var d=Math.sin(h),a=(d+Math.sin(c))/2,b=1+d*(2*a-d),g=Math.sqrt(b)/a;return f.invert=function(k,i){var j=g-i;return[Math.atan2(k,j)/a,iI((b-(k*k+j*j)*a*a)/(2*a))]},f}function eM(){function f(g,e){im+=a*g-c*e,c=g,a=e}var b,d,c,a;bS.point=function(e,g){bS.point=f,b=c=e,d=a=g},bS.lineEnd=function(){f(b,d)}}function cd(b,a){af>b&&(af=b),b>fA&&(fA=b),hz>a&&(hz=a),a>d6&&(d6=a)}function gK(){function k(e,a){j.push("M",e,",",a,d)}function f(e,a){j.push("M",e,",",a),b.point=h}function h(e,a){j.push("L",e,",",a)}function g(){b.point=k}function c(){j.push("Z")}var d=f2(4.5),j=[],b={point:k,lineStart:function(){b.point=f},lineEnd:g,polygonStart:function(){b.lineEnd=c},polygonEnd:function(){b.lineEnd=g,b.point=k},pointRadius:function(a){return d=f2(a),b},result:function(){if(j.length){var a=j.join("");return j=[],a}}};return b}function f2(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function gq(b,a){jK+=b,aM+=a,++fR}function dj(){function c(h,f){var d=h-a,e=f-b,g=Math.sqrt(d*d+e*e);f8+=g*(a+h)/2,fb+=g*(b+f)/2,cO+=g,gq(a=h,b=f)}var a,b;cJ.point=function(e,d){cJ.point=c,gq(a=e,b=d)}}function hp(){cJ.point=gq}function a9(){function f(l,h){var j=l-c,g=h-a,k=Math.sqrt(j*j+g*g);f8+=k*(c+l)/2,fb+=k*(a+h)/2,cO+=k,k=a*l-c*h,jf+=k*(c+l),ed+=k*(a+h),dO+=3*k,gq(c=l,a=h)}var b,d,c,a;cJ.point=function(e,g){cJ.point=f,gq(b=c=e,d=a=g)},cJ.lineEnd=function(){f(b,d)}}function ev(k){function f(a,i){k.moveTo(a,i),k.arc(a,i,j,0,2*bV)}function h(a,i){k.moveTo(a,i),b.point=g}function g(a,i){k.lineTo(a,i)}function c(){b.point=f}function d(){k.closePath()}var j=4.5,b={point:f,lineStart:function(){b.point=h},lineEnd:c,polygonStart:function(){b.lineEnd=d},polygonEnd:function(){b.lineEnd=c,b.point=f},pointRadius:function(a){return j=a,b},result:h8};return b}function jP(g){function c(B){function D(l,h){l=g(l,h),B.point(l[0],l[1])}function A(){i=0/0,e.point=F,B.lineStart()}function F(m,l){var p=bA([m,l]),h=g(m,l);f(i,k,j,O,Q,n,i=h[0],k=h[1],j=m,O=p[0],Q=p[1],n=p[2],b,B),B.point(i,k)}function P(){e.point=D,B.lineEnd()}function N(){A(),e.point=H,e.lineEnd=C}function H(l,h){F(K=l,I=h),J=i,E=k,L=O,q=Q,G=n,e.point=F}function C(){f(i,k,j,O,Q,n,J,E,K,L,q,G,b,B),e.lineEnd=P,P()}var K,I,J,E,L,q,G,j,i,k,O,Q,n,e={point:D,lineStart:A,lineEnd:P,polygonStart:function(){B.polygonStart(),e.lineStart=N},polygonEnd:function(){B.polygonEnd(),e.lineStart=A}};return e}function f(I,W,Q,ai,ac,U,J,Z,X,Y,P,aa,G,R){var B=J-I,r=Z-W,D=B*B+r*r;if(D>4*d&&G--){var ae=ai+Y,al=ac+P,F=U+aa,j=Math.sqrt(ae*ae+al*al+F*F),H=Math.asin(F/=j),V=Math.abs(Math.abs(F)-1)<dP?(Q+X)/2:Math.atan2(al,ae),O=g(V,H),n=O[0],L=O[1],e=n-I,u=L-W,K=r*e-B*u;(K*K/D>d||Math.abs((B*e+r*u)/D-0.5)>0.3||a>ai*Y+ac*P+U*aa)&&(f(I,W,Q,ai,ac,U,n,L,V,ae/=j,al/=j,F,G,R),R.point(n,L),f(n,L,V,ae,al,F,J,Z,X,Y,P,aa,G,R))}}var d=0.5,a=Math.cos(30*h0),b=16;return c.precision=function(e){return arguments.length?(b=(d=e*e)>0&&16,c):Math.sqrt(d)},c}function gP(a){this.stream=a}function av(b){var a=jP(function(c,d){return b([c*jU,d*jU])});return function(d){var c=new gP(d=a(d));return c.point=function(f,g){d.point(f*h0,g*h0)},c}}function iX(a){return aD(function(){return a})()}function aD(I){function D(a){return a=U(a[0]*h0,a[1]*h0),[a[0]*N+S,K-a[1]*N]}function Q(a){return a=U.invert((a[0]-S)/N,(K-a[1])/N),a&&[a[0]*jU,a[1]*jU]}function F(){U=dF(H=a0(J,k,j),L);var a=L(R,B);return S=O-a[0]*N,K=G+a[1]*N,C()}function C(){return E&&(E.valid=!1,E=null),D}var L,H,U,S,K,E,P=jP(function(b,a){return b=L(b,a),[b[0]*N+S,K-b[1]*N]}),N=150,O=480,G=250,R=0,B=0,J=0,k=0,j=0,q=c4,T=hb,V=null,A=null;return D.stream=function(a){return E&&(E.valid=!1),E=aR(H,q(P(T(a)))),E.valid=!0,E},D.clipAngle=function(a){return arguments.length?(q=null==a?(V=a,c4):cI((V=+a)*h0),C()):V},D.clipExtent=function(a){return arguments.length?(A=a,T=a?bz(a[0][0],a[0][1],a[1][0],a[1][1]):hb,C()):A},D.scale=function(a){return arguments.length?(N=+a,F()):N},D.translate=function(a){return arguments.length?(O=+a[0],G=+a[1],F()):[O,G]},D.center=function(a){return arguments.length?(R=a[0]%360*h0,B=a[1]%360*h0,F()):[R*jU,B*jU]},D.rotate=function(a){return arguments.length?(J=a[0]%360*h0,k=a[1]%360*h0,j=a.length>2?a[2]%360*h0:0,F()):[J*jU,k*jU,j*jU]},a5.rebind(D,P,"precision"),function(){return L=I.apply(this,arguments),D.invert=L.invert&&Q,F()}}function aR(c,a){var b=new gP(a);return b.point=function(f,d){d=c(f*h0,d*h0),f=d[0],a.point(f>bV?f-2*bV:-bV>f?f+2*bV:f,d[1])},b}function eR(b,a){return[b,a]}function a0(c,a,b){return c?a||b?dF(cw(c),gx(a,b)):cw(c):a||b?gx(a,b):eR}function e4(a){return function(b,c){return b+=a,[b>bV?b-2*bV:-bV>b?b+2*bV:b,c]}}function cw(b){var a=e4(b);return a.invert=e4(-b),a}function gx(h,c){function f(q,k){var o=Math.cos(k),j=Math.cos(q)*o,p=Math.sin(q)*o,i=Math.sin(k),m=i*d+j*a;return[Math.atan2(p*b-m*g,j*d-i*a),iI(m*b+p*g)]}var d=Math.cos(h),a=Math.sin(h),b=Math.cos(c),g=Math.sin(c);return f.invert=function(q,k){var o=Math.cos(k),j=Math.cos(q)*o,p=Math.sin(q)*o,i=Math.sin(k),m=i*b-p*g;return[Math.atan2(p*b+i*g,j*d+m*a),iI(m*d-j*a)]},f}function cY(d,a){var c=Math.cos(d),b=Math.sin(d);return function(g,h,k,f){var m=k*a;null!=g?(g=ez(c,g),h=ez(c,h),(k>0?h>g:g>h)&&(g+=2*k*bV)):(g=d+2*k*bV,h=d-0.5*m);for(var e,j=g;k>0?j>h:h>j;j-=m){f.point((e=fH([c,-b*Math.cos(j),-b*Math.sin(j)]))[0],e[1])}}}function ez(d,a){var c=bA(a);c[0]-=d,ax(c);var b=iH(-c[1]);return((-c[2]<0?-b:b)+2*Math.PI-dP)%(2*Math.PI)}function jp(d,a,c){var b=a5.range(d,a-dP,c).concat(a);return function(e){return b.map(function(f){return[e,f]})}}function bH(d,a,c){var b=a5.range(d,a-dP,c).concat(a);return function(e){return b.map(function(f){return[f,e]})}}function bm(a){return a.source}function fs(a){return a.target}function g6(k,G,C,b){var F=Math.cos(G),q=Math.sin(G),j=Math.cos(b),E=Math.sin(b),D=F*Math.cos(k),m=F*Math.sin(k),H=j*Math.cos(C),B=j*Math.sin(C),v=2*Math.asin(Math.sqrt(iA(b-G)+F*j*iA(C-k))),A=1/Math.sin(v),d=v?function(i){var c=Math.sin(i*=v)*A,g=Math.sin(v-i)*A,f=g*D+c*H,a=g*m+c*B,h=g*q+c*E;return[Math.atan2(a,f)*jU,Math.atan2(h,Math.sqrt(f*f+a*a))*jU]}:function(){return[k*jU,G*jU]};return d.distance=v,d}function jG(){function d(k,f){var g=Math.sin(f*=h0),h=Math.cos(f),e=Math.abs((k*=h0)-a),j=Math.cos(e);bB+=Math.atan2(Math.sqrt((e=h*Math.sin(e))*e+(e=b*g-c*h*j)*e),c*g+b*h*j),a=k,c=g,b=h}var a,c,b;fM.point=function(e,f){a=e*h0,c=Math.sin(f*=h0),b=Math.cos(f),fM.point=d},fM.lineEnd=function(){fM.point=fM.lineEnd=h8}}function aI(c,a){function b(g,j){var h=Math.cos(g),d=Math.cos(j),f=c(h*d);return[f*d*Math.sin(g),f*Math.sin(j)]}return b.invert=function(k,h){var g=Math.sqrt(k*k+h*h),d=a(g),f=Math.sin(d),j=Math.cos(d);return[Math.atan2(k*f,g*j),Math.asin(g&&h*f/g)]},b}function fP(h,c){function f(k,i){var j=Math.abs(Math.abs(i)-bV/2)<dP?0:g/Math.pow(a(i),b);return[j*Math.sin(b*k),g-j*Math.cos(b*k)]}var d=Math.cos(h),a=function(e){return Math.tan(bV/4+e/2)},b=h===c?Math.sin(h):Math.log(d/Math.cos(c))/Math.log(a(c)/a(h)),g=d*Math.pow(a(h),b)/b;return b?(f.invert=function(l,i){var k=g-i,j=iY(b)*Math.sqrt(l*l+k*k);return[Math.atan2(l,k)/b,2*Math.atan(Math.pow(g/j,1/b))-bV/2]},f):e8}function f6(g,c){function f(j,h){var i=b-h;return[i*Math.sin(a*j),b-i*Math.cos(a*j)]}var d=Math.cos(g),a=g===c?Math.sin(g):(d-Math.cos(c))/(c-g),b=d/a+g;return Math.abs(a)<dP?eR:(f.invert=function(j,h){var i=b-h;return[Math.atan2(j,i)/a,b-iY(a)*Math.sqrt(j*j+i*i)]},f)}function e8(b,a){return[b,Math.log(Math.tan(bV/4+a/2))]}function cM(g){var c,f=iX(g),d=f.scale,a=f.translate,b=f.clipExtent;return f.scale=function(){var e=d.apply(f,arguments);return e===f?c?f.clipExtent(null):f:e},f.translate=function(){var e=a.apply(f,arguments);return e===f?c?f.clipExtent(null):f:e},f.clipExtent=function(j){var h=b.apply(f,arguments);if(h===f){if(c=null==j){var e=bV*d(),i=a();b([[i[0]-e,i[1]-e],[i[0]+e,i[1]+e]])}}else{c&&(h=null)}return h},f.clipExtent(null)}function i8(c,a){var b=Math.cos(a)*Math.sin(c);return[Math.log((1+b)/(1-b))/2,Math.atan2(Math.tan(a),Math.cos(c))]}function d9(k){function f(u){function e(){i.push("M",d(k(v),b))}for(var r,i=[],v=[],q=-1,m=u.length,n=c6(h),a=c6(g);++q<m;){c.call(this,r=u[q],q)?v.push([+n.call(this,r,q),+a.call(this,r,q)]):v.length&&(e(),v=[])}return v.length&&e(),i.length?i.join(""):null}var h=dK,g=cn,c=b6,d=c2,j=d.key,b=0.7;return f.x=function(a){return arguments.length?(h=a,f):h},f.y=function(a){return arguments.length?(g=a,f):g},f.defined=function(a){return arguments.length?(c=a,f):c},f.interpolate=function(a){return arguments.length?(j="function"==typeof a?d=a:(d=gM.get(a)||c2).key,f):j},f.tension=function(a){return arguments.length?(b=a,f):b},f}function dK(a){return a[0]}function cn(a){return a[1]}function c2(a){return a.join("L")}function bY(a){return c2(a)+"Z"}function dX(f){for(var b=0,d=f.length,c=f[0],a=[c[0],",",c[1]];++b<d;){a.push("H",(c[0]+(c=f[b])[0])/2,"V",c[1])}return d>1&&a.push("H",c[0]),a.join("")}function dp(f){for(var b=0,d=f.length,c=f[0],a=[c[0],",",c[1]];++b<d;){a.push("V",(c=f[b])[1],"H",c[0])}return a.join("")}function ij(f){for(var b=0,d=f.length,c=f[0],a=[c[0],",",c[1]];++b<d;){a.push("H",(c=f[b])[0],"V",c[1])}return a.join("")}function jX(b,a){return b.length<4?c2(b):b[1]+dS(b.slice(1,b.length-1),bK(b,a))}function hw(b,a){return b.length<3?c2(b):b[0]+dS((b.push(b[0]),b),bK([b[b.length-2]].concat(b,[b[1]]),a))}function fy(b,a){return b.length<3?c2(b):b[0]+dS(b,bK(b,a))}function dS(f,q){if(q.length<1||f.length!=q.length&&f.length!=q.length+2){return c2(f)}var j=f.length!=q.length,b="",p=f[0],h=f[1],d=q[0],m=d,k=1;if(j&&(b+="Q"+(h[0]-2*d[0]/3)+","+(h[1]-2*d[1]/3)+","+h[0]+","+h[1],p=f[1],k=2),q.length>1){m=q[1],h=f[k],k++,b+="C"+(p[0]+d[0])+","+(p[1]+d[1])+","+(h[0]-m[0])+","+(h[1]-m[1])+","+h[0]+","+h[1];for(var g=2;g<q.length;g++,k++){h=f[k],m=q[g],b+="S"+(h[0]-m[0])+","+(h[1]-m[1])+","+h[0]+","+h[1]}}if(j){var v=f[k];b+="Q"+(h[0]+2*m[0]/3)+","+(h[1]+2*m[1]/3)+","+v[0]+","+v[1]}return b}function bK(f,m){for(var h,b=[],l=(1-m)/2,g=f[0],d=f[1],k=1,j=f.length;++k<j;){h=g,g=d,d=f[k],b.push([l*(d[0]-h[0]),l*(d[1]-h[1])])}return b}function gU(f){if(f.length<3){return c2(f)}var m=1,h=f.length,b=f[0],l=b[0],g=b[1],d=[l,l,l,(b=f[1])[0]],k=[g,g,g,b[1]],j=[l,",",g,"L",dx(dk,d),",",dx(dk,k)];for(f.push(f[h-1]);++m<=h;){b=f[m],d.shift(),d.push(b[0]),k.shift(),k.push(b[1]),jk(j,d,k)}return f.pop(),j.push("L",b),j.join("")}function cz(h){if(h.length<4){return c2(h)}for(var c,f=[],d=-1,a=h.length,b=[0],g=[0];++d<3;){c=h[d],b.push(c[0]),g.push(c[1])}for(f.push(dx(dk,b)+","+dx(dk,g)),--d;++d<a;){c=h[d],b.shift(),b.push(c[0]),g.shift(),g.push(c[1]),jk(f,b,g)}return f.join("")}function bq(k){for(var f,h,g=-1,c=k.length,d=c+4,j=[],b=[];++g<4;){h=k[g%c],j.push(h[0]),b.push(h[1])}for(f=[dx(dk,j),",",dx(dk,b)],--g;++g<d;){h=k[g%c],j.shift(),j.push(h[0]),b.shift(),b.push(h[1]),jk(f,j,b)}return f.join("")}function fD(f,q){var j=f.length-1;if(j){for(var b,p,h=f[0][0],d=f[0][1],m=f[j][0]-h,k=f[j][1]-d,g=-1;++g<=j;){b=f[g],p=g/j,b[0]=q*b[0]+(1-q)*(h+p*m),b[1]=q*b[1]+(1-q)*(d+p*k)}}return gU(f)}function dx(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]*a[3]}function jk(c,a,b){c.push("C",dx(f3,a),",",dx(f3,b),",",dx(gs,a),",",dx(gs,b),",",dx(dk,a),",",dx(dk,b))}function hJ(b,a){return(a[1]-b[1])/(a[0]-b[0])}function eE(h){for(var c=0,f=h.length-1,d=[],a=h[0],b=h[1],g=d[0]=hJ(a,b);++c<f;){d[c]=(g+(g=hJ(a=b,b=h[c+1])))/2}return d[c]=g,d}function b1(f){for(var m,h,b,l,g=[],d=eE(f),k=-1,j=f.length-1;++k<j;){m=hJ(f[k],f[k+1]),Math.abs(m)<0.000001?d[k]=d[k+1]=0:(h=d[k]/m,b=d[k+1]/m,l=h*h+b*b,l>9&&(l=3*m/Math.sqrt(l),d[k]=l*h,d[k+1]=l*b))}for(k=-1;++k<=j;){l=(f[Math.min(j,k+1)][0]-f[Math.max(0,k-1)][0])/(6*(1+d[k]*d[k])),g.push([l||0,d[k]*l||0])}return g}function gC(a){return a.length<3?c2(a):a[0]+dS(a,b1(a))}function fU(f,q,j,b){var p,h,d,m,k,g,v;return p=b[f],h=p[0],d=p[1],p=b[q],m=p[0],k=p[1],p=b[j],g=p[0],v=p[1],(v-d)*(m-h)-(k-d)*(g-h)>0}function gd(c,a,b){return(b[0]-a[0])*(c[1]-a[1])<(b[1]-a[1])*(c[0]-a[0])}function c7(g,C,q,b){var B=g[0],k=q[0],d=C[0]-B,A=b[0]-k,v=g[1],j=q[1],D=C[1]-v,p=b[1]-j,m=(A*(v-j)-p*(B-k))/(p*d-A*D);return[B+m*d,v+m*D]}function hd(c){var a=c[0],b=c[c.length-1];return !(a[0]-b[0]||a[1]-b[1])}function a3(F,A){var N={list:F.map(function(c,a){return{index:a,x:c[0],y:c[1]}}).sort(function(c,a){return c.y<a.y?-1:c.y>a.y?1:c.x<a.x?-1:c.x>a.x?1:0}),bottomSite:null},C={list:[],leftEnd:null,rightEnd:null,init:function(){C.leftEnd=C.createHalfEdge(null,"l"),C.rightEnd=C.createHalfEdge(null,"l"),C.leftEnd.r=C.rightEnd,C.rightEnd.l=C.leftEnd,C.list.unshift(C.leftEnd,C.rightEnd)},createHalfEdge:function(c,a){return{edge:c,side:a,vertex:null,l:null,r:null}},insert:function(c,a){a.l=c,a.r=c.r,c.r.l=a,c.r=a},leftBound:function(c){var a=C.leftEnd;do{a=a.r}while(a!=C.rightEnd&&q.rightOf(a,c));return a=a.l},del:function(a){a.l.r=a.r,a.r.l=a.l,a.edge=null},right:function(a){return a.r},left:function(a){return a.l},leftRegion:function(a){return null==a.edge?N.bottomSite:a.edge.region[a.side]},rightRegion:function(a){return null==a.edge?N.bottomSite:a.edge.region[bd[a.side]]}},q={bisect:function(l,d){var g={region:{l:l,r:d},ep:{l:null,r:null}},f=d.x-l.x,a=d.y-l.y,c=f>0?f:-f,h=a>0?a:-a;return g.c=l.x*f+l.y*a+0.5*(f*f+a*a),c>h?(g.a=1,g.b=a/f,g.c/=f):(g.b=1,g.a=f/a,g.c/=a),g},intersect:function(h,V){var R=h.edge,d=V.edge;if(!R||!d||R.region.r==d.region.r){return null}var U=R.a*d.b-R.b*d.a;if(Math.abs(U)<1e-10){return null}var p,g,T=(R.c*d.b-d.c*R.b)/U,S=(d.c*R.a-R.c*d.a)/U,m=R.region.r,W=d.region.r;m.y<W.y||m.y==W.y&&m.x<W.x?(p=h,g=R):(p=V,g=d);var v=T>=g.region.r.x;return v&&"l"===p.side||!v&&"r"===p.side?null:{x:T,y:S}},rightOf:function(p,Z){var V=p.edge,d=V.region.r,Y=Z.x>d.x;if(Y&&"l"===p.side){return 1}if(!Y&&"r"===p.side){return 0}if(1===V.a){var R=Z.y-d.y,m=Z.x-d.x,X=0,W=0;if(!Y&&V.b<0||Y&&V.b>=0?W=X=R>=V.b*m:(W=Z.x+Z.y*V.b>V.c,V.b<0&&(W=!W),W||(X=1)),!X){var v=d.x-V.region.l.x;W=V.b*(m*m-R*R)<v*R*(1+2*m/v+V.b*V.b),V.b<0&&(W=!W)}}else{var aa=V.c-V.a*Z.x,U=Z.y-aa,S=Z.x-d.x,T=aa-d.y;W=U*U>S*S+T*T}return"l"===p.side?W:!W},endPoint:function(d,c,a){d.ep[c]=a,d.ep[bd[c]]&&A(d)},distance:function(f,a){var d=f.x-a.x,c=f.y-a.y;return Math.sqrt(d*d+c*c)}},I={list:[],insert:function(l,f,h){l.vertex=f,l.ystar=f.y+h;for(var g=0,d=I.list,i=d.length;i>g;g++){var c=d[g];if(!(l.ystar>c.ystar||l.ystar==c.ystar&&f.x>c.vertex.x)){break}}d.splice(g,0,l)},del:function(f){for(var a=0,d=I.list,c=d.length;c>a&&d[a]!=f;++a){}d.splice(a,1)},empty:function(){return 0===I.list.length},nextEvent:function(f){for(var a=0,d=I.list,c=d.length;c>a;++a){if(d[a]==f){return d[a+1]}}return null},min:function(){var a=I.list[0];return{x:a.vertex.x,y:a.ystar}},extractMin:function(){return I.list.shift()}};C.init(),N.bottomSite=N.list.shift();for(var E,Q,P,H,B,L,J,K,D,O,k,G,j,b=N.list.shift();;){if(I.empty()||(E=I.min()),b&&(I.empty()||b.y<E.y||b.y==E.y&&b.x<E.x)){Q=C.leftBound(b),P=C.right(Q),J=C.rightRegion(Q),G=q.bisect(J,b),L=C.createHalfEdge(G,"l"),C.insert(Q,L),O=q.intersect(Q,L),O&&(I.del(Q),I.insert(Q,O,q.distance(O,b))),Q=L,L=C.createHalfEdge(G,"r"),C.insert(Q,L),O=q.intersect(L,P),O&&I.insert(L,O,q.distance(O,b)),b=N.list.shift()}else{if(I.empty()){break}Q=I.extractMin(),H=C.left(Q),P=C.right(Q),B=C.right(P),J=C.leftRegion(Q),K=C.rightRegion(P),k=Q.vertex,q.endPoint(Q.edge,Q.side,k),q.endPoint(P.edge,P.side,k),C.del(Q),I.del(P),C.del(P),j="l",J.y>K.y&&(D=J,J=K,K=D,j="r"),G=q.bisect(J,K),L=C.createHalfEdge(G,j),C.insert(H,L),q.endPoint(G,bd[j],k),O=q.intersect(H,L),O&&(I.del(H),I.insert(H,O,q.distance(O,J))),O=q.intersect(L,B),O&&I.insert(L,O,q.distance(O,J))}}for(Q=C.right(C.leftEnd);Q!=C.rightEnd;Q=C.right(Q)){A(Q.edge)}}function eh(a){return a.x}function jJ(a){return a.y}function gH(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function ad(f,m,h,b,l,g){if(!f(m,h,b,l,g)){var d=0.5*(h+l),k=0.5*(b+g),j=m.nodes;j[0]&&ad(f,j[0],h,b,d,k),j[1]&&ad(f,j[1],d,b,l,k),j[2]&&ad(f,j[2],h,k,d,g),j[3]&&ad(f,j[3],d,k,l,g)}}function iC(k,f){k=a5.rgb(k),f=a5.rgb(f);var h=k.r,g=k.g,c=k.b,d=f.r-h,j=f.g-g,b=f.b-c;return function(a){return"#"+hG(Math.round(h+d*a))+hG(Math.round(g+j*a))+hG(Math.round(c+b*a))}}function am(f,b){var d,c={},a={};for(d in f){d in b?c[d]=aU(f[d],b[d]):a[d]=f[d]}for(d in b){d in f||(a[d]=b[d])}return function(e){for(d in c){a[d]=c[d](e)}return a}}function aL(b,a){return a-=b=+b,function(c){return b+a*c}}function eJ(f,q){var j,b,p,h,d,m=0,k=0,g=[],v=[];for(f+="",q+="",ew.lastIndex=0,b=0;j=ew.exec(q);++b){j.index&&g.push(q.substring(m,k=j.index)),v.push({i:g.length,x:j[0]}),g.push(null),m=ew.lastIndex}for(m<q.length&&g.push(q.substring(m)),b=0,h=v.length;(j=ew.exec(f))&&h>b;++b){if(d=v[b],d.x==j[0]){if(d.i){if(null==g[d.i+1]){for(g[d.i-1]+=d.x,g.splice(d.i,1),p=b+1;h>p;++p){v[p].i--}}else{for(g[d.i-1]+=d.x+g[d.i+1],g.splice(d.i,2),p=b+1;h>p;++p){v[p].i-=2}}}else{if(null==g[d.i+1]){g[d.i]=d.x}else{for(g[d.i]=d.x+g[d.i+1],g.splice(d.i+1,1),p=b+1;h>p;++p){v[p].i--}}}v.splice(b,1),h--,b--}else{d.x=aL(parseFloat(j[0]),parseFloat(d.x))}}for(;h>b;){d=v.pop(),null==g[d.i+1]?g[d.i]=d.x:(g[d.i]=d.x+g[d.i+1],g.splice(d.i+1,1)),h--}return 1===g.length?null==g[0]?(d=v[0].x,function(a){return d(a)+""}):function(){return q}:function(a){for(b=0;h>b;++b){g[(d=v[b]).i]=d.x(a)}return g.join("")}}function aU(d,a){for(var c,b=a5.interpolators.length;--b>=0&&!(c=a5.interpolators[b](d,a));){}return c}function eW(k,f){var h,g=[],c=[],d=k.length,j=f.length,b=Math.min(k.length,f.length);for(h=0;b>h;++h){g.push(aU(k[h],f[h]))}for(;d>h;++h){c[h]=k[h]}for(;j>h;++h){c[h]=f[h]}return function(a){for(h=0;b>h;++h){c[h]=g[h](a)}return c}}function ch(a){return function(b){return 0>=b?0:b>=1?1:a(b)}}function gm(a){return function(b){return 1-a(1-b)}}function cR(a){return function(b){return 0.5*(0.5>b?a(2*b):2-a(2-2*b))}}function ep(a){return a*a}function jd(a){return a*a*a}function bC(c){if(0>=c){return 0}if(c>=1){return 1}var a=c*c,b=a*c;return 4*(0.5>c?b:3*(c-a)+b-0.75)}function bf(a){return function(b){return Math.pow(b,a)}}function fh(a){return 1-Math.cos(a*bV/2)}function gZ(a){return Math.pow(2,10*(a-1))}function jw(a){return 1-Math.sqrt(1-a*a)}function az(c,a){var b;return arguments.length<2&&(a=0.45),arguments.length?b=a/(2*bV)*Math.asin(1/c):(c=1,b=a/4),function(d){return 1+c*Math.pow(2,10*-d)*Math.sin(2*(d-b)*bV/a)}}function fI(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function fZ(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+0.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375}function e1(k,f){k=a5.hcl(k),f=a5.hcl(f);var h=k.h,g=k.c,c=k.l,d=f.h-h,j=f.c-g,b=f.l-c;return isNaN(j)&&(j=0,g=isNaN(g)?f.c:g),isNaN(d)?(d=0,h=isNaN(h)?f.h:h):d>180?d-=360:-180>d&&(d+=360),function(a){return iS(h+d*a,g+j*a,c+b*a)+""}}function cF(k,f){k=a5.hsl(k),f=a5.hsl(f);var h=k.h,g=k.s,c=k.l,d=f.h-h,j=f.s-g,b=f.l-c;return isNaN(j)&&(j=0,g=isNaN(g)?f.s:g),isNaN(d)?(d=0,h=isNaN(h)?f.h:h):d>180?d-=360:-180>d&&(d+=360),function(a){return i5(h+d*a,g+j*a,c+b*a)+""}}function iP(k,f){k=a5.lab(k),f=a5.lab(f);var h=k.l,g=k.a,c=k.b,d=f.l-h,j=f.a-g,b=f.b-c;return function(a){return iG(h+d*a,g+j*a,c+b*a)+""}}function d0(b,a){return a-=b,function(c){return Math.round(b+a*c)}}function dC(g){var c=[g.a,g.b],f=[g.c,g.d],d=cV(c),a=b7(c,f),b=cV(bT(f,c,-a))||0;c[0]*f[1]<f[0]*c[1]&&(c[0]*=-1,c[1]*=-1,d*=-1,a*=-1),this.rotate=(d?Math.atan2(c[1],c[0]):Math.atan2(-f[0],f[1]))*jU,this.translate=[g.e,g.f],this.scale=[d,b],this.skew=b?Math.atan2(a,b)*jU:0}function b7(b,a){return b[0]*a[0]+b[1]*a[1]}function cV(b){var a=Math.sqrt(b7(b,b));return a&&(b[0]/=a,b[1]/=a),a}function bT(c,a,b){return c[0]+=b*a[0],c[1]+=b*a[1],c}function dN(k,G){var C,b=[],F=[],q=a5.transform(k),j=a5.transform(G),E=q.translate,D=j.translate,m=q.rotate,H=j.rotate,B=q.skew,v=j.skew,A=q.scale,d=j.scale;return E[0]!=D[0]||E[1]!=D[1]?(b.push("translate(",null,",",null,")"),F.push({i:1,x:aL(E[0],D[0])},{i:3,x:aL(E[1],D[1])})):D[0]||D[1]?b.push("translate("+D+")"):b.push(""),m!=H?(m-H>180?H+=360:H-m>180&&(m+=360),F.push({i:b.push(b.pop()+"rotate(",null,")")-2,x:aL(m,H)})):H&&b.push(b.pop()+"rotate("+H+")"),B!=v?F.push({i:b.push(b.pop()+"skewX(",null,")")-2,x:aL(B,v)}):v&&b.push(b.pop()+"skewX("+v+")"),A[0]!=d[0]||A[1]!=d[1]?(C=b.push(b.pop()+"scale(",null,",",null,")"),F.push({i:C-4,x:aL(A[0],d[0])},{i:C-2,x:aL(A[1],d[1])})):(1!=d[0]||1!=d[1])&&b.push(b.pop()+"scale("+d+")"),C=F.length,function(e){for(var c,a=-1;++a<C;){b[(c=F[a]).i]=c.x(e)}return b.join("")}}function df(b,a){return a=a-(b=+b)?1/(a-b):0,function(c){return(c-b)*a}}function hW(b,a){return a=a-(b=+b)?1/(a-b):0,function(c){return Math.max(0,Math.min(1,(c-b)*a))}}function jS(g){for(var c=g.source,f=g.target,d=fn(c,f),a=[c];c!==d;){c=c.parent,a.push(c)}for(var b=a.length;f!==d;){a.splice(b,0,f),f=f.parent}return a}function hk(c){for(var a=[],b=c.parent;null!=b;){a.push(c),c=b,b=b.parent}return a.push(c),a}function fn(h,c){if(h===c){return h}for(var f=hk(h),d=hk(c),a=f.pop(),b=d.pop(),g=null;a===b;){g=a,a=f.pop(),b=d.pop()}return g}function dQ(a){a.fixed|=2}function bG(a){a.fixed&=-7}function gS(a){a.fixed|=4,a.px=a.x,a.py=a.y}function cv(a){a.fixed&=-5}function bk(f,q,j){var b=0,p=0;if(f.charge=0,!f.leaf){for(var h,d=f.nodes,m=d.length,k=-1;++k<m;){h=d[k],null!=h&&(bk(h,q,j),f.charge+=h.charge,b+=h.charge*h.cx,p+=h.charge*h.cy)}}if(f.point){f.leaf||(f.point.x+=Math.random()-0.5,f.point.y+=Math.random()-0.5);var g=q*j[f.point.index];f.charge+=f.pointCharge=g,b+=g*f.point.x,p+=g*f.point.y}f.cx=b/f.charge,f.cy=p/f.charge}function fB(b,a){return a5.rebind(b,a,"sort","children","value"),b.nodes=b,b.links=eC,b}function dv(a){return a.children}function jh(a){return a.value}function hE(b,a){return a.value-b.value}function eC(a){return a5.merge(a.map(function(b){return(b.children||[]).map(function(c){return{source:b,target:c}})}))}function bX(a){return a.x}function gA(a){return a.y}function fS(c,a,b){c.y0=a,c.y=b}function f9(a){return a5.range(a.length)}function c5(d){for(var a=-1,c=d[0].length,b=[];++a<c;){b[a]=0}return b}function g9(g){for(var c,f=1,d=0,a=g[0][1],b=g.length;b>f;++f){(c=g[f][1])>a&&(d=f,a=c)}return d}function aZ(a){return a.reduce(ef,0)}function ef(b,a){return b+a[1]}function jF(b,a){return gE(b,Math.ceil(Math.log(a.length)/Math.LN2+1))}function gE(g,c){for(var f=-1,d=+g[0],a=(g[1]-d)/c,b=[];++f<=c;){b[f]=a*f+d}return b}function jW(a){return[a5.min(a),a5.max(a)]}function ix(b,a){return b.parent==a.parent?1:2}function ah(b){var a=b.children;return a&&a.length?a[0]:b._tree.thread}function aH(c){var a,b=c.children;return b&&(a=b.length)?b[a-1]:c._tree.thread}function eG(g,c){var f=g.children;if(f&&(a=f.length)){for(var d,a,b=-1;++b<a;){c(d=eG(f[b],c),g)>0&&(g=d)}}return g}function aQ(b,a){return b.x-a.x}function eU(b,a){return a.x-b.x}function cb(b,a){return b.depth-a.depth}function gh(c,a){function b(k,g){var e=k.children;if(e&&(h=e.length)){for(var f,h,d=null,j=-1;++j<h;){f=e[j],b(f,d),d=f}}a(k,g)}b(c,null)}function cP(g){for(var c,f=0,d=0,a=g.children,b=a.length;--b>=0;){c=a[b]._tree,c.prelim+=f,c.mod+=f,f+=c.shift+(d+=c.change)}}function ek(d,a,c){d=d._tree,a=a._tree;var b=c/(a.number-d.number);d.change+=b,a.change-=b,a.shift+=c,a.prelim+=c,a.mod+=c}function i7(c,a,b){return c._tree.ancestor.parent==a.parent?c._tree.ancestor:b}function by(b,a){return b.value-a.value}function a8(c,a){var b=c._pack_next;c._pack_next=a,a._pack_prev=c,a._pack_next=b,b._pack_prev=a}function fd(b,a){b._pack_next=a,a._pack_prev=b}function gW(f,b){var d=b.x-f.x,c=b.y-f.y,a=f.r+b.r;return 0.999*a*a>d*d+c*c}function jn(F){function A(a){B=Math.min(a.x-a.r,B),L=Math.max(a.x+a.r,L),J=Math.min(a.y-a.r,J),K=Math.max(a.y+a.r,K)}if((N=F.children)&&(H=N.length)){var N,C,q,I,E,Q,P,H,B=1/0,L=-1/0,J=1/0,K=-1/0;if(N.forEach(aq),C=N[0],C.x=-C.r,C.y=0,A(C),H>1&&(q=N[1],q.x=q.r,q.y=0,A(q),H>2)){for(I=N[2],eY(C,q,I),A(I),a8(C,I),C._pack_prev=I,a8(I,q),q=C._pack_next,E=3;H>E;E++){eY(C,q,I=N[E]);var D=0,O=1,k=1;for(Q=q._pack_next;Q!==q;Q=Q._pack_next,O++){if(gW(Q,I)){D=1;break}}if(1==D){for(P=C._pack_prev;P!==Q._pack_prev&&!gW(P,I);P=P._pack_prev,k++){}}D?(k>O||O==k&&q.r<C.r?fd(C,q=Q):fd(C=P,q),E--):(a8(C,I),q=I,A(I))}}var G=(B+L)/2,j=(J+K)/2,b=0;for(E=0;H>E;E++){I=N[E],I.x-=G,I.y-=j,b=Math.max(b,I.r+Math.sqrt(I.x*I.x+I.y*I.y))}F.r=b,N.forEach(fF)}}function aq(a){a._pack_next=a._pack_prev=a}function fF(a){delete a._pack_next,delete a._pack_prev}function fW(h,c,f,d){var a=h.children;if(h.x=c+=d*h.x,h.y=f+=d*h.y,h.r*=d,a){for(var b=-1,g=a.length;++b<g;){fW(a[b],c,f,d)}}}function eY(f,q,j){var b=f.r+j.r,p=q.x-f.x,h=q.y-f.y;if(b&&(p||h)){var d=q.r+j.r,m=p*p+h*h;d*=d,b*=b;var k=0.5+(b-d)/(2*m),g=Math.sqrt(Math.max(0,2*d*(b+m)-(b-=m)*b-d*d))/(2*m);j.x=f.x+k*p+g*h,j.y=f.y+k*h-g*p}else{j.x=f.x+b,j.y=f.y}}function cC(a){return 1+a5.max(a,function(b){return b.y})}function iJ(a){return a.reduce(function(c,b){return c+b.x},0)/a.length}function dV(b){var a=b.children;return a&&a.length?dV(a[0]):b}function dz(c){var a,b=c.children;return b&&(a=b.length)?dz(b[a-1]):c}function b4(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function cT(g,c){var f=g.x+c[3],d=g.y+c[0],a=g.dx-c[1]-c[3],b=g.dy-c[0]-c[2];return 0>a&&(f+=a/2,a=0),0>b&&(d+=b/2,b=0),{x:f,y:d,dx:a,dy:b}}function bP(c){var a=c[0],b=c[c.length-1];return b>a?[a,b]:[b,a]}function dJ(a){return a.rangeExtent?a.rangeExtent():bP(a.range())}function c9(g,c,f,d){var a=f(g[0],g[1]),b=d(c[0],c[1]);return function(e){return b(a(e))}}function hQ(h,c){var f,d=0,a=h.length-1,b=h[d],g=h[a];return b>g&&(f=d,d=a,a=f,f=b,b=g,g=f),h[d]=c.floor(b),h[a]=c.ceil(g),h}function jO(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:cy}function hf(k,f,h,g){var c=[],d=[],j=0,b=Math.min(k.length,f.length)-1;for(k[b]<k[0]&&(k=k.slice().reverse(),f=f.slice().reverse());++j<=b;){c.push(h(k[j-1],k[j])),d.push(g(f[j-1],f[j]))}return function(a){var i=a5.bisect(k,a,1,b)-1;return d[i](c[i](a))}}function fk(k,f,h,g){function c(){var a=Math.min(k.length,f.length)>2?hf:c9,e=g?hW:df;return j=a(k,f,e,h),b=a(f,k,e,aU),d}function d(a){return j(a)}var j,b;return d.invert=function(a){return b(a)},d.domain=function(a){return arguments.length?(k=a.map(Number),c()):k},d.range=function(a){return arguments.length?(f=a,c()):f},d.rangeRound=function(a){return d.range(a).interpolate(d0)},d.clamp=function(a){return arguments.length?(g=a,c()):g},d.interpolate=function(a){return arguments.length?(h=a,c()):h},d.ticks=function(a){return cG(k,a)},d.tickFormat=function(a,i){return bx(k,a,i)},d.nice=function(a){return bO(k,a),c()},d.copy=function(){return fk(k,f,h,g)},c()}function d1(b,a){return a5.rebind(b,a,"range","rangeRound","interpolate","clamp")}function bO(b,a){return hQ(b,jO(g0(b,a)[2]))}function g0(g,c){null==c&&(c=10);var f=bP(g),d=f[1]-f[0],a=Math.pow(10,Math.floor(Math.log(d/c)/Math.LN10)),b=c/d*a;return 0.15>=b?a*=10:0.35>=b?a*=5:0.75>=b&&(a*=2),f[0]=Math.ceil(f[0]/a)*a,f[1]=Math.floor(f[1]/a)*a+0.5*a,f[2]=a,f}function cG(b,a){return a5.range.apply(a5,g0(b,a))}function bx(d,a,c){var b=-Math.floor(Math.log(g0(d,a)[2])/Math.LN10+0.01);return a5.format(c?c.replace(eT,function(g,r,k,q,j,f,p,m,h,v){return[r,k,q,j,f,p,m,h||"."+(b-2*("%"===v)),v].join("")}):",."+b+"f")}function fJ(h,c,f,d){function a(e){return(f?Math.log(0>e?0:e):-Math.log(e>0?0:-e))/Math.log(c)}function b(e){return f?Math.pow(c,e):-Math.pow(c,-e)}function g(e){return h(a(e))}return g.invert=function(e){return b(h.invert(e))},g.domain=function(e){return arguments.length?(f=e[0]>=0,h.domain((d=e.map(Number)).map(a)),g):d},g.base=function(i){return arguments.length?(c=+i,h.domain(d.map(a)),g):c},g.nice=function(){var e=hQ(d.map(a),f?Math:cZ);return h.domain(e),d=e.map(b),g},g.ticks=function(){var r=bP(d),p=[],i=r[0],q=r[1],e=Math.floor(a(i)),k=Math.ceil(a(q)),m=c%1?2:c;if(isFinite(k-e)){if(f){for(;k>e;e++){for(var j=1;m>j;j++){p.push(b(e)*j)}}p.push(b(e))}else{for(p.push(b(e));e++<k;){for(var j=m-1;j>0;j--){p.push(b(e)*j)}}}for(e=0;p[e]<i;e++){}for(k=p.length;p[k-1]>q;k--){}p=p.slice(e,k)}return p},g.tickFormat=function(l,i){if(!arguments.length){return gy}arguments.length<2?i=gy:"function"!=typeof i&&(i=a5.format(i));var j,e=Math.max(0.1,l/g.ticks().length),k=f?(j=1e-12,Math.ceil):(j=-1e-12,Math.floor);return function(m){return m/b(k(a(m)+j))<=e?i(m):""}},g.copy=function(){return fJ(h.copy(),c,f,d)},d1(g,h)}function dD(g,c,f){function d(e){return g(a(e))}var a=jy(c),b=jy(1/c);return d.invert=function(e){return b(g.invert(e))},d.domain=function(e){return arguments.length?(g.domain((f=e.map(Number)).map(a)),d):f},d.ticks=function(e){return cG(f,e)},d.tickFormat=function(h,e){return bx(f,h,e)},d.nice=function(e){return d.domain(bO(f,e))},d.exponent=function(e){return arguments.length?(a=jy(c=e),b=jy(1/c),g.domain(f.map(a)),d):c},d.copy=function(){return dD(g.copy(),c,f)},d1(d,g)}function jy(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function hY(j,d){function g(a){return h[((c.get(a)||c.set(a,j.push(a)))-1)%h.length]}function f(a,i){return a5.range(j.length).map(function(e){return a+i*e})}var c,h,b;return g.domain=function(i){if(!arguments.length){return j}j=[],c=new hF;for(var k,e=-1,l=i.length;++e<l;){c.has(k=i[e])||c.set(k,j.push(k))}return g[d.t].apply(g,d.a)},g.range=function(a){return arguments.length?(h=a,b=0,d={t:"range",a:arguments},g):h},g.rangePoints=function(e,k){arguments.length<2&&(k=0);var n=e[0],a=e[1],m=(a-n)/(Math.max(1,j.length-1)+k);return h=f(j.length<2?(n+a)/2:n+m*k/2,m),b=0,d={t:"rangePoints",a:arguments},g},g.rangeBands=function(e,k,p){arguments.length<2&&(k=0),arguments.length<3&&(p=k);var a=e[1]<e[0],n=e[a-0],o=e[1-a],m=(o-n)/(j.length-k+2*p);return h=f(n+m*p,m),a&&h.reverse(),b=m*(1-k),d={t:"rangeBands",a:arguments},g},g.rangeRoundBands=function(e,k,q){arguments.length<2&&(k=0),arguments.length<3&&(q=k);var a=e[1]<e[0],n=e[a-0],p=e[1-a],m=Math.floor((p-n)/(j.length-k+2*q)),o=p-n-(j.length-k)*m;return h=f(n+Math.round(o/2),m),a&&h.reverse(),b=Math.round(m*(1-k)),d={t:"rangeRoundBands",a:arguments},g},g.rangeBand=function(){return b},g.rangeExtent=function(){return bP(d.a[0])},g.copy=function(){return hY(j,d)},g.domain(j)}function eK(f,b){function d(){var h=0,g=b.length;for(a=[];++h<g;){a[h-1]=a5.quantile(f,h/g)}return c}function c(e){return isNaN(e=+e)?void 0:b[a5.bisect(a,e)]}var a;return c.domain=function(e){return arguments.length?(f=e.filter(function(g){return !isNaN(g)}).sort(a5.ascending),d()):f},c.range=function(e){return arguments.length?(b=e,d()):b},c.quantiles=function(){return a},c.invertExtent=function(g){return g=b.indexOf(g),0>g?[0/0,0/0]:[g>0?a[g-1]:f[0],g<a.length?a[g]:f[f.length-1]]},c.copy=function(){return eK(f,b)},d()}function b8(h,c,f){function d(e){return f[Math.max(0,Math.min(g,Math.floor(b*(e-h))))]}function a(){return b=f.length/(c-h),g=f.length-1,d}var b,g;return d.domain=function(i){return arguments.length?(h=+i[0],c=+i[i.length-1],a()):[h,c]},d.range=function(e){return arguments.length?(f=e,a()):f},d.invertExtent=function(e){return e=f.indexOf(e),e=0>e?0/0:e/b+h,[e,e+1/b]},d.copy=function(){return b8(h,c,f)},a()}function gI(c,a){function b(d){return d>=d?a[a5.bisect(c,d)]:void 0}return b.domain=function(d){return arguments.length?(c=d,b):c},b.range=function(d){return arguments.length?(a=d,b):a},b.invertExtent=function(d){return d=a.indexOf(d),[c[d-1],c[d]]},b.copy=function(){return gI(c,a)},b}function f0(b){function a(c){return +c}return a.invert=a,a.domain=a.range=function(c){return arguments.length?(b=c.map(a),a):b},a.ticks=function(c){return cG(b,c)},a.tickFormat=function(c,d){return bx(b,c,d)},a.copy=function(){return f0(b)},a}function gn(a){return a.innerRadius}function dg(a){return a.outerRadius}function hm(a){return a.startAngle}function a7(a){return a.endAngle}function eq(g){for(var c,f,d,a=-1,b=g.length;++a<b;){c=g[a],f=c[0],d=c[1]+fv,c[0]=f*Math.cos(d),c[1]=f*Math.sin(d)}return g}function jN(g){function A(F){function o(){n.push("M",q(g(e),k),B,h(g(E.reverse()),k),"Z")}for(var f,i,a,n=[],E=[],e=[],s=-1,l=F.length,u=c6(m),r=c6(v),D=m===b?function(){return i}:c6(b),C=v===j?function(){return a}:c6(j);++s<l;){d.call(this,f=F[s],s)?(E.push([i=+u.call(this,f,s),a=+r.call(this,f,s)]),e.push([+D.call(this,f,s),+C.call(this,f,s)])):E.length&&(o(),E=[],e=[])}return E.length&&o(),n.length?n.join(""):null}var m=dK,b=dK,v=0,j=cn,d=b6,q=c2,p=q.key,h=q,B="L",k=0.7;return A.x=function(a){return arguments.length?(m=b=a,A):b},A.x0=function(a){return arguments.length?(m=a,A):m},A.x1=function(a){return arguments.length?(b=a,A):b},A.y=function(a){return arguments.length?(v=j=a,A):j},A.y0=function(a){return arguments.length?(v=a,A):v},A.y1=function(a){return arguments.length?(j=a,A):j},A.defined=function(a){return arguments.length?(d=a,A):d},A.interpolate=function(a){return arguments.length?(p="function"==typeof a?q=a:(q=gM.get(a)||c2).key,h=q.reverse||q,B=q.closed?"M":"L",A):p},A.tension=function(a){return arguments.length?(k=a,A):k},A}function gO(a){return a.radius}function an(a){return[a.x,a.y]}function iQ(a){return function(){var b=a.apply(this,arguments),d=b[0],c=b[1]+fv;return[d*Math.cos(c),d*Math.sin(c)]}}function aB(){return 64}function aP(){return"circle"}function eQ(b){var a=Math.sqrt(b/bV);return"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"Z"}function aY(b,a){return fj(b,cN),b.id=a,b}function e2(f,b,d,c){var a=f.id;return iL(f,"function"==typeof d?function(h,e,g){h.__transition__[a].tween.set(b,c(d.call(h,h.__data__,e,g)))}:(d=c(d),function(e){e.__transition__[a].tween.set(b,d)}))}function cs(a){return null==a&&(a=""),function(){this.textContent=a}}function gw(j,d,g,f){var c=j.__transition__||(j.__transition__={active:0,count:0}),h=c[g];if(!h){var b=f.time;h=c[g]={tween:new hF,time:b,ease:f.ease,delay:f.delay,duration:f.duration},++c.count,a5.timer(function(a){function q(l){return c.active>g?i():(c.active=g,h.event&&h.event.start.call(j,t,d),h.tween.forEach(function(s,p){(p=p.call(j,t,d))&&e.push(p)}),o(l)?1:(jY(o,0,b),void 0))}function o(s){if(c.active!==g){return i()}for(var p=(s-k)/m,l=n(p),v=e.length;v>0;){e[--v].call(j,l)}return p>=1?(h.event&&h.event.end.call(j,t,d),i()):void 0}function i(){return --c.count?delete c[g]:delete j.__transition__,1}var t=j.__data__,n=h.ease,k=h.delay,m=h.duration,e=[];return a>=k?q(a):(jY(q,k,b),void 0)},0,b)}}function cW(b,a){b.attr("transform",function(c){return"translate("+a(c)+",0)"})}function ey(b,a){b.attr("transform",function(c){return"translate(0,"+a(c)+")"})}function jl(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function bF(f,m,h){function b(a){var i=f(a),c=g(i,1);return c-a>a-i?i:c}function l(a){return m(a=f(new dZ(a-1)),1),a}function g(c,a){return m(c=new dZ(+c),a),c}function d(s,p,e){var q=l(s),c=[];if(e>1){for(;p>q;){h(q)%e||c.push(new Date(+q)),m(q,1)}}else{for(;p>q;){c.push(new Date(+q)),m(q,1)}}return c}function k(o,a,i){try{dZ=jl;var c=new jl;return c._=o,d(c,a,i)}finally{dZ=Date}}f.floor=f,f.round=b,f.ceil=l,f.offset=g,f.range=d;var j=f.utc=bj(f);return j.floor=j,j.round=bj(b),j.ceil=bj(l),j.offset=bj(g),j.range=k,f}function bj(a){return function(b,d){try{dZ=jl;var c=new jl;return c._=b,a(c,d)._}finally{dZ=Date}}}function fp(c){function a(g){for(var h,e,f,j=[],d=-1,k=0;++d<b;){37===c.charCodeAt(d)&&(j.push(c.substring(k,d)),null!=(e=gj[h=c.charAt(++d)])&&(h=c.charAt(++d)),(f=db[h])&&(h=f(g,null==e?"e"===h?" ":"0":e)),j.push(h),k=d+1)}return j.push(c.substring(k,d)),j.join("")}var b=c.length;return a.parse=function(f){var h={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},g=g5(h,c,f,0);if(g!=f.length){return null}"p" in h&&(h.H=h.H%12+12*h.p);var d=new dZ;return"j" in h?d.setFullYear(h.y,0,h.j):"w" in h&&("W" in h||"U" in h)?(d.setFullYear(h.y,0,1),d.setFullYear(h.y,0,"W" in h?(h.w+6)%7+7*h.W-(d.getDay()+5)%7:h.w+7*h.U-(d.getDay()+6)%7)):d.setFullYear(h.y,h.m,h.d),d.setHours(h.H,h.M,h.S,h.L),d},a.toString=function(){return c},a}function g5(f,q,j,b){for(var p,h,d,m=0,k=q.length,g=j.length;k>m;){if(b>=g){return -1}if(p=q.charCodeAt(m++),37===p){if(d=q.charAt(m++),h=hg[d in gj?q.charAt(m++):d],!h||(b=h(f,j,b))<0){return -1}}else{if(p!=j.charCodeAt(b++)){return -1}}}return b}function jD(a){return new RegExp("^(?:"+a.map(a5.requote).join("|")+")","i")}function aG(d){for(var a=new hF,c=-1,b=d.length;++c<b;){a.set(d[c].toLowerCase(),c)}return a}function fO(g,c,f){var d=0>g?"-":"",a=(d?-g:g)+"",b=a.length;return d+(f>b?new Array(f-b+1).join(c)+a:a)}function f5(d,a,c){dA.lastIndex=0;var b=dA.exec(a.substring(c));return b?(d.w=jq.get(b[0].toLowerCase()),c+b[0].length):-1}function e7(d,a,c){bw.lastIndex=0;var b=bw.exec(a.substring(c));return b?(d.w=fG.get(b[0].toLowerCase()),c+b[0].length):-1}function cL(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c,c+1));return b?(d.w=+b[0],c+b[0].length):-1}function i3(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c));return b?(d.U=+b[0],c+b[0].length):-1}function d8(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c));return b?(d.W=+b[0],c+b[0].length):-1}function dI(d,a,c){b5.lastIndex=0;var b=b5.exec(a.substring(c));return b?(d.m=gF.get(b[0].toLowerCase()),c+b[0].length):-1}function ck(d,a,c){hR.lastIndex=0;var b=hR.exec(a.substring(c));return b?(d.m=eH.get(b[0].toLowerCase()),c+b[0].length):-1}function c1(c,a,b){return g5(c,db.c.toString(),a,b)}function bW(c,a,b){return g5(c,db.x.toString(),a,b)}function dT(c,a,b){return g5(c,db.X.toString(),a,b)}function dn(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c,c+4));return b?(d.y=+b[0],c+b[0].length):-1}function ib(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c,c+2));return b?(d.y=jV(+b[0]),c+b[0].length):-1}function jV(a){return a+(a>68?1900:2000)}function hv(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c,c+2));return b?(d.m=b[0]-1,c+b[0].length):-1}function fx(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c,c+2));return b?(d.d=+b[0],c+b[0].length):-1}function dU(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c,c+3));return b?(d.j=+b[0],c+b[0].length):-1}function bM(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c,c+2));return b?(d.H=+b[0],c+b[0].length):-1}function gV(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c,c+2));return b?(d.M=+b[0],c+b[0].length):-1}function cB(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c,c+2));return b?(d.S=+b[0],c+b[0].length):-1}function bv(d,a,c){a6.lastIndex=0;var b=a6.exec(a.substring(c,c+3));return b?(d.L=+b[0],c+b[0].length):-1}function fE(d,a,c){var b=em.get(a.substring(c,c+=2).toLowerCase());return null==b?-1:(d.p=b,c)}function dy(f){var b=f.getTimezoneOffset(),d=b>0?"-":"+",c=~~(Math.abs(b)/60),a=Math.abs(b)%60;return d+fO(c,"0",2)+fO(a,"0",2)}function jm(d,a,c){fX.lastIndex=0;var b=fX.exec(a.substring(c,c+1));return b?c+b[0].length:-1}function hM(c){function a(e){try{dZ=jl;var d=new dZ;return d._=e,b(d)}finally{dZ=Date}}var b=fp(c);return a.parse=function(e){try{dZ=jl;var d=b.parse(e);return d&&d._}finally{dZ=Date}},a.toString=b.toString,a}function eF(a){return a.toISOString()}function b3(f,b,d){function c(e){return f(e)}function a(l,k){var j=l[1]-l[0],g=j/k,h=a5.bisect(gL,g);return h==gL.length?[b.year,g0(l.map(function(e){return e/31536000000}),k)[2]]:h?b[g/gL[h-1]<gL[h]/g?h-1:h]:[aO,g0(l,k)[2]]}return c.invert=function(e){return gD(f.invert(e))},c.domain=function(e){return arguments.length?(f.domain(e),c):f.domain().map(gD)},c.nice=function(m,j){function k(i){return !isNaN(i)&&!m.range(i,gD(+i+1),j).length}var h=c.domain(),l=bP(h),g=null==m?a(l,10):"number"==typeof m&&a(l,m);return g&&(m=g[0],j=g[1]),c.domain(hQ(h,j>1?{floor:function(e){for(;k(e=m.floor(e));){e=gD(e-1)}return e},ceil:function(e){for(;k(e=m.ceil(e));){e=gD(+e+1)}return e}}:m))},c.ticks=function(k,h){var j=bP(c.domain()),g=null==k?a(j,10):"number"==typeof k?a(j,k):!k.range&&[{range:k},h];return g&&(k=g[0],h=g[1]),k.range(j[0],gD(+j[1]+1),h)},c.tickFormat=function(){return d},c.copy=function(){return b3(f.copy(),b,d)},d1(c,f)}function gD(a){return new Date(a)}function fV(a){return function(b){for(var d=a.length-1,c=a[d];!c[1](b);){c=a[--d]}return c[0](b)}}function gf(a){return JSON.parse(a.responseText)}function c8(b){var a=gJ.createRange();return a.selectNode(gJ.body),a.createContextualFragment(b.responseText)}var a5={version:"3.3.2"};Date.now||(Date.now=function(){return +new Date});var ej=[].slice,jL=function(a){return ej.call(a)},gJ=document,ag=gJ.documentElement,iF=window;try{jL(ag.childNodes)[0].nodeType}catch(ap){jL=function(c){for(var a=c.length,b=new Array(a);a--;){b[a]=c[a]}return b}}try{gJ.createElement("div").style.setProperty("opacity",0,"")}catch(aN){var eL=iF.Element.prototype,aW=eL.setAttribute,eX=eL.setAttributeNS,cm=iF.CSSStyleDeclaration.prototype,gp=cm.setProperty;eL.setAttribute=function(b,a){aW.call(this,b,a+"")},eL.setAttributeNS=function(c,a,b){eX.call(this,c,a,b+"")},cm.setProperty=function(c,a,b){gp.call(this,c,a+"",b)}}a5.ascending=function(b,a){return a>b?-1:b>a?1:b>=a?0:0/0},a5.descending=function(b,a){return b>a?-1:a>b?1:a>=b?0:0/0},a5.min=function(g,c){var f,d,a=-1,b=g.length;if(1===arguments.length){for(;++a<b&&!(null!=(f=g[a])&&f>=f);){f=void 0}for(;++a<b;){null!=(d=g[a])&&f>d&&(f=d)}}else{for(;++a<b&&!(null!=(f=c.call(g,g[a],a))&&f>=f);){f=void 0}for(;++a<b;){null!=(d=c.call(g,g[a],a))&&f>d&&(f=d)}}return f},a5.max=function(g,c){var f,d,a=-1,b=g.length;if(1===arguments.length){for(;++a<b&&!(null!=(f=g[a])&&f>=f);){f=void 0}for(;++a<b;){null!=(d=g[a])&&d>f&&(f=d)}}else{for(;++a<b&&!(null!=(f=c.call(g,g[a],a))&&f>=f);){f=void 0}for(;++a<b;){null!=(d=c.call(g,g[a],a))&&d>f&&(f=d)}}return f},a5.extent=function(h,c){var f,d,a,b=-1,g=h.length;if(1===arguments.length){for(;++b<g&&!(null!=(f=a=h[b])&&f>=f);){f=a=void 0}for(;++b<g;){null!=(d=h[b])&&(f>d&&(f=d),d>a&&(a=d))}}else{for(;++b<g&&!(null!=(f=a=c.call(h,h[b],b))&&f>=f);){f=void 0}for(;++b<g;){null!=(d=c.call(h,h[b],b))&&(f>d&&(f=d),d>a&&(a=d))}}return[f,a]},a5.sum=function(g,c){var f,d=0,a=g.length,b=-1;if(1===arguments.length){for(;++b<a;){isNaN(f=+g[b])||(d+=f)}}else{for(;++b<a;){isNaN(f=+c.call(g,g[b],b))||(d+=f)}}return d},a5.mean=function(f,h){var g,c=f.length,d=0,j=-1,b=0;if(1===arguments.length){for(;++j<c;){hP(g=f[j])&&(d+=(g-d)/++b)}}else{for(;++j<c;){hP(g=h.call(f,f[j],j))&&(d+=(g-d)/++b)}}return b?d:void 0},a5.quantile=function(g,c){var f=(g.length-1)*c+1,d=Math.floor(f),a=+g[d-1],b=f-d;return b?a+b*(g[d]-a):a},a5.median=function(a,b){return arguments.length>1&&(a=a.map(b)),a=a.filter(hP),a.length?a5.quantile(a.sort(a5.ascending),0.5):void 0},a5.bisector=function(a){return{left:function(d,g,f,b){for(arguments.length<3&&(f=0),arguments.length<4&&(b=d.length);b>f;){var c=f+b>>>1;a.call(d,d[c],c)<g?f=c+1:b=c}return f},right:function(d,g,f,b){for(arguments.length<3&&(f=0),arguments.length<4&&(b=d.length);b>f;){var c=f+b>>>1;g<a.call(d,d[c],c)?b=c:f=c+1}return f}}};var cS=a5.bisector(function(a){return a});a5.bisectLeft=cS.left,a5.bisect=a5.bisectRight=cS.right,a5.shuffle=function(d){for(var a,c,b=d.length;b;){c=0|Math.random()*b--,a=d[b],d[b]=d[c],d[c]=a}return d},a5.permute=function(d,a){for(var c=a.length,b=new Array(c);c--;){b[c]=d[a[c]]}return b},a5.pairs=function(g){for(var c,f=0,d=g.length-1,a=g[0],b=new Array(0>d?0:d);d>f;){b[f]=[c=a,a=g[++f]]}return b},a5.zip=function(){if(!(a=arguments.length)){return[]}for(var g=-1,d=a5.min(arguments,hH),c=new Array(d);++g<d;){for(var a,b=-1,f=c[g]=new Array(a);++b<a;){f[b]=arguments[b][g]}}return c},a5.transpose=function(a){return a5.zip.apply(a5,a)},a5.keys=function(c){var a=[];for(var b in c){a.push(b)}return a},a5.values=function(c){var a=[];for(var b in c){a.push(c[b])}return a},a5.entries=function(c){var a=[];for(var b in c){a.push({key:b,value:c[b]})}return a},a5.merge=function(a){return Array.prototype.concat.apply([],a)},a5.range=function(h,e,f){if(arguments.length<3&&(f=1,arguments.length<2&&(e=h,h=0)),1/0===(e-h)/f){throw new Error("infinite range")}var c,d=[],g=h5(Math.abs(f)),b=-1;if(h*=g,e*=g,f*=g,0>f){for(;(c=h+f*++b)>e;){d.push(c/g)}}else{for(;(c=h+f*++b)<e;){d.push(c/g)}}return d},a5.map=function(c){var a=new hF;if(c instanceof hF){c.forEach(function(f,d){a.set(f,d)})}else{for(var b in c){a.set(b,c[b])}}return a},hK(hF,{has:function(a){return es+a in this},get:function(a){return this[es+a]},set:function(b,a){return this[es+b]=a},remove:function(a){return a=es+a,a in this&&delete this[a]},keys:function(){var a=[];return this.forEach(function(b){a.push(b)}),a},values:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a},entries:function(){var a=[];return this.forEach(function(b,c){a.push({key:b,value:c})}),a},forEach:function(b){for(var a in this){a.charCodeAt(0)===jg&&b.call(this,a.substring(1),this[a])}}});var es="\0",jg=es.charCodeAt(0);a5.nest=function(){function j(A,r,q){if(q>=h.length){return f?f.call(c,r):g?r.sort(g):r}for(var i,B,n,k,m=-1,e=r.length,o=h[q++],u=new hF;++m<e;){(k=u.get(i=o(B=r[m])))?k.push(B):u.set(i,[B])}return A?(B=A(),n=function(l,a){B.set(l,j(A,a,q))}):(B={},n=function(l,a){B[l]=j(A,a,q)}),u.forEach(n),B}function d(l,k){if(k>=h.length){return l}var i=[],a=b[k++];return l.forEach(function(m,e){i.push({key:m,values:d(e,k)})}),a?i.sort(function(m,e){return a(m.key,e.key)}):i}var g,f,c={},h=[],b=[];return c.map=function(a,i){return j(i,a,0)},c.entries=function(a){return d(j(a5.map,a,0),0)},c.key=function(a){return h.push(a),c},c.sortKeys=function(a){return b[h.length-1]=a,c},c.sortValues=function(a){return g=a,c},c.rollup=function(a){return f=a,c},c},a5.set=function(d){var a=new hZ;if(d){for(var c=0,b=d.length;b>c;++c){a.add(d[c])}}return a},hK(hZ,{has:function(a){return es+a in this},add:function(a){return this[es+a]=!0,a},remove:function(a){return a=es+a,a in this&&delete this[a]},values:function(){var a=[];return this.forEach(function(b){a.push(b)}),a},forEach:function(b){for(var a in this){a.charCodeAt(0)===jg&&b.call(this,a.substring(1))}}}),a5.behavior={},a5.rebind=function(f,b){for(var d,c=1,a=arguments.length;++c<a;){f[d=arguments[c]]=hO(f,b,b[d])}return f};var bE=["webkit","ms","moz","Moz","o","O"];a5.dispatch=function(){for(var c=new hU,a=-1,b=arguments.length;++a<b;){c[arguments[a]]=hI(c)}return c},hU.prototype.on=function(d,a){var c=d.indexOf("."),b="";if(c>=0&&(b=d.substring(c+1),d=d.substring(0,c)),d){return arguments.length<2?this[d].on(b):this[d].on(b,a)}if(2===arguments.length){if(null==a){for(d in this){this.hasOwnProperty(d)&&this[d].on(b,null)}}return this}},a5.event=null,a5.requote=function(a){return a.replace(bh,"\\$&")};var bh=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,fj={}.__proto__?function(b,a){b.__proto__=a}:function(c,a){for(var b in a){c[b]=a[b]}},g1=function(b,a){return a.querySelector(b)},jz=function(b,a){return a.querySelectorAll(b)},aC=ag[ig(ag,"matchesSelector")],fK=function(b,a){return aC.call(b,a)};"function"==typeof Sizzle&&(g1=function(b,a){return Sizzle(b,a)[0]||null},jz=function(b,a){return Sizzle.uniqueSort(Sizzle(b,a))},fK=Sizzle.matchesSelector),a5.selection=function(){return iT};var f1=a5.selection.prototype=[];f1.select=function(f){var q,j,b,p,h=[];f=h7(f);for(var d=-1,m=this.length;++d<m;){h.push(q=[]),q.parentNode=(b=this[d]).parentNode;for(var k=-1,g=b.length;++k<g;){(p=b[k])?(q.push(j=f.call(p,p.__data__,k,d)),j&&"__data__" in p&&(j.__data__=p.__data__)):q.push(null)}}return hN(h)},f1.selectAll=function(f){var m,h,b=[];f=hD(f);for(var l=-1,g=this.length;++l<g;){for(var d=this[l],k=-1,j=d.length;++k<j;){(h=d[k])&&(b.push(m=jL(f.call(h,h.__data__,k,l))),m.parentNode=h)}}return hN(b)};var e3={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};a5.ns={prefix:e3,qualify:function(c){var a=c.indexOf(":"),b=c;return a>=0&&(b=c.substring(0,a),c=c.substring(a+1)),e3.hasOwnProperty(b)?{space:e3[b],local:c}:c}},f1.attr=function(c,a){if(arguments.length<2){if("string"==typeof c){var b=this.node();return c=a5.ns.qualify(c),c.local?b.getAttributeNS(c.space,c.local):b.getAttribute(c)}for(a in c){this.each(hS(a,c[a]))}return this}return this.each(hS(c,a))},f1.classed=function(f,b){if(arguments.length<2){if("string"==typeof f){var d=this.node(),c=(f=f.trim().split(/^|\s+/g)).length,a=-1;if(b=d.classList){for(;++a<c;){if(!b.contains(f[a])){return !1}}}else{for(b=d.getAttribute("class");++a<c;){if(!iN(f[a]).test(b)){return !1}}}return !0}for(b in f){this.each(hB(b,f[b]))}return this}return this.each(hB(f,b))},f1.style=function(d,a,c){var b=arguments.length;if(3>b){if("string"!=typeof d){2>b&&(a="");for(c in d){this.each(ih(c,d[c],a))}return this}if(2>b){return iF.getComputedStyle(this.node(),null).getPropertyValue(d)}c=""}return this.each(ih(d,a,c))},f1.property=function(b,a){if(arguments.length<2){if("string"==typeof b){return this.node()[b]}for(a in b){this.each(hC(a,b[a]))}return this}return this.each(hC(b,a))},f1.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},f1.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},f1.append=function(a){return a=iD(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},f1.insert=function(b,a){return b=iD(b),a=h7(a),this.select(function(){return this.insertBefore(b.apply(this,arguments),a.apply(this,arguments))})},f1.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})},f1.data=function(f,p){function j(t,E){var c,A,s,I=t.length,D=E.length,B=Math.min(I,D),C=new Array(D),l=new Array(D),G=new Array(I);if(p){var J,u=new hF,H=new hF,F=[];for(c=-1;++c<I;){J=p.call(A=t[c],A.__data__,c),u.has(J)?G[c]=A:u.set(J,A),F.push(J)}for(c=-1;++c<D;){J=p.call(E,s=E[c],c),(A=u.get(J))?(C[c]=A,A.__data__=s):H.has(J)||(l[c]=i0(s)),H.set(J,s),u.remove(J)}for(c=-1;++c<I;){u.has(F[c])&&(G[c]=t[c])}}else{for(c=-1;++c<B;){A=t[c],s=E[c],A?(A.__data__=s,C[c]=A):l[c]=i0(s)}for(;D>c;++c){l[c]=i0(E[c])}for(;I>c;++c){G[c]=t[c]}}l.update=C,l.parentNode=C.parentNode=G.parentNode=t.parentNode,k.push(l),g.push(C),q.push(G)}var b,h,d=-1,m=this.length;if(!arguments.length){for(f=new Array(m=(b=this[0]).length);++d<m;){(h=b[d])&&(f[d]=h.__data__)}return f}var k=hL([]),g=hN([]),q=hN([]);if("function"==typeof f){for(;++d<m;){j(b=this[d],f.call(b,b.parentNode.__data__,d))}}else{for(;++d<m;){j(b=this[d],f)}}return g.enter=function(){return k},g.exit=function(){return q},g},f1.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},f1.filter=function(f){var m,h,b,l=[];"function"!=typeof f&&(f=hV(f));for(var g=0,d=this.length;d>g;g++){l.push(m=[]),m.parentNode=(h=this[g]).parentNode;for(var k=0,j=h.length;j>k;k++){(b=h[k])&&f.call(b,b.__data__,k)&&m.push(b)}}return hN(l)},f1.order=function(){for(var g=-1,c=this.length;++g<c;){for(var f,d=this[g],a=d.length-1,b=d[a];--a>=0;){(f=d[a])&&(b&&b!==f.nextSibling&&b.parentNode.insertBefore(f,b),b=f)}}return this},f1.sort=function(c){c=i6.apply(this,arguments);for(var a=-1,b=this.length;++a<b;){this[a].sort(c)}return this.order()},f1.each=function(a){return iL(this,function(b,d,c){a.call(b,b.__data__,d,c)})},f1.call=function(b){var a=jL(arguments);return b.apply(a[0]=this,a),this},f1.empty=function(){return !this.node()},f1.node=function(){for(var g=0,c=this.length;c>g;g++){for(var f=this[g],d=0,a=f.length;a>d;d++){var b=f[d];if(b){return b}}}return null},f1.size=function(){var a=0;return this.each(function(){++a}),a};var cH=[];a5.selection.enter=hL,a5.selection.enter.prototype=cH,cH.append=f1.append,cH.empty=f1.empty,cH.node=f1.node,cH.call=f1.call,cH.size=f1.size,cH.select=function(f){for(var q,j,b,p,h,d=[],m=-1,k=this.length;++m<k;){b=(p=this[m]).update,d.push(q=[]),q.parentNode=p.parentNode;for(var g=-1,v=p.length;++g<v;){(h=p[g])?(q.push(b[g]=j=f.call(p.parentNode,h.__data__,g,m)),j.__data__=h.__data__):q.push(null)}}return hN(d)},cH.insert=function(b,a){return arguments.length<2&&(a=iB(this)),f1.insert.call(this,b,a)},f1.transition=function(){for(var f,q,j=aK||++jb,b=[],p=fQ||{time:Date.now(),ease:bC,delay:0,duration:250},h=-1,d=this.length;++h<d;){b.push(f=[]);for(var m=this[h],k=-1,g=m.length;++k<g;){(q=m[k])&&gw(q,k,j,p),f.push(q)}}return aY(b,j)},f1.interrupt=function(){return this.each(hy)},a5.select=function(b){var a=["string"==typeof b?g1(b,gJ):b];return a.parentNode=ag,hN([a])},a5.selectAll=function(b){var a=jL("string"==typeof b?jz(b,gJ):b);return a.parentNode=ag,hN([a])};var iT=a5.select(ag);f1.on=function(d,a,c){var b=arguments.length;if(3>b){if("string"!=typeof d){2>b&&(a=!1);for(c in d){this.each(i4(c,d[c],a))}return this}if(2>b){return(b=this.node()["__on"+d])&&b._}c=!1}return this.each(i4(d,a,c))};var d4=a5.map({mouseenter:"mouseover",mouseleave:"mouseout"});d4.forEach(function(a){"on"+a in gJ&&d4.remove(a)});var dE=ig(ag.style,"userSelect"),b9=0;a5.mouse=function(a){return iV(a,h1())};var cX=/WebKit/.test(iF.navigator.userAgent)?-1:0;a5.touches=function(b,a){return arguments.length<2&&(a=h1().touches),a?jL(a).map(function(c){var d=iV(b,c);return d.identifier=c.identifier,d}):[]},a5.behavior.drag=function(){function k(){this.on("mousedown.drag",j).on("touchstart.drag",b)}function f(){return a5.event.changedTouches[0].identifier}function h(e,a){return a5.touches(e).filter(function(i){return i.identifier===a})[0]}function g(m,a,l,i){return function(){function n(){if(!G){return E()}var s=a(G,u),p=s[0]-B[0],o=s[1]-B[1];F|=p|o,B=s,A({type:"drag",x:s[0]+C[0],y:s[1]+C[1],dx:p,dy:o})}function E(){q.on(l+"."+e,null).on(i+"."+e,null),D(F&&a5.event.target===t),A({type:"dragend"})}var C,r=this,G=r.parentNode,A=c.of(r,arguments),t=a5.event.target,u=m(),e=null==u?"drag":"drag-"+u,B=a(G,u),F=0,q=a5.select(iF).on(l+"."+e,n).on(i+"."+e,E),D=iO();d?(C=d.apply(r,arguments),C=[C.x-B[0],C.y-B[1]]):C=[0,0],A({type:"dragstart"})}}var c=h2(k,"drag","dragstart","dragend"),d=null,j=g(h8,a5.mouse,"mousemove","mouseup"),b=g(f,h,"touchmove","touchend");return k.origin=function(a){return arguments.length?(d=a,k):d},a5.rebind(k,c,"on")};var bV=Math.PI,dP=0.000001,dh=dP*dP,h0=bV/180,jU=180/bV,hn=Math.SQRT2,fq=2,d7=4;a5.interpolateZoom=function(E,q){function L(f){var a=f*b;if(F){var c=iq(N),d=H/(fq*I)*(c*iU(hn*a+N)-iE(N));return[B+d*G,k+d*A,H*c/iq(hn*a+N)]}return[B+f*G,k+f*A,H*Math.exp(hn*a)]}var B=E[0],k=E[1],H=E[2],D=q[0],P=q[1],O=q[2],G=D-B,A=P-k,K=G*G+A*A,I=Math.sqrt(K),J=(O*O-H*H+d7*K)/(2*H*fq*I),C=(O*O-H*H-d7*K)/(2*O*fq*I),N=Math.log(Math.sqrt(J*J+1)-J),j=Math.log(Math.sqrt(C*C+1)-C),F=j-N,b=(F||Math.log(O/H))/hn;return L.duration=1000*b,L},a5.behavior.zoom=function(){function Z(a){a.on(W,ac).on(cK+".zoom",ao).on(B,X).on("dblclick.zoom",at).on(f,Q)}function O(a){return[(a[0]-g.x)/g.k,(a[1]-g.y)/g.k]}function ar(a){return[a[0]*g.k+g.x,a[1]*g.k+g.y]}function U(a){g.k=Math.max(ae[0],Math.min(ae[1],a))}function K(b,a){a=ar(a),g.x+=b[0]-a[0],g.y+=b[1]-a[1]}function al(){ba&&ba.domain(H.range().map(function(a){return(a-g.x)/g.k}).map(H.invert)),I&&I.domain(be.range().map(function(a){return(a-g.y)/g.k}).map(be.invert))}function Y(a){a({type:"zoomstart"})}function bc(a){al(),a({type:"zoom",scale:g.k,translate:[g.x,g.y]})}function au(a){a({type:"zoomend"})}function ac(){function b(){p=1,K(a5.mouse(a),j),bc(d)}function o(){m.on(B,iF===a?X:null).on(V,null),k(p&&a5.event.target===c),au(d)}var a=this,d=ai.of(a,arguments),c=a5.event.target,p=0,m=a5.select(iF).on(B,b).on(V,o),j=O(a5.mouse(a)),k=iO();hy.call(a),Y(d)}function Q(){function c(){var b=a5.touches(r);return a=g.k,o={},b.forEach(function(d){o[d.identifier]=O(d)}),b}function q(){var h=Date.now(),n=c();if(1===n.length){if(500>h-F){var d=n[0],p=o[d.identifier];U(2*g.k),K(d,p),h3(),bc(A)}F=h}else{if(n.length>1){var d=n[0],v=n[1],b=d[0]-v[0],m=d[1]-v[1];j=b*b+m*m}}}function k(){var C=a5.touches(r),h=C[0],m=o[h.identifier];if(d=C[1]){var d,p=o[d.identifier],v=a5.event.scale;if(null==v){var b=(b=d[0]-h[0])*b+(b=d[1]-h[1])*b;v=j&&Math.sqrt(b/j)}h=[(h[0]+d[0])/2,(h[1]+d[1])/2],m=[(m[0]+p[0])/2,(m[1]+p[1])/2],U(v*a)}F=null,K(h,m),bc(A)}function l(){a5.event.touches.length?c():(t.on(R,null).on(P,null),u.on(W,ac).on(f,Q),s(),au(A))}var o,a,r=this,A=ai.of(r,arguments),j=0,t=a5.select(iF).on(R,k).on(P,l),u=a5.select(r).on(W,null).on(f,q),s=iO();hy.call(r),q(),Y(A)}function ao(){var b=ai.of(this,arguments);G?clearTimeout(G):(hy.call(this),Y(b)),G=setTimeout(function(){G=null,au(b)},50),h3();var a=aa||a5.mouse(this);J||(J=O(a)),U(Math.pow(2,0.002*bU())*g.k),K(a,J),bc(b)}function X(){J=null}function at(){var d=ai.of(this,arguments),c=a5.mouse(this),b=O(c),a=Math.log(g.k)/Math.LN2;Y(d),U(Math.pow(2,a5.event.shiftKey?Math.ceil(a)-1:Math.floor(a)+1)),K(c,b),bc(d),au(d)}var J,aa,G,F,H,ba,be,I,g={x:0,y:0,k:1},L=[960,500],ae=g4,W="mousedown.zoom",B="mousemove.zoom",V="mouseup.zoom",f="touchstart.zoom",R="touchmove.zoom",P="touchend.zoom",ai=h2(Z,"zoomstart","zoom","zoomend");return Z.event=function(a){a.each(function(){var c=ai.of(this,arguments),b=g;aK?a5.select(this).transition().each("start.zoom",function(){g=this.__chart__||{x:0,y:0,k:1},Y(c)}).tween("zoom:zoom",function(){var k=L[0],j=L[1],d=k/2,h=j/2,l=a5.interpolateZoom([(d-g.x)/g.k,(h-g.y)/g.k,k/g.k],[(d-b.x)/b.k,(h-b.y)/b.k,k/b.k]);return function(e){var i=l(e),m=k/i[2];this.__chart__=g={x:d-i[0]*m,y:h-i[1]*m,k:m},bc(c)}}).each("end.zoom",function(){au(c)}):(this.__chart__=g,Y(c),bc(c),au(c))})},Z.translate=function(a){return arguments.length?(g={x:+a[0],y:+a[1],k:g.k},al(),Z):[g.x,g.y]},Z.scale=function(a){return arguments.length?(g={x:g.x,y:g.y,k:+a},al(),Z):g.k},Z.scaleExtent=function(a){return arguments.length?(ae=null==a?g4:[+a[0],+a[1]],Z):ae},Z.center=function(a){return arguments.length?(aa=a&&[+a[0],+a[1]],Z):aa},Z.size=function(a){return arguments.length?(L=a&&[+a[0],+a[1]],Z):L},Z.x=function(a){return arguments.length?(ba=a,H=a.copy(),g={x:0,y:0,k:1},Z):ba},Z.y=function(a){return arguments.length?(I=a,be=a.copy(),g={x:0,y:0,k:1},Z):I},a5.rebind(Z,ai,"on")};var bU,g4=[0,1/0],cK="onwheel" in gJ?(bU=function(){return -a5.event.deltaY*(a5.event.deltaMode?120:1)},"wheel"):"onmousewheel" in gJ?(bU=function(){return a5.event.wheelDelta},"mousewheel"):(bU=function(){return -a5.event.detail},"MozMousePixelScroll");iy.prototype.toString=function(){return this.rgb()+""},a5.hsl=function(c,a,b){return 1===arguments.length?c instanceof iv?ip(c.h,c.s,c.l):eD(""+c,bZ,ip):ip(+c,+a,+b)};var bD=iv.prototype=new iy;bD.brighter=function(a){return a=Math.pow(0.7,arguments.length?a:1),ip(this.h,this.s,this.l/a)},bD.darker=function(a){return a=Math.pow(0.7,arguments.length?a:1),ip(this.h,this.s,a*this.l)},bD.rgb=function(){return i5(this.h,this.s,this.l)},a5.hcl=function(c,a,b){return 1===arguments.length?c instanceof iw?jE(c.h,c.c,c.l):c instanceof iR?dR(c.l,c.a,c.b):dR((c=gB((c=a5.rgb(c)).r,c.g,c.b)).l,c.a,c.b):jE(+c,+a,+b)};var fN=iw.prototype=new iy;fN.brighter=function(a){return jE(this.h,this.c,Math.min(100,this.l+dH*(arguments.length?a:1)))},fN.darker=function(a){return jE(this.h,this.c,Math.max(0,this.l-dH*(arguments.length?a:1)))},fN.rgb=function(){return iS(this.h,this.c,this.l).rgb()},a5.lab=function(c,a,b){return 1===arguments.length?c instanceof iR?iW(c.l,c.a,c.b):c instanceof iw?iS(c.l,c.c,c.h):gB((c=a5.rgb(c)).r,c.g,c.b):iW(+c,+a,+b)};var dH=18,jC=0.95047,h9=1,eP=1.08883,cj=iR.prototype=new iy;cj.brighter=function(a){return iW(Math.min(100,this.l+dH*(arguments.length?a:1)),this.a,this.b)},cj.darker=function(a){return iW(Math.max(0,this.l-dH*(arguments.length?a:1)),this.a,this.b)},cj.rgb=function(){return iG(this.l,this.a,this.b)},a5.rgb=function(c,a,b){return 1===arguments.length?c instanceof jj?dw(c.r,c.g,c.b):eD(""+c,dw,i5):dw(~~c,~~a,~~b)};var gN=jj.prototype=new iy;gN.brighter=function(f){f=Math.pow(0.7,arguments.length?f:1);var b=this.r,d=this.g,c=this.b,a=30;return b||d||c?(b&&a>b&&(b=a),d&&a>d&&(d=a),c&&a>c&&(c=a),dw(Math.min(255,~~(b/f)),Math.min(255,~~(d/f)),Math.min(255,~~(c/f)))):dw(a,a,a)},gN.darker=function(a){return a=Math.pow(0.7,arguments.length?a:1),dw(~~(a*this.r),~~(a*this.g),~~(a*this.b))},gN.hsl=function(){return bZ(this.r,this.g,this.b)},gN.toString=function(){return"#"+hG(this.r)+hG(this.g)+hG(this.b)};var f4=a5.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});f4.forEach(function(b,a){f4.set(b,bn(a))}),a5.functor=c6,a5.xhr=a1(hb),a5.dsv=function(f,m){function h(p,c,a){arguments.length<3&&(a=c,c=null);var l=a5.xhr(p,m,a);return l.row=function(e){return arguments.length?l.response(null==(c=e)?b:k(e)):c},l.row(c)}function b(a){return h.parse(a.responseText)}function k(a){return function(c){return h.parse(c.responseText,a)}}function d(a){return a.map(j).join(f)}function j(a){return i.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var i=new RegExp('["'+f+"\n]"),g=f.charCodeAt(0);return h.parse=function(e,a){var c;return h.parseRows(e,function(p,o){if(c){return c(p,o-1)}var l=new Function("d","return {"+p.map(function(r,q){return JSON.stringify(r)+": d["+q+"]"}).join(",")+"}");c=a?function(r,q){return a(l(r),q)}:l})},h.parseRows=function(q,G){function C(){if(H>=D){return p}if(F){return F=!1,v}var n=H;if(34===q.charCodeAt(n)){for(var s=n;s++<D;){if(34===q.charCodeAt(s)){if(34!==q.charCodeAt(s+1)){break}++s}}H=s+2;var o=q.charCodeAt(s+1);return 13===o?(F=!0,10===q.charCodeAt(s+2)&&++H):10===o&&(F=!0),q.substring(n+1,s).replace(/""/g,'"')}for(;D>H;){var o=q.charCodeAt(H++),c=1;if(10===o){F=!0}else{if(13===o){F=!0,10===q.charCodeAt(H)&&(++H,++c)}else{if(o!==g){continue}}}return q.substring(n,H-c)}return q.substring(n)}for(var l,F,v={},p={},E=[],D=q.length,H=0,B=0;(l=C())!==p;){for(var A=[];l!==v&&l!==p;){A.push(l),l=C()}(!G||(A=G(A,B++)))&&E.push(A)}return E},h.format=function(c){if(Array.isArray(c[0])){return h.formatRows(c)}var e=new hZ,a=[];return c.forEach(function(o){for(var l in o){e.has(l)||a.push(e.add(l))}}),[a.map(j).join(f)].concat(c.map(function(l){return a.map(function(o){return j(l[o])}).join(f)})).join("\n")},h.formatRows=function(a){return a.map(d).join("\n")},h},a5.csv=a5.dsv(",","text/csv"),a5.tsv=a5.dsv("	","text/tab-separated-values");var gv,dm,hs,bg,ex,jT=iF[ig(iF,"requestAnimationFrame")]||function(a){setTimeout(a,17)};a5.timer=function(g,c,f){var d=arguments.length;2>d&&(c=0),3>d&&(f=Date.now());var a=f+c,b={callback:g,time:a,next:null};dm?dm.next=b:gv=b,dm=b,hs||(bg=clearTimeout(bg),hs=1,jT(gG))},a5.timer.flush=function(){iz(),ak()};var gR=".",aA=",",i2=[3,3],aF="$",aV=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(aJ);a5.formatPrefix=function(c,a){var b=0;return c&&(0>c&&(c*=-1),a&&(c=a5.round(c,eI(c,a))),b=1+Math.floor(1e-12+Math.log(c)/Math.LN10),b=Math.max(-24,Math.min(24,3*Math.floor((0>=b?b+1:b-1)/3)))),aV[8+b/3]},a5.round=function(b,a){return a?Math.round(b*(a=Math.pow(10,a)))/a:Math.round(b)},a5.format=function(k){var G=eT.exec(k),C=G[1]||" ",b=G[2]||">",F=G[3]||"",q=G[4]||"",j=G[5],E=+G[6],D=G[7],m=G[8],H=G[9],B=1,v="",A=!1;switch(m&&(m=+m.substring(1)),(j||"0"===C&&"="===b)&&(j=C="0",b="=",D&&(E-=Math.floor((E-1)/4))),H){case"n":D=!0,H="g";break;case"%":B=100,v="%",H="f";break;case"p":B=100,v="%",H="r";break;case"b":case"o":case"x":case"X":"#"===q&&(q="0"+H.toLowerCase());case"c":case"d":A=!0,m=0;break;case"s":B=-1,H="r"}"#"===q?q="":"$"===q&&(q=aF),"r"!=H||m||(H="g"),null!=m&&("g"==H?m=Math.max(1,Math.min(21,m)):("e"==H||"f"==H)&&(m=Math.max(0,Math.min(20,m)))),H=a4.get(H)||aS;var d=j&&D;return function(l){if(A&&l%1){return""}var f=0>l||0===l&&0>1/l?(l=-l,"-"):F;if(0>B){var g=a5.formatPrefix(l,m);l=g.scale(l),v=g.symbol}else{l*=B}l=H(l,m);var e=l.lastIndexOf("."),c=0>e?l:l.substring(0,e),i=0>e?"":gR+l.substring(e+1);!j&&D&&(c=e6(c));var h=q.length+c.length+i.length+(d?0:f.length),a=E>h?new Array(h=E-h+1).join(C):"";return d&&(c=e6(a+c)),f+=q,l=c+i,("<"===b?f+l+a:">"===b?a+f+l:"^"===b?a.substring(0,h>>=1)+f+l+a.substring(h):f+(d?l:a+l))+v}};var eT=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,a4=a5.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(b,a){return b.toPrecision(a)},e:function(b,a){return b.toExponential(a)},f:function(b,a){return b.toFixed(a)},r:function(b,a){return(b=a5.round(b,eI(b,a))).toFixed(Math.max(0,Math.min(20,eI(b*(1+1e-15),a))))}}),e6=hb;if(i2){var cA=i2.length;e6=function(f){for(var b=f.length,d=[],c=0,a=i2[0];b>0&&a>0;){d.push(f.substring(b-=a,b+a)),a=i2[c=(c+1)%cA]}return d.reverse().join(aA)}}a5.geo={},eV.prototype={s:0,t:0,add:function(a){cf(a,this.t,gz),cf(gz.s,this.s,this),this.s?this.t+=gz.t:this.s=gz.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var gz=new eV;a5.geo.stream=function(b,a){b&&c0.hasOwnProperty(b.type)?c0[b.type](b,a):gk(b,a)};var c0={Feature:function(b,a){gk(b.geometry,a)},FeatureCollection:function(f,b){for(var d=f.features,c=-1,a=d.length;++c<a;){gk(d[c].geometry,b)}}},eB={Sphere:function(b,a){a.sphere()},Point:function(b,a){b=b.coordinates,a.point(b[0],b[1],b[2])},MultiPoint:function(f,b){for(var d=f.coordinates,c=-1,a=d.length;++c<a;){f=d[c],b.point(f[0],f[1],f[2])}},LineString:function(b,a){cQ(b.coordinates,a,0)},MultiLineString:function(f,b){for(var d=f.coordinates,c=-1,a=d.length;++c<a;){cQ(d[c],b,0)}},Polygon:function(b,a){en(b.coordinates,a)},MultiPolygon:function(f,b){for(var d=f.coordinates,c=-1,a=d.length;++c<a;){en(d[c],b)}},GeometryCollection:function(f,b){for(var d=f.geometries,c=-1,a=d.length;++c<a;){gk(d[c],b)}}};a5.geo.area=function(a){return jx=0,a5.geo.stream(a,bs),jx};var jx,bL=new eV,bs={sphere:function(){jx+=4*bV},point:h8,lineStart:h8,lineEnd:h8,polygonStart:function(){bL.reset(),bs.lineStart=i9},polygonEnd:function(){var a=2*bL;jx+=0>a?4*bV+a:a,bs.lineStart=bs.lineEnd=bs.point=h8}};a5.geo.bounds=function(){function H(b,a){j.push(q=[D=b,L=b]),O>a&&(O=a),a>N&&(N=a)}function C(V,h){var a=bA([V*h0,h*h0]);if(I){var U=fg(I,a),g=[U[1],-U[0],0],b=fg(g,U);ax(b),b=fH(b);var n=V-F,f=n>0?1:-1,m=b[0]*jU*f,s=Math.abs(n)>180;if(s^(m>f*F&&f*V>m)){var p=b[1]*jU;p>N&&(N=p)}else{if(m=(m+360)%360-180,s^(m>f*F&&f*V>m)){var p=-b[1]*jU;O>p&&(O=p)}else{O>h&&(O=h),h>N&&(N=h)}}s?F>V?T(D,V)>T(D,L)&&(L=V):T(V,L)>T(D,L)&&(D=V):L>=D?(D>V&&(D=V),V>L&&(L=V)):V>F?T(D,V)>T(D,L)&&(L=V):T(V,L)>T(D,L)&&(D=V)}else{H(V,h)}I=a,F=V}function P(){S.point=C}function E(){q[0]=D,q[1]=L,S.point=H,I=null}function B(c,b){if(I){var a=c-F;k+=Math.abs(a)>180?a+(a>0?360:-360):a}else{Q=c,A=b}bs.point(c,b),C(c,b)}function K(){bs.lineStart()}function G(){B(Q,A),bs.lineEnd(),Math.abs(k)>dP&&(D=-(L=180)),q[0]=D,q[1]=L,I=null}function T(b,a){return(a-=b)<0?a+360:a}function R(b,a){return b[0]-a[0]}function J(b,a){return a[0]<=a[1]?a[0]<=b&&b<=a[1]:b<a[0]||a[1]<b}var D,O,L,N,F,Q,A,I,k,j,q,S={point:H,lineStart:P,lineEnd:E,polygonStart:function(){S.point=B,S.lineStart=K,S.lineEnd=G,k=0,bs.polygonStart()},polygonEnd:function(){bs.polygonEnd(),S.point=H,S.lineStart=P,S.lineEnd=E,0>bL?(D=-(L=180),O=-(N=90)):k>dP?N=90:-dP>k&&(O=-90),q[0]=D,q[1]=L}};return function(l){N=L=-(D=O=1/0),j=[],a5.geo.stream(l,S);var c=j.length;if(c){j.sort(R);for(var g,d=1,a=j[0],b=[a];c>d;++d){g=j[d],J(g[0],a)||J(g[1],a)?(T(a[0],g[1])>T(a[0],a[1])&&(a[1]=g[1]),T(g[0],a[1])>T(a[0],a[1])&&(a[0]=g[0])):b.push(a=g)}for(var h,g,f=-1/0,c=b.length-1,d=0,a=b[c];c>=d;a=g,++d){g=b[d],(h=T(a[1],g[0]))>f&&(f=h,D=g[0],L=a[1])}}return j=q=null,1/0===D||1/0===O?[[0/0,0/0],[0/0,0/0]]:[[D,O],[L,N]]}}(),a5.geo.centroid=function(f){fw=g8=jK=aM=fR=f8=fb=cO=jf=ed=dO=0,a5.geo.stream(f,cq);var b=jf,d=ed,c=dO,a=b*b+d*d+c*c;return dh>a&&(b=f8,d=fb,c=cO,dP>g8&&(b=jK,d=aM,c=fR),a=b*b+d*d+c*c,dh>a)?[0/0,0/0]:[Math.atan2(d,b)*jU,iI(c/Math.sqrt(a))*jU]};var fw,g8,jK,aM,fR,f8,fb,cO,jf,ed,dO,cq={sphere:h8,point:e0,lineStart:iM,lineEnd:dY,polygonStart:function(){cq.lineStart=dB},polygonEnd:function(){cq.lineStart=iM}},c4=dL(b6,fm,bQ,g2),b2=[-bV,0],d2=1000000000;a5.geo.clipExtent=function(){var h,c,f,d,a,b,g={stream:function(e){return a&&(a.valid=!1),a=b(e),a.valid=!0,a},extent:function(e){return arguments.length?(b=bz(h=+e[0][0],c=+e[0][1],f=+e[1][0],d=+e[1][1]),a&&(a.valid=!1,a=null),g):[[h,c],[f,d]]}};return g.extent([[0,0],[960,500]])},(a5.geo.conicEqualArea=function(){return jA(h4)}).raw=h4,a5.geo.albers=function(){return a5.geo.conicEqualArea().rotate([96,0]).center([-0.6,38.7]).parallels([29.5,45.5]).scale(1070)},a5.geo.albersUsa=function(){function f(e){var a=e[0],c=e[1];return m=null,h(a,c),m||(b(a,c),m)||l(a,c),m}var m,h,b,l,g=a5.geo.albers(),d=a5.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),k=a5.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),j={point:function(c,a){m=[c,a]}};return f.invert=function(p){var c=g.scale(),o=g.translate(),i=(p[0]-o[0])/c,a=(p[1]-o[1])/c;return(a>=0.12&&0.234>a&&i>=-0.425&&-0.214>i?d:a>=0.166&&0.234>a&&i>=-0.214&&-0.115>i?k:g).invert(p)},f.stream=function(o){var a=g.stream(o),i=d.stream(o),c=k.stream(o);return{point:function(p,e){a.point(p,e),i.point(p,e),c.point(p,e)},sphere:function(){a.sphere(),i.sphere(),c.sphere()},lineStart:function(){a.lineStart(),i.lineStart(),c.lineStart()},lineEnd:function(){a.lineEnd(),i.lineEnd(),c.lineEnd()},polygonStart:function(){a.polygonStart(),i.polygonStart(),c.polygonStart()},polygonEnd:function(){a.polygonEnd(),i.polygonEnd(),c.polygonEnd()}}},f.precision=function(a){return arguments.length?(g.precision(a),d.precision(a),k.precision(a),f):g.precision()},f.scale=function(a){return arguments.length?(g.scale(a),d.scale(0.35*a),k.scale(a),f.translate(g.translate())):g.scale()},f.translate=function(c){if(!arguments.length){return g.translate()}var a=g.scale(),e=+c[0],i=+c[1];return h=g.translate(c).clipExtent([[e-0.455*a,i-0.238*a],[e+0.455*a,i+0.238*a]]).stream(j).point,b=d.translate([e-0.307*a,i+0.201*a]).clipExtent([[e-0.425*a+dP,i+0.12*a+dP],[e-0.214*a-dP,i+0.234*a-dP]]).stream(j).point,l=k.translate([e-0.205*a,i+0.212*a]).clipExtent([[e-0.214*a+dP,i+0.166*a+dP],[e-0.115*a-dP,i+0.234*a-dP]]).stream(j).point,f},f.scale(1070)};var ds,im,af,hz,fA,d6,bS={point:h8,lineStart:h8,lineEnd:h8,polygonStart:function(){im=0,bS.lineStart=eM},polygonEnd:function(){bS.lineStart=bS.lineEnd=bS.point=h8,ds+=Math.abs(im/2)}},g3={point:cd,lineStart:h8,lineEnd:h8,polygonStart:h8,polygonEnd:h8},cJ={point:gq,lineStart:dj,lineEnd:hp,polygonStart:function(){cJ.lineStart=a9},polygonEnd:function(){cJ.point=gq,cJ.lineStart=dj,cJ.lineEnd=hp}};a5.geo.transform=function(a){return{stream:function(b){var d=new gP(b);for(var c in a){d[c]=a[c]}return d}}},gP.prototype={point:function(b,a){this.stream.point(b,a)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},a5.geo.path=function(){function k(a){return a&&("function"==typeof b&&d.pointRadius(+b.apply(this,arguments)),j&&j.valid||(j=c(d)),a5.geo.stream(a,j)),d.result()}function f(){return j=null,k}var h,g,c,d,j,b=4.5;return k.area=function(a){return ds=0,a5.geo.stream(a,c(bS)),ds},k.centroid=function(a){return jK=aM=fR=f8=fb=cO=jf=ed=dO=0,a5.geo.stream(a,c(cJ)),dO?[jf/dO,ed/dO]:cO?[f8/cO,fb/cO]:fR?[jK/fR,aM/fR]:[0/0,0/0]},k.bounds=function(a){return fA=d6=-(af=hz=1/0),a5.geo.stream(a,c(g3)),[[af,hz],[fA,d6]]},k.projection=function(a){return arguments.length?(c=(h=a)?a.stream||av(a):hb,f()):h},k.context=function(a){return arguments.length?(d=null==(g=a)?new gK:new ev(a),"function"!=typeof b&&d.pointRadius(b),f()):g},k.pointRadius=function(a){return arguments.length?(b="function"==typeof a?a:(d.pointRadius(+a),+a),k):b},k.projection(a5.geo.albersUsa()).context(null)},a5.geo.projection=iX,a5.geo.projectionMutator=aD,(a5.geo.equirectangular=function(){return iX(eR)}).raw=eR.invert=eR,a5.geo.rotation=function(b){function a(c){return c=b(c[0]*h0,c[1]*h0),c[0]*=jU,c[1]*=jU,c}return b=a0(b[0]%360*h0,b[1]*h0,b.length>2?b[2]*h0:0),a.invert=function(c){return c=b.invert(c[0]*h0,c[1]*h0),c[0]*=jU,c[1]*=jU,c},a},a5.geo.circle=function(){function f(){var h="function"==typeof c?c.apply(this,arguments):c,g=a0(-h[0]*h0,-h[1]*h0,0).invert,e=[];return d(null,null,1,{point:function(j,i){e.push(j=g(j,i)),j[0]*=jU,j[1]*=jU}}),{type:"Polygon",coordinates:[e]}}var b,d,c=[0,0],a=6;return f.origin=function(e){return arguments.length?(c=e,f):c},f.angle=function(e){return arguments.length?(d=cY((b=+e)*h0,a*h0),f):b},f.precision=function(e){return arguments.length?(d=cY(b*h0,(a=+e)*h0),f):a},f.angle(90)},a5.geo.distance=function(g,A){var m,b=(A[0]-g[0])*h0,v=g[1]*h0,j=A[1]*h0,d=Math.sin(b),q=Math.cos(b),p=Math.sin(v),h=Math.cos(v),B=Math.sin(j),k=Math.cos(j);return Math.atan2(Math.sqrt((m=k*d)*m+(m=h*B-p*k*q)*m),p*B+h*k*q)},a5.geo.graticule=function(){function E(){return{type:"MultiLineString",coordinates:q()}}function q(){return a5.range(Math.ceil(H/j)*j,k,j).map(I).concat(a5.range(Math.ceil(G/F)*F,O,F).map(J)).concat(a5.range(Math.ceil(B/C)*C,L,C).filter(function(a){return Math.abs(a%j)>dP}).map(A)).concat(a5.range(Math.ceil(P/N)*N,D,N).filter(function(a){return Math.abs(a%F)>dP}).map(K))}var L,B,k,H,D,P,O,G,A,K,I,J,C=10,N=C,j=90,F=360,b=2.5;return E.lines=function(){return q().map(function(a){return{type:"LineString",coordinates:a}})},E.outline=function(){return{type:"Polygon",coordinates:[I(H).concat(J(O).slice(1),I(k).reverse().slice(1),J(G).reverse().slice(1))]}},E.extent=function(a){return arguments.length?E.majorExtent(a).minorExtent(a):E.minorExtent()},E.majorExtent=function(a){return arguments.length?(H=+a[0][0],k=+a[1][0],G=+a[0][1],O=+a[1][1],H>k&&(a=H,H=k,k=a),G>O&&(a=G,G=O,O=a),E.precision(b)):[[H,G],[k,O]]},E.minorExtent=function(a){return arguments.length?(B=+a[0][0],L=+a[1][0],P=+a[0][1],D=+a[1][1],B>L&&(a=B,B=L,L=a),P>D&&(a=P,P=D,D=a),E.precision(b)):[[B,P],[L,D]]},E.step=function(a){return arguments.length?E.majorStep(a).minorStep(a):E.minorStep()},E.majorStep=function(a){return arguments.length?(j=+a[0],F=+a[1],E):[j,F]},E.minorStep=function(a){return arguments.length?(C=+a[0],N=+a[1],E):[C,N]},E.precision=function(a){return arguments.length?(b=+a,A=jp(P,D,90),K=bH(B,L,b),I=jp(G,O,90),J=bH(H,k,b),E):b},E.majorExtent([[-180,-90+dP],[180,90-dP]]).minorExtent([[-180,-80-dP],[180,80+dP]])},a5.geo.greatArc=function(){function f(){return{type:"LineString",coordinates:[b||c.apply(this,arguments),d||a.apply(this,arguments)]}}var b,d,c=bm,a=fs;return f.distance=function(){return a5.geo.distance(b||c.apply(this,arguments),d||a.apply(this,arguments))},f.source=function(g){return arguments.length?(c=g,b="function"==typeof g?null:g,f):c},f.target=function(e){return arguments.length?(a=e,d="function"==typeof e?null:e,f):a},f.precision=function(){return arguments.length?f:0},f},a5.geo.interpolate=function(b,a){return g6(b[0]*h0,b[1]*h0,a[0]*h0,a[1]*h0)},a5.geo.length=function(a){return bB=0,a5.geo.stream(a,fM),bB};var bB,fM={sphere:h8,point:h8,lineStart:jG,lineEnd:h8,polygonStart:h8,polygonEnd:h8},dG=aI(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(a5.geo.azimuthalEqualArea=function(){return iX(dG)}).raw=dG;var jB=aI(function(b){var a=Math.acos(b);return a&&a/Math.sin(a)},hb);(a5.geo.azimuthalEquidistant=function(){return iX(jB)}).raw=jB,(a5.geo.conicConformal=function(){return jA(fP)}).raw=fP,(a5.geo.conicEquidistant=function(){return jA(f6)}).raw=f6;var h6=aI(function(a){return 1/a},Math.atan);(a5.geo.gnomonic=function(){return iX(h6)}).raw=h6,e8.invert=function(b,a){return[b,2*Math.atan(Math.exp(a))-bV/2]},(a5.geo.mercator=function(){return cM(e8)}).raw=e8;var eO=aI(function(){return 1},Math.asin);(a5.geo.orthographic=function(){return iX(eO)}).raw=eO;var cg=aI(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(a5.geo.stereographic=function(){return iX(cg)}).raw=cg,i8.invert=function(b,a){return[Math.atan2(iE(b),Math.cos(a)),iI(Math.sin(a)/iq(b))]},(a5.geo.transverseMercator=function(){return cM(i8)}).raw=i8,a5.geom={},a5.svg={},a5.svg.line=function(){return d9(hb)};var gM=a5.map({linear:c2,"linear-closed":bY,step:dX,"step-before":dp,"step-after":ij,basis:gU,"basis-open":cz,"basis-closed":bq,bundle:fD,cardinal:fy,"cardinal-open":jX,"cardinal-closed":hw,monotone:gC});gM.forEach(function(b,a){a.key=b,a.closed=/-closed$/.test(b)});var f3=[0,2/3,1/3,0],gs=[0,1/3,2/3,0],dk=[0,1/6,2/3,1/6];a5.geom.hull=function(d){function a(E){if(E.length<3){return[]}var A,r,H,D,P,N,G,B,K,I,J,C,L=c6(c),q=c6(b),F=E.length,j=F-1,e=[],k=[],O=0;if(L===dK&&b===cn){A=E}else{for(H=0,A=[];F>H;++H){A.push([+L.call(this,r=E[H],H),+q.call(this,r,H)])}}for(H=1;F>H;++H){(A[H][1]<A[O][1]||A[H][1]==A[O][1]&&A[H][0]<A[O][0])&&(O=H)}for(H=0;F>H;++H){H!==O&&(N=A[H][1]-A[O][1],P=A[H][0]-A[O][0],e.push({angle:Math.atan2(N,P),index:H}))}for(e.sort(function(g,f){return g.angle-f.angle}),J=e[0].angle,I=e[0].index,K=0,H=1;j>H;++H){if(D=e[H].index,J==e[H].angle){if(P=A[I][0]-A[O][0],N=A[I][1]-A[O][1],G=A[D][0]-A[O][0],B=A[D][1]-A[O][1],P*P+N*N>=G*G+B*B){e[H].index=-1;continue}e[K].index=-1}J=e[H].angle,K=H,I=D}for(k.push(O),H=0,D=0;2>H;++D){e[D].index>-1&&(k.push(e[D].index),H++)}for(C=k.length;j>D;++D){if(!(e[D].index<0)){for(;!fU(k[C-2],k[C-1],e[D].index,A);){--C}k[C++]=e[D].index}}var Q=[];for(H=C-1;H>=0;--H){Q.push(E[k[H]])}return Q}var c=dK,b=cn;return arguments.length?a(d):(a.x=function(e){return arguments.length?(c=e,a):c},a.y=function(e){return arguments.length?(b=e,a):b},a)},a5.geom.polygon=function(a){return fj(a,hq),a};var hq=a5.geom.polygon.prototype=[];hq.area=function(){for(var f,b=-1,d=this.length,c=this[d-1],a=0;++b<d;){f=c,c=this[b],a+=f[1]*c[0]-f[0]*c[1]}return 0.5*a},hq.centroid=function(k){var f,h,g=-1,c=this.length,d=0,j=0,b=this[c-1];for(arguments.length||(k=-1/(6*this.area()));++g<c;){f=b,b=this[g],h=f[0]*b[1]-b[0]*f[1],d+=(f[0]+b[0])*h,j+=(f[1]+b[1])*h}return[d*k,j*k]},hq.clip=function(f){for(var q,j,b,p,h,d,m=hd(f),k=-1,g=this.length-hd(this),v=this[g-1];++k<g;){for(q=f.slice(),f.length=0,p=this[k],h=q[(b=q.length-m)-1],j=-1;++j<b;){d=q[j],gd(d,v,p)?(gd(h,v,p)||f.push(c7(h,d,v,p)),f.push(d)):gd(h,v,p)&&f.push(c7(h,d,v,p)),h=d}m&&f.push(f[0]),v=p}return f},a5.geom.delaunay=function(c){var a=c.map(function(){return[]}),b=[];return a3(c,function(d){a[d.region.l.index].push(c[d.region.r.index])}),a.forEach(function(g,h){var e=c[h],f=e[0],j=e[1];g.forEach(function(i){i.angle=Math.atan2(i[0]-f,i[1]-j)}),g.sort(function(l,i){return l.angle-i.angle});for(var d=0,k=g.length-1;k>d;d++){b.push([e,g[d],g[d+1]])}}),b},a5.geom.voronoi=function(f){function b(g){var q,j,e,p=g.map(function(){return[]}),m=c6(d),h=c6(c),r=g.length,k=1000000;if(m===dK&&h===cn){q=g}else{for(q=new Array(r),e=0;r>e;++e){q[e]=[+m.call(this,j=g[e],e),+h.call(this,j,e)]}}if(a3(q,function(A){var G,D,s,F,C,v;1===A.a&&A.b>=0?(G=A.ep.r,D=A.ep.l):(G=A.ep.l,D=A.ep.r),1===A.a?(C=G?G.y:-k,s=A.c-A.b*C,v=D?D.y:k,F=A.c-A.b*v):(s=G?G.x:-k,C=A.c-A.a*s,F=D?D.x:k,v=A.c-A.a*F);var E=[s,C],B=[F,v];p[A.region.l.index].push(E,B),p[A.region.r.index].push(E,B)}),p=p.map(function(B,v){var t=q[v][0],l=q[v][1],s=B.map(function(i){return Math.atan2(i[0]-t,i[1]-l)}),A=a5.range(B.length).sort(function(o,i){return s[o]-s[i]});return A.filter(function(o,i){return !i||s[o]-s[A[i-1]]>dP}).map(function(i){return B[i]})}),p.forEach(function(C,I){var t=C.length;if(!t){return C.push([-k,-k],[-k,k],[k,k],[k,-k])}if(!(t>2)){var P=q[I],F=C[0],B=C[1],N=P[0],K=P[1],E=F[0],Q=F[1],G=B[0],H=B[1],A=Math.abs(G-E),J=H-Q;if(Math.abs(J)<dP){var O=Q>K?-k:k;C.push([-k,O],[k,O])}else{if(dP>A){var D=E>N?-k:k;C.push([D,-k],[D,k])}else{var O=(E-N)*(H-Q)>(G-E)*(Q-K)?k:-k,L=Math.abs(J)-A;Math.abs(L)<dP?C.push([0>J?O:-O,O]):(L>0&&(O*=-1),C.push([-k,O],[k,O]))}}}}),a){for(e=0;r>e;++e){a.clip(p[e])}}for(e=0;r>e;++e){p[e].point=g[e]}return p}var d=dK,c=cn,a=null;return arguments.length?b(f):(b.x=function(e){return arguments.length?(d=e,b):d},b.y=function(e){return arguments.length?(c=e,b):c},b.clipExtent=function(l){if(!arguments.length){return a&&[a[0],a[2]]}if(null==l){a=null}else{var j=+l[0][0],h=+l[0][1],g=+l[1][0],k=+l[1][1];a=a5.geom.polygon([[j,h],[j,k],[g,k],[g,h]])}return b},b.size=function(e){return arguments.length?b.clipExtent(e&&[[0,0],e]):a&&a[2]},b.links=function(g){var q,p,j,e=g.map(function(){return[]}),m=[],k=c6(d),h=c6(c),r=g.length;if(k===dK&&h===cn){q=g}else{for(q=new Array(r),j=0;r>j;++j){q[j]=[+k.call(this,p=g[j],j),+h.call(this,p,j)]}}return a3(q,function(i){var n=i.region.l.index,l=i.region.r.index;e[n][l]||(e[n][l]=e[l][n]=!0,m.push({source:g[n],target:g[l]}))}),m},b.triangles=function(m){if(d===dK&&c===cn){return a5.geom.delaunay(m)}for(var j,g=new Array(l),h=c6(d),k=c6(c),e=-1,l=m.length;++e<l;){(g[e]=[+h.call(this,j=m[e],e),+k.call(this,j,e)]).data=j}return a5.geom.delaunay(g).map(function(i){return i.map(function(o){return o.data})})},b)};var bd={l:"r",r:"l"};a5.geom.quadtree=function(f,m,h,b,l){function g(B){function F(E,T,P,p,S,N,v,R){if(!isNaN(P)&&!isNaN(p)){if(E.leaf){var Q=E.x,U=E.y;if(null!=Q){if(Math.abs(Q-P)+Math.abs(U-p)<0.01){D(E,T,P,p,S,N,v,R)}else{var O=E.point;E.x=E.y=E.point=null,D(E,O,Q,U,S,N,v,R),D(E,T,P,p,S,N,v,R)}}else{E.x=P,E.y=p,E.point=T}}else{D(E,T,P,p,S,N,v,R)}}}function D(v,U,Q,i,T,p,S,R){var E=0.5*(T+S),V=0.5*(p+R),P=Q>=E,N=i>=V,O=(N<<1)+P;v.leaf=!1,v=v.nodes[O]||(v.nodes[O]=gH()),P?T=E:S=E,N?p=V:R=V,F(v,U,Q,i,T,p,S,R)}var u,I,G,H,A,J,r,C,e,c=c6(k),o=c6(j);if(null!=m){J=m,r=h,C=b,e=l}else{if(C=e=-(J=r=1/0),I=[],G=[],A=B.length,d){for(H=0;A>H;++H){u=B[H],u.x<J&&(J=u.x),u.y<r&&(r=u.y),u.x>C&&(C=u.x),u.y>e&&(e=u.y),I.push(u.x),G.push(u.y)}}else{for(H=0;A>H;++H){var K=+c(u=B[H],H),L=+o(u,H);J>K&&(J=K),r>L&&(r=L),K>C&&(C=K),L>e&&(e=L),I.push(K),G.push(L)}}}var q=C-J,a=e-r;q>a?e=r+q:C=J+a;var t=gH();if(t.add=function(i){F(t,i,+c(i,++H),+o(i,H),J,r,C,e)},t.visit=function(i){ad(i,t,J,r,C,e)},H=-1,null==m){for(;++H<A;){F(t,B[H],I[H],G[H],J,r,C,e)}--H}else{B.forEach(t.add)}return I=G=B=u=null,t}var d,k=dK,j=cn;return(d=arguments.length)?(k=eh,j=jJ,3===d&&(l=h,b=m,h=m=0),g(f)):(g.x=function(a){return arguments.length?(k=a,g):k},g.y=function(a){return arguments.length?(j=a,g):j},g.extent=function(a){return arguments.length?(null==a?m=h=b=l=null:(m=+a[0][0],h=+a[0][1],b=+a[1][0],l=+a[1][1]),g):null==m?null:[[m,h],[b,l]]},g.size=function(a){return arguments.length?(null==a?m=h=b=l=null:(m=h=0,b=+a[0],l=+a[1]),g):null==m?null:[b-m,l-h]},g)},a5.interpolateRgb=iC,a5.interpolateObject=am,a5.interpolateNumber=aL,a5.interpolateString=eJ;var ew=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;a5.interpolate=aU,a5.interpolators=[function(c,a){var b=typeof a;return("string"===b?f4.has(a)||/^(#|rgb\(|hsl\()/.test(a)?iC:eJ:a instanceof iy?iC:"object"===b?Array.isArray(a)?eW:am:aL)(c,a)}],a5.interpolateArray=eW;var jR=function(){return hb},gQ=a5.map({linear:jR,poly:bf,quad:function(){return ep},cubic:function(){return jd},sin:function(){return fh},exp:function(){return gZ},circle:function(){return jw},elastic:az,back:fI,bounce:function(){return fZ}}),ay=a5.map({"in":hb,out:gm,"in-out":cR,"out-in":function(a){return cR(gm(a))}});a5.ease=function(d){var a=d.indexOf("-"),c=a>=0?d.substring(0,a):d,b=a>=0?d.substring(a+1):"in";return c=gQ.get(c)||jR,b=ay.get(b)||hb,ch(b(c.apply(null,Array.prototype.slice.call(arguments,1))))},a5.interpolateHcl=e1,a5.interpolateHsl=cF,a5.interpolateLab=iP,a5.interpolateRound=d0,a5.transform=function(b){var a=gJ.createElementNS(a5.ns.prefix.svg,"g");return(a5.transform=function(d){if(null!=d){a.setAttribute("transform",d);var c=a.transform.baseVal.consolidate()}return new dC(c?c.matrix:iZ)})(b)},dC.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var iZ={a:1,b:0,c:0,d:1,e:0,f:0};a5.interpolateTransform=dN,a5.layout={},a5.layout.bundle=function(){return function(d){for(var a=[],c=-1,b=d.length;++c<b;){a.push(jS(d[c]))}return a}},a5.layout.chord=function(){function f(){var c,i,t,r,s,a={},A=[],G=a5.range(h),e=[];for(j=[],b=[],c=0,r=-1;++r<h;){for(i=0,s=-1;++s<h;){i+=p[r][s]}A.push(i),e.push(a5.range(h)),c+=i}for(d&&G.sort(function(H,l){return d(A[H],A[l])}),m&&e.forEach(function(H,l){H.sort(function(J,I){return m(p[l][J],p[l][I])})}),c=(2*bV-v*h)/c,i=0,r=-1;++r<h;){for(t=i,s=-1;++s<h;){var C=G[r],u=e[C][s],D=p[C][u],B=i,F=i+=D*c;a[C+"-"+u]={index:C,subindex:u,startAngle:B,endAngle:F,value:D}}b[C]={index:C,startAngle:t,endAngle:i,value:(i-t)/c},i+=v}for(r=-1;++r<h;){for(s=r-1;++s<h;){var E=a[r+"-"+s],o=a[s+"-"+r];(E.value||o.value)&&j.push(E.value<o.value?{source:o,target:E}:{source:E,target:o})}}k&&q()}function q(){j.sort(function(c,a){return k((c.source.value+c.target.value)/2,(a.source.value+a.target.value)/2)})}var j,b,p,h,d,m,k,g={},v=0;return g.matrix=function(a){return arguments.length?(h=(p=a)&&p.length,j=b=null,g):p},g.padding=function(a){return arguments.length?(v=a,j=b=null,g):v},g.sortGroups=function(a){return arguments.length?(d=a,j=b=null,g):d},g.sortSubgroups=function(a){return arguments.length?(m=a,j=null,g):m},g.sortChords=function(a){return arguments.length?(k=a,j&&q(),g):k},g.chords=function(){return j||f(),j},g.groups=function(){return b||f(),b},g},a5.layout.force=function(){function D(a){return function(h,m,l,f){if(h.point!==a){var g=h.cx-a.x,n=h.cy-a.y,d=1/Math.sqrt(g*g+n*n);if(L>(f-m)*d){var p=h.charge*d*d;return a.px-=g*p,a.py-=n*p,!0}if(h.point&&isFinite(d)){var p=h.pointCharge*d*d;a.px-=g*p,a.py-=n*p}}return !h.charge}}function k(a){a.px=a5.event.x,a.py=a5.event.y,O.resume()}var K,A,j,G,C,O={},N=a5.dispatch("start","tick","end"),F=[1,1],q=0.9,J=aE,H=aT,I=-30,B=0.1,L=0.8,b=[],E=[];return O.tick=function(){if((A*=0.99)<0.005){return N.end({type:"end",alpha:A=0}),!0}var u,i,r,g,c,m,o,l,p,n=b.length,s=E.length;for(i=0;s>i;++i){r=E[i],g=r.source,c=r.target,l=c.x-g.x,p=c.y-g.y,(m=l*l+p*p)&&(m=A*G[i]*((m=Math.sqrt(m))-j[i])/m,l*=m,p*=m,c.x-=l*(o=g.weight/(c.weight+g.weight)),c.y-=p*o,g.x+=l*(o=1-o),g.y+=p*o)}if((o=A*B)&&(l=F[0]/2,p=F[1]/2,i=-1,o)){for(;++i<n;){r=b[i],r.x+=(l-r.x)*o,r.y+=(p-r.y)*o}}if(I){for(bk(u=a5.geom.quadtree(b),A,C),i=-1;++i<n;){(r=b[i]).fixed||u.visit(D(r))}}for(i=-1;++i<n;){r=b[i],r.fixed?(r.x=r.px,r.y=r.py):(r.x-=(r.px-(r.px=r.x))*q,r.y-=(r.py-(r.py=r.y))*q)}N.tick({type:"tick",alpha:A})},O.nodes=function(a){return arguments.length?(b=a,O):b},O.links=function(a){return arguments.length?(E=a,O):E},O.size=function(a){return arguments.length?(F=a,O):F},O.linkDistance=function(a){return arguments.length?(J="function"==typeof a?a:+a,O):J},O.distance=O.linkDistance,O.linkStrength=function(a){return arguments.length?(H="function"==typeof a?a:+a,O):H},O.friction=function(a){return arguments.length?(q=+a,O):q},O.charge=function(a){return arguments.length?(I="function"==typeof a?a:+a,O):I},O.gravity=function(a){return arguments.length?(B=+a,O):B},O.theta=function(a){return arguments.length?(L=+a,O):L},O.alpha=function(a){return arguments.length?(a=+a,A?A=a>0?a:0:a>0&&(N.start({type:"start",alpha:A=a}),a5.timer(O.tick)),O):A},O.start=function(){function g(t,p){for(var d,e=u(h),s=-1,c=e.length;++s<c;){if(!isNaN(d=e[s][t])){return d}}return Math.random()*p}function u(){if(!m){for(m=[],a=0;f>a;++a){m[a]=[]}for(a=0;l>a;++a){var c=E[a];m[c.source.index].push(c.target),m[c.target.index].push(c.source)}}return m[h]}var h,a,m,v,f=b.length,l=E.length,o=F[0],i=F[1];for(h=0;f>h;++h){(v=b[h]).index=h,v.weight=0}for(h=0;l>h;++h){v=E[h],"number"==typeof v.source&&(v.source=b[v.source]),"number"==typeof v.target&&(v.target=b[v.target]),++v.source.weight,++v.target.weight}for(h=0;f>h;++h){v=b[h],isNaN(v.x)&&(v.x=g("x",o)),isNaN(v.y)&&(v.y=g("y",i)),isNaN(v.px)&&(v.px=v.x),isNaN(v.py)&&(v.py=v.y)}if(j=[],"function"==typeof J){for(h=0;l>h;++h){j[h]=+J.call(this,E[h],h)}}else{for(h=0;l>h;++h){j[h]=J}}if(G=[],"function"==typeof H){for(h=0;l>h;++h){G[h]=+H.call(this,E[h],h)}}else{for(h=0;l>h;++h){G[h]=H}}if(C=[],"function"==typeof I){for(h=0;f>h;++h){C[h]=+I.call(this,b[h],h)}}else{for(h=0;f>h;++h){C[h]=I}}return O.resume()},O.resume=function(){return O.alpha(0.1)},O.stop=function(){return O.alpha(0)},O.drag=function(){return K||(K=a5.behavior.drag().origin(hb).on("dragstart.force",dQ).on("drag.force",k).on("dragend.force",bG)),arguments.length?(this.on("mouseover.force",gS).on("mouseout.force",cv).call(K),void 0):K},a5.rebind(O,N,"on")};var aE=20,aT=1;a5.layout.hierarchy=function(){function g(u,i,r){var q=a.call(f,u,i);if(u.depth=i,r.push(u),q&&(j=q.length)){for(var j,v,n=-1,k=u.children=[],m=0,e=i+1;++n<j;){v=g(q[n],e,r),v.parent=u,k.push(v),m+=v.value}d&&k.sort(d),b&&(u.value=m)}else{b&&(u.value=+b.call(f,u,i)||0)}return u}function c(p,j){var i=p.children,k=0;if(i&&(h=i.length)){for(var h,m=-1,e=j+1;++m<h;){k+=c(i[m],e)}}else{b&&(k=+b.call(f,p,j)||0)}return b&&(p.value=k),k}function f(h){var i=[];return g(h,0,i),i}var d=hE,a=dv,b=jh;return f.sort=function(e){return arguments.length?(d=e,f):d},f.children=function(e){return arguments.length?(a=e,f):a},f.value=function(e){return arguments.length?(b=e,f):b},f.revalue=function(e){return c(e,0),e},f},a5.layout.partition=function(){function f(s,m,g,q){var k=s.children;if(s.x=m,s.y=s.depth*q,s.dx=g,s.dy=q,k&&(h=k.length)){var h,p,n,j=-1;for(g=s.value?g/s.value:0;++j<h;){f(p=k[j],m,n=p.value*g,q),m+=n}}}function b(l){var k=l.children,j=0;if(k&&(g=k.length)){for(var g,h=-1;++h<g;){j=Math.max(j,b(k[h]))}}return 1+j}function d(h,g){var j=c.call(this,h,g);return f(j[0],0,a[0],a[1]/b(j[0])),j}var c=a5.layout.hierarchy(),a=[1,1];return d.size=function(e){return arguments.length?(a=e,d):a},fB(d,c)},a5.layout.pie=function(){function f(h){var k=h.map(function(l,i){return +b.call(f,l,i)}),g=+("function"==typeof c?c.apply(this,arguments):c),m=(("function"==typeof a?a.apply(this,arguments):a)-g)/a5.sum(k),e=a5.range(h.length);null!=d&&e.sort(d===eS?function(l,i){return k[i]-k[l]}:function(l,i){return d(h[l],h[i])});var j=[];return e.forEach(function(l){var i;j[l]={data:h[l],value:i=k[l],startAngle:g,endAngle:g+=i*m}}),j}var b=Number,d=eS,c=0,a=2*bV;return f.value=function(g){return arguments.length?(b=g,f):b},f.sort=function(e){return arguments.length?(d=e,f):d},f.startAngle=function(e){return arguments.length?(c=e,f):c},f.endAngle=function(e){return arguments.length?(a=e,f):a},f};var eS={};a5.layout.stack=function(){function h(t,r){var j=t.map(function(m,l){return c.call(h,m,l)}),A=j.map(function(l){return l.map(function(m,p){return[b.call(h,m,p),g.call(h,m,p)]})}),o=f.call(h,A,r);j=a5.permute(j,o),A=a5.permute(A,o);var k,n,e,q=d.call(h,A,r),u=j.length,i=j[0].length;for(n=0;i>n;++n){for(a.call(h,j[0][n],e=q[n],A[0][n][1]),k=1;u>k;++k){a.call(h,j[k][n],e+=A[k-1][n][1],A[k][n][1])}}return t}var c=hb,f=f9,d=c5,a=fS,b=bX,g=gA;return h.values=function(i){return arguments.length?(c=i,h):c},h.order=function(e){return arguments.length?(f="function"==typeof e?e:a2.get(e)||f9,h):f},h.offset=function(e){return arguments.length?(d="function"==typeof e?e:e5.get(e)||c5,h):d},h.x=function(e){return arguments.length?(b=e,h):b},h.y=function(e){return arguments.length?(g=e,h):g},h.out=function(e){return arguments.length?(a=e,h):a},h};var a2=a5.map({"inside-out":function(f){var q,j,b=f.length,p=f.map(g9),h=f.map(aZ),d=a5.range(b).sort(function(c,a){return p[c]-p[a]}),m=0,k=0,g=[],v=[];for(q=0;b>q;++q){j=d[q],k>m?(m+=h[j],g.push(j)):(k+=h[j],v.push(j))}return v.reverse().concat(g)},reverse:function(a){return a5.range(a.length).reverse()},"default":f9}),e5=a5.map({silhouette:function(f){var m,h,b,l=f.length,g=f[0].length,d=[],k=0,j=[];for(h=0;g>h;++h){for(m=0,b=0;l>m;m++){b+=f[m][h][1]}b>k&&(k=b),d.push(b)}for(h=0;g>h;++h){j[h]=(k-d[h])/2}return j},wiggle:function(j){var E,A,b,D,m,d,C,B,k,F=j.length,v=j[0],p=v.length,q=[];for(q[0]=B=k=0,A=1;p>A;++A){for(E=0,D=0;F>E;++E){D+=j[E][A][1]}for(E=0,m=0,C=v[A][0]-v[A-1][0];F>E;++E){for(b=0,d=(j[E][A][1]-j[E][A-1][1])/(2*C);E>b;++b){d+=(j[b][A][1]-j[b][A-1][1])/C}m+=d*j[E][A][1]}q[A]=B-=D?m/D*C:0,k>B&&(k=B)}for(A=0;p>A;++A){q[A]-=k}return q},expand:function(k){var f,h,g,c=k.length,d=k[0].length,j=1/c,b=[];for(h=0;d>h;++h){for(f=0,g=0;c>f;f++){g+=k[f][h][1]}if(g){for(f=0;c>f;f++){k[f][h][1]/=g}}else{for(f=0;c>f;f++){k[f][h][1]=j}}}for(h=0;d>h;++h){b[h]=0}return b},zero:c5});a5.layout.histogram=function(){function f(k,q){for(var j,A,v=[],m=k.map(d,this),B=c.call(this,m,q),u=a.call(this,B,m,q),q=-1,r=m.length,t=u.length-1,e=b?1:1/r;++q<t;){j=v[q]=[],j.dx=u[q+1]-(j.x=u[q]),j.y=0}if(t>0){for(q=-1;++q<r;){A=m[q],A>=B[0]&&A<=B[1]&&(j=v[a5.bisect(u,A,1,t)-1],j.y+=e,j.push(k[q]))}}return v}var b=!0,d=Number,c=jW,a=jF;return f.value=function(e){return arguments.length?(d=e,f):d},f.range=function(e){return arguments.length?(c=c6(e),f):c},f.bins=function(e){return arguments.length?(a="number"==typeof e?function(g){return gE(g,e)}:c6(e),f):a},f.frequency=function(g){return arguments.length?(b=!!g,f):b},f},a5.layout.tree=function(){function f(k,q){function j(p,L){var o=p.children,K=p._tree;if(o&&(F=o.length)){for(var F,J,v,N=o[0],I=N,G=-1;++G<F;){v=o[G],j(v,J),I=B(v,J,I),J=v}cP(p);var H=0.5*(N._tree.prelim+v._tree.prelim);L?(K.prelim=L._tree.prelim+d(p,L),K.mod=K.prelim-H):K.prelim=H}else{L&&(K.prelim=L._tree.prelim+d(p,L))}}function C(o,h){o.x=o._tree.prelim+h;var l=o.children;if(l&&(i=l.length)){var i,g=-1;for(h+=o._tree.mod;++g<i;){C(l[g],h)}}}function B(v,N,g){if(N){for(var L,G=v,p=v,K=N,J=v.parent.children[0],F=G._tree.mod,O=p._tree.mod,I=K._tree.mod,H=J._tree.mod;K=aH(K),G=ah(G),K&&G;){J=ah(J),p=aH(p),p._tree.ancestor=v,L=K._tree.prelim+I-G._tree.prelim-F+d(K,G),L>0&&(ek(i7(K,v,g),v,L),F+=L,O+=L),I+=K._tree.mod,F+=G._tree.mod,H+=J._tree.mod,O+=p._tree.mod}K&&!aH(p)&&(p._tree.thread=K,p._tree.mod+=I-O),G&&!ah(J)&&(J._tree.thread=G,J._tree.mod+=F-H,g=v)}return g}var m=b.call(this,k,q),E=m[0];gh(E,function(h,g){h._tree={ancestor:h,prelim:0,mod:0,change:0,shift:0,number:g?g._tree.number+1:0}}),j(E),C(E,-E._tree.prelim);var u=eG(E,eU),r=eG(E,aQ),t=eG(E,cb),e=u.x-d(u,r)/2,A=r.x+d(r,u)/2,D=t.depth||1;return gh(E,a?function(g){g.x*=c[0],g.y=g.depth*c[1],delete g._tree}:function(g){g.x=(g.x-e)/(A-e)*c[0],g.y=g.depth/D*c[1],delete g._tree}),m}var b=a5.layout.hierarchy().sort(null).value(null),d=ix,c=[1,1],a=!1;return f.separation=function(e){return arguments.length?(d=e,f):d},f.size=function(e){return arguments.length?(a=null==(c=e),f):a?null:c},f.nodeSize=function(e){return arguments.length?(a=null!=(c=e),f):a?c:null},fB(f,b)},a5.layout.pack=function(){function f(q,h){var m=d.call(this,q,h),g=m[0],p=a[0],e=a[1],j=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(g.x=g.y=0,gh(g,function(i){i.r=+j(i.value)}),gh(g,jn),c){var k=c*(b?1:Math.max(2*g.r/p,2*g.r/e))/2;gh(g,function(i){i.r+=k}),gh(g,jn),gh(g,function(i){i.r-=k})}return fW(g,p/2,e/2,b?1:1/Math.max(2*g.r/p,2*g.r/e)),m}var b,d=a5.layout.hierarchy().sort(by),c=0,a=[1,1];return f.size=function(e){return arguments.length?(a=e,f):a},f.radius=function(g){return arguments.length?(b=null==g||"function"==typeof g?g:+g,f):b},f.padding=function(e){return arguments.length?(c=+e,f):c},fB(f,d)},a5.layout.cluster=function(){function f(j,m){var e,u=b.call(this,j,m),t=u[0],k=0;gh(t,function(h){var g=h.children;g&&g.length?(h.x=iJ(g),h.y=cC(g)):(h.x=e?k+=d(h,e):0,h.y=0,e=h)});var v=dV(t),r=dz(t),p=v.x-d(v,r)/2,q=r.x+d(r,v)/2;return gh(t,a?function(g){g.x=(g.x-t.x)*c[0],g.y=(t.y-g.y)*c[1]}:function(g){g.x=(g.x-p)/(q-p)*c[0],g.y=(1-(t.y?g.y/t.y:1))*c[1]}),u}var b=a5.layout.hierarchy().sort(null).value(null),d=ix,c=[1,1],a=!1;return f.separation=function(e){return arguments.length?(d=e,f):d},f.size=function(e){return arguments.length?(a=null==(c=e),f):a?null:c},f.nodeSize=function(e){return arguments.length?(a=null!=(c=e),f):a?c:null},fB(f,b)},a5.layout.treemap=function(){function k(l,f){for(var h,g,a=-1,c=l.length;++a<c;){g=(h=l[a]).value*(0>f?0:f),h.area=isNaN(g)||0>=g?0:g}}function G(u){var r=u.children;if(r&&r.length){var g,K,J,n=B(u),L=[],t=r.slice(),f=1/0,I="slice"===A?n.dx:"dice"===A?n.dy:"slice-dice"===A?1&u.depth?n.dy:n.dx:Math.min(n.dx,n.dy);for(k(t,n.dx*n.dy/u.value),L.area=0;(J=t.length)>0;){L.push(g=t[J-1]),L.area+=g.area,"squarify"!==A||(K=b(L,I))<=f?(t.pop(),f=K):(L.area-=L.pop().area,F(L,I,n,!1),I=Math.min(n.dx,n.dy),L.length=L.area=0,f=1/0)}L.length&&(F(L,I,n,!0),L.length=L.area=0),r.forEach(G)}}function C(g){var h=g.children;if(h&&h.length){var f,l=B(g),e=h.slice(),n=[];for(k(e,l.dx*l.dy/g.value),n.area=0;f=e.pop();){n.push(f),n.area+=f.area,null!=f.z&&(F(n,f.z?l.dx:l.dy,l,!e.length),n.length=n.area=0)}h.forEach(C)}}function b(I,h){for(var p,l=I.area,f=0,g=1/0,s=-1,c=I.length;++s<c;){(p=I[s].area)&&(g>p&&(g=p),p>f&&(f=p))}return l*=l,h*=h,l?Math.max(h*f*d/l,l/(h*g*d)):1/0}function F(g,L,I,c){var K,p=-1,f=g.length,J=I.x,h=I.y,N=L?D(g.area/L):0;if(L==I.dx){for((c||N>I.dy)&&(N=I.dy);++p<f;){K=g[p],K.x=J,K.y=h,K.dy=N,J+=K.dx=Math.min(I.x+I.dx-J,N?D(K.area/N):0)}K.z=!0,K.dx+=I.x+I.dx-J,I.y+=N,I.dy-=N}else{for((c||N>I.dx)&&(N=I.dx);++p<f;){K=g[p],K.x=J,K.y=h,K.dx=N,h+=K.dy=Math.min(I.y+I.dy-h,N?D(K.area/N):0)}K.z=!1,K.dy+=I.y+I.dy-h,I.x+=N,I.dx-=N}}function q(e){var a=j||E(e),c=a[0];return c.x=0,c.y=0,c.dx=m[0],c.dy=m[1],j&&E.revalue(c),k([c],c.dx*c.dy/c.value),(j?C:G)(c),v&&(j=a),a}var j,E=a5.layout.hierarchy(),D=Math.round,m=[1,1],H=null,B=b4,v=!1,A="squarify",d=0.5*(1+Math.sqrt(5));return q.size=function(a){return arguments.length?(m=a,q):m},q.padding=function(g){function a(h){var i=g.call(q,h,h.depth);return null==i?b4(h):cT(h,"number"==typeof i?[i,i,i,i]:i)}function f(e){return cT(e,g)}if(!arguments.length){return H}var c;return B=null==(H=g)?b4:"function"==(c=typeof g)?a:"number"===c?(g=[g,g,g,g],f):f,q},q.round=function(a){return arguments.length?(D=a?Math.round:Number,q):D!=Number},q.sticky=function(a){return arguments.length?(v=a,j=null,q):v},q.ratio=function(a){return arguments.length?(d=a,q):d},q.mode=function(a){return arguments.length?(A=a+"",q):A},fB(q,E)},a5.random={normal:function(c,a){var b=arguments.length;return 2>b&&(a=1),1>b&&(c=0),function(){var g,f,d;do{g=2*Math.random()-1,f=2*Math.random()-1,d=g*g+f*f}while(!d||d>1);return c+a*g*Math.sqrt(-2*Math.log(d)/d)}},logNormal:function(){var a=a5.random.normal.apply(a5,arguments);return function(){return Math.exp(a())}},irwinHall:function(a){return function(){for(var b=0,c=0;a>c;c++){b+=Math.random()}return b/a}}},a5.scale={};var cy={floor:hb,ceil:hb};a5.scale.linear=function(){return fk([0,1],[0,1],aU,!1)},a5.scale.log=function(){return fJ(a5.scale.linear().domain([0,1]),10,!0,[1,10])};var gy=a5.format(".0e"),cZ={floor:function(a){return -Math.ceil(-a)},ceil:function(a){return -Math.floor(-a)}};a5.scale.pow=function(){return dD(a5.scale.linear(),1,[0,1])},a5.scale.sqrt=function(){return a5.scale.pow().exponent(0.5)},a5.scale.ordinal=function(){return hY([],{t:"range",a:[[]]})},a5.scale.category10=function(){return a5.scale.ordinal().range(eA)},a5.scale.category20=function(){return a5.scale.ordinal().range(jv)},a5.scale.category20b=function(){return a5.scale.ordinal().range(bJ)},a5.scale.category20c=function(){return a5.scale.ordinal().range(bp)};var eA=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(fC),jv=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(fC),bJ=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(fC),bp=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(fC);a5.scale.quantile=function(){return eK([],[])},a5.scale.quantize=function(){return b8(0,1,[0,1])},a5.scale.threshold=function(){return gI([0.5],[0,1])},a5.scale.identity=function(){return f0([0,1])},a5.svg.arc=function(){function f(){var j=b.apply(this,arguments),m=d.apply(this,arguments),e=c.apply(this,arguments)+fv,u=a.apply(this,arguments)+fv,t=(e>u&&(t=e,e=u,u=t),u-e),k=bV>t?"0":"1",v=Math.cos(e),r=Math.sin(e),p=Math.cos(u),q=Math.sin(u);return t>=g7?j?"M0,"+m+"A"+m+","+m+" 0 1,1 0,"+-m+"A"+m+","+m+" 0 1,1 0,"+m+"M0,"+j+"A"+j+","+j+" 0 1,0 0,"+-j+"A"+j+","+j+" 0 1,0 0,"+j+"Z":"M0,"+m+"A"+m+","+m+" 0 1,1 0,"+-m+"A"+m+","+m+" 0 1,1 0,"+m+"Z":j?"M"+m*v+","+m*r+"A"+m+","+m+" 0 "+k+",1 "+m*p+","+m*q+"L"+j*p+","+j*q+"A"+j+","+j+" 0 "+k+",0 "+j*v+","+j*r+"Z":"M"+m*v+","+m*r+"A"+m+","+m+" 0 "+k+",1 "+m*p+","+m*q+"L0,0Z"}var b=gn,d=dg,c=hm,a=a7;return f.innerRadius=function(g){return arguments.length?(b=c6(g),f):b},f.outerRadius=function(e){return arguments.length?(d=c6(e),f):d},f.startAngle=function(e){return arguments.length?(c=c6(e),f):c},f.endAngle=function(e){return arguments.length?(a=c6(e),f):a},f.centroid=function(){var g=(b.apply(this,arguments)+d.apply(this,arguments))/2,e=(c.apply(this,arguments)+a.apply(this,arguments))/2+fv;return[Math.cos(e)*g,Math.sin(e)*g]},f};var fv=-bV/2,g7=2*bV-0.000001;a5.svg.line.radial=function(){var a=d9(eq);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},dp.reverse=ij,ij.reverse=dp,a5.svg.area=function(){return jN(hb)},a5.svg.area.radial=function(){var a=jN(eq);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},a5.svg.chord=function(){function f(r,i){var o=q(this,h,r,i),e=q(this,d,r,i);return"M"+o.p0+b(o.r,o.p1,o.a1-o.a0)+(j(o,e)?p(o.r,o.p1,o.r,o.p0):p(o.r,o.p1,e.r,e.p0)+b(e.r,e.p1,e.a1-e.a0)+p(e.r,e.p1,o.r,o.p0))+"Z"}function q(D,l,B,A){var a=l.call(D,B,A),c=m.call(D,a,A),C=k.call(D,a,A)+fv,v=g.call(D,a,A)+fv;return{r:c,a0:C,a1:v,p0:[c*Math.cos(C),c*Math.sin(C)],p1:[c*Math.cos(v),c*Math.sin(v)]}}function j(c,a){return c.a0==a.a0&&c.a1==a.a1}function b(i,a,c){return"A"+i+","+i+" 0 "+ +(c>bV)+",1 "+a}function p(l,a,i,c){return"Q 0,0 "+c}var h=bm,d=fs,m=gO,k=hm,g=a7;return f.radius=function(a){return arguments.length?(m=c6(a),f):m},f.source=function(a){return arguments.length?(h=c6(a),f):h},f.target=function(a){return arguments.length?(d=c6(a),f):d},f.startAngle=function(a){return arguments.length?(k=c6(a),f):k},f.endAngle=function(a){return arguments.length?(g=c6(a),f):g},f},a5.svg.diagonal=function(){function d(k,f){var g=a.call(this,k,f),h=c.call(this,k,f),e=(g.y+h.y)/2,j=[g,{x:g.x,y:e},{x:h.x,y:e},h];return j=j.map(b),"M"+j[0]+"C"+j[1]+" "+j[2]+" "+j[3]}var a=bm,c=fs,b=an;return d.source=function(f){return arguments.length?(a=c6(f),d):a},d.target=function(e){return arguments.length?(c=c6(e),d):c},d.projection=function(e){return arguments.length?(b=e,d):b},d},a5.svg.diagonal.radial=function(){var c=a5.svg.diagonal(),a=an,b=c.projection;return c.projection=function(d){return arguments.length?b(iQ(a=d)):a},c},a5.svg.symbol=function(){function c(e,d){return(jI.get(a.call(this,e,d))||eQ)(b.call(this,e,d))}var a=aP,b=aB;return c.type=function(d){return arguments.length?(a=c6(d),c):a},c.size=function(d){return arguments.length?(b=c6(d),c):b},c};var jI=a5.map({circle:eQ,cross:function(b){var a=Math.sqrt(b/5)/2;return"M"+-3*a+","+-a+"H"+-a+"V"+-3*a+"H"+a+"V"+-a+"H"+3*a+"V"+a+"H"+a+"V"+3*a+"H"+-a+"V"+a+"H"+-3*a+"Z"},diamond:function(c){var a=Math.sqrt(c/(2*e9)),b=a*e9;return"M0,"+-a+"L"+b+",0 0,"+a+" "+-b+",0Z"},square:function(b){var a=Math.sqrt(b)/2;return"M"+-a+","+-a+"L"+a+","+-a+" "+a+","+a+" "+-a+","+a+"Z"},"triangle-down":function(c){var a=Math.sqrt(c/f7),b=a*f7/2;return"M0,"+b+"L"+a+","+-b+" "+-a+","+-b+"Z"},"triangle-up":function(c){var a=Math.sqrt(c/f7),b=a*f7/2;return"M0,"+-b+"L"+a+","+b+" "+-a+","+b+"Z"}});a5.svg.symbolTypes=jI.keys();var aK,fQ,f7=Math.sqrt(3),e9=Math.tan(30*h0),cN=[],jb=0;cN.call=f1.call,cN.empty=f1.empty,cN.node=f1.node,cN.size=f1.size,a5.transition=function(a){return arguments.length?aK?a.transition():a:iT.transition()},a5.transition.prototype=cN,cN.select=function(f){var q,j,b,p=this.id,h=[];f=h7(f);for(var d=-1,m=this.length;++d<m;){h.push(q=[]);for(var k=this[d],g=-1,v=k.length;++g<v;){(b=k[g])&&(j=f.call(b,b.__data__,g,d))?("__data__" in b&&(j.__data__=b.__data__),gw(j,g,p,b.__transition__[p]),q.push(j)):q.push(null)}}return aY(h,p)},cN.selectAll=function(k){var G,C,b,F,q,j=this.id,E=[];k=hD(k);for(var D=-1,m=this.length;++D<m;){for(var H=this[D],B=-1,v=H.length;++B<v;){if(b=H[B]){q=b.__transition__[j],C=k.call(b,b.__data__,B,D),E.push(G=[]);for(var A=-1,d=C.length;++A<d;){(F=C[A])&&gw(F,A,j,q),G.push(F)}}}}return aY(E,j)},cN.filter=function(f){var m,h,b,l=[];"function"!=typeof f&&(f=hV(f));for(var g=0,d=this.length;d>g;g++){l.push(m=[]);for(var h=this[g],k=0,j=h.length;j>k;k++){(b=h[k])&&f.call(b,b.__data__,k)&&m.push(b)}}return aY(l,this.id)},cN.tween=function(c,a){var b=this.id;return arguments.length<2?this.node().__transition__[b].tween.get(c):iL(this,null==a?function(d){d.__transition__[b].tween.remove(c)}:function(d){d.__transition__[b].tween.set(c,a)})},cN.attr=function(k,f){function h(){this.removeAttribute(b)}function g(){this.removeAttributeNS(b.space,b.local)}function c(a){return null==a?h:(a+="",function(){var i,l=this.getAttribute(b);return l!==a&&(i=j(l,a),function(e){this.setAttribute(b,i(e))})})}function d(a){return null==a?g:(a+="",function(){var i,l=this.getAttributeNS(b.space,b.local);return l!==a&&(i=j(l,a),function(e){this.setAttributeNS(b.space,b.local,i(e))})})}if(arguments.length<2){for(f in k){this.attr(f,k[f])}return this}var j="transform"==k?dN:aU,b=a5.ns.qualify(k);return e2(this,"attr."+k,f,b.local?d:c)},cN.attrTween=function(f,b){function d(i,h){var g=b.call(this,i,h,this.getAttribute(a));return g&&function(e){this.setAttribute(a,g(e))}}function c(i,h){var g=b.call(this,i,h,this.getAttributeNS(a.space,a.local));return g&&function(e){this.setAttributeNS(a.space,a.local,g(e))}}var a=a5.ns.qualify(f);return this.tween("attr."+f,a.local?c:d)},cN.style=function(g,c,f){function d(){this.style.removeProperty(g)}function a(e){return null==e?d:(e+="",function(){var i,h=iF.getComputedStyle(this,null).getPropertyValue(g);return h!==e&&(i=aU(h,e),function(j){this.style.setProperty(g,i(j),f)})})}var b=arguments.length;if(3>b){if("string"!=typeof g){2>b&&(c="");for(f in g){this.style(f,g[f],c)}return this}f=""}return e2(this,"style."+g,c,a)},cN.styleTween=function(d,a,c){function b(g,e){var f=a.call(this,g,e,iF.getComputedStyle(this,null).getPropertyValue(d));return f&&function(h){this.style.setProperty(d,f(h),c)}}return arguments.length<3&&(c=""),this.tween("style."+d,b)},cN.text=function(a){return e2(this,"text",a,cs)},cN.remove=function(){return this.each("end.transition",function(){var a;this.__transition__.count<2&&(a=this.parentNode)&&a.removeChild(this)})},cN.ease=function(b){var a=this.id;return arguments.length<1?this.node().__transition__[a].ease:("function"!=typeof b&&(b=a5.ease.apply(a5,arguments)),iL(this,function(c){c.__transition__[a].ease=b}))},cN.delay=function(b){var a=this.id;return iL(this,"function"==typeof b?function(f,d,c){f.__transition__[a].delay=+b.call(f,f.__data__,d,c)}:(b=+b,function(c){c.__transition__[a].delay=b}))},cN.duration=function(b){var a=this.id;return iL(this,"function"==typeof b?function(f,d,c){f.__transition__[a].duration=Math.max(1,b.call(f,f.__data__,d,c))}:(b=Math.max(1,b),function(c){c.__transition__[a].duration=b}))},cN.each=function(f,b){var d=this.id;if(arguments.length<2){var c=fQ,a=aK;aK=d,iL(this,function(g,h,e){fQ=g.__transition__[d],f.call(g,g.__data__,h,e)}),fQ=c,aK=a}else{iL(this,function(g){var e=g.__transition__[d];(e.event||(e.event=a5.dispatch("start","end"))).on(f,b)})}return this},cN.transition=function(){for(var f,q,j,b,p=this.id,h=++jb,d=[],m=0,k=this.length;k>m;m++){d.push(f=[]);for(var q=this[m],g=0,v=q.length;v>g;g++){(j=q[g])&&(b=Object.create(j.__transition__[p]),b.delay+=b.duration,gw(j,g,h,b)),f.push(j)}}return aY(d,h)},a5.svg.axis=function(){function f(a){a.each(function(){var D,G=a5.select(this),u=null==j?h.ticks?h.ticks.apply(h,k):h.domain():j,K=null==m?h.tickFormat?h.tickFormat.apply(h,k):hb:m,I=G.selectAll(".tick").data(u,hb),J=I.enter().insert("g",".domain").attr("class","tick").style("opacity",0.000001),C=a5.transition(I.exit()).style("opacity",0.000001).remove(),L=a5.transition(I).style("opacity",1),r=dJ(h),F=G.selectAll(".domain").data([0]),i=(F.enter().append("path").attr("class","domain"),a5.transition(F)),e=h.copy(),o=this.__chart__||e;this.__chart__=e,J.append("line"),J.append("text");var N=J.select("line"),O=L.select("line"),q=I.select("text").text(K),c=J.select("text"),t=L.select("text");switch(b){case"bottom":D=cW,N.attr("y2",l),c.attr("y",Math.max(l,0)+d),O.attr("x2",0).attr("y2",l),t.attr("x",0).attr("y",Math.max(l,0)+d),q.attr("dy",".71em").style("text-anchor","middle"),i.attr("d","M"+r[0]+","+g+"V0H"+r[1]+"V"+g);break;case"top":D=cW,N.attr("y2",-l),c.attr("y",-(Math.max(l,0)+d)),O.attr("x2",0).attr("y2",-l),t.attr("x",0).attr("y",-(Math.max(l,0)+d)),q.attr("dy","0em").style("text-anchor","middle"),i.attr("d","M"+r[0]+","+-g+"V0H"+r[1]+"V"+-g);break;case"left":D=ey,N.attr("x2",-l),c.attr("x",-(Math.max(l,0)+d)),O.attr("x2",-l).attr("y2",0),t.attr("x",-(Math.max(l,0)+d)).attr("y",0),q.attr("dy",".32em").style("text-anchor","end"),i.attr("d","M"+-g+","+r[0]+"H0V"+r[1]+"H"+-g);break;case"right":D=ey,N.attr("x2",l),c.attr("x",Math.max(l,0)+d),O.attr("x2",l).attr("y2",0),t.attr("x",Math.max(l,0)+d).attr("y",0),q.attr("dy",".32em").style("text-anchor","start"),i.attr("d","M"+g+","+r[0]+"H0V"+r[1]+"H"+g)}if(h.rangeBand){var H=e.rangeBand()/2,B=function(p){return e(p)+H};J.call(D,B),L.call(D,B)}else{J.call(D,o),L.call(D,e),C.call(D,e)}})}var m,h=a5.scale.linear(),b=eb,l=6,g=6,d=3,k=[10],j=null;return f.scale=function(a){return arguments.length?(h=a,f):h},f.orient=function(a){return arguments.length?(b=a in dM?a+"":eb,f):b},f.ticks=function(){return arguments.length?(k=arguments,f):k},f.tickValues=function(a){return arguments.length?(j=a,f):j},f.tickFormat=function(a){return arguments.length?(m=a,f):m},f.tickSize=function(a){var c=arguments.length;return c?(l=+a,g=+arguments[c-1],f):l},f.innerTickSize=function(a){return arguments.length?(l=+a,f):l},f.outerTickSize=function(a){return arguments.length?(g=+a,f):g},f.tickPadding=function(a){return arguments.length?(d=+a,f):d},f.tickSubdivide=function(){return arguments.length&&f},f};var eb="bottom",dM={top:1,right:1,bottom:1,left:1};a5.svg.brush=function(){function j(a){a.each(function(){var d=a5.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",F).on("touchstart.brush",F),p=d.selectAll(".background").data([0]);p.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),d.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var c=d.selectAll(".resize").data(E,hb);c.exit().remove(),c.enter().append("g").attr("class",function(h){return"resize "+h}).style("cursor",function(h){return cp[h]}).append("rect").attr("x",function(h){return/[ew]$/.test(h)?-3:null}).attr("y",function(h){return/^[ns]/.test(h)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),c.style("display",j.empty()?"none":null);var l,n=a5.transition(d),e=a5.transition(p);C&&(l=dJ(C),e.attr("x",l[0]).attr("width",l[1]-l[0]),A(n)),k&&(l=dJ(k),e.attr("y",l[0]).attr("height",l[1]-l[0]),b(n)),G(n)})}function G(a){a.selectAll(".resize").attr("transform",function(c){return"translate("+H[+/e$/.test(c)]+","+q[+/^s/.test(c)]+")"})}function A(a){a.select(".extent").attr("x",H[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",H[1]-H[0])}function b(a){a.select(".extent").attr("y",q[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",q[1]-q[0])}function F(){function p(){var u=a5.event.changedTouches;return u?a5.touches(R,u)[0]:a5.mouse(R)}function P(){32==a5.event.keyCode&&(I||(l=null,h[0]-=H[1],h[1]-=q[1],I=2),h3())}function o(){32==a5.event.keyCode&&2==I&&(h[0]+=H[1],h[1]+=q[1],I=0,h3())}function K(){var v=p(),u=!1;Q&&(v[0]+=Q[0],v[1]+=Q[1]),I||(a5.event.altKey?(l||(l=[(H[0]+H[1])/2,(q[0]+q[1])/2]),h[0]=H[+(v[0]<l[0])],h[1]=q[+(v[1]<l[1])]):l=null),J&&i(v,C,0)&&(A(r),u=!0),d&&i(v,k,1)&&(b(r),u=!0),u&&(G(r),c({type:"brush",mode:I?"move":"resize"}))}function i(S,ac,W){var N,aa,Y=dJ(ac),X=Y[0],T=Y[1],V=h[W],U=W?q:H,Z=U[1]-U[0];return I&&(X-=V,T-=Z+V),N=(W?B:f)?Math.max(X,Math.min(T,S[W])):S[W],I?aa=(N+=V)+Z:(l&&(V=Math.max(X,Math.min(T,2*l[W]-N))),N>V?(aa=N,N=V):aa=V),U[0]!=N||U[1]!=aa?(W?g=null:m=null,U[0]=N,U[1]=aa,!0):void 0}function e(){K(),r.style("pointer-events","all").selectAll(".resize").style("display",j.empty()?"none":null),a5.select("body").style("cursor",null),t.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),a(),c({type:"brushend"})}var l,Q,R=this,n=a5.select(a5.event.target),c=D.of(R,arguments),r=a5.select(R),L=n.datum(),J=!/^(n|s)$/.test(L)&&C,d=!/^(e|w)$/.test(L)&&k,I=n.classed("extent"),a=iO(),h=p(),t=a5.select(iF).on("keydown.brush",P).on("keyup.brush",o);if(a5.event.changedTouches?t.on("touchmove.brush",K).on("touchend.brush",e):t.on("mousemove.brush",K).on("mouseup.brush",e),r.interrupt().selectAll("*").interrupt(),I){h[0]=H[0]-h[0],h[1]=q[0]-h[1]}else{if(L){var s=+/w$/.test(L),O=+/^n/.test(L);Q=[H[1-s]-h[0],q[1-O]-h[1]],h[0]=H[s],h[1]=q[O]}else{a5.event.altKey&&(l=h.slice())}}r.style("pointer-events","none").selectAll(".resize").style("display",null),a5.select("body").style("cursor",n.style("cursor")),c({type:"brushstart"}),K()}var m,g,D=h2(j,"brushstart","brush","brushend"),C=null,k=null,H=[0,0],q=[0,0],f=!0,B=!0,E=c3[0];return j.event=function(a){a.each(function(){var h=D.of(this,arguments),c={x:H,y:q,i:m,j:g},d=this.__chart__||c;this.__chart__=c,aK?a5.select(this).transition().each("start.brush",function(){m=d.i,g=d.j,H=d.x,q=d.y,h({type:"brushstart"})}).tween("brush:brush",function(){var l=eW(H,c.x),i=eW(q,c.y);return m=g=null,function(e){H=c.x=l(e),q=c.y=i(e),h({type:"brush",mode:"resize"})}}).each("end.brush",function(){m=c.i,g=c.j,h({type:"brush",mode:"resize"}),h({type:"brushend"})}):(h({type:"brushstart"}),h({type:"brush",mode:"resize"}),h({type:"brushend"}))})},j.x=function(a){return arguments.length?(C=a,E=c3[!C<<1|!k],j):C},j.y=function(a){return arguments.length?(k=a,E=c3[!C<<1|!k],j):k},j.clamp=function(a){return arguments.length?(C&&k?(f=!!a[0],B=!!a[1]):C?f=!!a:k&&(B=!!a),j):C&&k?[f,B]:C?f:k?B:null},j.extent=function(h){var n,i,d,c,l;return arguments.length?(C&&(n=h[0],i=h[1],k&&(n=n[0],i=i[0]),m=[n,i],C.invert&&(n=C(n),i=C(i)),n>i&&(l=n,n=i,i=l),(n!=H[0]||i!=H[1])&&(H=[n,i])),k&&(d=h[0],c=h[1],C&&(d=d[1],c=c[1]),g=[d,c],k.invert&&(d=k(d),c=k(c)),d>c&&(l=d,d=c,c=l),(d!=q[0]||c!=q[1])&&(q=[d,c])),j):(C&&(m?(n=m[0],i=m[1]):(n=H[0],i=H[1],C.invert&&(n=C.invert(n),i=C.invert(i)),n>i&&(l=n,n=i,i=l))),k&&(g?(d=g[0],c=g[1]):(d=q[0],c=q[1],k.invert&&(d=k.invert(d),c=k.invert(c)),d>c&&(l=d,d=c,c=l))),C&&k?[[n,d],[i,c]]:C?[n,i]:k&&[d,c])},j.clear=function(){return j.empty()||(H=[0,0],q=[0,0],m=g=null),j},j.empty=function(){return !!C&&H[0]==H[1]||!!k&&q[0]==q[1]},a5.rebind(j,D,"on")};var cp={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},c3=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],b0=a5.time={},dZ=Date,dq=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];jl.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ik.setUTCDate.apply(this._,arguments)},setDay:function(){ik.setUTCDay.apply(this._,arguments)},setFullYear:function(){ik.setUTCFullYear.apply(this._,arguments)},setHours:function(){ik.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ik.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ik.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ik.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ik.setUTCSeconds.apply(this._,arguments)},setTime:function(){ik.setTime.apply(this._,arguments)}};var ik=Date.prototype,ab="%a %b %e %X %Y",hx="%m/%d/%Y",fz="%H:%M:%S",dW=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],bN=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],gX=["January","February","March","April","May","June","July","August","September","October","November","December"],cD=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];b0.year=bF(function(a){return a=b0.day(a),a.setMonth(0,1),a},function(b,a){b.setFullYear(b.getFullYear()+a)},function(a){return a.getFullYear()}),b0.years=b0.year.range,b0.years.utc=b0.year.utc.range,b0.day=bF(function(b){var a=new dZ(2000,0);return a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),a},function(b,a){b.setDate(b.getDate()+a)},function(a){return a.getDate()-1}),b0.days=b0.day.range,b0.days.utc=b0.day.utc.range,b0.dayOfYear=function(b){var a=b0.year(b);return Math.floor((b-a-60000*(b.getTimezoneOffset()-a.getTimezoneOffset()))/86400000)},dq.forEach(function(c,a){c=c.toLowerCase(),a=7-a;var b=b0[c]=bF(function(d){return(d=b0.day(d)).setDate(d.getDate()-(d.getDay()+a)%7),d},function(e,d){e.setDate(e.getDate()+7*Math.floor(d))},function(f){var d=b0.year(f).getDay();return Math.floor((b0.dayOfYear(f)+(d+a)%7)/7)-(d!==a)});b0[c+"s"]=b.range,b0[c+"s"].utc=b.utc.range,b0[c+"OfYear"]=function(f){var d=b0.year(f).getDay();return Math.floor((b0.dayOfYear(f)+(d+a)%7)/7)}}),b0.week=b0.sunday,b0.weeks=b0.sunday.range,b0.weeks.utc=b0.sunday.utc.range,b0.weekOfYear=b0.sundayOfYear,b0.format=fp;var bw=jD(dW),fG=aG(dW),dA=jD(bN),jq=aG(bN),hR=jD(gX),eH=aG(gX),b5=jD(cD),gF=aG(cD),fX=/^%/,gj={"-":"",_:" ",0:"0"},db={a:function(a){return bN[a.getDay()]},A:function(a){return dW[a.getDay()]},b:function(a){return cD[a.getMonth()]},B:function(a){return gX[a.getMonth()]},c:fp(ab),d:function(b,a){return fO(b.getDate(),a,2)},e:function(b,a){return fO(b.getDate(),a,2)},H:function(b,a){return fO(b.getHours(),a,2)},I:function(b,a){return fO(b.getHours()%12||12,a,2)},j:function(b,a){return fO(1+b0.dayOfYear(b),a,3)},L:function(b,a){return fO(b.getMilliseconds(),a,3)},m:function(b,a){return fO(b.getMonth()+1,a,2)},M:function(b,a){return fO(b.getMinutes(),a,2)},p:function(a){return a.getHours()>=12?"PM":"AM"},S:function(b,a){return fO(b.getSeconds(),a,2)},U:function(b,a){return fO(b0.sundayOfYear(b),a,2)},w:function(a){return a.getDay()},W:function(b,a){return fO(b0.mondayOfYear(b),a,2)},x:fp(hx),X:fp(fz),y:function(b,a){return fO(b.getFullYear()%100,a,2)},Y:function(b,a){return fO(b.getFullYear()%10000,a,4)},Z:dy,"%":function(){return"%"}},hg={a:f5,A:e7,b:dI,B:ck,c:c1,d:fx,e:fx,H:bM,I:bM,j:dU,L:bv,m:hv,M:gV,p:fE,S:cB,U:i3,w:cL,W:d8,x:bW,X:dT,y:ib,Y:dn,"%":jm},a6=/^\s*\d+/,em=a5.map({am:0,pm:1});fp.utc=hM;var jM=hM("%Y-%m-%dT%H:%M:%S.%LZ");fp.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?eF:jM,eF.parse=function(b){var a=new Date(b);return isNaN(a)?null:a},eF.toString=jM.toString,b0.second=bF(function(a){return new dZ(1000*Math.floor(a/1000))},function(b,a){b.setTime(b.getTime()+1000*Math.floor(a))},function(a){return a.getSeconds()}),b0.seconds=b0.second.range,b0.seconds.utc=b0.second.utc.range,b0.minute=bF(function(a){return new dZ(60000*Math.floor(a/60000))},function(b,a){b.setTime(b.getTime()+60000*Math.floor(a))},function(a){return a.getMinutes()}),b0.minutes=b0.minute.range,b0.minutes.utc=b0.minute.utc.range,b0.hour=bF(function(b){var a=b.getTimezoneOffset()/60;return new dZ(3600000*(Math.floor(b/3600000-a)+a))},function(b,a){b.setTime(b.getTime()+3600000*Math.floor(a))},function(a){return a.getHours()}),b0.hours=b0.hour.range,b0.hours.utc=b0.hour.utc.range,b0.month=bF(function(a){return a=b0.day(a),a.setDate(1),a},function(b,a){b.setMonth(b.getMonth()+a)},function(a){return a.getMonth()}),b0.months=b0.month.range,b0.months.utc=b0.month.utc.range;var gL=[1000,5000,15000,30000,60000,300000,900000,1800000,3600000,10800000,21600000,43200000,86400000,172800000,604800000,2592000000,7776000000,31536000000],aj=[[b0.second,1],[b0.second,5],[b0.second,15],[b0.second,30],[b0.minute,1],[b0.minute,5],[b0.minute,15],[b0.minute,30],[b0.hour,1],[b0.hour,3],[b0.hour,6],[b0.hour,12],[b0.day,1],[b0.day,2],[b0.week,1],[b0.month,1],[b0.month,3],[b0.year,1]],iK=[[fp("%Y"),b6],[fp("%B"),function(a){return a.getMonth()}],[fp("%b %d"),function(a){return 1!=a.getDate()}],[fp("%a %d"),function(a){return a.getDay()&&1!=a.getDate()}],[fp("%I %p"),function(a){return a.getHours()}],[fp("%I:%M"),function(a){return a.getMinutes()}],[fp(":%S"),function(a){return a.getSeconds()}],[fp(".%L"),function(a){return a.getMilliseconds()}]],aw=fV(iK);aj.year=b0.year,b0.scale=function(){return b3(a5.scale.linear(),aj,aw)};var aO={range:function(c,a,b){return a5.range(+c,+a,b).map(gD)}},eN=aj.map(function(a){return[a[0].utc,a[1]]}),aX=[[hM("%Y"),b6],[hM("%B"),function(a){return a.getUTCMonth()}],[hM("%b %d"),function(a){return 1!=a.getUTCDate()}],[hM("%a %d"),function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],[hM("%I %p"),function(a){return a.getUTCHours()}],[hM("%I:%M"),function(a){return a.getUTCMinutes()}],[hM(":%S"),function(a){return a.getUTCSeconds()}],[hM(".%L"),function(a){return a.getUTCMilliseconds()}]],eZ=fV(aX);return eN.year=b0.year.utc,b0.scale.utc=function(){return b3(a5.scale.linear(),eN,eZ)},a5.text=a1(function(a){return a.responseText}),a5.json=function(b,a){return eg(b,"application/json",gf,a)},a5.html=function(b,a){return eg(b,"text/html",c8,a)},a5.xml=a1(function(a){return a.responseXML}),a5}();var UsersBar=function(A,f){var B=f||{};var J={width:B.width||200,height:B.height||400,flip:B.flip==undefined?false:B.flip,caps:B.caps==undefined?false:B.caps,gradient:B.gradient==undefined?true:B.gradient,gradientMinOpacity:B.gradientMinOpacity||0.3,gradientMaxOpacity:B.gradientMaxOpacity||0.8,topUsers:B.topUsers||5,bottomUsers:B.bottomUsers||5,animationDelay:B.animationDelay||2000,userColor:B.userColor||"#FFF",userHoverColor:B.userHoverColor||"#FFF",userSelfColor:B.userSelfColor||"#F90",userSelfHoverColor:B.userSelfHoverColor||"#F90",userBackColor:B.userBackColor||"#000",userHoverBackColor:B.userHoverBackColor||"#555",userBackOpacity:B.userBackOpacity||0,userBackHoverOpacity:B.userBackHoverOpacity||0.6,lineColor:B.lineColor||"#FFF",separatorColor:B.separatorColor||"#F90",separatorOpacity:B.separatorOpacity||0.4,bulletColor:B.bulletColor||"#666",bulletHoverColor:B.bulletHoverColor||"#FFF",bulletSelfColor:B.bulletSelfColor||"#F90",bulletSelfHoverColor:B.bulletSelfColor||"#F90",backgroundColor:B.backgroundColor||"#000"};var u=d3.select(A).append("svg").attr("width",J.width).attr("height",J.height);var t="stroke:"+J.lineColor+";fill:none;stroke-width:1px",c="stroke:"+J.lineColor+";fill:none;stroke-width:2px",D=10,q=4,E="fill:"+J.userBackColor+";stroke-width:0.5px;opacity:"+J.userBackOpacity,I="stroke:"+J.backgroundColor+";fill:"+J.bulletColor+";stroke-width:2px",C="fill:"+J.userHoverBackColor+";stroke-width:0.2px;opacity:"+J.userBackHoverOpacity,p="stroke:"+J.backgroundColor+";fill:"+J.bulletHoverColor+";stroke-width:2px",n=4,s=24,v=10,k=10;var F=0,d=0,m=null;var a=u.append("defs");a.append("path").attr("id","ico-user").attr("style","stroke:none;fill:#999").attr("d","m 12.363198,11.707021 c 0,0.536933 -0.434011,0.970945 -0.970944,0.970945 l -9.7094455,0 c -0.535961,0 -0.97094412,-0.434012 -0.97094412,-0.970945 0,-1.9418892 1.87683502,-3.7536693 3.79542092,-4.4702269 C 3.3994378,6.5522788 2.6537526,5.3366558 2.6537526,3.9394666 l 0,-0.9709435 c 0,-2.14481613 1.7389612,-3.88377727 3.8837772,-3.88377727 2.144816,0 3.8837772,1.73896114 3.8837772,3.88377727 l 0,0.9709435 c 0,1.3971892 -0.7456862,2.6128122 -1.8525622,3.2973275 1.9176162,0.7165576 3.7944532,2.5283377 3.7944532,4.4702269 z");a.append("path").attr("id","ico-user-me").attr("style","stroke:none;fill:#F90").attr("d","m 12.363198,11.707021 c 0,0.536933 -0.434011,0.970945 -0.970944,0.970945 l -9.7094455,0 c -0.535961,0 -0.97094412,-0.434012 -0.97094412,-0.970945 0,-1.9418892 1.87683502,-3.7536693 3.79542092,-4.4702269 C 3.3994378,6.5522788 2.6537526,5.3366558 2.6537526,3.9394666 l 0,-0.9709435 c 0,-2.14481613 1.7389612,-3.88377727 3.8837772,-3.88377727 2.144816,0 3.8837772,1.73896114 3.8837772,3.88377727 l 0,0.9709435 c 0,1.3971892 -0.7456862,2.6128122 -1.8525622,3.2973275 1.9176162,0.7165576 3.7944532,2.5283377 3.7944532,4.4702269 z");a.append("path").attr("id","ico-crown").attr("style","stroke:none;fill:"+J.separatorColor+";opacity:"+J.separatorOpacity).attr("d","m 15.002682,4.7738008 -2.084199,1.8754026 0.175432,-1.9114577 c 0,0 -0.286826,-0.4310466 -0.661368,-0.081797 L 11.17008,6.2698178 9.525,3.6786949 c 0,0 -0.4531102,-0.4622585 -1.2178009,0 L 6.7035551,6.2041652 5.615983,4.655411 c 0,0 -0.2782161,-0.4396568 -0.6280042,0.027445 L 5.1026017,6.7670551 3.048,4.7738008 c 0,0 -0.635,-0.2566907 -0.9379703,0.3605509 L 3.437072,12.441695 h 10.957517 l 1.82697,-7.119534 c 0,0 -0.205029,-0.9411992 -1.218877,-0.5483602 z M 3.044233,3.1997542 C 3.044233,2.4420593 2.3629534,1.8307373 1.5207712,1.8307373 0.68289406,1.8301991 0,2.4420593 0,3.1997542 c 0,0.7560805 0.68289406,1.369017 1.5207712,1.369017 0.8427203,0 1.5234618,-0.6129365 1.5234618,-1.369017 z m 15.192644,-0.050047 c 0,0.7563844 -0.681113,1.3695551 -1.521309,1.3695551 -0.840196,0 -1.52131,-0.6131707 -1.52131,-1.3695551 0,-0.7563844 0.681114,-1.3695551 1.52131,-1.3695551 0.840196,0 1.521309,0.6131707 1.521309,1.3695551 z m -14.815411,9.8398094 10.991958,0 0,2.739111 -10.991958,0 z M 14.197631,3.4462202 c 0,0.4410509 -0.397296,0.7985932 -0.887386,0.7985932 -0.490089,0 -0.887385,-0.3575423 -0.887385,-0.7985932 0,-0.4410508 0.397296,-0.7985932 0.887385,-0.7985932 0.49009,0 0.887386,0.3575424 0.887386,0.7985932 z M 10.439292,1.3690169 c 0,0.7560872 -0.6813547,1.3690169 -1.5218477,1.3690169 -0.840493,0 -1.5218474,-0.6129297 -1.5218474,-1.3690169 C 7.3955969,0.61292976 8.0769513,0 8.9174443,0 9.7579373,0 10.439292,0.61292976 10.439292,1.3690169 z m -5.5766988,2.829517 c 0.4918559,0 0.8884619,-0.3573221 0.8884619,-0.7980551 0,-0.4418093 -0.396606,-0.7985932 -0.8884619,-0.7985932 -0.4891653,0 -0.8868475,0.3567839 -0.8868475,0.7985932 0,0.440733 0.3976822,0.7980551 0.8868475,0.7980551 z");a.append("path").attr("id","ico-newbie").attr("style","stroke:none;fill:"+J.separatorColor+";opacity:"+J.separatorOpacity).attr("d","M 10.384,14.709 C 10.16,14.484 9.795,14.484 9.57,14.71 l -0.624,0.623 c -0.991,-0.306 -2.154,-0.039 -2.983,0.791 -1.162,1.161 -1.228,2.979 -0.147,4.06 1.081,1.08 2.898,1.015 4.06,-0.146 0.83,-0.829 1.097,-1.992 0.791,-2.983 l 0.624,-0.623 c 0.225,-0.226 0.225,-0.59 0,-0.815 l -0.907,-0.908 z m 8.97,-0.326 C 21.486,12.25 21.486,8.78 19.353,6.648 17.22,4.516 13.75,4.515 11.618,6.648 10.053,8.213 9.641,10.498 10.374,12.446 8.746,10.929 7.5,9.951 7.343,10.108 c -0.206,0.205 1.542,2.286 3.902,4.646 2.361,2.361 4.442,4.108 4.647,3.902 0.157,-0.157 -0.82,-1.403 -2.337,-3.03 1.948,0.733 4.233,0.322 5.799,-1.243 z m -4.689,0.367 c 0.354,-0.673 0.036,-1.763 -0.809,-2.606 -0.844,-0.845 -1.934,-1.162 -2.606,-0.809 -0.087,-1.06 0.271,-2.149 1.08,-2.958 1.459,-1.459 3.834,-1.459 5.293,0 1.458,1.458 1.459,3.833 0,5.292 -0.809,0.81 -1.898,1.168 -2.958,1.081 z");var H=a.append("linearGradient").attr("id","line-gradient").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");H.append("stop").attr("offset","0%").attr("style","stop-color:"+J.lineColor+";stop-opacity:1");H.append("stop").attr("offset","33%").attr("style","stop-color:"+J.lineColor+";stop-opacity:0.1");H.append("stop").attr("offset","50%").attr("style","stop-color:"+J.lineColor+";stop-opacity:1");H.append("stop").attr("offset","66%").attr("style","stop-color:"+J.lineColor+";stop-opacity:0.1");H.append("stop").attr("offset","100%").attr("style","stop-color:"+J.lineColor+";stop-opacity:1");var H=a.append("linearGradient").attr("id","separator-gradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");H.append("stop").attr("offset","10%").attr("style","stop-color:"+J.separatorColor+";stop-opacity:0");H.append("stop").attr("offset","50%").attr("style","stop-color:"+J.separatorColor+";stop-opacity:"+J.separatorOpacity);H.append("stop").attr("offset","90%").attr("style","stop-color:"+J.separatorColor+";stop-opacity:0");var h=(J.flip?(J.width-D):0);u.append("line").attr("style",t).attr("x1",h+D/2).attr("y1",q).attr("x2",h+D/2).attr("y2",J.height-q);if(J.caps){u.append("line").attr("style",c).attr("x1",h).attr("y1",J.height-q).attr("x2",h+D).attr("y2",J.height-q);u.append("line").attr("style",t).attr("x1",h+D/2).attr("y1",q).attr("x2",h+D/2).attr("y2",J.height-q)}function r(o){o=o.toFixed(2)+"";x=o.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var g=/(\d+)(\d{3})/;while(g.test(x1)){x1=x1.replace(g,"$1,$2")}return x1}var e=u.append("g");e.append("rect").attr("width",J.width-k-D).attr("height",1).attr("y",J.height/3*2).attr("fill","url(#separator-gradient)");e.append("rect").attr("width",J.width-k-D).attr("height",1).attr("y",J.height/3).attr("fill","url(#separator-gradient)");var b=J.flip?J.width/2-k-D-8:J.width/2+k+D-15;e.append("use").attr("y",J.height/3*2).attr("x",b).attr("xlink:href","#ico-newbie");e.append("use").attr("y",J.height/3-20).attr("x",b).attr("xlink:href","#ico-crown");function l(K){var o=(K-F)/(d-F),g=(J.height-(3*q)-s/2);return(1-o)*g}function j(L){var o=(L-F)/(d-F),g=(J.gradientMaxOpacity-J.gradientMinOpacity),K=Math.sin(o*Math.PI)*g+J.gradientMinOpacity;return K}function i(g,o){g.transition().duration(J.animationDelay).attr("transform",function(L,K){return"translate(0,"+l(L.credit)+")"});g.select("use").attr("xlink:href",function(L,K){return"#ico-user"+(L.me?"-me":"")});g.select("use").transition().duration(J.animationDelay).style("opacity",function(L,K){if(L.me){return 1}if(!J.gradient){return 1}return j(L.credit)});g.select("text.txt-name").text(function(L,K){return L.text});g.select("text.txt-name").transition().duration(J.animationDelay).style("opacity",function(L,K){if(L.me){return 1}if(!J.gradient){return 1}return j(L.credit)}).style("fill",function(L,K){return L.me?J.userSelfColor:J.userColor});g.select("text.txt-credit").transition().duration(J.animationDelay).style("opacity",function(L,K){if(L.me){return 1}if(!J.gradient){return 1}return j(L.credit)}).style("fill",function(L,K){return L.me?J.userSelfColor:J.userColor}).text(function(L,K){return"#"+r(L.credit)});g.select("circle").style("fill",function(L,K){return L.me?J.bulletSelfColor:J.bulletColor});return g}function G(K){var N=K.append("g"),g=J.width-D-k-n,L=(s-v)/2,o=J.width;N.attr("class","uframegroup").style("cursor","pointer");N.append("path").attr("class","uframe").attr("style",E).attr("d",J.flip?"M"+n+",0L"+g+",0L"+g+","+L+"L"+(g+k)+","+(L+v/2)+"L"+g+","+(s-L)+"L"+g+","+s+"L"+n+","+s+"Z":"M"+(o-n)+",0L"+(o-g)+",0L"+(o-g)+","+L+"L"+(o-g-k)+","+(L+v/2)+"L"+(o-g)+","+(s-L)+"L"+(o-g)+","+s+"L"+(o-n)+","+s+"Z");N.append("circle").attr("class","upoint").attr("style",I).attr("r",4).attr("cx",J.flip?(o-D/2):(D/2)).attr("cy",s/2);var O=J.flip?-20:0;N.append("use").attr("x",O+D+k+n+5).attr("y",5).attr("xlink:href","#ico-user");N.append("text").attr("class","txt-name").attr("x",O+D+k+n+5+18).attr("y",s/2+3).attr("fill","#666").style("font-size","12px").text("---");var P=J.flip?0:15;N.append("text").attr("class","txt-credit").attr("x",O+g+P).attr("y",s/2+2).attr("fill","#666").style("text-anchor","end").style("font-size","10px").text("---");N.on("mouseover",function(S,Q){var R=d3.select(this);R.select("path").attr("style",C);R.select("circle").attr("style",p);R.select("circle").style("fill",S.me?J.bulletSelfHoverColor:J.bulletHoverColor);if(J.gradient){R.select("text").attr("old:opacity",R.select("text").style("opacity"));R.selectAll("text").style("opacity",1);R.selectAll("use").style("opacity",1)}m=R});N.on("mouseout",function(S,Q){var R=d3.select(this);R.select("path").attr("style",E);R.select("circle").attr("style",I);R.select("circle").style("fill",S.me?J.bulletSelfColor:J.bulletColor);if(J.gradient){R.selectAll("text").style("opacity",R.select("text").attr("old:opacity"));R.selectAll("use").style("opacity",R.select("text").attr("old:opacity"))}m=null});return N}this.update=function(N){if(J.gradient&&(m!=null)){m.selectAll("text").style("opacity",m.select("text").attr("old:opacity"));m.selectAll("use").style("opacity",m.select("text").attr("old:opacity"));m=null}var K=N.slice(0);K.sort(function(Q,P){return P.credit-Q.credit});d=K[0].credit;F=K[K.length-1].credit;console.log(K);var o=K.length-J.bottomUsers,g=J.topUsers-1;var L=[l(K[o].credit),l(K[g].credit)+s];var O=i(u.selectAll("g.uframegroup").data(K));i(G(O.enter()));O.exit().remove();e.selectAll("rect").data(L).transition().duration(J.animationDelay).attr("y",function(P){return P});e.selectAll("use").data(L).transition().duration(J.animationDelay).attr("y",function(Q,P){return Q+((P==1)?-25:5)})}};
/*!
* Bootstrap.js by @fat & @mdo
* Copyright 2012 Twitter, Inc.
* http://www.apache.org/licenses/LICENSE-2.0.txt
*/
;!function(a){a(function(){a.support.transition=function(){var b=function(){var c,e=document.createElement("bootstrap"),d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(c in d){if(void 0!==e.style[c]){return d[c]}}}();return b&&{end:b}}()})}(window.jQuery),!function(d){var c='[data-dismiss="alert"]',b=function(e){d(e).on("click",c,this.close)};b.prototype.close=function(j){function g(){i.trigger("closed").remove()}var i,h=d(this),f=h.attr("data-target");f||(f=h.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,"")),i=d(f),j&&j.preventDefault(),i.length||(i=h.hasClass("alert")?h:h.parent()),i.trigger(j=d.Event("close")),j.isDefaultPrevented()||(i.removeClass("in"),d.support.transition&&i.hasClass("fade")?i.on(d.support.transition.end,g):g())};var a=d.fn.alert;d.fn.alert=function(e){return this.each(function(){var g=d(this),f=g.data("alert");f||g.data("alert",f=new b(this)),"string"==typeof e&&f[e].call(g)})},d.fn.alert.Constructor=b,d.fn.alert.noConflict=function(){return d.fn.alert=a,this},d(document).on("click.alert.data-api",c,b.prototype.close)}(window.jQuery),!function(c){var b=function(e,d){this.$element=c(e),this.options=c.extend({},c.fn.button.defaults,d)};b.prototype.setState=function(g){var i="disabled",e=this.$element,f=e.data(),h=e.is("input")?"val":"html";g+="Text",f.resetText||e.data("resetText",e[h]()),e[h](f[g]||this.options[g]),setTimeout(function(){"loadingText"==g?e.addClass(i).attr(i,i):e.removeClass(i).removeAttr(i)},0)},b.prototype.toggle=function(){var d=this.$element.closest('[data-toggle="buttons-radio"]');d&&d.find(".active").removeClass("active"),this.$element.toggleClass("active")};var a=c.fn.button;c.fn.button=function(d){return this.each(function(){var g=c(this),f=g.data("button"),e="object"==typeof d&&d;f||g.data("button",f=new b(this,e)),"toggle"==d?f.toggle():d&&f.setState(d)})},c.fn.button.defaults={loadingText:"loading..."},c.fn.button.Constructor=b,c.fn.button.noConflict=function(){return c.fn.button=a,this},c(document).on("click.button.data-api","[data-toggle^=button]",function(f){var d=c(f.target);d.hasClass("btn")||(d=d.closest(".btn")),d.button("toggle")})}(window.jQuery),!function(b){var c=function(e,d){this.$element=b(e),this.options=d,"hover"==this.options.pause&&this.$element.on("mouseenter",b.proxy(this.pause,this)).on("mouseleave",b.proxy(this.cycle,this))};c.prototype={cycle:function(d){return d||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(b.proxy(this.next,this),this.options.interval)),this},to:function(h){var d=this.$element.find(".item.active"),e=d.parent().children(),f=e.index(d),g=this;if(!(h>e.length-1||0>h)){return this.sliding?this.$element.one("slid",function(){g.to(h)}):f==h?this.pause().cycle():this.slide(h>f?"next":"prev",b(e[h]))}},pause:function(d){return d||(this.paused=!0),this.$element.find(".next, .prev").length&&b.support.transition.end&&(this.$element.trigger(b.support.transition.end),this.cycle()),clearInterval(this.interval),this.interval=null,this},next:function(){return this.sliding?void 0:this.slide("next")},prev:function(){return this.sliding?void 0:this.slide("prev")},slide:function(k,f){var j,m=this.$element.find(".item.active"),d=f||m[k](),i=this.interval,l="next"==k?"left":"right",g="next"==k?"first":"last",h=this;if(this.sliding=!0,i&&this.pause(),d=d.length?d:this.$element.find(".item")[g](),j=b.Event("slide",{relatedTarget:d[0]}),!d.hasClass("active")){if(b.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(j),j.isDefaultPrevented()){return}d.addClass(k),d[0].offsetWidth,m.addClass(l),d.addClass(l),this.$element.one(b.support.transition.end,function(){d.removeClass([k,l].join(" ")).addClass("active"),m.removeClass(["active",l].join(" ")),h.sliding=!1,setTimeout(function(){h.$element.trigger("slid")},0)})}else{if(this.$element.trigger(j),j.isDefaultPrevented()){return}m.removeClass("active"),d.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return i&&this.cycle(),this}}};var a=b.fn.carousel;b.fn.carousel=function(d){return this.each(function(){var h=b(this),g=h.data("carousel"),e=b.extend({},b.fn.carousel.defaults,"object"==typeof d&&d),f="string"==typeof d?d:e.slide;g||h.data("carousel",g=new c(this,e)),"number"==typeof d?g.to(d):f?g[f]():e.interval&&g.cycle()})},b.fn.carousel.defaults={interval:5000,pause:"hover"},b.fn.carousel.Constructor=c,b.fn.carousel.noConflict=function(){return b.fn.carousel=a,this},b(document).on("click.carousel.data-api","[data-slide]",function(i){var f,h=b(this),d=b(h.attr("data-target")||(f=h.attr("href"))&&f.replace(/.*(?=#[^\s]+$)/,"")),g=b.extend({},d.data(),h.data());d.carousel(g),i.preventDefault()})}(window.jQuery),!function(b){var c=function(e,d){this.$element=b(e),this.options=b.extend({},b.fn.collapse.defaults,d),this.options.parent&&(this.$parent=b(this.options.parent)),this.options.toggle&&this.toggle()};c.prototype={constructor:c,dimension:function(){var d=this.$element.hasClass("width");return d?"width":"height"},show:function(){var g,d,f,e;if(!this.transitioning){if(g=this.dimension(),d=b.camelCase(["scroll",g].join("-")),f=this.$parent&&this.$parent.find("> .accordion-group > .in"),f&&f.length){if(e=f.data("collapse"),e&&e.transitioning){return}f.collapse("hide"),e||f.data("collapse",null)}this.$element[g](0),this.transition("addClass",b.Event("show"),"shown"),b.support.transition&&this.$element[g](this.$element[0][d])}},hide:function(){var d;this.transitioning||(d=this.dimension(),this.reset(this.$element[d]()),this.transition("removeClass",b.Event("hide"),"hidden"),this.$element[d](0))},reset:function(d){var e=this.dimension();return this.$element.removeClass("collapse")[e](d||"auto")[0].offsetWidth,this.$element[null!==d?"addClass":"removeClass"]("collapse"),this},transition:function(h,e,f){var g=this,d=function(){"show"==e.type&&g.reset(),g.transitioning=0,g.$element.trigger(f)};this.$element.trigger(e),e.isDefaultPrevented()||(this.transitioning=1,this.$element[h]("in"),b.support.transition&&this.$element.hasClass("collapse")?this.$element.one(b.support.transition.end,d):d())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var a=b.fn.collapse;b.fn.collapse=function(d){return this.each(function(){var g=b(this),f=g.data("collapse"),e="object"==typeof d&&d;f||g.data("collapse",f=new c(this,e)),"string"==typeof d&&f[d]()})},b.fn.collapse.defaults={toggle:!0},b.fn.collapse.Constructor=c,b.fn.collapse.noConflict=function(){return b.fn.collapse=a,this},b(document).on("click.collapse.data-api","[data-toggle=collapse]",function(i){var d,h=b(this),g=h.attr("data-target")||i.preventDefault()||(d=h.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""),f=b(g).data("collapse")?"toggle":h.data();h[b(g).hasClass("in")?"addClass":"removeClass"]("collapsed"),b(g).collapse(f)})}(window.jQuery),!function(f){function d(){f(b).each(function(){e(f(this)).removeClass("open")})}function e(i){var h,g=i.attr("data-target");return g||(g=i.attr("href"),g=g&&/#/.test(g)&&g.replace(/.*(?=#[^\s]*$)/,"")),h=f(g),h.length||(h=i.parent()),h}var b="[data-toggle=dropdown]",a=function(h){var g=f(h).on("click.dropdown.data-api",this.toggle);f("html").on("click.dropdown.data-api",function(){g.parent().removeClass("open")})};a.prototype={constructor:a,toggle:function(){var i,g,h=f(this);if(!h.is(".disabled, :disabled")){return i=e(h),g=i.hasClass("open"),d(),g||i.toggleClass("open"),h.focus(),!1}},keydown:function(k){var j,l,i,h,g;if(/(38|40|27)/.test(k.keyCode)&&(j=f(this),k.preventDefault(),k.stopPropagation(),!j.is(".disabled, :disabled"))){if(i=e(j),h=i.hasClass("open"),!h||h&&27==k.keyCode){return j.click()}l=f("[role=menu] li:not(.divider):visible a",i),l.length&&(g=l.index(l.filter(":focus")),38==k.keyCode&&g>0&&g--,40==k.keyCode&&l.length-1>g&&g++,~g||(g=0),l.eq(g).focus())}}};var c=f.fn.dropdown;f.fn.dropdown=function(g){return this.each(function(){var i=f(this),h=i.data("dropdown");h||i.data("dropdown",h=new a(this)),"string"==typeof g&&h[g].call(i)})},f.fn.dropdown.Constructor=a,f.fn.dropdown.noConflict=function(){return f.fn.dropdown=c,this},f(document).on("click.dropdown.data-api touchstart.dropdown.data-api",d).on("click.dropdown touchstart.dropdown.data-api",".dropdown form",function(g){g.stopPropagation()}).on("touchstart.dropdown.data-api",".dropdown-menu",function(g){g.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",b,a.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",b+", [role=menu]",a.prototype.keydown)}(window.jQuery),!function(c){var b=function(e,d){this.options=d,this.$element=c(e).delegate('[data-dismiss="modal"]',"click.dismiss.modal",c.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};b.prototype={constructor:b,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var d=this,f=c.Event("show");this.$element.trigger(f),this.isShown||f.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var e=c.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(document.body),d.$element.show(),e&&d.$element[0].offsetWidth,d.$element.addClass("in").attr("aria-hidden",!1),d.enforceFocus(),e?d.$element.one(c.support.transition.end,function(){d.$element.focus().trigger("shown")}):d.$element.focus().trigger("shown")}))},hide:function(d){d&&d.preventDefault(),d=c.Event("hide"),this.$element.trigger(d),this.isShown&&!d.isDefaultPrevented()&&(this.isShown=!1,this.escape(),c(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),c.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var d=this;c(document).on("focusin.modal",function(f){d.$element[0]===f.target||d.$element.has(f.target).length||d.$element.focus()})},escape:function(){var d=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(f){27==f.which&&d.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var d=this,e=setTimeout(function(){d.$element.off(c.support.transition.end),d.hideModal()},500);this.$element.one(c.support.transition.end,function(){clearTimeout(e),d.hideModal()})},hideModal:function(){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(f){var e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=c.support.transition&&e;this.$backdrop=c('<div class="modal-backdrop '+e+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?c.proxy(this.$element[0].focus,this.$element[0]):c.proxy(this.hide,this)),d&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),d?this.$backdrop.one(c.support.transition.end,f):f()}else{!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),c.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(c.support.transition.end,c.proxy(this.removeBackdrop,this)):this.removeBackdrop()):f&&f()}}};var a=c.fn.modal;c.fn.modal=function(d){return this.each(function(){var g=c(this),f=g.data("modal"),e=c.extend({},c.fn.modal.defaults,g.data(),"object"==typeof d&&d);f||g.data("modal",f=new b(this,e)),"string"==typeof d?f[d]():e.show&&f.show()})},c.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},c.fn.modal.Constructor=b,c.fn.modal.noConflict=function(){return c.fn.modal=a,this},c(document).on("click.modal.data-api",'[data-toggle="modal"]',function(i){var h=c(this),f=h.attr("href"),d=c(h.attr("data-target")||f&&f.replace(/.*(?=#[^\s]+$)/,"")),g=d.data("modal")?"toggle":c.extend({remote:!/#/.test(f)&&f},d.data(),h.data());i.preventDefault(),d.modal(g).one("hide",function(){h.focus()})})}(window.jQuery),!function(c){var b=function(e,d){this.init("tooltip",e,d)};b.prototype={constructor:b,init:function(g,f,e){var h,d;this.type=g,this.$element=c(f),this.options=this.getOptions(e),this.enabled=!0,"click"==this.options.trigger?this.$element.on("click."+this.type,this.options.selector,c.proxy(this.toggle,this)):"manual"!=this.options.trigger&&(h="hover"==this.options.trigger?"mouseenter":"focus",d="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(h+"."+this.type,this.options.selector,c.proxy(this.enter,this)),this.$element.on(d+"."+this.type,this.options.selector,c.proxy(this.leave,this))),this.options.selector?this._options=c.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(d){return d=c.extend({},c.fn[this.type].defaults,d,this.$element.data()),d.delay&&"number"==typeof d.delay&&(d.delay={show:d.delay,hide:d.delay}),d},enter:function(f){var d=c(f.currentTarget)[this.type](this._options).data(this.type);return d.options.delay&&d.options.delay.show?(clearTimeout(this.timeout),d.hoverState="in",this.timeout=setTimeout(function(){"in"==d.hoverState&&d.show()},d.options.delay.show),void 0):d.show()},leave:function(f){var d=c(f.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),d.options.delay&&d.options.delay.hide?(d.hoverState="out",this.timeout=setTimeout(function(){"out"==d.hoverState&&d.hide()},d.options.delay.hide),void 0):d.hide()},show:function(){var h,d,j,f,i,e,g;if(this.hasContent()&&this.enabled){switch(h=this.tip(),this.setContent(),this.options.animation&&h.addClass("fade"),e="function"==typeof this.options.placement?this.options.placement.call(this,h[0],this.$element[0]):this.options.placement,d=/in/.test(e),h.detach().css({top:0,left:0,display:"block"}).insertAfter(this.$element),j=this.getPosition(d),f=h[0].offsetWidth,i=h[0].offsetHeight,d?e.split(" ")[1]:e){case"bottom":g={top:j.top+j.height,left:j.left+j.width/2-f/2};break;case"top":g={top:j.top-i,left:j.left+j.width/2-f/2};break;case"left":g={top:j.top+j.height/2-i/2,left:j.left-f};break;case"right":g={top:j.top+j.height/2-i/2,left:j.left+j.width}}h.offset(g).addClass(e).addClass("in")}},setContent:function(){var e=this.tip(),d=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](d),e.removeClass("fade in top bottom left right")},hide:function(){function e(){var f=setTimeout(function(){d.off(c.support.transition.end).detach()},500);d.one(c.support.transition.end,function(){clearTimeout(f),d.detach()})}var d=this.tip();return d.removeClass("in"),c.support.transition&&this.$tip.hasClass("fade")?e():d.detach(),this},fixTitle:function(){var d=this.$element;(d.attr("title")||"string"!=typeof d.attr("data-original-title"))&&d.attr("data-original-title",d.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(d){return c.extend({},d?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var f,d=this.$element,e=this.options;return f=d.attr("data-original-title")||("function"==typeof e.title?e.title.call(d[0]):e.title)},tip:function(){return this.$tip=this.$tip||c(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(f){var d=c(f.currentTarget)[this.type](this._options).data(this.type);d[d.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var a=c.fn.tooltip;c.fn.tooltip=function(d){return this.each(function(){var g=c(this),f=g.data("tooltip"),e="object"==typeof d&&d;f||g.data("tooltip",f=new b(this,e)),"string"==typeof d&&f[d]()})},c.fn.tooltip.Constructor=b,c.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!1},c.fn.tooltip.noConflict=function(){return c.fn.tooltip=a,this}}(window.jQuery),!function(c){var b=function(e,d){this.init("popover",e,d)};b.prototype=c.extend({},c.fn.tooltip.Constructor.prototype,{constructor:b,setContent:function(){var f=this.tip(),e=this.getTitle(),d=this.getContent();f.find(".popover-title")[this.options.html?"html":"text"](e),f.find(".popover-content")[this.options.html?"html":"text"](d),f.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,d=this.$element,f=this.options;return e=d.attr("data-content")||("function"==typeof f.content?f.content.call(d[0]):f.content)},tip:function(){return this.$tip||(this.$tip=c(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var a=c.fn.popover;c.fn.popover=function(d){return this.each(function(){var g=c(this),f=g.data("popover"),e="object"==typeof d&&d;f||g.data("popover",f=new b(this,e)),"string"==typeof d&&f[d]()})},c.fn.popover.Constructor=b,c.fn.popover.defaults=c.extend({},c.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"></div></div></div>'}),c.fn.popover.noConflict=function(){return c.fn.popover=a,this}}(window.jQuery),!function(c){function b(g,f){var e,h=c.proxy(this.process,this),d=c(g).is("body")?c(window):c(g);this.options=c.extend({},c.fn.scrollspy.defaults,f),this.$scrollElement=d.on("scroll.scroll-spy.data-api",h),this.selector=(this.options.target||(e=c(g).attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=c("body"),this.refresh(),this.process()}b.prototype={constructor:b,refresh:function(){var e,d=this;this.offsets=c([]),this.targets=c([]),e=this.$body.find(this.selector).map(function(){var g=c(this),f=g.data("target")||g.attr("href"),h=/^#\w/.test(f)&&c(f);return h&&h.length&&[[h.position().top+d.$scrollElement.scrollTop(),f]]||null}).sort(function(g,f){return g[0]-f[0]}).each(function(){d.offsets.push(this[0]),d.targets.push(this[1])})},process:function(){var e,j=this.$scrollElement.scrollTop()+this.options.offset,f=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,h=f-this.$scrollElement.height(),g=this.offsets,d=this.targets,k=this.activeTarget;if(j>=h){return k!=(e=d.last()[0])&&this.activate(e)}for(e=g.length;e--;){k!=d[e]&&j>=g[e]&&(!g[e+1]||g[e+1]>=j)&&this.activate(d[e])}},activate:function(f){var e,d;this.activeTarget=f,c(this.selector).parent(".active").removeClass("active"),d=this.selector+'[data-target="'+f+'"],'+this.selector+'[href="'+f+'"]',e=c(d).parent("li").addClass("active"),e.parent(".dropdown-menu").length&&(e=e.closest("li.dropdown").addClass("active")),e.trigger("activate")}};var a=c.fn.scrollspy;c.fn.scrollspy=function(d){return this.each(function(){var g=c(this),f=g.data("scrollspy"),e="object"==typeof d&&d;f||g.data("scrollspy",f=new b(this,e)),"string"==typeof d&&f[d]()})},c.fn.scrollspy.Constructor=b,c.fn.scrollspy.defaults={offset:10},c.fn.scrollspy.noConflict=function(){return c.fn.scrollspy=a,this},c(window).on("load",function(){c('[data-spy="scroll"]').each(function(){var d=c(this);d.scrollspy(d.data())})})}(window.jQuery),!function(c){var b=function(d){this.element=c(d)};b.prototype={constructor:b,show:function(){var h,f,j,i=this.element,g=i.closest("ul:not(.dropdown-menu)"),d=i.attr("data-target");d||(d=i.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),i.parent("li").hasClass("active")||(h=g.find(".active:last a")[0],j=c.Event("show",{relatedTarget:h}),i.trigger(j),j.isDefaultPrevented()||(f=c(d),this.activate(i.parent("li"),g),this.activate(f,f.parent(),function(){i.trigger({type:"shown",relatedTarget:h})})))},activate:function(f,e,i){function g(){d.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),f.addClass("active"),h?(f[0].offsetWidth,f.addClass("in")):f.removeClass("fade"),f.parent(".dropdown-menu")&&f.closest("li.dropdown").addClass("active"),i&&i()}var d=e.find("> .active"),h=i&&c.support.transition&&d.hasClass("fade");h?d.one(c.support.transition.end,g):g(),d.removeClass("in")}};var a=c.fn.tab;c.fn.tab=function(d){return this.each(function(){var f=c(this),e=f.data("tab");e||f.data("tab",e=new b(this)),"string"==typeof d&&e[d]()})},c.fn.tab.Constructor=b,c.fn.tab.noConflict=function(){return c.fn.tab=a,this},c(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(d){d.preventDefault(),c(this).tab("show")})}(window.jQuery),!function(b){var c=function(e,d){this.$element=b(e),this.options=b.extend({},b.fn.typeahead.defaults,d),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=b(this.options.menu),this.shown=!1,this.listen()};c.prototype={constructor:c,select:function(){var d=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(d)).change(),this.hide()},updater:function(d){return d},show:function(){var d=b.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:d.top+d.height,left:d.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(){var d;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(d=b.isFunction(this.source)?this.source(this.query,b.proxy(this.process,this)):this.source,d?this.process(d):this)},process:function(d){var e=this;return d=b.grep(d,function(f){return e.matcher(f)}),d=this.sorter(d),d.length?this.render(d.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(d){return ~d.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(f){for(var h,g=[],e=[],d=[];h=f.shift();){h.toLowerCase().indexOf(this.query.toLowerCase())?~h.indexOf(this.query)?e.push(h):d.push(h):g.push(h)}return g.concat(e,d)},highlighter:function(d){var e=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return d.replace(RegExp("("+e+")","ig"),function(f,g){return"<strong>"+g+"</strong>"})},render:function(d){var e=this;return d=b(d).map(function(f,g){return f=b(e.options.item).attr("data-value",g),f.find("a").html(e.highlighter(g)),f[0]}),d.first().addClass("active"),this.$menu.html(d),this},next:function(){var e=this.$menu.find(".active").removeClass("active"),d=e.next();d.length||(d=b(this.$menu.find("li")[0])),d.addClass("active")},prev:function(){var e=this.$menu.find(".active").removeClass("active"),d=e.prev();d.length||(d=this.$menu.find("li").last()),d.addClass("active")},listen:function(){this.$element.on("blur",b.proxy(this.blur,this)).on("keypress",b.proxy(this.keypress,this)).on("keyup",b.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",b.proxy(this.keydown,this)),this.$menu.on("click",b.proxy(this.click,this)).on("mouseenter","li",b.proxy(this.mouseenter,this))},eventSupported:function(d){var e=d in this.$element;return e||(this.$element.setAttribute(d,"return;"),e="function"==typeof this.$element[d]),e},move:function(d){if(this.shown){switch(d.keyCode){case 9:case 13:case 27:d.preventDefault();break;case 38:d.preventDefault(),this.prev();break;case 40:d.preventDefault(),this.next()}d.stopPropagation()}},keydown:function(d){this.suppressKeyPressRepeat=~b.inArray(d.keyCode,[40,38,9,13,27]),this.move(d)},keypress:function(d){this.suppressKeyPressRepeat||this.move(d)},keyup:function(d){switch(d.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown){return}this.select();break;case 27:if(!this.shown){return}this.hide();break;default:this.lookup()}d.stopPropagation(),d.preventDefault()},blur:function(){var d=this;setTimeout(function(){d.hide()},150)},click:function(d){d.stopPropagation(),d.preventDefault(),this.select()},mouseenter:function(d){this.$menu.find(".active").removeClass("active"),b(d.currentTarget).addClass("active")}};var a=b.fn.typeahead;b.fn.typeahead=function(d){return this.each(function(){var g=b(this),f=g.data("typeahead"),e="object"==typeof d&&d;f||g.data("typeahead",f=new c(this,e)),"string"==typeof d&&f[d]()})},b.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},b.fn.typeahead.Constructor=c,b.fn.typeahead.noConflict=function(){return b.fn.typeahead=a,this},b(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(f){var d=b(this);d.data("typeahead")||(f.preventDefault(),d.typeahead(d.data()))})}(window.jQuery),!function(c){var b=function(e,d){this.options=c.extend({},c.fn.affix.defaults,d),this.$window=c(window).on("scroll.affix.data-api",c.proxy(this.checkPosition,this)).on("click.affix.data-api",c.proxy(function(){setTimeout(c.proxy(this.checkPosition,this),1)},this)),this.$element=c(e),this.checkPosition()};b.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e,h=c(document).height(),j=this.$window.scrollTop(),d=this.$element.offset(),k=this.options.offset,f=k.bottom,g=k.top,i="affix affix-top affix-bottom";"object"!=typeof k&&(f=g=k),"function"==typeof g&&(g=k.top()),"function"==typeof f&&(f=k.bottom()),e=null!=this.unpin&&j+this.unpin<=d.top?!1:null!=f&&d.top+this.$element.height()>=h-f?"bottom":null!=g&&g>=j?"top":!1,this.affixed!==e&&(this.affixed=e,this.unpin="bottom"==e?d.top-j:null,this.$element.removeClass(i).addClass("affix"+(e?"-"+e:"")))}};var a=c.fn.affix;c.fn.affix=function(d){return this.each(function(){var g=c(this),f=g.data("affix"),e="object"==typeof d&&d;f||g.data("affix",f=new b(this,e)),"string"==typeof d&&f[d]()})},c.fn.affix.Constructor=b,c.fn.affix.defaults={offset:0},c.fn.affix.noConflict=function(){return c.fn.affix=a,this},c(window).on("load",function(){c('[data-spy="affix"]').each(function(){var e=c(this),d=e.data();d.offset=d.offset||{},d.offsetBottom&&(d.offset.bottom=d.offsetBottom),d.offsetTop&&(d.offset.top=d.offsetTop),e.affix(d)})})}(window.jQuery);var rotatingProgressTimer=0,rotatingActive=false,rotatingMessages=[];function __resetNestProgress(){clearTimeout(rotatingProgressTimer);rotatingActive=false;rotatingMessages=[];rotatingProgressTimer=0}function __showNestProgress(){if(!rotatingActive){return}if(rotatingMessages.length==0){return}var a=rotatingMessages.shift();progressMessage(a,true,true);if(rotatingMessages.length==0){__resetNestProgress()}else{rotatingProgressTimer=setTimeout(__showNestProgress,Math.random()*5000+2000)}}function progressRotatingMessages(a){rotatingMessages=a;if(!rotatingActive){rotatingActive=true;__showNestProgress()}}function progressCancelRotating(){if(!rotatingActive){return}__resetNestProgress()}var progressCurrentText="#loading-text-1",lastProgressText="";function progressAnimateText(a){if(lastProgressText==a){return}lastProgressText=a;$(progressCurrentText).stop(true,true);$(progressCurrentText).animate({opacity:0},200);if(progressCurrentText=="#loading-text-1"){progressCurrentText="#loading-text-2"}else{progressCurrentText="#loading-text-1"}$(progressCurrentText).stop(true,true);$(progressCurrentText).html(a);$(progressCurrentText).css({opacity:0,top:25});$(progressCurrentText).animate({opacity:1,top:0},200,"easeOutExpo")}function progressUpdate(a,b){a=Math.round(a);progressCancelRotating();$("#loading").fadeIn(500);$("#loading").removeClass("error");$("#progressbar-value").css({width:a+"%"});progressAnimateText(b);$("#loading-percent").html(a+"%")}function progressError(a){progressCancelRotating();$("#loading").fadeIn(500);$("#loading").addClass("error");$("#progressbar-value").css({width:"100%"});progressAnimateText(a);$("#loading-percent").html("")}function progressMessage(c,b,a){if(!a){progressCancelRotating()}$("#loading").fadeIn(500);$("#loading").removeClass("error");$("#progressbar-value").css({width:"100%"});progressAnimateText(c);if(!b){$("#loading-percent").html("")}else{$("#loading-percent").html('<img src="theme/img/ajax-dots.gif" />')}}function showLaunchControls(){$("#launch-controls").fadeIn(500)}function hideLaunchControls(){$("#launch-controls").fadeOut(500,function(){$("#launch-controls").hide()})}function showProgress(){$("#loading").fadeIn(500)}function hideProgress(){progressCancelRotating();$("#loading").fadeOut(500)}function showDashboard(){$("#upper-controls").fadeIn(500);$("#lower-controls").fadeIn(500)}function hideDashboard(){$("#upper-controls").fadeOut(500,function(){$("#upper-controls").hide()});$("#lower-controls").fadeOut(500,function(){$("#lower-controls").hide()})}function aceleratorStop(){v_session.hibernate();hideDashboard();setTimeout(function(){progressMessage("Ramping-down the accelerator",true)},500)}function aceleratorCleanup(){v_session.close();hideDashboard();setTimeout(function(){progressMessage("Dismantling the accelerator",true)},500)}function acceleratorStart(){var b=boincGetInfo();if(!b){v_session.start(localBoincInfo)}else{var a="BOINC_USERNAME="+b.name+"\nBOINC_AUTHENTICATOR="+b.authenticator+"\nBOINC_USERID="+b.id+"\n";console.log("Starting with BOINC_Config",a);v_session.start({boinc_config:a});v_session.setProperty("/boinc/name",b.name);v_session.setProperty("/boinc/id",b.id);v_session.setProperty("/boinc/auth",b.authenticator);$("#boinc-logout").hide()}hideLaunchControls();progressMessage("Ramping-up the accelerator",true)}function acceleratorRDP(a){v_session.openRDPWindow()}function acceleratorOpenRDP(){var b=v_session.__session.resolution,a=b.split("x");var c=window.open("http://cernvm.cern.ch/releases/webapi/webrdp/webclient.html#"+v_session.rdpURL+","+a[0]+","+a[1],"cernvmRDP");window.w=c}function acceleratorSetRDPURL(c){var d=v_session.__session.resolution,b=d.split("x");c.href="http://cernvm.cern.ch/releases/webapi/webrdp/webclient.html#"+v_session.rdpURL+","+b[0]+","+b[1]}function acceleratorLogs(){var a=window.open(v_session.apiURL+"/logs","cernvmLogs")}var localBoincInfo=null;function boincGetInfo(){if(localBoincInfo!=null){return localBoincInfo}if(!localStorage.getItem("boinc-id")){return false}else{return localBoincInfo={id:localStorage.getItem("boinc-id"),name:localStorage.getItem("boinc-name"),authenticator:localStorage.getItem("boinc-auth")}}}function boincLogin(){$("#boinc-error-msg").hide();$("#boinc-login-form").fadeIn()}function boincLogout(){localBoincInfo=null;localStorage.removeItem("boinc-id");localStorage.removeItem("boinc-name");localStorage.removeItem("boinc-auth");boincUpdateStatus(true)}function boincUpdateStatus(a){var b=boincGetInfo();if(!b){if(!a){$("#boinc-login").show();$("#boinc-status").hide()}else{$("#boinc-status").fadeOut(250,function(){$("#boinc-login").fadeIn(250)})}}else{$("#boinc-name").html(b.name);if(!a){$("#boinc-login").hide();$("#boinc-status").show()}else{$("#boinc-login").fadeOut(250,function(){$("#boinc-status").fadeIn(250)})}}}function boincDoLogin(){var d=$("#boinc-login-email").val(),a=$("#boinc-login-password").val(),g=$("#boinc-login-remember").prop("checked");$("#boinc-error-msg").hide();$("#boinc-login-form input").prop("disabled",true);$("#boinc-login-form button").prop("disabled",true);$("#boinc-login-submit").html("Loading...");var c=escape(d),f=md5(a+c.toLowerCase());var b="http://lhcathome2.cern.ch/test4theory";var e=$.ajax({url:b+"/lookup_account.php?email_addr="+c+"&passwd_hash="+f+"&get_opaque_auth=1",dataType:"xml"}).done(function(i){if(i.firstChild.tagName=="error"){$("#boinc-error-msg").html("Login error: "+i.getElementsByTagName("error_msg")[0].textContent);$("#boinc-error-msg").fadeIn()}else{var h=i.getElementsByTagName("authenticator")[0].textContent;if(!h){$("#boinc-error-msg").html("Unable to identify the authenticator");$("#boinc-error-msg").fadeIn()}$.ajax({url:b+"/am_get_info.php?account_key="+h,dataType:"xml"}).done(function(j){if(j.firstChild.tagName=="error"){$("#boinc-error-msg").html("User info error: "+j.getElementsByTagName("error_msg")[0].textContent);$("#boinc-error-msg").fadeIn()}else{localBoincInfo={id:j.getElementsByTagName("id")[0].textContent,name:j.getElementsByTagName("name")[0].textContent,authenticator:h};if(g){localStorage.setItem("boinc-id",localBoincInfo.id);localStorage.setItem("boinc-name",localBoincInfo.name);localStorage.setItem("boinc-auth",localBoincInfo.authenticator)}else{localStorage.removeItem("boinc-id");localStorage.removeItem("boinc-name");localStorage.removeItem("boinc-auth")}$("#boinc-login-form").fadeOut();boincUpdateStatus(true)}}).fail(function(j){$("#boinc-error-msg").html("Connunication error: "+j);$("#boinc-error-msg").fadeIn()})}}).fail(function(h){$("#boinc-error-msg").html("Connunication error: "+h);$("#boinc-error-msg").fadeIn()}).always(function(){$("#boinc-login-form input").prop("disabled",false);$("#boinc-login-form button").prop("disabled",false);$("#boinc-login-submit").html("Login")})}var lhc,v_session;function setPreparingView(){lhc.setView(1);progressRotatingMessages(["Connecting to your instance","Configuring network","Starting critical services","Preparing environment","Preparing accelerator software","Contacting time services","Calibrating timers","Discovering environment","Connecting to controller interface","Connecting to CERN","Authorizing client","Mounting network filesystems","Configuring job manager","Downloading simulator components","Downloading physics configuration","Downloading reference data","Starting work queue","Starting simulator","Probe injection beam","Beam dumped","Physics injection beam","Preparing ramp","Ramping accelerator","Reached flat top","Squeezing beams","Adjusting beams","Stable physics beams","Waiting for physics job"])}var inited=false,isTimeTraveller=false;$(document).ready(function(){if(inited){return}inited=true;$("#not-supported-msg").hide();$("#upper-controls").hide();$("#lower-controls").hide();$("#launch-controls").hide();$("#boinc-login-form").hide();boincUpdateStatus();progressUpdate(0,"Setting up environment");$("body").removeClass("not-ready");$(".dial").knob();function d(){try{var f=new M.Viewport({container:"#collider",bg:0,autostop:false,fullscreen:false,stats:false});f.renderer.sortObjects=false;lhc=new M.AcceleratorRing(f.camera);f.scene.add(lhc);f.addUpdateHandler(lhc.update.bind(lhc));lhc.setView(0)}catch(g){$("#not-supported-msg").fadeIn();$("#loading").hide();isTimeTraveller=true;return}}function a(){CVM.debugLogging=true;CVM.addInstallProgressHandler(function(f,h){var g=f*30/100;progressUpdate(10+g,h);console.log("InstallProgress = ",10+g)});CVM.startCVMWebAPI(function(f){progressUpdate(20,"Establishing session");f.addEventListener("progress",function(g,i){var h=g*40/100;progressUpdate(40+h,i);console.log("pluginProgress = ",40+h)});f.requestSession("http://test.local/VirtualAtomSmasher/sign.php",function(h){window.s=h;v_session=h;if(h.state==2){showLaunchControls()}var g=h.getProperty("/boinc/name");if(g!=""){$("#boinc-logout").hide();if(localBoincInfo==null){localBoincInfo={name:g,id:h.getProperty("/boinc/id"),authenticator:h.getProperty("/boinc/auth")};boincUpdateStatus(false)}}h.addEventListener("progress",function(i,k){var j=i*20/100;progressUpdate(80+j,k);console.log("sessionProgress = ",80+j)});h.addEventListener("error",function(i){lhc.setView(3);progressError(i)});h.addEventListener("sessionStateChange",function(i){if(i==2){progressMessage("Your accelerator is closed");lhc.setView(0);showLaunchControls();hideDashboard()}else{if((i==3)||(i==4)){setPreparingView();hideLaunchControls();hideDashboard()}else{if(i==6){progressMessage("Your accelerator is frozen");lhc.setView(0);showLaunchControls();hideDashboard()}else{if(i==0){progressMessage("Your accelerator is destroyed");lhc.setView(0);showLaunchControls();hideDashboard();$("#boinc-logout").show();boincUpdateStatus(false)}}}}});h.addEventListener("apiAvailable",function(){lhc.setView(2);hideProgress();showDashboard()});h.addEventListener("apiUnavailable",function(){if(lhc.view!=0){progressMessage("Disconnected from the accelerator");lhc.setView(1);hideDashboard();h.__session.update();setTimeout(function(){if((h.state==2)&&(lhc.view!=0)){progressMessage("Your accelerator is closed");lhc.setView(0);showLaunchControls();hideDashboard()}},1000)}})},function(g){lhc.setView(3);progressError(g)})},function(f){lhc.setView(3);progressError(f)},true)}var e=[];var c=8;var b=new UsersBar("#user-list",{width:250,height:250,flip:true});window.updateUsers=function(){e=[];var f=Math.round(Math.random()*10000000);for(var g=0;g<15;g++){e.push({credit:f,text:"User "+g,me:(g==c)});f+=Math.round(Math.random()*80)+30}b.update(e)};window.updateUsers();progressUpdate(0,"Starting WebGL");setTimeout(function(){d();progressUpdate(0,"Starting CernVM WebAPI");setTimeout(function(){if(isTimeTraveller){return}a()},500)},500)});